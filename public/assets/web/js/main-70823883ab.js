"use strict";var app;!function(){var e=function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&t[n]&&(e[n]=t[n])};function t(t){if(t&&(this._config={chunkSize:1048576},!(this._config.chunkSize&&this._config.chunkSize<102400)&&(e(this._config,t),(this._config.aliyunCredential||this._config.stsToken)&&this._config.endpoint))){var n=window.ALY;this._config.stsToken?this.oss=new n.OSS({accessKeyId:this._config.stsToken.Credentials.AccessKeyId,secretAccessKey:this._config.stsToken.Credentials.AccessKeySecret,securityToken:this._config.stsToken.Credentials.SecurityToken,endpoint:this._config.endpoint,apiVersion:"2013-10-15"}):this.oss=new n.OSS({accessKeyId:this._config.aliyunCredential.accessKeyId,secretAccessKey:this._config.aliyunCredential.secretAccessKey,endpoint:this._config.endpoint,apiVersion:"2013-10-15"});var o=this._config.endpoint.split("://");o.length<2||(this._config.endpoint={protocol:o[0],host:o[1]})}}t.prototype.upload=function(t){if(t)if(t.file){var n=t.file;if(t.key){t.key.replace(new RegExp("^/"),"");var o=this;!function(e){var r={chunksHash:{},chunks:[]},i=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,a=o._config.chunkSize,s=Math.ceil(n.size/a),l=0,c=function(t){r.chunks[l]=t.target.result,++l<s?u():(r.file_size=n.size,e(null,r))},p=function(){console.error("读取文件失败"),"function"==typeof t.onerror&&t.onerror("读取文件失败")};function u(){var e=new FileReader;e.onload=c,e.onerror=p;var t=l*a,o=t+a>=n.size?n.size:t+a,r=i.call(n,t,o);e.readAsArrayBuffer(r)}u()}(function(r,i){var a=function(e,n){e?"function"==typeof t.onerror&&t.onerror(e):"function"==typeof t.oncomplete&&t.oncomplete(n)};1==i.chunks.length?function(r,i){var a={Bucket:o._config.bucket,Key:t.key,Body:r.chunks[0],ContentType:n.type||""};e(a,t.headers),o.oss.putObject(a,i).on("httpUploadProgress",function(e){"function"==typeof t.onprogress&&t.onprogress({loaded:e.loaded,total:n.size})})}(i,a):function(r,i){var a,s,l=t.maxRetry||3,c=0,p=-1,u=0,d={Parts:[]},f=function(e){if(!(e>=r.chunks.length)){p<e&&(p=e),++u<o._config.concurrency&&e<r.chunks.length-1&&f(e+1);var s={Body:r.chunks[e],Bucket:o._config.bucket,Key:t.key,PartNumber:String(e+1),UploadId:a},m=1,g=function(){d.Parts[e]={PartNumber:e+1,loaded:0},o.oss.uploadPart(s,function(t,n){t?m>l?i(t):(d.Parts[e].loaded=0,m++,g()):(d.Parts[e].ETag=n.ETag,d.Parts[e].loaded=s.Body.byteLength,u--,++c==r.chunks.length?h():f(p+1))}).on("httpUploadProgress",function(o){d.Parts[e].loaded=o.loaded;var r=0;for(var i in d.Parts)r+=d.Parts[i].loaded;"function"==typeof t.onprogress&&t.onprogress({loaded:r,total:n.size})})};g()}},h=function(){for(var e in d.Parts)delete d.Parts[e].loaded;var n={Bucket:o._config.bucket,Key:t.key,CompleteMultipartUpload:d,UploadId:a};o.oss.completeMultipartUpload(n,i)};s={Bucket:o._config.bucket,Key:t.key,ContentType:n.type||""},e(s,t.headers),o.oss.createMultipartUpload(s,function(e,t){e?i(e):(a=t.UploadId,f(0))})}(i,a)})}else"function"==typeof t.onerror&&t.onerror("需要 key")}else"function"==typeof t.onerror&&t.onerror("需要 file");else"function"==typeof t.onerror&&t.onerror("需要 options")},window.OssUpload=t}(),angular.module("ui.bootstrap",["ui.bootstrap.collapse","ui.bootstrap.tabindex","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.isClass","ui.bootstrap.datepicker","ui.bootstrap.position","ui.bootstrap.datepickerPopup","ui.bootstrap.debounce","ui.bootstrap.multiMap","ui.bootstrap.dropdown","ui.bootstrap.stackedMap","ui.bootstrap.modal","ui.bootstrap.paging","ui.bootstrap.pager","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.collapse",[]).directive("uibCollapse",["$animate","$q","$parse","$injector",function(e,t,n,o){var r=o.has("$animateCss")?o.get("$animateCss"):null;return{link:function(o,i,a){var s=n(a.expanding),l=n(a.expanded),c=n(a.collapsing),p=n(a.collapsed),u=!1,d={},f={};function h(e){return u?{width:e.scrollWidth+"px"}:{height:e.scrollHeight+"px"}}function m(){i.removeClass("collapsing").addClass("collapse").css(d),l(o)}function g(){i.css(f),i.removeClass("collapsing").addClass("collapse"),p(o)}!function(){(u=!!("horizontal"in a))?(d={width:""},f={width:"0"}):(d={height:""},f={height:"0"});o.$eval(a.uibCollapse)||i.addClass("in").addClass("collapse").attr("aria-expanded",!0).attr("aria-hidden",!1).css(d)}(),o.$watch(a.uibCollapse,function(n){n?function(){if(!i.hasClass("collapse")&&!i.hasClass("in"))return g();t.resolve(c(o)).then(function(){i.css(h(i[0])).removeClass("collapse").addClass("collapsing").attr("aria-expanded",!1).attr("aria-hidden",!0),r?r(i,{removeClass:"in",to:f}).start().finally(g):e.removeClass(i,"in",{to:f}).then(g)},angular.noop)}():i.hasClass("collapse")&&i.hasClass("in")||t.resolve(s(o)).then(function(){i.removeClass("collapse").addClass("collapsing").attr("aria-expanded",!0).attr("aria-hidden",!1),r?r(i,{addClass:"in",easing:"ease",css:{overflow:"hidden"},to:h(i[0])}).start().finally(m):e.addClass(i,"in",{css:{overflow:"hidden"},to:h(i[0])}).then(m)},angular.noop)})}}}]),angular.module("ui.bootstrap.tabindex",[]).directive("uibTabindexToggle",function(){return{restrict:"A",link:function(e,t,n){n.$observe("disabled",function(e){n.$set("tabindex",e?-1:null)})}}}),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse","ui.bootstrap.tabindex"]).constant("uibAccordionConfig",{closeOthers:!0}).controller("UibAccordionController",["$scope","$attrs","uibAccordionConfig",function(e,t,n){this.groups=[],this.closeOthers=function(o){(angular.isDefined(t.closeOthers)?e.$eval(t.closeOthers):n.closeOthers)&&angular.forEach(this.groups,function(e){e!==o&&(e.isOpen=!1)})},this.addGroup=function(e){var t=this;this.groups.push(e),e.$on("$destroy",function(n){t.removeGroup(e)})},this.removeGroup=function(e){var t=this.groups.indexOf(e);-1!==t&&this.groups.splice(t,1)}}]).directive("uibAccordion",function(){return{controller:"UibAccordionController",controllerAs:"accordion",transclude:!0,templateUrl:function(e,t){return t.templateUrl||"uib/template/accordion/accordion.html"}}}).directive("uibAccordionGroup",function(){return{require:"^uibAccordion",transclude:!0,restrict:"A",templateUrl:function(e,t){return t.templateUrl||"uib/template/accordion/accordion-group.html"},scope:{heading:"@",panelClass:"@?",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(e){this.heading=e}},link:function(e,t,n,o){t.addClass("panel"),o.addGroup(e),e.openClass=n.openClass||"panel-open",e.panelClass=n.panelClass||"panel-default",e.$watch("isOpen",function(n){t.toggleClass(e.openClass,!!n),n&&o.closeOthers(e)}),e.toggleOpen=function(t){e.isDisabled||t&&32!==t.which||(e.isOpen=!e.isOpen)};var r="accordiongroup-"+e.$id+"-"+Math.floor(1e4*Math.random());e.headingId=r+"-tab",e.panelId=r+"-panel"}}}).directive("uibAccordionHeading",function(){return{transclude:!0,template:"",replace:!0,require:"^uibAccordionGroup",link:function(e,t,n,o,r){o.setHeading(r(e,angular.noop))}}}).directive("uibAccordionTransclude",function(){return{require:"^uibAccordionGroup",link:function(e,t,n,o){e.$watch(function(){return o[n.uibAccordionTransclude]},function(e){if(e){var n=angular.element(t[0].querySelector("uib-accordion-header,data-uib-accordion-header,x-uib-accordion-header,uib\\:accordion-header,[uib-accordion-header],[data-uib-accordion-header],[x-uib-accordion-header]"));n.html(""),n.append(e)}})}}}),angular.module("ui.bootstrap.alert",[]).controller("UibAlertController",["$scope","$element","$attrs","$interpolate","$timeout",function(e,t,n,o,r){e.closeable=!!n.close,t.addClass("alert"),n.$set("role","alert"),e.closeable&&t.addClass("alert-dismissible");var i=angular.isDefined(n.dismissOnTimeout)?o(n.dismissOnTimeout)(e.$parent):null;i&&r(function(){e.close()},parseInt(i,10))}]).directive("uibAlert",function(){return{controller:"UibAlertController",controllerAs:"alert",restrict:"A",templateUrl:function(e,t){return t.templateUrl||"uib/template/alert/alert.html"},transclude:!0,scope:{close:"&"}}}),angular.module("ui.bootstrap.buttons",[]).constant("uibButtonConfig",{activeClass:"active",toggleEvent:"click"}).controller("UibButtonsController",["uibButtonConfig",function(e){this.activeClass=e.activeClass||"active",this.toggleEvent=e.toggleEvent||"click"}]).directive("uibBtnRadio",["$parse",function(e){return{require:["uibBtnRadio","ngModel"],controller:"UibButtonsController",controllerAs:"buttons",link:function(t,n,o,r){var i=r[0],a=r[1],s=e(o.uibUncheckable);n.find("input").css({display:"none"}),a.$render=function(){n.toggleClass(i.activeClass,angular.equals(a.$modelValue,t.$eval(o.uibBtnRadio)))},n.on(i.toggleEvent,function(){if(!o.disabled){var e=n.hasClass(i.activeClass);e&&!angular.isDefined(o.uncheckable)||t.$apply(function(){a.$setViewValue(e?null:t.$eval(o.uibBtnRadio)),a.$render()})}}),o.uibUncheckable&&t.$watch(s,function(e){o.$set("uncheckable",e?"":void 0)})}}}]).directive("uibBtnCheckbox",function(){return{require:["uibBtnCheckbox","ngModel"],controller:"UibButtonsController",controllerAs:"button",link:function(e,t,n,o){var r=o[0],i=o[1];function a(){return s(n.btnCheckboxTrue,!0)}function s(t,n){return angular.isDefined(t)?e.$eval(t):n}t.find("input").css({display:"none"}),i.$render=function(){t.toggleClass(r.activeClass,angular.equals(i.$modelValue,a()))},t.on(r.toggleEvent,function(){n.disabled||e.$apply(function(){i.$setViewValue(t.hasClass(r.activeClass)?s(n.btnCheckboxFalse,!1):a()),i.$render()})})}}}),angular.module("ui.bootstrap.carousel",[]).controller("UibCarouselController",["$scope","$element","$interval","$timeout","$animate",function(e,t,n,o,r){var i,a,s=this,l=s.slides=e.slides=[],c="uib-slideDirection",p=e.active,u=!1;function d(e){for(var t=0;t<l.length;t++)l[t].slide.active=t===e}function f(e){for(var t=0;t<l.length;t++)if(l[t].slide===e)return t}function h(){i&&(n.cancel(i),i=null)}function m(){h();var t=+e.interval;!isNaN(t)&&t>0&&(i=n(g,t))}function g(){var t=+e.interval;a&&!isNaN(t)&&t>0&&l.length?e.next():e.pause()}t.addClass("carousel"),s.addSlide=function(t,n){l.push({slide:t,element:n}),l.sort(function(e,t){return+e.slide.index-+t.slide.index}),(t.index===e.active||1===l.length&&!angular.isNumber(e.active))&&(e.$currentTransition&&(e.$currentTransition=null),p=t.index,e.active=t.index,d(p),s.select(l[f(t)]),1===l.length&&e.play())},s.getCurrentIndex=function(){for(var e=0;e<l.length;e++)if(l[e].slide.index===p)return e},s.next=e.next=function(){var t=(s.getCurrentIndex()+1)%l.length;if(0!==t||!e.noWrap())return s.select(l[t],"next");e.pause()},s.prev=e.prev=function(){var t=s.getCurrentIndex()-1<0?l.length-1:s.getCurrentIndex()-1;if(!e.noWrap()||t!==l.length-1)return s.select(l[t],"prev");e.pause()},s.removeSlide=function(t){var n=f(t);l.splice(n,1),l.length>0&&p===n?n>=l.length?(p=l.length-1,e.active=p,d(p),s.select(l[l.length-1])):(p=n,e.active=p,d(p),s.select(l[n])):p>n&&(p--,e.active=p),0===l.length&&(p=null,e.active=null)},s.select=e.select=function(n,o){var i=f(n.slide);void 0===o&&(o=i>s.getCurrentIndex()?"next":"prev"),n.slide.index===p||e.$currentTransition||function(n,o,i){if(u)return;if(angular.extend(n,{direction:i}),angular.extend(l[p].slide||{},{direction:i}),r.enabled(t)&&!e.$currentTransition&&l[o].element&&s.slides.length>1){l[o].element.data(c,n.direction);var a=s.getCurrentIndex();angular.isNumber(a)&&l[a].element&&l[a].element.data(c,n.direction),e.$currentTransition=!0,r.on("addClass",l[o].element,function(t,n){"close"===n&&(e.$currentTransition=null,r.off("addClass",t))})}e.active=n.index,p=n.index,d(o),m()}(n.slide,i,o)},e.indexOfSlide=function(e){return+e.slide.index},e.isActive=function(t){return e.active===t.slide.index},e.isPrevDisabled=function(){return 0===e.active&&e.noWrap()},e.isNextDisabled=function(){return e.active===l.length-1&&e.noWrap()},e.pause=function(){e.noPause||(a=!1,h())},e.play=function(){a||(a=!0,m())},t.on("mouseenter",e.pause),t.on("mouseleave",e.play),e.$on("$destroy",function(){u=!0,h()}),e.$watch("noTransition",function(e){r.enabled(t,!e)}),e.$watch("interval",m),e.$watchCollection("slides",function(t){t.length||(e.$currentTransition=null)}),e.$watch("active",function(e){if(angular.isNumber(e)&&p!==e){for(var t=0;t<l.length;t++)if(l[t].slide.index===e){e=t;break}l[e]&&(d(e),s.select(l[e]),p=e)}})}]).directive("uibCarousel",function(){return{transclude:!0,controller:"UibCarouselController",controllerAs:"carousel",restrict:"A",templateUrl:function(e,t){return t.templateUrl||"uib/template/carousel/carousel.html"},scope:{active:"=",interval:"=",noTransition:"=",noPause:"=",noWrap:"&"}}}).directive("uibSlide",["$animate",function(e){return{require:"^uibCarousel",restrict:"A",transclude:!0,templateUrl:function(e,t){return t.templateUrl||"uib/template/carousel/slide.html"},scope:{actual:"=?",index:"=?"},link:function(t,n,o,r){n.addClass("item"),r.addSlide(t,n),t.$on("$destroy",function(){r.removeSlide(t)}),t.$watch("active",function(t){e[t?"addClass":"removeClass"](n,"active")})}}}]).animation(".item",["$animateCss",function(e){function t(e,t,n){e.removeClass(t),n&&n()}return{beforeAddClass:function(n,o,r){if("active"===o){var i=n.data("uib-slideDirection"),a="next"===i?"left":"right",s=t.bind(this,n,a+" "+i,r);return n.addClass(i),e(n,{addClass:a}).start().done(s),function(){!0}}r()},beforeRemoveClass:function(n,o,r){if("active"===o){var i="next"===n.data("uib-slideDirection")?"left":"right",a=t.bind(this,n,i,r);return e(n,{addClass:i}).start().done(a),function(){!0}}r()}}}]),angular.module("ui.bootstrap.dateparser",[]).service("uibDateParser",["$log","$locale","dateFilter","orderByFilter","filterFilter",function(e,t,n,o,r){var i,a,s=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;function l(e){return r(a,{key:e},!0)[0]}function c(e,t,n){return function(){return e.substr(t+1,n-t-1)}}function p(e,t){for(var n=e.substr(t),o=0;o<a.length;o++)if(new RegExp("^"+a[o].key).test(n)){var r=a[o];return{endIdx:t+r.key.length,parser:r.formatter}}return{endIdx:t+1,parser:function(){return n.charAt(0)}}}function u(e){return parseInt(e,10)}function d(e,t){e=e.replace(/:/g,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function f(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}function h(e,t,n){n=n?-1:1;var o=e.getTimezoneOffset();return f(e,n*(d(t,o)-o))}this.init=function(){i=t.id,this.parsers={},this.formatters={},a=[{key:"yyyy",regex:"\\d{4}",apply:function(e){this.year=+e},formatter:function(e){var t=new Date;return t.setFullYear(Math.abs(e.getFullYear())),n(t,"yyyy")}},{key:"yy",regex:"\\d{2}",apply:function(e){e=+e,this.year=e<69?e+2e3:e+1900},formatter:function(e){var t=new Date;return t.setFullYear(Math.abs(e.getFullYear())),n(t,"yy")}},{key:"y",regex:"\\d{1,4}",apply:function(e){this.year=+e},formatter:function(e){var t=new Date;return t.setFullYear(Math.abs(e.getFullYear())),n(t,"y")}},{key:"M!",regex:"0?[1-9]|1[0-2]",apply:function(e){this.month=e-1},formatter:function(e){var t=e.getMonth();return/^[0-9]$/.test(t)?n(e,"MM"):n(e,"M")}},{key:"MMMM",regex:t.DATETIME_FORMATS.MONTH.join("|"),apply:function(e){this.month=t.DATETIME_FORMATS.MONTH.indexOf(e)},formatter:function(e){return n(e,"MMMM")}},{key:"MMM",regex:t.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(e){this.month=t.DATETIME_FORMATS.SHORTMONTH.indexOf(e)},formatter:function(e){return n(e,"MMM")}},{key:"MM",regex:"0[1-9]|1[0-2]",apply:function(e){this.month=e-1},formatter:function(e){return n(e,"MM")}},{key:"M",regex:"[1-9]|1[0-2]",apply:function(e){this.month=e-1},formatter:function(e){return n(e,"M")}},{key:"d!",regex:"[0-2]?[0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e},formatter:function(e){var t=e.getDate();return/^[1-9]$/.test(t)?n(e,"dd"):n(e,"d")}},{key:"dd",regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e},formatter:function(e){return n(e,"dd")}},{key:"d",regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e},formatter:function(e){return n(e,"d")}},{key:"EEEE",regex:t.DATETIME_FORMATS.DAY.join("|"),formatter:function(e){return n(e,"EEEE")}},{key:"EEE",regex:t.DATETIME_FORMATS.SHORTDAY.join("|"),formatter:function(e){return n(e,"EEE")}},{key:"HH",regex:"(?:0|1)[0-9]|2[0-3]",apply:function(e){this.hours=+e},formatter:function(e){return n(e,"HH")}},{key:"hh",regex:"0[0-9]|1[0-2]",apply:function(e){this.hours=+e},formatter:function(e){return n(e,"hh")}},{key:"H",regex:"1?[0-9]|2[0-3]",apply:function(e){this.hours=+e},formatter:function(e){return n(e,"H")}},{key:"h",regex:"[0-9]|1[0-2]",apply:function(e){this.hours=+e},formatter:function(e){return n(e,"h")}},{key:"mm",regex:"[0-5][0-9]",apply:function(e){this.minutes=+e},formatter:function(e){return n(e,"mm")}},{key:"m",regex:"[0-9]|[1-5][0-9]",apply:function(e){this.minutes=+e},formatter:function(e){return n(e,"m")}},{key:"sss",regex:"[0-9][0-9][0-9]",apply:function(e){this.milliseconds=+e},formatter:function(e){return n(e,"sss")}},{key:"ss",regex:"[0-5][0-9]",apply:function(e){this.seconds=+e},formatter:function(e){return n(e,"ss")}},{key:"s",regex:"[0-9]|[1-5][0-9]",apply:function(e){this.seconds=+e},formatter:function(e){return n(e,"s")}},{key:"a",regex:t.DATETIME_FORMATS.AMPMS.join("|"),apply:function(e){12===this.hours&&(this.hours=0),"PM"===e&&(this.hours+=12)},formatter:function(e){return n(e,"a")}},{key:"Z",regex:"[+-]\\d{4}",apply:function(e){var t=e.match(/([+-])(\d{2})(\d{2})/),n=t[1],o=t[2],r=t[3];this.hours+=u(n+o),this.minutes+=u(n+r)},formatter:function(e){return n(e,"Z")}},{key:"ww",regex:"[0-4][0-9]|5[0-3]",formatter:function(e){return n(e,"ww")}},{key:"w",regex:"[0-9]|[1-4][0-9]|5[0-3]",formatter:function(e){return n(e,"w")}},{key:"GGGG",regex:t.DATETIME_FORMATS.ERANAMES.join("|").replace(/\s/g,"\\s"),formatter:function(e){return n(e,"GGGG")}},{key:"GGG",regex:t.DATETIME_FORMATS.ERAS.join("|"),formatter:function(e){return n(e,"GGG")}},{key:"GG",regex:t.DATETIME_FORMATS.ERAS.join("|"),formatter:function(e){return n(e,"GG")}},{key:"G",regex:t.DATETIME_FORMATS.ERAS.join("|"),formatter:function(e){return n(e,"G")}}],angular.version.major>=1&&angular.version.minor>4&&a.push({key:"LLLL",regex:t.DATETIME_FORMATS.STANDALONEMONTH.join("|"),apply:function(e){this.month=t.DATETIME_FORMATS.STANDALONEMONTH.indexOf(e)},formatter:function(e){return n(e,"LLLL")}})},this.init(),this.getParser=function(e){var t=l(e);return t&&t.apply||null},this.overrideParser=function(e,t){var n=l(e);n&&angular.isFunction(t)&&(this.parsers={},n.apply=t)}.bind(this),this.filter=function(e,n){return angular.isDate(e)&&!isNaN(e)&&n?(n=t.DATETIME_FORMATS[n]||n,t.id!==i&&this.init(),this.formatters[n]||(this.formatters[n]=function(e){for(var t,n,o=[],r=0;r<e.length;)if(angular.isNumber(n)){if("'"===e.charAt(r))(r+1>=e.length||"'"!==e.charAt(r+1))&&(o.push(c(e,n,r)),n=null);else if(r===e.length)for(;n<e.length;)t=p(e,n),o.push(t),n=t.endIdx;r++}else"'"!==e.charAt(r)?(t=p(e,r),o.push(t.parser),r=t.endIdx):(n=r,r++);return o}(n)),this.formatters[n].reduce(function(t,n){return t+n(e)},"")):""},this.parse=function(n,r,l){if(!angular.isString(n)||!r)return n;r=(r=t.DATETIME_FORMATS[r]||r).replace(s,"\\$&"),t.id!==i&&this.init(),this.parsers[r]||(this.parsers[r]=function(e){var t=[],n=e.split(""),r=e.indexOf("'");if(r>-1){var i=!1;e=e.split("");for(var s=r;s<e.length;s++)i?("'"===e[s]&&(s+1<e.length&&"'"===e[s+1]?(e[s+1]="$",n[s+1]=""):(n[s]="",i=!1)),e[s]="$"):"'"===e[s]&&(e[s]="$",n[s]="",i=!0);e=e.join("")}return angular.forEach(a,function(o){var r=e.indexOf(o.key);if(r>-1){e=e.split(""),n[r]="("+o.regex+")",e[r]="$";for(var i=r+1,a=r+o.key.length;i<a;i++)n[i]="",e[i]="$";e=e.join(""),t.push({index:r,key:o.key,apply:o.apply,matcher:o.regex})}}),{regex:new RegExp("^"+n.join("")+"$"),map:o(t,"index")}}(r));var c=this.parsers[r],p=c.regex,u=c.map,d=n.match(p),f=!1;if(d&&d.length){var h,m;angular.isDate(l)&&!isNaN(l.getTime())?h={year:l.getFullYear(),month:l.getMonth(),date:l.getDate(),hours:l.getHours(),minutes:l.getMinutes(),seconds:l.getSeconds(),milliseconds:l.getMilliseconds()}:(l&&e.warn("dateparser:","baseDate is not a valid date"),h={year:1900,month:0,date:1,hours:0,minutes:0,seconds:0,milliseconds:0});for(var g=1,v=d.length;g<v;g++){var b=u[g-1];"Z"===b.matcher&&(f=!0),b.apply&&b.apply.call(h,d[g])}var y=f?Date.prototype.setUTCFullYear:Date.prototype.setFullYear,w=f?Date.prototype.setUTCHours:Date.prototype.setHours;return function(e,t,n){if(n<1)return!1;if(1===t&&n>28)return 29===n&&(e%4==0&&e%100!=0||e%400==0);if(3===t||5===t||8===t||10===t)return n<31;return!0}(h.year,h.month,h.date)&&(!angular.isDate(l)||isNaN(l.getTime())||f?(m=new Date(0),y.call(m,h.year,h.month,h.date),w.call(m,h.hours||0,h.minutes||0,h.seconds||0,h.milliseconds||0)):(m=new Date(l),y.call(m,h.year,h.month,h.date),w.call(m,h.hours,h.minutes,h.seconds,h.milliseconds))),m}},this.toTimezone=function(e,t){return e&&t?h(e,t):e},this.fromTimezone=function(e,t){return e&&t?h(e,t,!0):e},this.timezoneToOffset=d,this.addDateMinutes=f,this.convertTimezoneToLocal=h}]),angular.module("ui.bootstrap.isClass",[]).directive("uibIsClass",["$animate",function(e){var t=/^\s*([\s\S]+?)\s+on\s+([\s\S]+?)\s*$/,n=/^\s*([\s\S]+?)\s+for\s+([\s\S]+?)\s*$/;return{restrict:"A",compile:function(o,r){var i=[],a=[],s={},l=r.uibIsClass.match(t),c=l[2],p=l[1].split(",");return function(t,o,r){i.push(t),a.push({scope:t,element:o}),p.forEach(function(o,r){!function(t,o){var r=t.match(n),i=o.$eval(r[1]),l=r[2],p=s[t];if(!p){var u=function(t){var n=null;a.some(function(e){var o=e.scope.$eval(c);if(o===t)return n=e,!0}),p.lastActivated!==n&&(p.lastActivated&&e.removeClass(p.lastActivated.element,i),n&&e.addClass(n.element,i),p.lastActivated=n)};s[t]=p={lastActivated:null,scope:o,watchFn:u,compareWithExp:l,watcher:o.$watch(l,u)}}p.watchFn(o.$eval(l))}(o,t)}),t.$on("$destroy",u)};function u(e){var t=e.targetScope,n=i.indexOf(t);if(i.splice(n,1),a.splice(n,1),i.length){var o=i[0];angular.forEach(s,function(e){e.scope===t&&(e.watcher=o.$watch(e.compareWithExp,e.watchFn),e.scope=o)})}else s={}}}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.isClass"]).value("$datepickerSuppressError",!1).value("$datepickerLiteralWarning",!0).constant("uibDatepickerConfig",{datepickerMode:"day",formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",maxDate:null,maxMode:"year",minDate:null,minMode:"day",monthColumns:3,ngModelOptions:{},shortcutPropagation:!1,showWeeks:!0,yearColumns:5,yearRows:4}).controller("UibDatepickerController",["$scope","$element","$attrs","$parse","$interpolate","$locale","$log","dateFilter","uibDatepickerConfig","$datepickerLiteralWarning","$datepickerSuppressError","uibDateParser",function(e,t,n,o,r,i,a,s,l,c,p,u){var d=this,f={$setViewValue:angular.noop},h={},m=[];t.addClass("uib-datepicker"),n.$set("role","application"),e.datepickerOptions||(e.datepickerOptions={}),this.modes=["day","month","year"],["customClass","dateDisabled","datepickerMode","formatDay","formatDayHeader","formatDayTitle","formatMonth","formatMonthTitle","formatYear","maxDate","maxMode","minDate","minMode","monthColumns","showWeeks","shortcutPropagation","startingDay","yearColumns","yearRows"].forEach(function(t){switch(t){case"customClass":case"dateDisabled":e[t]=e.datepickerOptions[t]||angular.noop;break;case"datepickerMode":e.datepickerMode=angular.isDefined(e.datepickerOptions.datepickerMode)?e.datepickerOptions.datepickerMode:l.datepickerMode;break;case"formatDay":case"formatDayHeader":case"formatDayTitle":case"formatMonth":case"formatMonthTitle":case"formatYear":d[t]=angular.isDefined(e.datepickerOptions[t])?r(e.datepickerOptions[t])(e.$parent):l[t];break;case"monthColumns":case"showWeeks":case"shortcutPropagation":case"yearColumns":case"yearRows":d[t]=angular.isDefined(e.datepickerOptions[t])?e.datepickerOptions[t]:l[t];break;case"startingDay":angular.isDefined(e.datepickerOptions.startingDay)?d.startingDay=e.datepickerOptions.startingDay:angular.isNumber(l.startingDay)?d.startingDay=l.startingDay:d.startingDay=(i.DATETIME_FORMATS.FIRSTDAYOFWEEK+8)%7;break;case"maxDate":case"minDate":e.$watch("datepickerOptions."+t,function(e){e?angular.isDate(e)?d[t]=u.fromTimezone(new Date(e),h.getOption("timezone")):(c&&a.warn("Literal date support has been deprecated, please switch to date object usage"),d[t]=new Date(s(e,"medium"))):d[t]=l[t]?u.fromTimezone(new Date(l[t]),h.getOption("timezone")):null,d.refreshView()});break;case"maxMode":case"minMode":e.datepickerOptions[t]?e.$watch(function(){return e.datepickerOptions[t]},function(n){d[t]=e[t]=angular.isDefined(n)?n:e.datepickerOptions[t],("minMode"===t&&d.modes.indexOf(e.datepickerOptions.datepickerMode)<d.modes.indexOf(d[t])||"maxMode"===t&&d.modes.indexOf(e.datepickerOptions.datepickerMode)>d.modes.indexOf(d[t]))&&(e.datepickerMode=d[t],e.datepickerOptions.datepickerMode=d[t])}):d[t]=e[t]=l[t]||null}}),e.uniqueId="datepicker-"+e.$id+"-"+Math.floor(1e4*Math.random()),e.disabled=angular.isDefined(n.disabled)||!1,angular.isDefined(n.ngDisabled)&&m.push(e.$parent.$watch(n.ngDisabled,function(t){e.disabled=t,d.refreshView()})),e.isActive=function(t){return 0===d.compare(t.date,d.activeDate)&&(e.activeDateId=t.uid,!0)},this.init=function(t){h=function(t){var n;if(angular.version.minor<6)(n=t.$options||e.datepickerOptions.ngModelOptions||l.ngModelOptions||{}).getOption=function(e){return n[e]};else{var o=t.$options.getOption("timezone")||(e.datepickerOptions.ngModelOptions?e.datepickerOptions.ngModelOptions.timezone:null)||(l.ngModelOptions?l.ngModelOptions.timezone:null);n=t.$options.createChild(l.ngModelOptions).createChild(e.datepickerOptions.ngModelOptions).createChild(t.$options).createChild({timezone:o})}return n}(f=t),e.datepickerOptions.initDate?(d.activeDate=u.fromTimezone(e.datepickerOptions.initDate,h.getOption("timezone"))||new Date,e.$watch("datepickerOptions.initDate",function(e){e&&(f.$isEmpty(f.$modelValue)||f.$invalid)&&(d.activeDate=u.fromTimezone(e,h.getOption("timezone")),d.refreshView())})):d.activeDate=new Date;var n=f.$modelValue?new Date(f.$modelValue):new Date;this.activeDate=isNaN(n)?u.fromTimezone(new Date,h.getOption("timezone")):u.fromTimezone(n,h.getOption("timezone")),f.$render=function(){d.render()}},this.render=function(){if(f.$viewValue){var e=new Date(f.$viewValue);!isNaN(e)?this.activeDate=u.fromTimezone(e,h.getOption("timezone")):p||a.error('Datepicker directive: "ng-model" value must be a Date object')}this.refreshView()},this.refreshView=function(){if(this.element){e.selectedDt=null,this._refreshView(),e.activeDt&&(e.activeDateId=e.activeDt.uid);var t=f.$viewValue?new Date(f.$viewValue):null;t=u.fromTimezone(t,h.getOption("timezone")),f.$setValidity("dateDisabled",!t||this.element&&!this.isDisabled(t))}},this.createDateObject=function(t,n){var o=f.$viewValue?new Date(f.$viewValue):null;o=u.fromTimezone(o,h.getOption("timezone"));var r=new Date;r=u.fromTimezone(r,h.getOption("timezone"));var i=this.compare(t,r),a={date:t,label:u.filter(t,n),selected:o&&0===this.compare(t,o),disabled:this.isDisabled(t),past:i<0,current:0===i,future:i>0,customClass:this.customClass(t)||null};return o&&0===this.compare(t,o)&&(e.selectedDt=a),d.activeDate&&0===this.compare(a.date,d.activeDate)&&(e.activeDt=a),a},this.isDisabled=function(t){return e.disabled||this.minDate&&this.compare(t,this.minDate)<0||this.maxDate&&this.compare(t,this.maxDate)>0||e.dateDisabled&&e.dateDisabled({date:t,mode:e.datepickerMode})},this.customClass=function(t){return e.customClass({date:t,mode:e.datepickerMode})},this.split=function(e,t){for(var n=[];e.length>0;)n.push(e.splice(0,t));return n},e.select=function(t){if(e.datepickerMode===d.minMode){var n=f.$viewValue?u.fromTimezone(new Date(f.$viewValue),h.getOption("timezone")):new Date(0,0,0,0,0,0,0);n.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),n=u.toTimezone(n,h.getOption("timezone")),f.$setViewValue(n),f.$render()}else d.activeDate=t,g(d.modes[d.modes.indexOf(e.datepickerMode)-1]),e.$emit("uib:datepicker.mode");e.$broadcast("uib:datepicker.focus")},e.move=function(e){var t=d.activeDate.getFullYear()+e*(d.step.years||0),n=d.activeDate.getMonth()+e*(d.step.months||0);d.activeDate.setFullYear(t,n,1),d.refreshView()},e.toggleMode=function(t){t=t||1,e.datepickerMode===d.maxMode&&1===t||e.datepickerMode===d.minMode&&-1===t||(g(d.modes[d.modes.indexOf(e.datepickerMode)+t]),e.$emit("uib:datepicker.mode"))},e.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};function g(t){e.datepickerMode=t,e.datepickerOptions.datepickerMode=t}e.$on("uib:datepicker.focus",function(){d.element[0].focus()}),e.keydown=function(t){var n=e.keys[t.which];if(n&&!t.shiftKey&&!t.altKey&&!e.disabled)if(t.preventDefault(),d.shortcutPropagation||t.stopPropagation(),"enter"===n||"space"===n){if(d.isDisabled(d.activeDate))return;e.select(d.activeDate)}else!t.ctrlKey||"up"!==n&&"down"!==n?(d.handleKeyDown(n,t),d.refreshView()):e.toggleMode("up"===n?1:-1)},t.on("keydown",function(t){e.$apply(function(){e.keydown(t)})}),e.$on("$destroy",function(){for(;m.length;)m.shift()()})}]).controller("UibDaypickerController",["$scope","$element","dateFilter",function(e,t,n){var o=[31,28,31,30,31,30,31,31,30,31,30,31];function r(e,t){return 1!==t||e%4!=0||e%100==0&&e%400!=0?o[t]:29}function i(e){var t=new Date(e);t.setDate(t.getDate()+4-(t.getDay()||7));var n=t.getTime();return t.setMonth(0),t.setDate(1),Math.floor(Math.round((n-t)/864e5)/7)+1}this.step={months:1},this.element=t,this.init=function(t){angular.extend(t,this),e.showWeeks=t.showWeeks,t.refreshView()},this.getDates=function(e,t){for(var n,o=new Array(t),r=new Date(e),i=0;i<t;)n=new Date(r),o[i++]=n,r.setDate(r.getDate()+1);return o},this._refreshView=function(){var t=this.activeDate.getFullYear(),o=this.activeDate.getMonth(),r=new Date(this.activeDate);r.setFullYear(t,o,1);var a=this.startingDay-r.getDay(),s=a>0?7-a:-a,l=new Date(r);s>0&&l.setDate(1-s);for(var c=this.getDates(l,42),p=0;p<42;p++)c[p]=angular.extend(this.createDateObject(c[p],this.formatDay),{secondary:c[p].getMonth()!==o,uid:e.uniqueId+"-"+p});e.labels=new Array(7);for(var u=0;u<7;u++)e.labels[u]={abbr:n(c[u].date,this.formatDayHeader),full:n(c[u].date,"EEEE")};if(e.title=n(this.activeDate,this.formatDayTitle),e.rows=this.split(c,7),e.showWeeks){e.weekNumbers=[];for(var d=(11-this.startingDay)%7,f=e.rows.length,h=0;h<f;h++)e.weekNumbers.push(i(e.rows[h][d].date))}},this.compare=function(e,t){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),o=new Date(t.getFullYear(),t.getMonth(),t.getDate());return n.setFullYear(e.getFullYear()),o.setFullYear(t.getFullYear()),n-o},this.handleKeyDown=function(e,t){var n=this.activeDate.getDate();if("left"===e)n-=1;else if("up"===e)n-=7;else if("right"===e)n+=1;else if("down"===e)n+=7;else if("pageup"===e||"pagedown"===e){var o=this.activeDate.getMonth()+("pageup"===e?-1:1);this.activeDate.setMonth(o,1),n=Math.min(r(this.activeDate.getFullYear(),this.activeDate.getMonth()),n)}else"home"===e?n=1:"end"===e&&(n=r(this.activeDate.getFullYear(),this.activeDate.getMonth()));this.activeDate.setDate(n)}}]).controller("UibMonthpickerController",["$scope","$element","dateFilter",function(e,t,n){this.step={years:1},this.element=t,this.init=function(e){angular.extend(e,this),e.refreshView()},this._refreshView=function(){for(var t,o=new Array(12),r=this.activeDate.getFullYear(),i=0;i<12;i++)(t=new Date(this.activeDate)).setFullYear(r,i,1),o[i]=angular.extend(this.createDateObject(t,this.formatMonth),{uid:e.uniqueId+"-"+i});e.title=n(this.activeDate,this.formatMonthTitle),e.rows=this.split(o,this.monthColumns),e.yearHeaderColspan=this.monthColumns>3?this.monthColumns-2:1},this.compare=function(e,t){var n=new Date(e.getFullYear(),e.getMonth()),o=new Date(t.getFullYear(),t.getMonth());return n.setFullYear(e.getFullYear()),o.setFullYear(t.getFullYear()),n-o},this.handleKeyDown=function(e,t){var n=this.activeDate.getMonth();if("left"===e)n-=1;else if("up"===e)n-=this.monthColumns;else if("right"===e)n+=1;else if("down"===e)n+=this.monthColumns;else if("pageup"===e||"pagedown"===e){var o=this.activeDate.getFullYear()+("pageup"===e?-1:1);this.activeDate.setFullYear(o)}else"home"===e?n=0:"end"===e&&(n=11);this.activeDate.setMonth(n)}}]).controller("UibYearpickerController",["$scope","$element","dateFilter",function(e,t,n){var o,r;function i(e){return parseInt((e-1)/r,10)*r+1}this.element=t,this.yearpickerInit=function(){o=this.yearColumns,r=this.yearRows*o,this.step={years:r}},this._refreshView=function(){for(var t,n=new Array(r),a=0,s=i(this.activeDate.getFullYear());a<r;a++)(t=new Date(this.activeDate)).setFullYear(s+a,0,1),n[a]=angular.extend(this.createDateObject(t,this.formatYear),{uid:e.uniqueId+"-"+a});e.title=[n[0].label,n[r-1].label].join(" - "),e.rows=this.split(n,o),e.columns=o},this.compare=function(e,t){return e.getFullYear()-t.getFullYear()},this.handleKeyDown=function(e,t){var n=this.activeDate.getFullYear();"left"===e?n-=1:"up"===e?n-=o:"right"===e?n+=1:"down"===e?n+=o:"pageup"===e||"pagedown"===e?n+=("pageup"===e?-1:1)*r:"home"===e?n=i(this.activeDate.getFullYear()):"end"===e&&(n=i(this.activeDate.getFullYear())+r-1),this.activeDate.setFullYear(n)}}]).directive("uibDatepicker",function(){return{templateUrl:function(e,t){return t.templateUrl||"uib/template/datepicker/datepicker.html"},scope:{datepickerOptions:"=?"},require:["uibDatepicker","^ngModel"],restrict:"A",controller:"UibDatepickerController",controllerAs:"datepicker",link:function(e,t,n,o){var r=o[0],i=o[1];r.init(i)}}}).directive("uibDaypicker",function(){return{templateUrl:function(e,t){return t.templateUrl||"uib/template/datepicker/day.html"},require:["^uibDatepicker","uibDaypicker"],restrict:"A",controller:"UibDaypickerController",link:function(e,t,n,o){var r=o[0];o[1].init(r)}}}).directive("uibMonthpicker",function(){return{templateUrl:function(e,t){return t.templateUrl||"uib/template/datepicker/month.html"},require:["^uibDatepicker","uibMonthpicker"],restrict:"A",controller:"UibMonthpickerController",link:function(e,t,n,o){var r=o[0];o[1].init(r)}}}).directive("uibYearpicker",function(){return{templateUrl:function(e,t){return t.templateUrl||"uib/template/datepicker/year.html"},require:["^uibDatepicker","uibYearpicker"],restrict:"A",controller:"UibYearpickerController",link:function(e,t,n,o){var r=o[0];angular.extend(r,o[1]),r.yearpickerInit(),r.refreshView()}}}),angular.module("ui.bootstrap.position",[]).factory("$uibPosition",["$document","$window",function(e,t){var n,o,r={normal:/(auto|scroll)/,hidden:/(auto|scroll|hidden)/},i={auto:/\s?auto?\s?/i,primary:/^(top|bottom|left|right)$/,secondary:/^(top|bottom|left|right|center)$/,vertical:/^(top|bottom)$/},a=/(HTML|BODY)/;return{getRawNode:function(e){return e.nodeName?e:e[0]||e},parseStyle:function(e){return e=parseFloat(e),isFinite(e)?e:0},offsetParent:function(n){var o,r=(n=this.getRawNode(n)).offsetParent||e[0].documentElement;for(;r&&r!==e[0].documentElement&&(o=r,"static"===(t.getComputedStyle(o).position||"static"));)r=r.offsetParent;return r||e[0].documentElement},scrollbarWidth:function(r){if(r){if(angular.isUndefined(o)){var i=e.find("body");i.addClass("uib-position-body-scrollbar-measure"),o=t.innerWidth-i[0].clientWidth,o=isFinite(o)?o:0,i.removeClass("uib-position-body-scrollbar-measure")}return o}if(angular.isUndefined(n)){var a=angular.element('<div class="uib-position-scrollbar-measure"></div>');e.find("body").append(a),n=a[0].offsetWidth-a[0].clientWidth,n=isFinite(n)?n:0,a.remove()}return n},scrollbarPadding:function(e){e=this.getRawNode(e);var n=t.getComputedStyle(e),o=this.parseStyle(n.paddingRight),r=this.parseStyle(n.paddingBottom),i=this.scrollParent(e,!1,!0),s=this.scrollbarWidth(a.test(i.tagName));return{scrollbarWidth:s,widthOverflow:i.scrollWidth>i.clientWidth,right:o+s,originalRight:o,heightOverflow:i.scrollHeight>i.clientHeight,bottom:r+s,originalBottom:r}},isScrollable:function(e,n){e=this.getRawNode(e);var o=n?r.hidden:r.normal,i=t.getComputedStyle(e);return o.test(i.overflow+i.overflowY+i.overflowX)},scrollParent:function(n,o,i){n=this.getRawNode(n);var a=o?r.hidden:r.normal,s=e[0].documentElement,l=t.getComputedStyle(n);if(i&&a.test(l.overflow+l.overflowY+l.overflowX))return n;var c="absolute"===l.position,p=n.parentElement||s;if(p===s||"fixed"===l.position)return s;for(;p.parentElement&&p!==s;){var u=t.getComputedStyle(p);if(c&&"static"!==u.position&&(c=!1),!c&&a.test(u.overflow+u.overflowY+u.overflowX))break;p=p.parentElement}return p},position:function(n,o){n=this.getRawNode(n);var r=this.offset(n);if(o){var i=t.getComputedStyle(n);r.top-=this.parseStyle(i.marginTop),r.left-=this.parseStyle(i.marginLeft)}var a=this.offsetParent(n),s={top:0,left:0};return a!==e[0].documentElement&&((s=this.offset(a)).top+=a.clientTop-a.scrollTop,s.left+=a.clientLeft-a.scrollLeft),{width:Math.round(angular.isNumber(r.width)?r.width:n.offsetWidth),height:Math.round(angular.isNumber(r.height)?r.height:n.offsetHeight),top:Math.round(r.top-s.top),left:Math.round(r.left-s.left)}},offset:function(n){var o=(n=this.getRawNode(n)).getBoundingClientRect();return{width:Math.round(angular.isNumber(o.width)?o.width:n.offsetWidth),height:Math.round(angular.isNumber(o.height)?o.height:n.offsetHeight),top:Math.round(o.top+(t.pageYOffset||e[0].documentElement.scrollTop)),left:Math.round(o.left+(t.pageXOffset||e[0].documentElement.scrollLeft))}},viewportOffset:function(n,o,r){r=!1!==r;var i=(n=this.getRawNode(n)).getBoundingClientRect(),a={top:0,left:0,bottom:0,right:0},s=o?e[0].documentElement:this.scrollParent(n),l=s.getBoundingClientRect();if(a.top=l.top+s.clientTop,a.left=l.left+s.clientLeft,s===e[0].documentElement&&(a.top+=t.pageYOffset,a.left+=t.pageXOffset),a.bottom=a.top+s.clientHeight,a.right=a.left+s.clientWidth,r){var c=t.getComputedStyle(s);a.top+=this.parseStyle(c.paddingTop),a.bottom-=this.parseStyle(c.paddingBottom),a.left+=this.parseStyle(c.paddingLeft),a.right-=this.parseStyle(c.paddingRight)}return{top:Math.round(i.top-a.top),bottom:Math.round(a.bottom-i.bottom),left:Math.round(i.left-a.left),right:Math.round(a.right-i.right)}},parsePlacement:function(e){var t=i.auto.test(e);return t&&(e=e.replace(i.auto,"")),(e=e.split("-"))[0]=e[0]||"top",i.primary.test(e[0])||(e[0]="top"),e[1]=e[1]||"center",i.secondary.test(e[1])||(e[1]="center"),e[2]=!!t,e},positionElements:function(e,n,o,r){e=this.getRawNode(e),n=this.getRawNode(n);var a=angular.isDefined(n.offsetWidth)?n.offsetWidth:n.prop("offsetWidth"),s=angular.isDefined(n.offsetHeight)?n.offsetHeight:n.prop("offsetHeight");o=this.parsePlacement(o);var l=r?this.offset(e):this.position(e),c={top:0,left:0,placement:""};if(o[2]){var p=this.viewportOffset(e,r),u=t.getComputedStyle(n),d={width:a+Math.round(Math.abs(this.parseStyle(u.marginLeft)+this.parseStyle(u.marginRight))),height:s+Math.round(Math.abs(this.parseStyle(u.marginTop)+this.parseStyle(u.marginBottom)))};if(o[0]="top"===o[0]&&d.height>p.top&&d.height<=p.bottom?"bottom":"bottom"===o[0]&&d.height>p.bottom&&d.height<=p.top?"top":"left"===o[0]&&d.width>p.left&&d.width<=p.right?"right":"right"===o[0]&&d.width>p.right&&d.width<=p.left?"left":o[0],o[1]="top"===o[1]&&d.height-l.height>p.bottom&&d.height-l.height<=p.top?"bottom":"bottom"===o[1]&&d.height-l.height>p.top&&d.height-l.height<=p.bottom?"top":"left"===o[1]&&d.width-l.width>p.right&&d.width-l.width<=p.left?"right":"right"===o[1]&&d.width-l.width>p.left&&d.width-l.width<=p.right?"left":o[1],"center"===o[1])if(i.vertical.test(o[0])){var f=l.width/2-a/2;p.left+f<0&&d.width-l.width<=p.right?o[1]="left":p.right+f<0&&d.width-l.width<=p.left&&(o[1]="right")}else{var h=l.height/2-d.height/2;p.top+h<0&&d.height-l.height<=p.bottom?o[1]="top":p.bottom+h<0&&d.height-l.height<=p.top&&(o[1]="bottom")}}switch(o[0]){case"top":c.top=l.top-s;break;case"bottom":c.top=l.top+l.height;break;case"left":c.left=l.left-a;break;case"right":c.left=l.left+l.width}switch(o[1]){case"top":c.top=l.top;break;case"bottom":c.top=l.top+l.height-s;break;case"left":c.left=l.left;break;case"right":c.left=l.left+l.width-a;break;case"center":i.vertical.test(o[0])?c.left=l.left+l.width/2-a/2:c.top=l.top+l.height/2-s/2}return c.top=Math.round(c.top),c.left=Math.round(c.left),c.placement="center"===o[1]?o[0]:o[0]+"-"+o[1],c},adjustTop:function(e,t,n,o){if(-1!==e.indexOf("top")&&n!==o)return{top:t.top-o+"px"}},positionArrow:function(e,n){var o=(e=this.getRawNode(e)).querySelector(".tooltip-inner, .popover-inner");if(o){var r=angular.element(o).hasClass("tooltip-inner"),a=r?e.querySelector(".tooltip-arrow"):e.querySelector(".arrow");if(a){var s={top:"",bottom:"",left:"",right:""};if("center"!==(n=this.parsePlacement(n))[1]){var l="border-"+n[0]+"-width",c=t.getComputedStyle(a)[l],p="border-";i.vertical.test(n[0])?p+=n[0]+"-"+n[1]:p+=n[1]+"-"+n[0],p+="-radius";var u=t.getComputedStyle(r?o:e)[p];switch(n[0]){case"top":s.bottom=r?"0":"-"+c;break;case"bottom":s.top=r?"0":"-"+c;break;case"left":s.right=r?"0":"-"+c;break;case"right":s.left=r?"0":"-"+c}s[n[1]]=u,angular.element(a).css(s)}else angular.element(a).css(s)}}}}}]),angular.module("ui.bootstrap.datepickerPopup",["ui.bootstrap.datepicker","ui.bootstrap.position"]).value("$datepickerPopupLiteralWarning",!0).constant("uibDatepickerPopupConfig",{altInputFormats:[],appendToBody:!1,clearText:"Clear",closeOnDateSelection:!0,closeText:"Done",currentText:"Today",datepickerPopup:"yyyy-MM-dd",datepickerPopupTemplateUrl:"uib/template/datepickerPopup/popup.html",datepickerTemplateUrl:"uib/template/datepicker/datepicker.html",html5Types:{date:"yyyy-MM-dd","datetime-local":"yyyy-MM-ddTHH:mm:ss.sss",month:"yyyy-MM"},onOpenFocus:!0,showButtonBar:!0,placement:"auto bottom-left"}).controller("UibDatepickerPopupController",["$scope","$element","$attrs","$compile","$log","$parse","$window","$document","$rootScope","$uibPosition","dateFilter","uibDateParser","uibDatepickerPopupConfig","$timeout","uibDatepickerConfig","$datepickerPopupLiteralWarning",function(e,t,n,o,r,i,a,s,l,c,p,u,d,f,h,m){var g,v,b,y,w,x,$,C,_,k,S,T,I,E=!1,N=[];function O(t){var n=u.parse(t,g,e.date);if(isNaN(n))for(var o=0;o<I.length;o++)if(n=u.parse(t,I[o],e.date),!isNaN(n))return n;return n}function D(e){if(angular.isNumber(e)&&(e=new Date(e)),!e)return null;if(angular.isDate(e)&&!isNaN(e))return e;if(angular.isString(e)){var t=O(e);if(!isNaN(t))return u.toTimezone(t,S.getOption("timezone"))}return S.getOption("allowInvalid")?e:void 0}function P(e,t){var o=e||t;return!n.ngRequired&&!o||(angular.isNumber(o)&&(o=new Date(o)),!o||(!(!angular.isDate(o)||isNaN(o))||!!angular.isString(o)&&!isNaN(O(o))))}function A(n){if(e.isOpen||!e.disabled){var o=T[0],r=t[0].contains(n.target),i=void 0!==o.contains&&o.contains(n.target);!e.isOpen||r||i||e.$apply(function(){e.isOpen=!1})}}function M(n){27===n.which&&e.isOpen?(n.preventDefault(),n.stopPropagation(),e.$apply(function(){e.isOpen=!1}),t[0].focus()):40!==n.which||e.isOpen||(n.preventDefault(),n.stopPropagation(),e.$apply(function(){e.isOpen=!0}))}function U(){if(e.isOpen){var o=angular.element(T[0].querySelector(".uib-datepicker-popup")),r=n.popupPlacement?n.popupPlacement:d.placement,i=c.positionElements(t,o,r,b);o.css({top:i.top+"px",left:i.left+"px"}),o.hasClass("uib-position-measure")&&o.removeClass("uib-position-measure")}}this.init=function(r){if(S=function(e){var t;angular.version.minor<6?(t=angular.isObject(e.$options)?e.$options:{timezone:null}).getOption=function(e){return t[e]}:t=e.$options;return t}(k=r),v=angular.isDefined(n.closeOnDateSelection)?e.$parent.$eval(n.closeOnDateSelection):d.closeOnDateSelection,b=angular.isDefined(n.datepickerAppendToBody)?e.$parent.$eval(n.datepickerAppendToBody):d.appendToBody,y=angular.isDefined(n.onOpenFocus)?e.$parent.$eval(n.onOpenFocus):d.onOpenFocus,w=angular.isDefined(n.datepickerPopupTemplateUrl)?n.datepickerPopupTemplateUrl:d.datepickerPopupTemplateUrl,x=angular.isDefined(n.datepickerTemplateUrl)?n.datepickerTemplateUrl:d.datepickerTemplateUrl,I=angular.isDefined(n.altInputFormats)?e.$parent.$eval(n.altInputFormats):d.altInputFormats,e.showButtonBar=angular.isDefined(n.showButtonBar)?e.$parent.$eval(n.showButtonBar):d.showButtonBar,d.html5Types[n.type]?(g=d.html5Types[n.type],E=!0):(g=n.uibDatepickerPopup||d.datepickerPopup,n.$observe("uibDatepickerPopup",function(e,t){var n=e||d.datepickerPopup;if(n!==g&&(g=n,k.$modelValue=null,!g))throw new Error("uibDatepickerPopup must have a date format specified.")})),!g)throw new Error("uibDatepickerPopup must have a date format specified.");if(E&&n.uibDatepickerPopup)throw new Error("HTML5 date input types do not support custom formats.");($=angular.element("<div uib-datepicker-popup-wrap><div uib-datepicker></div></div>")).attr({"ng-model":"date","ng-change":"dateSelection(date)","template-url":w}),(C=angular.element($.children()[0])).attr("template-url",x),e.datepickerOptions||(e.datepickerOptions={}),E&&"month"===n.type&&(e.datepickerOptions.datepickerMode="month",e.datepickerOptions.minMode="month"),C.attr("datepicker-options","datepickerOptions"),E?k.$formatters.push(function(t){return e.date=u.fromTimezone(t,S.getOption("timezone")),t}):(k.$$parserName="date",k.$validators.date=P,k.$parsers.unshift(D),k.$formatters.push(function(t){return k.$isEmpty(t)?(e.date=t,t):(angular.isNumber(t)&&(t=new Date(t)),e.date=u.fromTimezone(t,S.getOption("timezone")),u.filter(e.date,g))})),k.$viewChangeListeners.push(function(){e.date=O(k.$viewValue)}),t.on("keydown",M),T=o($)(e),$.remove(),b?s.find("body").append(T):t.after(T),e.$on("$destroy",function(){for(!0===e.isOpen&&(l.$$phase||e.$apply(function(){e.isOpen=!1})),T.remove(),t.off("keydown",M),s.off("click",A),_&&_.off("scroll",U),angular.element(a).off("resize",U);N.length;)N.shift()()})},e.getText=function(t){return e[t+"Text"]||d[t+"Text"]},e.isDisabled=function(t){"today"===t&&(t=u.fromTimezone(new Date,S.getOption("timezone")));var n={};return angular.forEach(["minDate","maxDate"],function(t){e.datepickerOptions[t]?angular.isDate(e.datepickerOptions[t])?n[t]=new Date(e.datepickerOptions[t]):(m&&r.warn("Literal date support has been deprecated, please switch to date object usage"),n[t]=new Date(p(e.datepickerOptions[t],"medium"))):n[t]=null}),e.datepickerOptions&&n.minDate&&e.compare(t,n.minDate)<0||n.maxDate&&e.compare(t,n.maxDate)>0},e.compare=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate())-new Date(t.getFullYear(),t.getMonth(),t.getDate())},e.dateSelection=function(n){e.date=n;var o=e.date?u.filter(e.date,g):null;t.val(o),k.$setViewValue(o),v&&(e.isOpen=!1,t[0].focus())},e.keydown=function(n){27===n.which&&(n.stopPropagation(),e.isOpen=!1,t[0].focus())},e.select=function(t,n){if(n.stopPropagation(),"today"===t){var o=new Date;angular.isDate(e.date)?(t=new Date(e.date)).setFullYear(o.getFullYear(),o.getMonth(),o.getDate()):(t=u.fromTimezone(o,S.getOption("timezone"))).setHours(0,0,0,0)}e.dateSelection(t)},e.close=function(n){n.stopPropagation(),e.isOpen=!1,t[0].focus()},e.disabled=angular.isDefined(n.disabled)||!1,n.ngDisabled&&N.push(e.$parent.$watch(i(n.ngDisabled),function(t){e.disabled=t})),e.$watch("isOpen",function(o){o?e.disabled?e.isOpen=!1:f(function(){U(),y&&e.$broadcast("uib:datepicker.focus"),s.on("click",A);var o=n.popupPlacement?n.popupPlacement:d.placement;b||c.parsePlacement(o)[2]?(_=_||angular.element(c.scrollParent(t)))&&_.on("scroll",U):_=null,angular.element(a).on("resize",U)},0,!1):(s.off("click",A),_&&_.off("scroll",U),angular.element(a).off("resize",U))}),e.$on("uib:datepicker.mode",function(){f(U,0,!1)})}]).directive("uibDatepickerPopup",function(){return{require:["ngModel","uibDatepickerPopup"],controller:"UibDatepickerPopupController",scope:{datepickerOptions:"=?",isOpen:"=?",currentText:"@",clearText:"@",closeText:"@"},link:function(e,t,n,o){var r=o[0];o[1].init(r)}}}).directive("uibDatepickerPopupWrap",function(){return{restrict:"A",transclude:!0,templateUrl:function(e,t){return t.templateUrl||"uib/template/datepickerPopup/popup.html"}}}),angular.module("ui.bootstrap.debounce",[]).factory("$$debounce",["$timeout",function(e){return function(t,n){var o;return function(){var r=this,i=Array.prototype.slice.call(arguments);o&&e.cancel(o),o=e(function(){t.apply(r,i)},n)}}}]),angular.module("ui.bootstrap.multiMap",[]).factory("$$multiMap",function(){return{createNew:function(){var e={};return{entries:function(){return Object.keys(e).map(function(t){return{key:t,value:e[t]}})},get:function(t){return e[t]},hasKey:function(t){return!!e[t]},keys:function(){return Object.keys(e)},put:function(t,n){e[t]||(e[t]=[]),e[t].push(n)},remove:function(t,n){var o=e[t];if(o){var r=o.indexOf(n);-1!==r&&o.splice(r,1),o.length||delete e[t]}}}}}}),angular.module("ui.bootstrap.dropdown",["ui.bootstrap.multiMap","ui.bootstrap.position"]).constant("uibDropdownConfig",{appendToOpenClass:"uib-dropdown-open",openClass:"open"}).service("uibDropdownService",["$document","$rootScope","$$multiMap",function(e,t,n){var o=null,r=n.createNew();this.isOnlyOpen=function(e,t){var n=r.get(t);if(n&&n.reduce(function(t,n){return n.scope===e?n:t},{}))return 1===n.length;return!1},this.open=function(t,n,a){if(o||e.on("click",i),o&&o!==t&&(o.isOpen=!1),o=t,a){var s=r.get(a);if(s)-1===s.map(function(e){return e.scope}).indexOf(t)&&r.put(a,{scope:t});else r.put(a,{scope:t})}},this.close=function(t,n,a){if(o===t&&(e.off("click",i),e.off("keydown",this.keybindFilter),o=null),a){var s=r.get(a);if(s){var l=s.reduce(function(e,n){return n.scope===t?n:e},{});l&&r.remove(a,l)}}};var i=function(e){if(o&&o.isOpen&&!(e&&"disabled"===o.getAutoClose()||e&&3===e.which)){var n=o.getToggleElement();if(!(e&&n&&n[0].contains(e.target))){var r=o.getDropdownElement();e&&"outsideClick"===o.getAutoClose()&&r&&r[0].contains(e.target)||(o.focusToggleElement(),o.isOpen=!1,t.$$phase||o.$apply())}}};this.keybindFilter=function(e){if(o){var t=o.getDropdownElement(),n=o.getToggleElement(),r=t&&t[0].contains(e.target),a=n&&n[0].contains(e.target);27===e.which?(e.stopPropagation(),o.focusToggleElement(),i()):o.isKeynavEnabled()&&-1!==[38,40].indexOf(e.which)&&o.isOpen&&(r||a)&&(e.preventDefault(),e.stopPropagation(),o.focusDropdownEntry(e.which))}}}]).controller("UibDropdownController",["$scope","$element","$attrs","$parse","uibDropdownConfig","uibDropdownService","$animate","$uibPosition","$document","$compile","$templateRequest",function(e,t,n,o,r,i,a,s,l,c,p){var u,d,f=this,h=e.$new(),m=r.appendToOpenClass,g=r.openClass,v=angular.noop,b=n.onToggle?o(n.onToggle):angular.noop,y=!1,w=l.find("body");function x(){t.append(f.dropdownMenu)}t.addClass("dropdown"),this.init=function(){n.isOpen&&(d=o(n.isOpen),v=d.assign,e.$watch(d,function(e){h.isOpen=!!e})),y=angular.isDefined(n.keyboardNav)},this.toggle=function(e){return h.isOpen=arguments.length?!!e:!h.isOpen,angular.isFunction(v)&&v(h,h.isOpen),h.isOpen},this.isOpen=function(){return h.isOpen},h.getToggleElement=function(){return f.toggleElement},h.getAutoClose=function(){return n.autoClose||"always"},h.getElement=function(){return t},h.isKeynavEnabled=function(){return y},h.focusDropdownEntry=function(e){var n=f.dropdownMenu?angular.element(f.dropdownMenu).find("a"):t.find("ul").eq(0).find("a");switch(e){case 40:angular.isNumber(f.selectedOption)?f.selectedOption=f.selectedOption===n.length-1?f.selectedOption:f.selectedOption+1:f.selectedOption=0;break;case 38:angular.isNumber(f.selectedOption)?f.selectedOption=0===f.selectedOption?0:f.selectedOption-1:f.selectedOption=n.length-1}n[f.selectedOption].focus()},h.getDropdownElement=function(){return f.dropdownMenu},h.focusToggleElement=function(){f.toggleElement&&f.toggleElement[0].focus()},h.$watch("isOpen",function(r,d){var y=null,$=!1;if(angular.isDefined(n.dropdownAppendTo)){var C=o(n.dropdownAppendTo)(h);C&&(y=angular.element(C))}angular.isDefined(n.dropdownAppendToBody)&&(!1!==o(n.dropdownAppendToBody)(h)&&($=!0));if($&&!y&&(y=w),y&&f.dropdownMenu&&(r?(y.append(f.dropdownMenu),t.on("$destroy",x)):(t.off("$destroy",x),x())),y&&f.dropdownMenu){var _,k,S,T=s.positionElements(t,f.dropdownMenu,"bottom-left",!0),I=0;if(_={top:T.top+"px",display:r?"block":"none"},(k=f.dropdownMenu.hasClass("dropdown-menu-right"))?(_.left="auto",(S=s.scrollbarPadding(y)).heightOverflow&&S.scrollbarWidth&&(I=S.scrollbarWidth),_.right=window.innerWidth-I-(T.left+t.prop("offsetWidth"))+"px"):(_.left=T.left+"px",_.right="auto"),!$){var E=s.offset(y);_.top=T.top-E.top+"px",k?_.right=window.innerWidth-(T.left-E.left+t.prop("offsetWidth"))+"px":_.left=T.left-E.left+"px"}f.dropdownMenu.css(_)}var N=y||t,O=y?m:g,D=N.hasClass(O),P=i.isOnlyOpen(e,y);D===!r&&a[y?P?"removeClass":"addClass":r?"addClass":"removeClass"](N,O).then(function(){angular.isDefined(r)&&r!==d&&b(e,{open:!!r})});if(r)f.dropdownMenuTemplateUrl?p(f.dropdownMenuTemplateUrl).then(function(e){u=h.$new(),c(e.trim())(u,function(e){var t=e;f.dropdownMenu.replaceWith(t),f.dropdownMenu=t,l.on("keydown",i.keybindFilter)})}):l.on("keydown",i.keybindFilter),h.focusToggleElement(),i.open(h,t,y);else{if(i.close(h,t,y),f.dropdownMenuTemplateUrl){u&&u.$destroy();var A=angular.element('<ul class="dropdown-menu"></ul>');f.dropdownMenu.replaceWith(A),f.dropdownMenu=A}f.selectedOption=null}angular.isFunction(v)&&v(e,r)})}]).directive("uibDropdown",function(){return{controller:"UibDropdownController",link:function(e,t,n,o){o.init()}}}).directive("uibDropdownMenu",function(){return{restrict:"A",require:"?^uibDropdown",link:function(e,t,n,o){if(o&&!angular.isDefined(n.dropdownNested)){t.addClass("dropdown-menu");var r=n.templateUrl;r&&(o.dropdownMenuTemplateUrl=r),o.dropdownMenu||(o.dropdownMenu=t)}}}}).directive("uibDropdownToggle",function(){return{require:"?^uibDropdown",link:function(e,t,n,o){if(o){t.addClass("dropdown-toggle"),o.toggleElement=t;var r=function(r){r.preventDefault(),t.hasClass("disabled")||n.disabled||e.$apply(function(){o.toggle()})};t.on("click",r),t.attr({"aria-haspopup":!0,"aria-expanded":!1}),e.$watch(o.isOpen,function(e){t.attr("aria-expanded",!!e)}),e.$on("$destroy",function(){t.off("click",r)})}}}}),angular.module("ui.bootstrap.stackedMap",[]).factory("$$stackedMap",function(){return{createNew:function(){var e=[];return{add:function(t,n){e.push({key:t,value:n})},get:function(t){for(var n=0;n<e.length;n++)if(t===e[n].key)return e[n]},keys:function(){for(var t=[],n=0;n<e.length;n++)t.push(e[n].key);return t},top:function(){return e[e.length-1]},remove:function(t){for(var n=-1,o=0;o<e.length;o++)if(t===e[o].key){n=o;break}return e.splice(n,1)[0]},removeTop:function(){return e.pop()},length:function(){return e.length}}}}}),angular.module("ui.bootstrap.modal",["ui.bootstrap.multiMap","ui.bootstrap.stackedMap","ui.bootstrap.position"]).provider("$uibResolve",function(){var e=this;this.resolver=null,this.setResolver=function(e){this.resolver=e},this.$get=["$injector","$q",function(t,n){var o=e.resolver?t.get(e.resolver):null;return{resolve:function(e,r,i,a){if(o)return o.resolve(e,r,i,a);var s=[];return angular.forEach(e,function(e){angular.isFunction(e)||angular.isArray(e)?s.push(n.resolve(t.invoke(e))):angular.isString(e)?s.push(n.resolve(t.get(e))):s.push(n.resolve(e))}),n.all(s).then(function(t){var n={},o=0;return angular.forEach(e,function(e,r){n[r]=t[o++]}),n})}}}]}).directive("uibModalBackdrop",["$animate","$injector","$uibModalStack",function(e,t,n){return{restrict:"A",compile:function(e,t){return e.addClass(t.backdropClass),o}};function o(t,o,r){r.modalInClass&&(e.addClass(o,r.modalInClass),t.$on(n.NOW_CLOSING_EVENT,function(n,i){var a=i();t.modalOptions.animation?e.removeClass(o,r.modalInClass).then(a):a()}))}}]).directive("uibModalWindow",["$uibModalStack","$q","$animateCss","$document",function(e,t,n,o){return{scope:{index:"@"},restrict:"A",transclude:!0,templateUrl:function(e,t){return t.templateUrl||"uib/template/modal/window.html"},link:function(r,i,a){i.addClass(a.windowTopClass||""),r.size=a.size,r.close=function(t){var n=e.getTop();n&&n.value.backdrop&&"static"!==n.value.backdrop&&t.target===t.currentTarget&&(t.preventDefault(),t.stopPropagation(),e.dismiss(n.key,"backdrop click"))},i.on("click",r.close),r.$isRendered=!0;var s=t.defer();r.$$postDigest(function(){s.resolve()}),s.promise.then(function(){var s=null;a.modalInClass&&(s=n(i,{addClass:a.modalInClass}).start(),r.$on(e.NOW_CLOSING_EVENT,function(e,t){var o=t();n(i,{removeClass:a.modalInClass}).start().then(o)})),t.when(s).then(function(){var t=e.getTop();if(t&&e.modalRendered(t.key),!o[0].activeElement||!i[0].contains(o[0].activeElement)){var n=i[0].querySelector("[autofocus]");n?n.focus():i[0].focus()}})})}}}]).directive("uibModalAnimationClass",function(){return{compile:function(e,t){t.modalAnimation&&e.addClass(t.uibModalAnimationClass)}}}).directive("uibModalTransclude",["$animate",function(e){return{link:function(t,n,o,r,i){i(t.$parent,function(t){n.empty(),e.enter(t,n)})}}}]).factory("$uibModalStack",["$animate","$animateCss","$document","$compile","$rootScope","$q","$$multiMap","$$stackedMap","$uibPosition",function(e,t,n,o,r,i,a,s,l){var c,p,u,d="modal-open",f=s.createNew(),h=a.createNew(),m={NOW_CLOSING_EVENT:"modal.stack.now-closing"},g=0,v=null,b="data-bootstrap-modal-aria-hidden-count",y=/[A-Z]/g;function w(){for(var e=-1,t=f.keys(),n=0;n<t.length;n++)f.get(t[n]).value.backdrop&&(e=n);return e>-1&&e<g&&(e=g),e}function x(e,t){var n=f.get(e).value,o=n.appendTo;f.remove(e),(v=f.top())&&(g=parseInt(v.value.modalDomEl.attr("index"),10)),C(n.modalDomEl,n.modalScope,function(){var t=n.openedClass||d;h.remove(t,e);var r=h.hasKey(t);o.toggleClass(t,r),!r&&u&&u.heightOverflow&&u.scrollbarWidth&&(u.originalRight?o.css({paddingRight:u.originalRight+"px"}):o.css({paddingRight:""}),u=null),$(!0)},n.closedDeferred),function(){if(c&&-1===w()){C(c,p,function(){null}),c=void 0,p=void 0}}(),t&&t.focus?t.focus():o.focus&&o.focus()}function $(e){var t;f.length()>0&&(t=f.top().value).modalDomEl.toggleClass(t.windowTopClass||"",e)}function C(t,n,o,r){var a,s=null;return n.$broadcast(m.NOW_CLOSING_EVENT,function(){return a||(a=i.defer(),s=a.promise),function(){a.resolve()}}),i.when(s).then(function i(){if(i.done)return;i.done=!0;e.leave(t).then(function(){o&&o(),t.remove(),r&&r.resolve()});n.$destroy()})}function _(e){if(e.isDefaultPrevented())return e;var t=f.top();if(t)switch(e.which){case 27:t.value.keyboard&&(e.preventDefault(),r.$apply(function(){m.dismiss(t.key,"escape key press")}));break;case 9:var n=m.loadFocusElementList(t),o=!1;e.shiftKey?(m.isFocusInFirstItem(e,n)||m.isModalFocused(e,t))&&(o=m.focusLastFocusableElement(n)):m.isFocusInLastItem(e,n)&&(o=m.focusFirstFocusableElement(n)),o&&(e.preventDefault(),e.stopPropagation())}}function k(e,t,n){return!e.value.modalScope.$broadcast("modal.closing",t,n).defaultPrevented}function S(){Array.prototype.forEach.call(document.querySelectorAll("["+b+"]"),function(e){var t=parseInt(e.getAttribute(b),10)-1;e.setAttribute(b,t),t||(e.removeAttribute(b),e.removeAttribute("aria-hidden"))})}return r.$watch(w,function(e){p&&(p.index=e)}),n.on("keydown",_),r.$on("$destroy",function(){n.off("keydown",_)}),m.open=function(t,i){var a=n[0].activeElement,s=i.openedClass||d;$(!1),v=f.top(),f.add(t,{deferred:i.deferred,renderDeferred:i.renderDeferred,closedDeferred:i.closedDeferred,modalScope:i.scope,backdrop:i.backdrop,keyboard:i.keyboard,openedClass:i.openedClass,windowTopClass:i.windowTopClass,animation:i.animation,appendTo:i.appendTo}),h.put(s,t);var m,x=i.appendTo,C=w();C>=0&&!c&&((p=r.$new(!0)).modalOptions=i,p.index=C,(c=angular.element('<div uib-modal-backdrop="modal-backdrop"></div>')).attr({class:"modal-backdrop","ng-style":"{'z-index': 1040 + (index && 1 || 0) + index*10}","uib-modal-animation-class":"fade","modal-in-class":"in"}),i.backdropClass&&c.addClass(i.backdropClass),i.animation&&c.attr("modal-animation","true"),o(c)(p),e.enter(c,x),l.isScrollable(x)&&(u=l.scrollbarPadding(x)).heightOverflow&&u.scrollbarWidth&&x.css({paddingRight:u.right+"px"})),i.component?(m=document.createElement(i.component.name.replace(y,function(e,t){return(t?"-":"")+e.toLowerCase()})),(m=angular.element(m)).attr({resolve:"$resolve","modal-instance":"$uibModalInstance",close:"$close($value)",dismiss:"$dismiss($value)"})):m=i.content,g=v?parseInt(v.value.modalDomEl.attr("index"),10)+1:0;var _=angular.element('<div uib-modal-window="modal-window"></div>');_.attr({class:"modal","template-url":i.windowTemplateUrl,"window-top-class":i.windowTopClass,role:"dialog","aria-labelledby":i.ariaLabelledBy,"aria-describedby":i.ariaDescribedBy,size:i.size,index:g,animate:"animate","ng-style":"{'z-index': 1050 + $$topModalIndex*10, display: 'block'}",tabindex:-1,"uib-modal-animation-class":"fade","modal-in-class":"in"}).append(m),i.windowClass&&_.addClass(i.windowClass),i.animation&&_.attr("modal-animation","true"),x.addClass(s),i.scope&&(i.scope.$$topModalIndex=g),e.enter(o(_)(i.scope),x),f.top().value.modalDomEl=_,f.top().value.modalOpener=a,function e(t){if(!t||"BODY"===t[0].tagName)return;(function(e){var t=e.parent()?e.parent().children():[];return Array.prototype.filter.call(t,function(t){return t!==e[0]})})(t).forEach(function(e){var t="true"===e.getAttribute("aria-hidden"),n=parseInt(e.getAttribute(b),10);n||(n=t?1:0),e.setAttribute(b,n+1),e.setAttribute("aria-hidden","true")});return e(t.parent())}(_)},m.close=function(e,t){var n=f.get(e);return S(),n&&k(n,t,!0)?(n.value.modalScope.$$uibDestructionScheduled=!0,n.value.deferred.resolve(t),x(e,n.value.modalOpener),!0):!n},m.dismiss=function(e,t){var n=f.get(e);return S(),n&&k(n,t,!1)?(n.value.modalScope.$$uibDestructionScheduled=!0,n.value.deferred.reject(t),x(e,n.value.modalOpener),!0):!n},m.dismissAll=function(e){for(var t=this.getTop();t&&this.dismiss(t.key,e);)t=this.getTop()},m.getTop=function(){return f.top()},m.modalRendered=function(e){var t=f.get(e);t&&t.value.renderDeferred.resolve()},m.focusFirstFocusableElement=function(e){return e.length>0&&(e[0].focus(),!0)},m.focusLastFocusableElement=function(e){return e.length>0&&(e[e.length-1].focus(),!0)},m.isModalFocused=function(e,t){if(e&&t){var n=t.value.modalDomEl;if(n&&n.length)return(e.target||e.srcElement)===n[0]}return!1},m.isFocusInFirstItem=function(e,t){return t.length>0&&(e.target||e.srcElement)===t[0]},m.isFocusInLastItem=function(e,t){return t.length>0&&(e.target||e.srcElement)===t[t.length-1]},m.loadFocusElementList=function(e){if(e){var t=e.value.modalDomEl;if(t&&t.length){var n=t[0].querySelectorAll("a[href], area[href], input:not([disabled]):not([tabindex='-1']), button:not([disabled]):not([tabindex='-1']),select:not([disabled]):not([tabindex='-1']), textarea:not([disabled]):not([tabindex='-1']), iframe, object, embed, *[tabindex]:not([tabindex='-1']), *[contenteditable=true]");return n?Array.prototype.filter.call(n,function(e){return function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}(e)}):n}}},m}]).provider("$uibModal",function(){var e={options:{animation:!0,backdrop:!0,keyboard:!0},$get:["$rootScope","$q","$document","$templateRequest","$controller","$uibResolve","$uibModalStack",function(t,n,o,r,i,a,s){var l={};var c=null;return l.getPromiseChain=function(){return c},l.open=function(l){var p,u,d,f=n.defer(),h=n.defer(),m=n.defer(),g=n.defer(),v={result:f.promise,opened:h.promise,closed:m.promise,rendered:g.promise,close:function(e){return s.close(v,e)},dismiss:function(e){return s.dismiss(v,e)}};if((l=angular.extend({},e.options,l)).resolve=l.resolve||{},l.appendTo=l.appendTo||o.find("body").eq(0),!l.appendTo.length)throw new Error("appendTo element not found. Make sure that the element passed is in DOM.");if(!l.component&&!l.template&&!l.templateUrl)throw new Error("One of component or template or templateUrl options is required.");function b(){return p}return p=l.component?n.when(a.resolve(l.resolve,{},null,null)):n.all([(u=l,u.template?n.when(u.template):r(angular.isFunction(u.templateUrl)?u.templateUrl():u.templateUrl)),a.resolve(l.resolve,{},null,null)]),d=c=n.all([c]).then(b,b).then(function(e){var n=l.scope||t,o=n.$new();o.$close=v.close,o.$dismiss=v.dismiss,o.$on("$destroy",function(){o.$$uibDestructionScheduled||o.$dismiss("$uibUnscheduledDestruction")});var r,a,c={scope:o,deferred:f,renderDeferred:g,closedDeferred:m,animation:l.animation,backdrop:l.backdrop,keyboard:l.keyboard,backdropClass:l.backdropClass,windowTopClass:l.windowTopClass,windowClass:l.windowClass,windowTemplateUrl:l.windowTemplateUrl,ariaLabelledBy:l.ariaLabelledBy,ariaDescribedBy:l.ariaDescribedBy,size:l.size,openedClass:l.openedClass,appendTo:l.appendTo},p={},u={};function d(t,n,r,i){t.$scope=o,t.$scope.$resolve={},r?t.$scope.$uibModalInstance=v:t.$uibModalInstance=v;var a=n?e[1]:e;angular.forEach(a,function(e,n){i&&(t[n]=e),t.$scope.$resolve[n]=e})}l.component?(d(p,!1,!0,!1),p.name=l.component,c.component=p):l.controller&&(d(u,!0,!1,!0),a=i(l.controller,u,!0,l.controllerAs),l.controllerAs&&l.bindToController&&((r=a.instance).$close=o.$close,r.$dismiss=o.$dismiss,angular.extend(r,{$resolve:u.$scope.$resolve},n)),r=a(),angular.isFunction(r.$onInit)&&r.$onInit()),l.component||(c.content=e[0]),s.open(v,c),h.resolve(!0)},function(e){h.reject(e),f.reject(e)}).finally(function(){c===d&&(c=null)}),v},l}]};return e}),angular.module("ui.bootstrap.paging",[]).factory("uibPaging",["$parse",function(e){return{create:function(t,n,o){t.setNumPages=o.numPages?e(o.numPages).assign:angular.noop,t.ngModelCtrl={$setViewValue:angular.noop},t._watchers=[],t.init=function(e,r){t.ngModelCtrl=e,t.config=r,e.$render=function(){t.render()},o.itemsPerPage?t._watchers.push(n.$parent.$watch(o.itemsPerPage,function(e){t.itemsPerPage=parseInt(e,10),n.totalPages=t.calculateTotalPages(),t.updatePage()})):t.itemsPerPage=r.itemsPerPage,n.$watch("totalItems",function(e,o){(angular.isDefined(e)||e!==o)&&(n.totalPages=t.calculateTotalPages(),t.updatePage())})},t.calculateTotalPages=function(){var e=t.itemsPerPage<1?1:Math.ceil(n.totalItems/t.itemsPerPage);return Math.max(e||0,1)},t.render=function(){n.page=parseInt(t.ngModelCtrl.$viewValue,10)||1},n.selectPage=function(e,o){o&&o.preventDefault(),(!n.ngDisabled||!o)&&n.page!==e&&e>0&&e<=n.totalPages&&(o&&o.target&&o.target.blur(),t.ngModelCtrl.$setViewValue(e),t.ngModelCtrl.$render())},n.getText=function(e){return n[e+"Text"]||t.config[e+"Text"]},n.noPrevious=function(){return 1===n.page},n.noNext=function(){return n.page===n.totalPages},t.updatePage=function(){t.setNumPages(n.$parent,n.totalPages),n.page>n.totalPages?n.selectPage(n.totalPages):t.ngModelCtrl.$render()},n.$on("$destroy",function(){for(;t._watchers.length;)t._watchers.shift()()})}}}]),angular.module("ui.bootstrap.pager",["ui.bootstrap.paging","ui.bootstrap.tabindex"]).controller("UibPagerController",["$scope","$attrs","uibPaging","uibPagerConfig",function(e,t,n,o){e.align=angular.isDefined(t.align)?e.$parent.$eval(t.align):o.align,n.create(this,e,t)}]).constant("uibPagerConfig",{itemsPerPage:10,previousText:"« Previous",nextText:"Next »",align:!0}).directive("uibPager",["uibPagerConfig",function(e){return{scope:{totalItems:"=",previousText:"@",nextText:"@",ngDisabled:"="},require:["uibPager","?ngModel"],restrict:"A",controller:"UibPagerController",controllerAs:"pager",templateUrl:function(e,t){return t.templateUrl||"uib/template/pager/pager.html"},link:function(t,n,o,r){n.addClass("pager");var i=r[0],a=r[1];a&&i.init(a,e)}}}]),angular.module("ui.bootstrap.pagination",["ui.bootstrap.paging","ui.bootstrap.tabindex"]).controller("UibPaginationController",["$scope","$attrs","$parse","uibPaging","uibPaginationConfig",function(e,t,n,o,r){var i=this,a=angular.isDefined(t.maxSize)?e.$parent.$eval(t.maxSize):r.maxSize,s=angular.isDefined(t.rotate)?e.$parent.$eval(t.rotate):r.rotate,l=angular.isDefined(t.forceEllipses)?e.$parent.$eval(t.forceEllipses):r.forceEllipses,c=angular.isDefined(t.boundaryLinkNumbers)?e.$parent.$eval(t.boundaryLinkNumbers):r.boundaryLinkNumbers,p=angular.isDefined(t.pageLabel)?function(n){return e.$parent.$eval(t.pageLabel,{$page:n})}:angular.identity;function u(e,t,n){return{number:e,text:t,active:n}}e.boundaryLinks=angular.isDefined(t.boundaryLinks)?e.$parent.$eval(t.boundaryLinks):r.boundaryLinks,e.directionLinks=angular.isDefined(t.directionLinks)?e.$parent.$eval(t.directionLinks):r.directionLinks,t.$set("role","menu"),o.create(this,e,t),t.maxSize&&i._watchers.push(e.$parent.$watch(n(t.maxSize),function(e){a=parseInt(e,10),i.render()}));var d=this.render;this.render=function(){d(),e.page>0&&e.page<=e.totalPages&&(e.pages=function(e,t){var n=[],o=1,r=t,i=angular.isDefined(a)&&a<t;i&&(s?(r=(o=Math.max(e-Math.floor(a/2),1))+a-1)>t&&(o=(r=t)-a+1):(o=(Math.ceil(e/a)-1)*a+1,r=Math.min(o+a-1,t)));for(var d=o;d<=r;d++){var f=u(d,p(d),d===e);n.push(f)}if(i&&a>0&&(!s||l||c)){if(o>1){if(!c||o>3){var h=u(o-1,"...",!1);n.unshift(h)}if(c){if(3===o){var m=u(2,"2",!1);n.unshift(m)}var g=u(1,"1",!1);n.unshift(g)}}if(r<t){if(!c||r<t-2){var v=u(r+1,"...",!1);n.push(v)}if(c){if(r===t-2){var b=u(t-1,t-1,!1);n.push(b)}var y=u(t,t,!1);n.push(y)}}}return n}(e.page,e.totalPages))}}]).constant("uibPaginationConfig",{itemsPerPage:10,boundaryLinks:!1,boundaryLinkNumbers:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0,forceEllipses:!1}).directive("uibPagination",["$parse","uibPaginationConfig",function(e,t){return{scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@",ngDisabled:"="},require:["uibPagination","?ngModel"],restrict:"A",controller:"UibPaginationController",controllerAs:"pagination",templateUrl:function(e,t){return t.templateUrl||"uib/template/pagination/pagination.html"},link:function(e,n,o,r){n.addClass("pagination");var i=r[0],a=r[1];a&&i.init(a,t)}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.stackedMap"]).provider("$uibTooltip",function(){var e={placement:"top",placementClassPrefix:"",animation:!0,popupDelay:0,popupCloseDelay:0,useContentExp:!1},t={mouseenter:"mouseleave",click:"click",outsideClick:"outsideClick",focus:"blur",none:""},n={};this.options=function(e){angular.extend(n,e)},this.setTriggers=function(e){angular.extend(t,e)},this.$get=["$window","$compile","$timeout","$document","$uibPosition","$interpolate","$rootScope","$parse","$$stackedMap",function(o,r,i,a,s,l,c,p,u){var d=u.createNew();function f(e){if(27===e.which){var t=d.top();t&&(t.value.close(),t=null)}}return a.on("keyup",f),c.$on("$destroy",function(){a.off("keyup",f)}),function(o,c,u,f){function h(e){var n=(e||f.trigger||u).split(" ");return{show:n,hide:n.map(function(e){return t[e]||e})}}f=angular.extend({},e,n,f);var m=o.replace(/[A-Z]/g,function(e,t){return(t?"-":"")+e.toLowerCase()}),g=l.startSymbol(),v=l.endSymbol(),b="<div "+m+'-popup uib-title="'+g+"title"+v+'" '+(f.useContentExp?'content-exp="contentExp()" ':'content="'+g+"content"+v+'" ')+'origin-scope="origScope" class="uib-position-measure '+c+'" tooltip-animation-class="fade"uib-tooltip-classes ng-class="{ in: isOpen }" ></div>';return{compile:function(e,t){var n=r(b);return function(e,t,r,l){var u,m,g,v,b,y,w,x,$=!!angular.isDefined(f.appendToBody)&&f.appendToBody,C=h(void 0),_=angular.isDefined(r[c+"Enable"]),k=e.$new(!0),S=!1,T=!!angular.isDefined(r[c+"IsOpen"])&&p(r[c+"IsOpen"]),I=!!f.useContentExp&&p(r[o]),E=[],N=function(){u&&u.html()&&(y||(y=i(function(){var e=s.positionElements(t,u,k.placement,$),n=angular.isDefined(u.offsetHeight)?u.offsetHeight:u.prop("offsetHeight"),o=$?s.offset(t):s.position(t);u.css({top:e.top+"px",left:e.left+"px"});var r=e.placement.split("-");u.hasClass(r[0])||(u.removeClass(x.split("-")[0]),u.addClass(r[0])),u.hasClass(f.placementClassPrefix+e.placement)||(u.removeClass(f.placementClassPrefix+x),u.addClass(f.placementClassPrefix+e.placement)),w=i(function(){var e=angular.isDefined(u.offsetHeight)?u.offsetHeight:u.prop("offsetHeight"),t=s.adjustTop(r,o,n,e);t&&u.css(t),w=null},0,!1),u.hasClass("uib-position-measure")?(s.positionArrow(u,e.placement),u.removeClass("uib-position-measure")):x!==e.placement&&s.positionArrow(u,e.placement),x=e.placement,y=null},0,!1)))};function O(){k.isOpen?P():D()}function D(){_&&!e.$eval(r[c+"Enable"])||(R(),function(){k.title=r[c+"Title"],k.content=I?I(e):r[o];k.popupClass=r[c+"Class"],k.placement=angular.isDefined(r[c+"Placement"])?r[c+"Placement"]:f.placement;var t=s.parsePlacement(k.placement);x=t[1]?t[0]+"-"+t[1]:t[0];var n=parseInt(r[c+"PopupDelay"],10),i=parseInt(r[c+"PopupCloseDelay"],10);k.popupDelay=isNaN(n)?f.popupDelay:n,k.popupCloseDelay=isNaN(i)?f.popupCloseDelay:i}(),k.popupDelay?v||(v=i(A,k.popupDelay,!1)):A())}function P(){M(),k.popupCloseDelay?b||(b=i(U,k.popupCloseDelay,!1)):U()}function A(){if(M(),R(),!k.content)return angular.noop;!function(){if(u)return;m=k.$new(),u=n(m,function(e){$?a.find("body").append(e):t.after(e)}),d.add(k,{close:U}),function(){E.length=0,I?(E.push(e.$watch(I,function(e){k.content=e,!e&&k.isOpen&&U()})),E.push(m.$watch(function(){S||(S=!0,m.$$postDigest(function(){S=!1,k&&k.isOpen&&N()}))}))):E.push(r.$observe(o,function(e){k.content=e,!e&&k.isOpen?U():N()}));E.push(r.$observe(c+"Title",function(e){k.title=e,k.isOpen&&N()})),E.push(r.$observe(c+"Placement",function(e){k.placement=e||f.placement,k.isOpen&&N()}))}()}(),k.$evalAsync(function(){k.isOpen=!0,z(!0),N()})}function M(){v&&(i.cancel(v),v=null),y&&(i.cancel(y),y=null)}function U(){k&&k.$evalAsync(function(){k&&(k.isOpen=!1,z(!1),k.animation?g||(g=i(L,150,!1)):L())})}function R(){b&&(i.cancel(b),b=null),g&&(i.cancel(g),g=null)}function L(){M(),R(),E.length&&(angular.forEach(E,function(e){e()}),E.length=0),u&&(u.remove(),u=null,w&&i.cancel(w)),d.remove(k),m&&(m.$destroy(),m=null)}function z(t){T&&angular.isFunction(T.assign)&&T.assign(e,t)}function F(e){k&&k.isOpen&&u&&(t[0].contains(e.target)||u[0].contains(e.target)||P())}function j(e){27===e.which&&P()}k.origScope=e,k.isOpen=!1,k.contentExp=function(){return k.content},r.$observe("disabled",function(e){e&&M(),e&&k.isOpen&&U()}),T&&e.$watch(T,function(e){k&&!e===k.isOpen&&O()});var B,G,H,V=function(){C.show.forEach(function(e){"outsideClick"===e?t.off("click",O):(t.off(e,D),t.off(e,O)),t.off("keypress",j)}),C.hide.forEach(function(e){"outsideClick"===e?a.off("click",F):t.off(e,P)})};B=[],G=[],H=e.$eval(r[c+"Trigger"]),V(),angular.isObject(H)?(Object.keys(H).forEach(function(e){B.push(e),G.push(H[e])}),C={show:B,hide:G}):C=h(H),"none"!==C.show&&C.show.forEach(function(e,n){"outsideClick"===e?(t.on("click",O),a.on("click",F)):e===C.hide[n]?t.on(e,O):e&&(t.on(e,D),t.on(C.hide[n],P)),t.on("keypress",j)});var Y,q=e.$eval(r[c+"Animation"]);k.animation=angular.isDefined(q)?!!q:f.animation;var W=c+"AppendToBody";Y=W in r&&void 0===r[W]||e.$eval(r[W]),$=angular.isDefined(Y)?Y:$,e.$on("$destroy",function(){V(),L(),k=null})}}}}}]}).directive("uibTooltipTemplateTransclude",["$animate","$sce","$compile","$templateRequest",function(e,t,n,o){return{link:function(r,i,a){var s,l,c,p=r.$eval(a.tooltipTemplateTranscludeScope),u=0,d=function(){l&&(l.remove(),l=null),s&&(s.$destroy(),s=null),c&&(e.leave(c).then(function(){l=null}),l=c,c=null)};r.$watch(t.parseAsResourceUrl(a.uibTooltipTemplateTransclude),function(t){var a=++u;t?(o(t,!0).then(function(o){if(a===u){var r=p.$new(),l=n(o)(r,function(t){d(),e.enter(t,i)});c=l,(s=r).$emit("$includeContentLoaded",t)}},function(){a===u&&(d(),r.$emit("$includeContentError",t))}),r.$emit("$includeContentRequested",t)):d()}),r.$on("$destroy",d)}}}]).directive("uibTooltipClasses",["$uibPosition",function(e){return{restrict:"A",link:function(t,n,o){if(t.placement){var r=e.parsePlacement(t.placement);n.addClass(r[0])}t.popupClass&&n.addClass(t.popupClass),t.animation&&n.addClass(o.tooltipAnimationClass)}}}]).directive("uibTooltipPopup",function(){return{restrict:"A",scope:{content:"@"},templateUrl:"uib/template/tooltip/tooltip-popup.html"}}).directive("uibTooltip",["$uibTooltip",function(e){return e("uibTooltip","tooltip","mouseenter")}]).directive("uibTooltipTemplatePopup",function(){return{restrict:"A",scope:{contentExp:"&",originScope:"&"},templateUrl:"uib/template/tooltip/tooltip-template-popup.html"}}).directive("uibTooltipTemplate",["$uibTooltip",function(e){return e("uibTooltipTemplate","tooltip","mouseenter",{useContentExp:!0})}]).directive("uibTooltipHtmlPopup",function(){return{restrict:"A",scope:{contentExp:"&"},templateUrl:"uib/template/tooltip/tooltip-html-popup.html"}}).directive("uibTooltipHtml",["$uibTooltip",function(e){return e("uibTooltipHtml","tooltip","mouseenter",{useContentExp:!0})}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("uibPopoverTemplatePopup",function(){return{restrict:"A",scope:{uibTitle:"@",contentExp:"&",originScope:"&"},templateUrl:"uib/template/popover/popover-template.html"}}).directive("uibPopoverTemplate",["$uibTooltip",function(e){return e("uibPopoverTemplate","popover","click",{useContentExp:!0})}]).directive("uibPopoverHtmlPopup",function(){return{restrict:"A",scope:{contentExp:"&",uibTitle:"@"},templateUrl:"uib/template/popover/popover-html.html"}}).directive("uibPopoverHtml",["$uibTooltip",function(e){return e("uibPopoverHtml","popover","click",{useContentExp:!0})}]).directive("uibPopoverPopup",function(){return{restrict:"A",scope:{uibTitle:"@",content:"@"},templateUrl:"uib/template/popover/popover.html"}}).directive("uibPopover",["$uibTooltip",function(e){return e("uibPopover","popover","click")}]),angular.module("ui.bootstrap.progressbar",[]).constant("uibProgressConfig",{animate:!0,max:100}).controller("UibProgressController",["$scope","$attrs","uibProgressConfig",function(e,t,n){var o=this,r=angular.isDefined(t.animate)?e.$parent.$eval(t.animate):n.animate;function i(){return angular.isDefined(e.maxParam)?e.maxParam:n.max}this.bars=[],e.max=i(),this.addBar=function(e,t,n){r||t.css({transition:"none"}),this.bars.push(e),e.max=i(),e.title=n&&angular.isDefined(n.title)?n.title:"progressbar",e.$watch("value",function(t){e.recalculatePercentage()}),e.recalculatePercentage=function(){var t=o.bars.reduce(function(e,t){return t.percent=+(100*t.value/t.max).toFixed(2),e+t.percent},0);t>100&&(e.percent-=t-100)},e.$on("$destroy",function(){t=null,o.removeBar(e)})},this.removeBar=function(e){this.bars.splice(this.bars.indexOf(e),1),this.bars.forEach(function(e){e.recalculatePercentage()})},e.$watch("maxParam",function(e){o.bars.forEach(function(e){e.max=i(),e.recalculatePercentage()})})}]).directive("uibProgress",function(){return{replace:!0,transclude:!0,controller:"UibProgressController",require:"uibProgress",scope:{maxParam:"=?max"},templateUrl:"uib/template/progressbar/progress.html"}}).directive("uibBar",function(){return{replace:!0,transclude:!0,require:"^uibProgress",scope:{value:"=",type:"@"},templateUrl:"uib/template/progressbar/bar.html",link:function(e,t,n,o){o.addBar(e,t,n)}}}).directive("uibProgressbar",function(){return{replace:!0,transclude:!0,controller:"UibProgressController",scope:{value:"=",maxParam:"=?max",type:"@"},templateUrl:"uib/template/progressbar/progressbar.html",link:function(e,t,n,o){o.addBar(e,angular.element(t.children()[0]),{title:n.title})}}}),angular.module("ui.bootstrap.rating",[]).constant("uibRatingConfig",{max:5,stateOn:null,stateOff:null,enableReset:!0,titles:["one","two","three","four","five"]}).controller("UibRatingController",["$scope","$attrs","uibRatingConfig",function(e,t,n){var o={$setViewValue:angular.noop},r=this;this.init=function(r){(o=r).$render=this.render,o.$formatters.push(function(e){return angular.isNumber(e)&&e<<0!==e&&(e=Math.round(e)),e}),this.stateOn=angular.isDefined(t.stateOn)?e.$parent.$eval(t.stateOn):n.stateOn,this.stateOff=angular.isDefined(t.stateOff)?e.$parent.$eval(t.stateOff):n.stateOff,this.enableReset=angular.isDefined(t.enableReset)?e.$parent.$eval(t.enableReset):n.enableReset;var i=angular.isDefined(t.titles)?e.$parent.$eval(t.titles):n.titles;this.titles=angular.isArray(i)&&i.length>0?i:n.titles;var a=angular.isDefined(t.ratingStates)?e.$parent.$eval(t.ratingStates):new Array(angular.isDefined(t.max)?e.$parent.$eval(t.max):n.max);e.range=this.buildTemplateObjects(a)},this.buildTemplateObjects=function(e){for(var t=0,n=e.length;t<n;t++)e[t]=angular.extend({index:t},{stateOn:this.stateOn,stateOff:this.stateOff,title:this.getTitle(t)},e[t]);return e},this.getTitle=function(e){return e>=this.titles.length?e+1:this.titles[e]},e.rate=function(t){if(!e.readonly&&t>=0&&t<=e.range.length){var n=r.enableReset&&o.$viewValue===t?0:t;o.$setViewValue(n),o.$render()}},e.enter=function(t){e.readonly||(e.value=t),e.onHover({value:t})},e.reset=function(){e.value=o.$viewValue,e.onLeave()},e.onKeydown=function(t){/(37|38|39|40)/.test(t.which)&&(t.preventDefault(),t.stopPropagation(),e.rate(e.value+(38===t.which||39===t.which?1:-1)))},this.render=function(){e.value=o.$viewValue,e.title=r.getTitle(e.value-1)}}]).directive("uibRating",function(){return{require:["uibRating","ngModel"],restrict:"A",scope:{readonly:"=?readOnly",onHover:"&",onLeave:"&"},controller:"UibRatingController",templateUrl:"uib/template/rating/rating.html",link:function(e,t,n,o){var r=o[0],i=o[1];r.init(i)}}}),angular.module("ui.bootstrap.tabs",[]).controller("UibTabsetController",["$scope",function(e){var t,n,o=this;function r(e){for(var t=0;t<o.tabs.length;t++)if(o.tabs[t].index===e)return t}o.tabs=[],o.select=function(e,i){if(!n){var a=r(t),s=o.tabs[a];if(s){if(s.tab.onDeselect({$event:i,$selectedIndex:e}),i&&i.isDefaultPrevented())return;s.tab.active=!1}var l=o.tabs[e];l?(l.tab.onSelect({$event:i}),l.tab.active=!0,o.active=l.index,t=l.index):!l&&angular.isDefined(t)&&(o.active=null,t=null)}},o.addTab=function(e){if(o.tabs.push({tab:e,index:e.index}),o.tabs.sort(function(e,t){return e.index>t.index?1:e.index<t.index?-1:0}),e.index===o.active||!angular.isDefined(o.active)&&1===o.tabs.length){var t=r(e.index);o.select(t)}},o.removeTab=function(e){for(var t,n=0;n<o.tabs.length;n++)if(o.tabs[n].tab===e){t=n;break}if(o.tabs[t].index===o.active){var r=t===o.tabs.length-1?t-1:t+1%o.tabs.length;o.select(r)}o.tabs.splice(t,1)},e.$watch("tabset.active",function(e){angular.isDefined(e)&&e!==t&&o.select(r(e))}),e.$on("$destroy",function(){n=!0})}]).directive("uibTabset",function(){return{transclude:!0,replace:!0,scope:{},bindToController:{active:"=?",type:"@"},controller:"UibTabsetController",controllerAs:"tabset",templateUrl:function(e,t){return t.templateUrl||"uib/template/tabs/tabset.html"},link:function(e,t,n){e.vertical=!!angular.isDefined(n.vertical)&&e.$parent.$eval(n.vertical),e.justified=!!angular.isDefined(n.justified)&&e.$parent.$eval(n.justified)}}}).directive("uibTab",["$parse",function(e){return{require:"^uibTabset",replace:!0,templateUrl:function(e,t){return t.templateUrl||"uib/template/tabs/tab.html"},transclude:!0,scope:{heading:"@",index:"=?",classes:"@?",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},controllerAs:"tab",link:function(t,n,o,r,i){t.disabled=!1,o.disable&&t.$parent.$watch(e(o.disable),function(e){t.disabled=!!e}),angular.isUndefined(o.index)&&(r.tabs&&r.tabs.length?t.index=Math.max.apply(null,r.tabs.map(function(e){return e.index}))+1:t.index=0),angular.isUndefined(o.classes)&&(t.classes=""),t.select=function(e){if(!t.disabled){for(var n,o=0;o<r.tabs.length;o++)if(r.tabs[o].tab===t){n=o;break}r.select(n,e)}},r.addTab(t),t.$on("$destroy",function(){r.removeTab(t)}),t.$transcludeFn=i}}}]).directive("uibTabHeadingTransclude",function(){return{restrict:"A",require:"^uibTab",link:function(e,t){e.$watch("headingElement",function(e){e&&(t.html(""),t.append(e))})}}}).directive("uibTabContentTransclude",function(){return{restrict:"A",require:"^uibTabset",link:function(e,t,n){var o=e.$eval(n.uibTabContentTransclude).tab;o.$transcludeFn(o.$parent,function(e){angular.forEach(e,function(e){!function(e){return e.tagName&&(e.hasAttribute("uib-tab-heading")||e.hasAttribute("data-uib-tab-heading")||e.hasAttribute("x-uib-tab-heading")||"uib-tab-heading"===e.tagName.toLowerCase()||"data-uib-tab-heading"===e.tagName.toLowerCase()||"x-uib-tab-heading"===e.tagName.toLowerCase()||"uib:tab-heading"===e.tagName.toLowerCase())}(e)?t.append(e):o.headingElement=e})})}}}),angular.module("ui.bootstrap.timepicker",[]).constant("uibTimepickerConfig",{hourStep:1,minuteStep:1,secondStep:1,showMeridian:!0,showSeconds:!1,meridians:null,readonlyInput:!1,mousewheel:!0,arrowkeys:!0,showSpinners:!0,templateUrl:"uib/template/timepicker/timepicker.html"}).controller("UibTimepickerController",["$scope","$element","$attrs","$parse","$log","$locale","uibTimepickerConfig",function(e,t,n,o,r,i,a){var s,l,c,p=new Date,u=[],d={$setViewValue:angular.noop},f=angular.isDefined(n.meridians)?e.$parent.$eval(n.meridians):a.meridians||i.DATETIME_FORMATS.AMPMS,h=!angular.isDefined(n.padHours)||e.$parent.$eval(n.padHours);e.tabindex=angular.isDefined(n.tabindex)?n.tabindex:0,t.removeAttr("tabindex"),this.init=function(t,o){(d=t).$render=this.render,d.$formatters.unshift(function(e){return e?new Date(e):null});var r=o.eq(0),i=o.eq(1),p=o.eq(2);s=r.controller("ngModel"),l=i.controller("ngModel"),c=p.controller("ngModel"),(angular.isDefined(n.mousewheel)?e.$parent.$eval(n.mousewheel):a.mousewheel)&&this.setupMousewheelEvents(r,i,p),(angular.isDefined(n.arrowkeys)?e.$parent.$eval(n.arrowkeys):a.arrowkeys)&&this.setupArrowkeyEvents(r,i,p),e.readonlyInput=angular.isDefined(n.readonlyInput)?e.$parent.$eval(n.readonlyInput):a.readonlyInput,this.setupInputEvents(r,i,p)};var m=a.hourStep;n.hourStep&&u.push(e.$parent.$watch(o(n.hourStep),function(e){m=+e}));var g,v,b=a.minuteStep;n.minuteStep&&u.push(e.$parent.$watch(o(n.minuteStep),function(e){b=+e})),u.push(e.$parent.$watch(o(n.min),function(e){var t=new Date(e);g=isNaN(t)?void 0:t})),u.push(e.$parent.$watch(o(n.max),function(e){var t=new Date(e);v=isNaN(t)?void 0:t}));var y=!1;n.ngDisabled&&u.push(e.$parent.$watch(o(n.ngDisabled),function(e){y=e})),e.noIncrementHours=function(){var e=I(p,60*m);return y||e>v||e<p&&e<g},e.noDecrementHours=function(){var e=I(p,60*-m);return y||e<g||e>p&&e>v},e.noIncrementMinutes=function(){var e=I(p,b);return y||e>v||e<p&&e<g},e.noDecrementMinutes=function(){var e=I(p,-b);return y||e<g||e>p&&e>v},e.noIncrementSeconds=function(){var e=E(p,w);return y||e>v||e<p&&e<g},e.noDecrementSeconds=function(){var e=E(p,-w);return y||e<g||e>p&&e>v},e.noToggleMeridian=function(){return p.getHours()<12?y||I(p,720)>v:y||I(p,-720)<g};var w=a.secondStep;function x(){var t=+e.hours;if((e.showMeridian?t>0&&t<13:t>=0&&t<24)&&""!==e.hours)return e.showMeridian&&(12===t&&(t=0),e.meridian===f[1]&&(t+=12)),t}function $(){var t=+e.minutes;if(t>=0&&t<60&&""!==e.minutes)return t}function C(e,t){return null===e?"":angular.isDefined(e)&&e.toString().length<2&&!t?"0"+e:e.toString()}function _(e){k(),d.$setViewValue(new Date(p)),S(e)}function k(){s&&s.$setValidity("hours",!0),l&&l.$setValidity("minutes",!0),c&&c.$setValidity("seconds",!0),d.$setValidity("time",!0),e.invalidHours=!1,e.invalidMinutes=!1,e.invalidSeconds=!1}function S(t){if(d.$modelValue){var n=p.getHours(),o=p.getMinutes(),r=p.getSeconds();e.showMeridian&&(n=0===n||12===n?12:n%12),e.hours="h"===t?n:C(n,!h),"m"!==t&&(e.minutes=C(o)),e.meridian=p.getHours()<12?f[0]:f[1],"s"!==t&&(e.seconds=C(r)),e.meridian=p.getHours()<12?f[0]:f[1]}else e.hours=null,e.minutes=null,e.seconds=null,e.meridian=f[0]}function T(e){p=E(p,e),_()}function I(e,t){return E(e,60*t)}function E(e,t){var n=new Date(e.getTime()+1e3*t),o=new Date(e);return o.setHours(n.getHours(),n.getMinutes(),n.getSeconds()),o}function N(){return(null===e.hours||""===e.hours)&&(null===e.minutes||""===e.minutes)&&(!e.showSeconds||e.showSeconds&&(null===e.seconds||""===e.seconds))}n.secondStep&&u.push(e.$parent.$watch(o(n.secondStep),function(e){w=+e})),e.showSeconds=a.showSeconds,n.showSeconds&&u.push(e.$parent.$watch(o(n.showSeconds),function(t){e.showSeconds=!!t})),e.showMeridian=a.showMeridian,n.showMeridian&&u.push(e.$parent.$watch(o(n.showMeridian),function(t){if(e.showMeridian=!!t,d.$error.time){var n=x(),o=$();angular.isDefined(n)&&angular.isDefined(o)&&(p.setHours(n),_())}else S()})),this.setupMousewheelEvents=function(t,n,o){var r=function(e){e.originalEvent&&(e=e.originalEvent);var t=e.wheelDelta?e.wheelDelta:-e.deltaY;return e.detail||t>0};t.on("mousewheel wheel",function(t){y||e.$apply(r(t)?e.incrementHours():e.decrementHours()),t.preventDefault()}),n.on("mousewheel wheel",function(t){y||e.$apply(r(t)?e.incrementMinutes():e.decrementMinutes()),t.preventDefault()}),o.on("mousewheel wheel",function(t){y||e.$apply(r(t)?e.incrementSeconds():e.decrementSeconds()),t.preventDefault()})},this.setupArrowkeyEvents=function(t,n,o){t.on("keydown",function(t){y||(38===t.which?(t.preventDefault(),e.incrementHours(),e.$apply()):40===t.which&&(t.preventDefault(),e.decrementHours(),e.$apply()))}),n.on("keydown",function(t){y||(38===t.which?(t.preventDefault(),e.incrementMinutes(),e.$apply()):40===t.which&&(t.preventDefault(),e.decrementMinutes(),e.$apply()))}),o.on("keydown",function(t){y||(38===t.which?(t.preventDefault(),e.incrementSeconds(),e.$apply()):40===t.which&&(t.preventDefault(),e.decrementSeconds(),e.$apply()))})},this.setupInputEvents=function(t,n,o){if(e.readonlyInput)return e.updateHours=angular.noop,e.updateMinutes=angular.noop,void(e.updateSeconds=angular.noop);var r=function(t,n,o){d.$setViewValue(null),d.$setValidity("time",!1),angular.isDefined(t)&&(e.invalidHours=t,s&&s.$setValidity("hours",!1)),angular.isDefined(n)&&(e.invalidMinutes=n,l&&l.$setValidity("minutes",!1)),angular.isDefined(o)&&(e.invalidSeconds=o,c&&c.$setValidity("seconds",!1))};e.updateHours=function(){var e=x(),t=$();d.$setDirty(),angular.isDefined(e)&&angular.isDefined(t)?(p.setHours(e),p.setMinutes(t),p<g||p>v?r(!0):_("h")):r(!0)},t.on("blur",function(t){d.$setTouched(),N()?k():null===e.hours||""===e.hours?r(!0):!e.invalidHours&&e.hours<10&&e.$apply(function(){e.hours=C(e.hours,!h)})}),e.updateMinutes=function(){var e=$(),t=x();d.$setDirty(),angular.isDefined(e)&&angular.isDefined(t)?(p.setHours(t),p.setMinutes(e),p<g||p>v?r(void 0,!0):_("m")):r(void 0,!0)},n.on("blur",function(t){d.$setTouched(),N()?k():null===e.minutes?r(void 0,!0):!e.invalidMinutes&&e.minutes<10&&e.$apply(function(){e.minutes=C(e.minutes)})}),e.updateSeconds=function(){var t=function(){var t=+e.seconds;return t>=0&&t<60?t:void 0}();d.$setDirty(),angular.isDefined(t)?(p.setSeconds(t),_("s")):r(void 0,void 0,!0)},o.on("blur",function(t){N()?k():!e.invalidSeconds&&e.seconds<10&&e.$apply(function(){e.seconds=C(e.seconds)})})},this.render=function(){var t=d.$viewValue;isNaN(t)?(d.$setValidity("time",!1),r.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(t&&(p=t),p<g||p>v?(d.$setValidity("time",!1),e.invalidHours=!0,e.invalidMinutes=!0):k(),S())},e.showSpinners=angular.isDefined(n.showSpinners)?e.$parent.$eval(n.showSpinners):a.showSpinners,e.incrementHours=function(){e.noIncrementHours()||T(60*m*60)},e.decrementHours=function(){e.noDecrementHours()||T(60*-m*60)},e.incrementMinutes=function(){e.noIncrementMinutes()||T(60*b)},e.decrementMinutes=function(){e.noDecrementMinutes()||T(60*-b)},e.incrementSeconds=function(){e.noIncrementSeconds()||T(w)},e.decrementSeconds=function(){e.noDecrementSeconds()||T(-w)},e.toggleMeridian=function(){var t=$(),n=x();e.noToggleMeridian()||(angular.isDefined(t)&&angular.isDefined(n)?T(720*(p.getHours()<12?60:-60)):e.meridian=e.meridian===f[0]?f[1]:f[0])},e.blur=function(){d.$setTouched()},e.$on("$destroy",function(){for(;u.length;)u.shift()()})}]).directive("uibTimepicker",["uibTimepickerConfig",function(e){return{require:["uibTimepicker","?^ngModel"],restrict:"A",controller:"UibTimepickerController",controllerAs:"timepicker",scope:{},templateUrl:function(t,n){return n.templateUrl||e.templateUrl},link:function(e,t,n,o){var r=o[0],i=o[1];i&&r.init(i,t.find("input"))}}}]),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.debounce","ui.bootstrap.position"]).factory("uibTypeaheadParser",["$parse",function(e){var t=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(n){var o=n.match(t);if(!o)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+n+'".');return{itemName:o[3],source:e(o[4]),viewMapper:e(o[2]||o[1]),modelMapper:e(o[1])}}}}]).controller("UibTypeaheadController",["$scope","$element","$attrs","$compile","$parse","$q","$timeout","$document","$window","$rootScope","$$debounce","$uibPosition","uibTypeaheadParser",function(e,t,n,o,r,i,a,s,l,c,p,u,d){var f,h,m=[9,13,27,38,40],g=e.$eval(n.typeaheadMinLength);g||0===g||(g=1),e.$watch(n.typeaheadMinLength,function(e){g=e||0===e?e:1});var v=e.$eval(n.typeaheadWaitMs)||0,b=!1!==e.$eval(n.typeaheadEditable);e.$watch(n.typeaheadEditable,function(e){b=!1!==e});var y,w,x=r(n.typeaheadLoading).assign||angular.noop,$=n.typeaheadShouldSelect?r(n.typeaheadShouldSelect):function(e,t){var n=t.$event;return 13===n.which||9===n.which},C=r(n.typeaheadOnSelect),_=!!angular.isDefined(n.typeaheadSelectOnBlur)&&e.$eval(n.typeaheadSelectOnBlur),k=r(n.typeaheadNoResults).assign||angular.noop,S=n.typeaheadInputFormatter?r(n.typeaheadInputFormatter):void 0,T=!!n.typeaheadAppendToBody&&e.$eval(n.typeaheadAppendToBody),I=n.typeaheadAppendTo?e.$eval(n.typeaheadAppendTo):null,E=!1!==e.$eval(n.typeaheadFocusFirst),N=!!n.typeaheadSelectOnExact&&e.$eval(n.typeaheadSelectOnExact),O=r(n.typeaheadIsOpen).assign||angular.noop,D=e.$eval(n.typeaheadShowHint)||!1,P=r(n.ngModel),A=r(n.ngModel+"($$$p)"),M=d.parse(n.uibTypeahead),U=e.$new(),R=e.$on("$destroy",function(){U.$destroy()});U.$on("$destroy",R);var L,z,F="typeahead-"+U.$id+"-"+Math.floor(1e4*Math.random());t.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":F}),D&&((L=angular.element("<div></div>")).css("position","relative"),t.after(L),(z=t.clone()).attr("placeholder",""),z.attr("tabindex","-1"),z.val(""),z.css({position:"absolute",top:"0px",left:"0px","border-color":"transparent","box-shadow":"none",opacity:1,background:"none 0% 0% / auto repeat scroll padding-box border-box rgb(255, 255, 255)",color:"#999"}),t.css({position:"relative","vertical-align":"top","background-color":"transparent"}),z.attr("id")&&z.removeAttr("id"),L.append(z),z.after(t));var j=angular.element("<div uib-typeahead-popup></div>");j.attr({id:F,matches:"matches",active:"activeIdx",select:"select(activeIdx, evt)","move-in-progress":"moveInProgress",query:"query",position:"position","assign-is-open":"assignIsOpen(isOpen)",debounce:"debounceUpdate"}),angular.isDefined(n.typeaheadTemplateUrl)&&j.attr("template-url",n.typeaheadTemplateUrl),angular.isDefined(n.typeaheadPopupTemplateUrl)&&j.attr("popup-template-url",n.typeaheadPopupTemplateUrl);var B=function(){U.matches=[],U.activeIdx=-1,t.attr("aria-expanded",!1),D&&z.val("")},G=function(e){return F+"-option-"+e};U.$watch("activeIdx",function(e){e<0?t.removeAttr("aria-activedescendant"):t.attr("aria-activedescendant",G(e))});var H=function(n,o){var r={$viewValue:n};x(e,!0),k(e,!1),i.when(M.source(e,r)).then(function(i){var a=n===f.$viewValue;if(a&&y)if(i&&i.length>0){U.activeIdx=E?0:-1,k(e,!1),U.matches.length=0;for(var s=0;s<i.length;s++)r[M.itemName]=i[s],U.matches.push({id:G(s),label:M.viewMapper(U,r),model:i[s]});if(U.query=n,W(),t.attr("aria-expanded",!0),N&&1===U.matches.length&&function(e,t){return!!(U.matches.length>t&&e)&&e.toUpperCase()===U.matches[t].label.toUpperCase()}(n,0)&&(angular.isNumber(U.debounceUpdate)||angular.isObject(U.debounceUpdate)?p(function(){U.select(0,o)},angular.isNumber(U.debounceUpdate)?U.debounceUpdate:U.debounceUpdate.default):U.select(0,o)),D){var l=U.matches[0].label;angular.isString(n)&&n.length>0&&l.slice(0,n.length).toUpperCase()===n.toUpperCase()?z.val(n+l.slice(n.length)):z.val("")}}else B(),k(e,!0);a&&x(e,!1)},function(){B(),x(e,!1),k(e,!0)})};T&&(angular.element(l).on("resize",q),s.find("body").on("scroll",q));var V,Y=p(function(){U.matches.length&&W(),U.moveInProgress=!1},200);function q(){U.moveInProgress||(U.moveInProgress=!0,U.$digest()),Y()}function W(){U.position=T?u.offset(t):u.position(t),U.position.top+=t.prop("offsetHeight")}U.moveInProgress=!1,U.query=void 0;var K=function(){V&&a.cancel(V)};B(),U.assignIsOpen=function(t){O(e,t)},U.select=function(o,r){var i,s,l={};w=!0,l[M.itemName]=s=U.matches[o].model,i=M.modelMapper(e,l),function(t,n){angular.isFunction(P(e))&&h.getOption("getterSetter")?A(t,{$$$p:n}):P.assign(t,n)}(e,i),f.$setValidity("editable",!0),f.$setValidity("parse",!0),C(e,{$item:s,$model:i,$label:M.viewMapper(e,l),$event:r}),B(),!1!==U.$eval(n.typeaheadFocusOnSelect)&&a(function(){t[0].focus()},0,!1)},t.on("keydown",function(t){if(0!==U.matches.length&&-1!==m.indexOf(t.which)){var n,o=$(e,{$event:t});if(-1===U.activeIdx&&o||9===t.which&&t.shiftKey)return B(),void U.$digest();switch(t.preventDefault(),t.which){case 27:t.stopPropagation(),B(),e.$digest();break;case 38:U.activeIdx=(U.activeIdx>0?U.activeIdx:U.matches.length)-1,U.$digest(),(n=j[0].querySelectorAll(".uib-typeahead-match")[U.activeIdx]).parentNode.scrollTop=n.offsetTop;break;case 40:U.activeIdx=(U.activeIdx+1)%U.matches.length,U.$digest(),(n=j[0].querySelectorAll(".uib-typeahead-match")[U.activeIdx]).parentNode.scrollTop=n.offsetTop;break;default:o&&U.$apply(function(){angular.isNumber(U.debounceUpdate)||angular.isObject(U.debounceUpdate)?p(function(){U.select(U.activeIdx,t)},angular.isNumber(U.debounceUpdate)?U.debounceUpdate:U.debounceUpdate.default):U.select(U.activeIdx,t)})}}}),t.on("focus",function(e){y=!0,0!==g||f.$viewValue||a(function(){H(f.$viewValue,e)},0)}),t.on("blur",function(e){_&&U.matches.length&&-1!==U.activeIdx&&!w&&(w=!0,U.$apply(function(){angular.isObject(U.debounceUpdate)&&angular.isNumber(U.debounceUpdate.blur)?p(function(){U.select(U.activeIdx,e)},U.debounceUpdate.blur):U.select(U.activeIdx,e)})),!b&&f.$error.editable&&(f.$setViewValue(),U.$apply(function(){f.$setValidity("editable",!0),f.$setValidity("parse",!0)}),t.val("")),y=!1,w=!1});var X=function(n){t[0]!==n.target&&3!==n.which&&0!==U.matches.length&&(B(),c.$$phase||e.$digest())};s.on("click",X),e.$on("$destroy",function(){s.off("click",X),(T||I)&&Z.remove(),T&&(angular.element(l).off("resize",q),s.find("body").off("scroll",q)),j.remove(),D&&L.remove()});var Z=o(j)(U);T?s.find("body").append(Z):I?angular.element(I).eq(0).append(Z):t.after(Z),this.init=function(t){h=function(e){var t;angular.version.minor<6?(t=e.$options||{}).getOption=function(e){return t[e]}:t=e.$options;return t}(f=t),U.debounceUpdate=r(h.getOption("debounce"))(e),f.$parsers.unshift(function(t){return y=!0,0===g||t&&t.length>=g?v>0?(K(),function(e){V=a(function(){H(e)},v)}(t)):H(t):(x(e,!1),K(),B()),b?t:t?void f.$setValidity("editable",!1):(f.$setValidity("editable",!0),null)}),f.$formatters.push(function(t){var n,o={};return b||f.$setValidity("editable",!0),S?(o.$model=t,S(e,o)):(o[M.itemName]=t,n=M.viewMapper(e,o),o[M.itemName]=void 0,n!==M.viewMapper(e,o)?n:t)})}}]).directive("uibTypeahead",function(){return{controller:"UibTypeaheadController",require:["ngModel","uibTypeahead"],link:function(e,t,n,o){o[1].init(o[0])}}}).directive("uibTypeaheadPopup",["$$debounce",function(e){return{scope:{matches:"=",query:"=",active:"=",position:"&",moveInProgress:"=",select:"&",assignIsOpen:"&",debounce:"&"},replace:!0,templateUrl:function(e,t){return t.popupTemplateUrl||"uib/template/typeahead/typeahead-popup.html"},link:function(t,n,o){t.templateUrl=o.templateUrl,t.isOpen=function(){var e=t.matches.length>0;return t.assignIsOpen({isOpen:e}),e},t.isActive=function(e){return t.active===e},t.selectActive=function(e){t.active=e},t.selectMatch=function(n,o){var r=t.debounce();angular.isNumber(r)||angular.isObject(r)?e(function(){t.select({activeIdx:n,evt:o})},angular.isNumber(r)?r:r.default):t.select({activeIdx:n,evt:o})}}}}]).directive("uibTypeaheadMatch",["$templateRequest","$compile","$parse",function(e,t,n){return{scope:{index:"=",match:"=",query:"="},link:function(o,r,i){var a=n(i.templateUrl)(o.$parent)||"uib/template/typeahead/typeahead-match.html";e(a).then(function(e){var n=angular.element(e.trim());r.replaceWith(n),t(n)(o)})}}}]).filter("uibTypeaheadHighlight",["$sce","$injector","$log",function(e,t,n){var o;return o=t.has("$sanitize"),function(t,r){return!o&&function(e){return/<.*>/g.test(e)}(t)&&n.warn("Unsafe use of typeahead please use ngSanitize"),t=r?(""+t).replace(new RegExp(r.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"gi"),"<strong>$&</strong>"):t,o||(t=e.trustAsHtml(t)),t}}]),angular.module("ui.bootstrap.carousel").run(function(){!angular.$$csp().noInlineStyle&&!angular.$$uibCarouselCss&&angular.element(document).find("head").prepend('<style type="text/css">.ng-animate.item:not(.left):not(.right){-webkit-transition:0s ease-in-out left;transition:0s ease-in-out left}</style>'),angular.$$uibCarouselCss=!0}),angular.module("ui.bootstrap.datepicker").run(function(){!angular.$$csp().noInlineStyle&&!angular.$$uibDatepickerCss&&angular.element(document).find("head").prepend('<style type="text/css">.uib-datepicker .uib-title{width:100%;}.uib-day button,.uib-month button,.uib-year button{min-width:100%;}.uib-left,.uib-right{width:100%}</style>'),angular.$$uibDatepickerCss=!0}),angular.module("ui.bootstrap.position").run(function(){!angular.$$csp().noInlineStyle&&!angular.$$uibPositionCss&&angular.element(document).find("head").prepend('<style type="text/css">.uib-position-measure{display:block !important;visibility:hidden !important;position:absolute !important;top:-9999px !important;left:-9999px !important;}.uib-position-scrollbar-measure{position:absolute !important;top:-9999px !important;width:50px !important;height:50px !important;overflow:scroll !important;}.uib-position-body-scrollbar-measure{overflow:scroll !important;}</style>'),angular.$$uibPositionCss=!0}),angular.module("ui.bootstrap.datepickerPopup").run(function(){!angular.$$csp().noInlineStyle&&!angular.$$uibDatepickerpopupCss&&angular.element(document).find("head").prepend('<style type="text/css">.uib-datepicker-popup.dropdown-menu{display:block;float:none;margin:0;}.uib-button-bar{padding:10px 9px 2px;}</style>'),angular.$$uibDatepickerpopupCss=!0}),angular.module("ui.bootstrap.tooltip").run(function(){!angular.$$csp().noInlineStyle&&!angular.$$uibTooltipCss&&angular.element(document).find("head").prepend('<style type="text/css">[uib-tooltip-popup].tooltip.top-left > .tooltip-arrow,[uib-tooltip-popup].tooltip.top-right > .tooltip-arrow,[uib-tooltip-popup].tooltip.bottom-left > .tooltip-arrow,[uib-tooltip-popup].tooltip.bottom-right > .tooltip-arrow,[uib-tooltip-popup].tooltip.left-top > .tooltip-arrow,[uib-tooltip-popup].tooltip.left-bottom > .tooltip-arrow,[uib-tooltip-popup].tooltip.right-top > .tooltip-arrow,[uib-tooltip-popup].tooltip.right-bottom > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.top-left > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.top-right > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.bottom-left > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.bottom-right > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.left-top > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.left-bottom > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.right-top > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.right-bottom > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.top-left > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.top-right > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.bottom-left > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.bottom-right > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.left-top > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.left-bottom > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.right-top > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.right-bottom > .tooltip-arrow,[uib-popover-popup].popover.top-left > .arrow,[uib-popover-popup].popover.top-right > .arrow,[uib-popover-popup].popover.bottom-left > .arrow,[uib-popover-popup].popover.bottom-right > .arrow,[uib-popover-popup].popover.left-top > .arrow,[uib-popover-popup].popover.left-bottom > .arrow,[uib-popover-popup].popover.right-top > .arrow,[uib-popover-popup].popover.right-bottom > .arrow,[uib-popover-html-popup].popover.top-left > .arrow,[uib-popover-html-popup].popover.top-right > .arrow,[uib-popover-html-popup].popover.bottom-left > .arrow,[uib-popover-html-popup].popover.bottom-right > .arrow,[uib-popover-html-popup].popover.left-top > .arrow,[uib-popover-html-popup].popover.left-bottom > .arrow,[uib-popover-html-popup].popover.right-top > .arrow,[uib-popover-html-popup].popover.right-bottom > .arrow,[uib-popover-template-popup].popover.top-left > .arrow,[uib-popover-template-popup].popover.top-right > .arrow,[uib-popover-template-popup].popover.bottom-left > .arrow,[uib-popover-template-popup].popover.bottom-right > .arrow,[uib-popover-template-popup].popover.left-top > .arrow,[uib-popover-template-popup].popover.left-bottom > .arrow,[uib-popover-template-popup].popover.right-top > .arrow,[uib-popover-template-popup].popover.right-bottom > .arrow{top:auto;bottom:auto;left:auto;right:auto;margin:0;}[uib-popover-popup].popover,[uib-popover-html-popup].popover,[uib-popover-template-popup].popover{display:block !important;}</style>'),angular.$$uibTooltipCss=!0}),angular.module("ui.bootstrap.timepicker").run(function(){!angular.$$csp().noInlineStyle&&!angular.$$uibTimepickerCss&&angular.element(document).find("head").prepend('<style type="text/css">.uib-time input{width:50px;}</style>'),angular.$$uibTimepickerCss=!0}),angular.module("ui.bootstrap.typeahead").run(function(){!angular.$$csp().noInlineStyle&&!angular.$$uibTypeaheadCss&&angular.element(document).find("head").prepend('<style type="text/css">[uib-typeahead-popup].dropdown-menu{display:block;}</style>'),angular.$$uibTypeaheadCss=!0}),angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.collapse","ui.bootstrap.tabindex","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.isClass","ui.bootstrap.datepicker","ui.bootstrap.position","ui.bootstrap.datepickerPopup","ui.bootstrap.debounce","ui.bootstrap.multiMap","ui.bootstrap.dropdown","ui.bootstrap.stackedMap","ui.bootstrap.modal","ui.bootstrap.paging","ui.bootstrap.pager","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.tpls",["uib/template/accordion/accordion-group.html","uib/template/accordion/accordion.html","uib/template/alert/alert.html","uib/template/carousel/carousel.html","uib/template/carousel/slide.html","uib/template/datepicker/datepicker.html","uib/template/datepicker/day.html","uib/template/datepicker/month.html","uib/template/datepicker/year.html","uib/template/datepickerPopup/popup.html","uib/template/modal/window.html","uib/template/pager/pager.html","uib/template/pagination/pagination.html","uib/template/tooltip/tooltip-html-popup.html","uib/template/tooltip/tooltip-popup.html","uib/template/tooltip/tooltip-template-popup.html","uib/template/popover/popover-html.html","uib/template/popover/popover-template.html","uib/template/popover/popover.html","uib/template/progressbar/bar.html","uib/template/progressbar/progress.html","uib/template/progressbar/progressbar.html","uib/template/rating/rating.html","uib/template/tabs/tab.html","uib/template/tabs/tabset.html","uib/template/timepicker/timepicker.html","uib/template/typeahead/typeahead-match.html","uib/template/typeahead/typeahead-popup.html"]),angular.module("ui.bootstrap.collapse",[]).directive("uibCollapse",["$animate","$q","$parse","$injector",function(e,t,n,o){var r=o.has("$animateCss")?o.get("$animateCss"):null;return{link:function(o,i,a){var s=n(a.expanding),l=n(a.expanded),c=n(a.collapsing),p=n(a.collapsed),u=!1,d={},f={};function h(e){return u?{width:e.scrollWidth+"px"}:{height:e.scrollHeight+"px"}}function m(){i.removeClass("collapsing").addClass("collapse").css(d),l(o)}function g(){i.css(f),i.removeClass("collapsing").addClass("collapse"),p(o)}!function(){(u=!!("horizontal"in a))?(d={width:""},f={width:"0"}):(d={height:""},f={height:"0"});o.$eval(a.uibCollapse)||i.addClass("in").addClass("collapse").attr("aria-expanded",!0).attr("aria-hidden",!1).css(d)}(),o.$watch(a.uibCollapse,function(n){n?function(){if(!i.hasClass("collapse")&&!i.hasClass("in"))return g();t.resolve(c(o)).then(function(){i.css(h(i[0])).removeClass("collapse").addClass("collapsing").attr("aria-expanded",!1).attr("aria-hidden",!0),r?r(i,{removeClass:"in",to:f}).start().finally(g):e.removeClass(i,"in",{to:f}).then(g)},angular.noop)}():i.hasClass("collapse")&&i.hasClass("in")||t.resolve(s(o)).then(function(){i.removeClass("collapse").addClass("collapsing").attr("aria-expanded",!0).attr("aria-hidden",!1),r?r(i,{addClass:"in",easing:"ease",css:{overflow:"hidden"},to:h(i[0])}).start().finally(m):e.addClass(i,"in",{css:{overflow:"hidden"},to:h(i[0])}).then(m)},angular.noop)})}}}]),angular.module("ui.bootstrap.tabindex",[]).directive("uibTabindexToggle",function(){return{restrict:"A",link:function(e,t,n){n.$observe("disabled",function(e){n.$set("tabindex",e?-1:null)})}}}),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse","ui.bootstrap.tabindex"]).constant("uibAccordionConfig",{closeOthers:!0}).controller("UibAccordionController",["$scope","$attrs","uibAccordionConfig",function(e,t,n){this.groups=[],this.closeOthers=function(o){(angular.isDefined(t.closeOthers)?e.$eval(t.closeOthers):n.closeOthers)&&angular.forEach(this.groups,function(e){e!==o&&(e.isOpen=!1)})},this.addGroup=function(e){var t=this;this.groups.push(e),e.$on("$destroy",function(n){t.removeGroup(e)})},this.removeGroup=function(e){var t=this.groups.indexOf(e);-1!==t&&this.groups.splice(t,1)}}]).directive("uibAccordion",function(){return{controller:"UibAccordionController",controllerAs:"accordion",transclude:!0,templateUrl:function(e,t){return t.templateUrl||"uib/template/accordion/accordion.html"}}}).directive("uibAccordionGroup",function(){return{require:"^uibAccordion",transclude:!0,restrict:"A",templateUrl:function(e,t){return t.templateUrl||"uib/template/accordion/accordion-group.html"},scope:{heading:"@",panelClass:"@?",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(e){this.heading=e}},link:function(e,t,n,o){t.addClass("panel"),o.addGroup(e),e.openClass=n.openClass||"panel-open",e.panelClass=n.panelClass||"panel-default",e.$watch("isOpen",function(n){t.toggleClass(e.openClass,!!n),n&&o.closeOthers(e)}),e.toggleOpen=function(t){e.isDisabled||t&&32!==t.which||(e.isOpen=!e.isOpen)};var r="accordiongroup-"+e.$id+"-"+Math.floor(1e4*Math.random());e.headingId=r+"-tab",e.panelId=r+"-panel"}}}).directive("uibAccordionHeading",function(){return{transclude:!0,template:"",replace:!0,require:"^uibAccordionGroup",link:function(e,t,n,o,r){o.setHeading(r(e,angular.noop))}}}).directive("uibAccordionTransclude",function(){return{require:"^uibAccordionGroup",link:function(e,t,n,o){e.$watch(function(){return o[n.uibAccordionTransclude]},function(e){if(e){var n=angular.element(t[0].querySelector("uib-accordion-header,data-uib-accordion-header,x-uib-accordion-header,uib\\:accordion-header,[uib-accordion-header],[data-uib-accordion-header],[x-uib-accordion-header]"));n.html(""),n.append(e)}})}}}),angular.module("ui.bootstrap.alert",[]).controller("UibAlertController",["$scope","$element","$attrs","$interpolate","$timeout",function(e,t,n,o,r){e.closeable=!!n.close,t.addClass("alert"),n.$set("role","alert"),e.closeable&&t.addClass("alert-dismissible");var i=angular.isDefined(n.dismissOnTimeout)?o(n.dismissOnTimeout)(e.$parent):null;i&&r(function(){e.close()},parseInt(i,10))}]).directive("uibAlert",function(){return{controller:"UibAlertController",controllerAs:"alert",restrict:"A",templateUrl:function(e,t){return t.templateUrl||"uib/template/alert/alert.html"},transclude:!0,scope:{close:"&"}}}),angular.module("ui.bootstrap.buttons",[]).constant("uibButtonConfig",{activeClass:"active",toggleEvent:"click"}).controller("UibButtonsController",["uibButtonConfig",function(e){this.activeClass=e.activeClass||"active",this.toggleEvent=e.toggleEvent||"click"}]).directive("uibBtnRadio",["$parse",function(e){return{require:["uibBtnRadio","ngModel"],controller:"UibButtonsController",controllerAs:"buttons",link:function(t,n,o,r){var i=r[0],a=r[1],s=e(o.uibUncheckable);n.find("input").css({display:"none"}),a.$render=function(){n.toggleClass(i.activeClass,angular.equals(a.$modelValue,t.$eval(o.uibBtnRadio)))},n.on(i.toggleEvent,function(){if(!o.disabled){var e=n.hasClass(i.activeClass);e&&!angular.isDefined(o.uncheckable)||t.$apply(function(){a.$setViewValue(e?null:t.$eval(o.uibBtnRadio)),a.$render()})}}),o.uibUncheckable&&t.$watch(s,function(e){o.$set("uncheckable",e?"":void 0)})}}}]).directive("uibBtnCheckbox",function(){return{require:["uibBtnCheckbox","ngModel"],controller:"UibButtonsController",controllerAs:"button",link:function(e,t,n,o){var r=o[0],i=o[1];function a(){return s(n.btnCheckboxTrue,!0)}function s(t,n){return angular.isDefined(t)?e.$eval(t):n}t.find("input").css({display:"none"}),i.$render=function(){t.toggleClass(r.activeClass,angular.equals(i.$modelValue,a()))},t.on(r.toggleEvent,function(){n.disabled||e.$apply(function(){i.$setViewValue(t.hasClass(r.activeClass)?s(n.btnCheckboxFalse,!1):a()),i.$render()})})}}}),angular.module("ui.bootstrap.carousel",[]).controller("UibCarouselController",["$scope","$element","$interval","$timeout","$animate",function(e,t,n,o,r){var i,a,s=this,l=s.slides=e.slides=[],c="uib-slideDirection",p=e.active,u=!1;function d(e){for(var t=0;t<l.length;t++)l[t].slide.active=t===e}function f(e){for(var t=0;t<l.length;t++)if(l[t].slide===e)return t}function h(){i&&(n.cancel(i),i=null)}function m(){h();var t=+e.interval;!isNaN(t)&&t>0&&(i=n(g,t))}function g(){var t=+e.interval;a&&!isNaN(t)&&t>0&&l.length?e.next():e.pause()}t.addClass("carousel"),s.addSlide=function(t,n){l.push({slide:t,element:n}),l.sort(function(e,t){return+e.slide.index-+t.slide.index}),(t.index===e.active||1===l.length&&!angular.isNumber(e.active))&&(e.$currentTransition&&(e.$currentTransition=null),p=t.index,e.active=t.index,d(p),s.select(l[f(t)]),1===l.length&&e.play())},s.getCurrentIndex=function(){for(var e=0;e<l.length;e++)if(l[e].slide.index===p)return e},s.next=e.next=function(){var t=(s.getCurrentIndex()+1)%l.length;if(0!==t||!e.noWrap())return s.select(l[t],"next");e.pause()},s.prev=e.prev=function(){var t=s.getCurrentIndex()-1<0?l.length-1:s.getCurrentIndex()-1;if(!e.noWrap()||t!==l.length-1)return s.select(l[t],"prev");e.pause()},s.removeSlide=function(t){var n=f(t);l.splice(n,1),l.length>0&&p===n?n>=l.length?(p=l.length-1,e.active=p,d(p),s.select(l[l.length-1])):(p=n,e.active=p,d(p),s.select(l[n])):p>n&&(p--,e.active=p),0===l.length&&(p=null,e.active=null)},s.select=e.select=function(n,o){var i=f(n.slide);void 0===o&&(o=i>s.getCurrentIndex()?"next":"prev"),n.slide.index===p||e.$currentTransition||function(n,o,i){if(u)return;if(angular.extend(n,{direction:i}),angular.extend(l[p].slide||{},{direction:i}),r.enabled(t)&&!e.$currentTransition&&l[o].element&&s.slides.length>1){l[o].element.data(c,n.direction);var a=s.getCurrentIndex();angular.isNumber(a)&&l[a].element&&l[a].element.data(c,n.direction),e.$currentTransition=!0,r.on("addClass",l[o].element,function(t,n){"close"===n&&(e.$currentTransition=null,r.off("addClass",t))})}e.active=n.index,p=n.index,d(o),m()}(n.slide,i,o)},e.indexOfSlide=function(e){return+e.slide.index},e.isActive=function(t){return e.active===t.slide.index},e.isPrevDisabled=function(){return 0===e.active&&e.noWrap()},e.isNextDisabled=function(){return e.active===l.length-1&&e.noWrap()},e.pause=function(){e.noPause||(a=!1,h())},e.play=function(){a||(a=!0,m())},t.on("mouseenter",e.pause),t.on("mouseleave",e.play),e.$on("$destroy",function(){u=!0,h()}),e.$watch("noTransition",function(e){r.enabled(t,!e)}),e.$watch("interval",m),e.$watchCollection("slides",function(t){t.length||(e.$currentTransition=null)}),e.$watch("active",function(e){if(angular.isNumber(e)&&p!==e){for(var t=0;t<l.length;t++)if(l[t].slide.index===e){e=t;break}l[e]&&(d(e),s.select(l[e]),p=e)}})}]).directive("uibCarousel",function(){return{transclude:!0,controller:"UibCarouselController",controllerAs:"carousel",restrict:"A",templateUrl:function(e,t){return t.templateUrl||"uib/template/carousel/carousel.html"},scope:{active:"=",interval:"=",noTransition:"=",noPause:"=",noWrap:"&"}}}).directive("uibSlide",["$animate",function(e){return{require:"^uibCarousel",restrict:"A",transclude:!0,templateUrl:function(e,t){return t.templateUrl||"uib/template/carousel/slide.html"},scope:{actual:"=?",index:"=?"},link:function(t,n,o,r){n.addClass("item"),r.addSlide(t,n),t.$on("$destroy",function(){r.removeSlide(t)}),t.$watch("active",function(t){e[t?"addClass":"removeClass"](n,"active")})}}}]).animation(".item",["$animateCss",function(e){function t(e,t,n){e.removeClass(t),n&&n()}return{beforeAddClass:function(n,o,r){if("active"===o){var i=n.data("uib-slideDirection"),a="next"===i?"left":"right",s=t.bind(this,n,a+" "+i,r);return n.addClass(i),e(n,{addClass:a}).start().done(s),function(){!0}}r()},beforeRemoveClass:function(n,o,r){if("active"===o){var i="next"===n.data("uib-slideDirection")?"left":"right",a=t.bind(this,n,i,r);return e(n,{addClass:i}).start().done(a),function(){!0}}r()}}}]),angular.module("ui.bootstrap.dateparser",[]).service("uibDateParser",["$log","$locale","dateFilter","orderByFilter","filterFilter",function(e,t,n,o,r){var i,a,s=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;function l(e){return r(a,{key:e},!0)[0]}function c(e,t,n){return function(){return e.substr(t+1,n-t-1)}}function p(e,t){for(var n=e.substr(t),o=0;o<a.length;o++)if(new RegExp("^"+a[o].key).test(n)){var r=a[o];return{endIdx:t+r.key.length,parser:r.formatter}}return{endIdx:t+1,parser:function(){return n.charAt(0)}}}function u(e){return parseInt(e,10)}function d(e,t){e=e.replace(/:/g,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function f(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}function h(e,t,n){n=n?-1:1;var o=e.getTimezoneOffset();return f(e,n*(d(t,o)-o))}this.init=function(){i=t.id,this.parsers={},this.formatters={},a=[{key:"yyyy",regex:"\\d{4}",apply:function(e){this.year=+e},formatter:function(e){var t=new Date;return t.setFullYear(Math.abs(e.getFullYear())),n(t,"yyyy")}},{key:"yy",regex:"\\d{2}",apply:function(e){e=+e,this.year=e<69?e+2e3:e+1900},formatter:function(e){var t=new Date;return t.setFullYear(Math.abs(e.getFullYear())),n(t,"yy")}},{key:"y",regex:"\\d{1,4}",apply:function(e){this.year=+e},formatter:function(e){var t=new Date;return t.setFullYear(Math.abs(e.getFullYear())),n(t,"y")}},{key:"M!",regex:"0?[1-9]|1[0-2]",apply:function(e){this.month=e-1},formatter:function(e){var t=e.getMonth();return/^[0-9]$/.test(t)?n(e,"MM"):n(e,"M")}},{key:"MMMM",regex:t.DATETIME_FORMATS.MONTH.join("|"),apply:function(e){this.month=t.DATETIME_FORMATS.MONTH.indexOf(e)},formatter:function(e){return n(e,"MMMM")}},{key:"MMM",regex:t.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(e){this.month=t.DATETIME_FORMATS.SHORTMONTH.indexOf(e)},formatter:function(e){return n(e,"MMM")}},{key:"MM",regex:"0[1-9]|1[0-2]",apply:function(e){this.month=e-1},formatter:function(e){return n(e,"MM")}},{key:"M",regex:"[1-9]|1[0-2]",apply:function(e){this.month=e-1},formatter:function(e){return n(e,"M")}},{key:"d!",regex:"[0-2]?[0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e},formatter:function(e){var t=e.getDate();return/^[1-9]$/.test(t)?n(e,"dd"):n(e,"d")}},{key:"dd",regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e},formatter:function(e){return n(e,"dd")}},{key:"d",regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(e){this.date=+e},formatter:function(e){return n(e,"d")}},{key:"EEEE",regex:t.DATETIME_FORMATS.DAY.join("|"),formatter:function(e){return n(e,"EEEE")}},{key:"EEE",regex:t.DATETIME_FORMATS.SHORTDAY.join("|"),formatter:function(e){return n(e,"EEE")}},{key:"HH",regex:"(?:0|1)[0-9]|2[0-3]",apply:function(e){this.hours=+e},formatter:function(e){return n(e,"HH")}},{key:"hh",regex:"0[0-9]|1[0-2]",apply:function(e){this.hours=+e},formatter:function(e){return n(e,"hh")}},{key:"H",regex:"1?[0-9]|2[0-3]",apply:function(e){this.hours=+e},formatter:function(e){return n(e,"H")}},{key:"h",regex:"[0-9]|1[0-2]",apply:function(e){this.hours=+e},formatter:function(e){return n(e,"h")}},{key:"mm",regex:"[0-5][0-9]",apply:function(e){this.minutes=+e},formatter:function(e){return n(e,"mm")}},{key:"m",regex:"[0-9]|[1-5][0-9]",apply:function(e){this.minutes=+e},formatter:function(e){return n(e,"m")}},{key:"sss",regex:"[0-9][0-9][0-9]",apply:function(e){this.milliseconds=+e},formatter:function(e){return n(e,"sss")}},{key:"ss",regex:"[0-5][0-9]",apply:function(e){this.seconds=+e},formatter:function(e){return n(e,"ss")}},{key:"s",regex:"[0-9]|[1-5][0-9]",apply:function(e){this.seconds=+e},formatter:function(e){return n(e,"s")}},{key:"a",regex:t.DATETIME_FORMATS.AMPMS.join("|"),apply:function(e){12===this.hours&&(this.hours=0),"PM"===e&&(this.hours+=12)},formatter:function(e){return n(e,"a")}},{key:"Z",regex:"[+-]\\d{4}",apply:function(e){var t=e.match(/([+-])(\d{2})(\d{2})/),n=t[1],o=t[2],r=t[3];this.hours+=u(n+o),this.minutes+=u(n+r)},formatter:function(e){return n(e,"Z")}},{key:"ww",regex:"[0-4][0-9]|5[0-3]",formatter:function(e){return n(e,"ww")}},{key:"w",regex:"[0-9]|[1-4][0-9]|5[0-3]",formatter:function(e){return n(e,"w")}},{key:"GGGG",regex:t.DATETIME_FORMATS.ERANAMES.join("|").replace(/\s/g,"\\s"),formatter:function(e){return n(e,"GGGG")}},{key:"GGG",regex:t.DATETIME_FORMATS.ERAS.join("|"),formatter:function(e){return n(e,"GGG")}},{key:"GG",regex:t.DATETIME_FORMATS.ERAS.join("|"),formatter:function(e){return n(e,"GG")}},{key:"G",regex:t.DATETIME_FORMATS.ERAS.join("|"),formatter:function(e){return n(e,"G")}}],angular.version.major>=1&&angular.version.minor>4&&a.push({key:"LLLL",regex:t.DATETIME_FORMATS.STANDALONEMONTH.join("|"),apply:function(e){this.month=t.DATETIME_FORMATS.STANDALONEMONTH.indexOf(e)},formatter:function(e){return n(e,"LLLL")}})},this.init(),this.getParser=function(e){var t=l(e);return t&&t.apply||null},this.overrideParser=function(e,t){var n=l(e);n&&angular.isFunction(t)&&(this.parsers={},n.apply=t)}.bind(this),this.filter=function(e,n){return angular.isDate(e)&&!isNaN(e)&&n?(n=t.DATETIME_FORMATS[n]||n,t.id!==i&&this.init(),this.formatters[n]||(this.formatters[n]=function(e){for(var t,n,o=[],r=0;r<e.length;)if(angular.isNumber(n)){if("'"===e.charAt(r))(r+1>=e.length||"'"!==e.charAt(r+1))&&(o.push(c(e,n,r)),n=null);else if(r===e.length)for(;n<e.length;)t=p(e,n),o.push(t),n=t.endIdx;r++}else"'"!==e.charAt(r)?(t=p(e,r),o.push(t.parser),r=t.endIdx):(n=r,r++);return o}(n)),this.formatters[n].reduce(function(t,n){return t+n(e)},"")):""},this.parse=function(n,r,l){if(!angular.isString(n)||!r)return n;r=(r=t.DATETIME_FORMATS[r]||r).replace(s,"\\$&"),t.id!==i&&this.init(),this.parsers[r]||(this.parsers[r]=function(e){var t=[],n=e.split(""),r=e.indexOf("'");if(r>-1){var i=!1;e=e.split("");for(var s=r;s<e.length;s++)i?("'"===e[s]&&(s+1<e.length&&"'"===e[s+1]?(e[s+1]="$",n[s+1]=""):(n[s]="",i=!1)),e[s]="$"):"'"===e[s]&&(e[s]="$",n[s]="",i=!0);e=e.join("")}return angular.forEach(a,function(o){var r=e.indexOf(o.key);if(r>-1){e=e.split(""),n[r]="("+o.regex+")",e[r]="$";for(var i=r+1,a=r+o.key.length;i<a;i++)n[i]="",e[i]="$";e=e.join(""),t.push({index:r,key:o.key,apply:o.apply,matcher:o.regex})}}),{regex:new RegExp("^"+n.join("")+"$"),map:o(t,"index")}}(r));var c=this.parsers[r],p=c.regex,u=c.map,d=n.match(p),f=!1;if(d&&d.length){var h,m;angular.isDate(l)&&!isNaN(l.getTime())?h={year:l.getFullYear(),month:l.getMonth(),date:l.getDate(),hours:l.getHours(),minutes:l.getMinutes(),seconds:l.getSeconds(),milliseconds:l.getMilliseconds()}:(l&&e.warn("dateparser:","baseDate is not a valid date"),h={year:1900,month:0,date:1,hours:0,minutes:0,seconds:0,milliseconds:0});for(var g=1,v=d.length;g<v;g++){var b=u[g-1];"Z"===b.matcher&&(f=!0),b.apply&&b.apply.call(h,d[g])}var y=f?Date.prototype.setUTCFullYear:Date.prototype.setFullYear,w=f?Date.prototype.setUTCHours:Date.prototype.setHours;return function(e,t,n){if(n<1)return!1;if(1===t&&n>28)return 29===n&&(e%4==0&&e%100!=0||e%400==0);if(3===t||5===t||8===t||10===t)return n<31;return!0}(h.year,h.month,h.date)&&(!angular.isDate(l)||isNaN(l.getTime())||f?(m=new Date(0),y.call(m,h.year,h.month,h.date),w.call(m,h.hours||0,h.minutes||0,h.seconds||0,h.milliseconds||0)):(m=new Date(l),y.call(m,h.year,h.month,h.date),w.call(m,h.hours,h.minutes,h.seconds,h.milliseconds))),m}},this.toTimezone=function(e,t){return e&&t?h(e,t):e},this.fromTimezone=function(e,t){return e&&t?h(e,t,!0):e},this.timezoneToOffset=d,this.addDateMinutes=f,this.convertTimezoneToLocal=h}]),angular.module("ui.bootstrap.isClass",[]).directive("uibIsClass",["$animate",function(e){var t=/^\s*([\s\S]+?)\s+on\s+([\s\S]+?)\s*$/,n=/^\s*([\s\S]+?)\s+for\s+([\s\S]+?)\s*$/;return{restrict:"A",compile:function(o,r){var i=[],a=[],s={},l=r.uibIsClass.match(t),c=l[2],p=l[1].split(",");return function(t,o,r){i.push(t),a.push({scope:t,element:o}),p.forEach(function(o,r){!function(t,o){var r=t.match(n),i=o.$eval(r[1]),l=r[2],p=s[t];if(!p){var u=function(t){var n=null;a.some(function(e){var o=e.scope.$eval(c);if(o===t)return n=e,!0}),p.lastActivated!==n&&(p.lastActivated&&e.removeClass(p.lastActivated.element,i),n&&e.addClass(n.element,i),p.lastActivated=n)};s[t]=p={lastActivated:null,scope:o,watchFn:u,compareWithExp:l,watcher:o.$watch(l,u)}}p.watchFn(o.$eval(l))}(o,t)}),t.$on("$destroy",u)};function u(e){var t=e.targetScope,n=i.indexOf(t);if(i.splice(n,1),a.splice(n,1),i.length){var o=i[0];angular.forEach(s,function(e){e.scope===t&&(e.watcher=o.$watch(e.compareWithExp,e.watchFn),e.scope=o)})}else s={}}}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.isClass"]).value("$datepickerSuppressError",!1).value("$datepickerLiteralWarning",!0).constant("uibDatepickerConfig",{datepickerMode:"day",formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",maxDate:null,maxMode:"year",minDate:null,minMode:"day",monthColumns:3,ngModelOptions:{},shortcutPropagation:!1,showWeeks:!0,yearColumns:5,yearRows:4}).controller("UibDatepickerController",["$scope","$element","$attrs","$parse","$interpolate","$locale","$log","dateFilter","uibDatepickerConfig","$datepickerLiteralWarning","$datepickerSuppressError","uibDateParser",function(e,t,n,o,r,i,a,s,l,c,p,u){var d=this,f={$setViewValue:angular.noop},h={},m=[];t.addClass("uib-datepicker"),n.$set("role","application"),e.datepickerOptions||(e.datepickerOptions={}),this.modes=["day","month","year"],["customClass","dateDisabled","datepickerMode","formatDay","formatDayHeader","formatDayTitle","formatMonth","formatMonthTitle","formatYear","maxDate","maxMode","minDate","minMode","monthColumns","showWeeks","shortcutPropagation","startingDay","yearColumns","yearRows"].forEach(function(t){switch(t){case"customClass":case"dateDisabled":e[t]=e.datepickerOptions[t]||angular.noop;break;case"datepickerMode":e.datepickerMode=angular.isDefined(e.datepickerOptions.datepickerMode)?e.datepickerOptions.datepickerMode:l.datepickerMode;break;case"formatDay":case"formatDayHeader":case"formatDayTitle":case"formatMonth":case"formatMonthTitle":case"formatYear":d[t]=angular.isDefined(e.datepickerOptions[t])?r(e.datepickerOptions[t])(e.$parent):l[t];break;case"monthColumns":case"showWeeks":case"shortcutPropagation":case"yearColumns":case"yearRows":d[t]=angular.isDefined(e.datepickerOptions[t])?e.datepickerOptions[t]:l[t];break;case"startingDay":angular.isDefined(e.datepickerOptions.startingDay)?d.startingDay=e.datepickerOptions.startingDay:angular.isNumber(l.startingDay)?d.startingDay=l.startingDay:d.startingDay=(i.DATETIME_FORMATS.FIRSTDAYOFWEEK+8)%7;break;case"maxDate":case"minDate":e.$watch("datepickerOptions."+t,function(e){e?angular.isDate(e)?d[t]=u.fromTimezone(new Date(e),h.getOption("timezone")):(c&&a.warn("Literal date support has been deprecated, please switch to date object usage"),d[t]=new Date(s(e,"medium"))):d[t]=l[t]?u.fromTimezone(new Date(l[t]),h.getOption("timezone")):null,d.refreshView()});break;case"maxMode":case"minMode":e.datepickerOptions[t]?e.$watch(function(){return e.datepickerOptions[t]},function(n){d[t]=e[t]=angular.isDefined(n)?n:e.datepickerOptions[t],("minMode"===t&&d.modes.indexOf(e.datepickerOptions.datepickerMode)<d.modes.indexOf(d[t])||"maxMode"===t&&d.modes.indexOf(e.datepickerOptions.datepickerMode)>d.modes.indexOf(d[t]))&&(e.datepickerMode=d[t],e.datepickerOptions.datepickerMode=d[t])}):d[t]=e[t]=l[t]||null}}),e.uniqueId="datepicker-"+e.$id+"-"+Math.floor(1e4*Math.random()),e.disabled=angular.isDefined(n.disabled)||!1,angular.isDefined(n.ngDisabled)&&m.push(e.$parent.$watch(n.ngDisabled,function(t){e.disabled=t,d.refreshView()})),e.isActive=function(t){return 0===d.compare(t.date,d.activeDate)&&(e.activeDateId=t.uid,!0)},this.init=function(t){h=function(t){var n;if(angular.version.minor<6)(n=t.$options||e.datepickerOptions.ngModelOptions||l.ngModelOptions||{}).getOption=function(e){return n[e]};else{var o=t.$options.getOption("timezone")||(e.datepickerOptions.ngModelOptions?e.datepickerOptions.ngModelOptions.timezone:null)||(l.ngModelOptions?l.ngModelOptions.timezone:null);n=t.$options.createChild(l.ngModelOptions).createChild(e.datepickerOptions.ngModelOptions).createChild(t.$options).createChild({timezone:o})}return n}(f=t),e.datepickerOptions.initDate?(d.activeDate=u.fromTimezone(e.datepickerOptions.initDate,h.getOption("timezone"))||new Date,e.$watch("datepickerOptions.initDate",function(e){e&&(f.$isEmpty(f.$modelValue)||f.$invalid)&&(d.activeDate=u.fromTimezone(e,h.getOption("timezone")),d.refreshView())})):d.activeDate=new Date;var n=f.$modelValue?new Date(f.$modelValue):new Date;this.activeDate=isNaN(n)?u.fromTimezone(new Date,h.getOption("timezone")):u.fromTimezone(n,h.getOption("timezone")),f.$render=function(){d.render()}},this.render=function(){if(f.$viewValue){var e=new Date(f.$viewValue);!isNaN(e)?this.activeDate=u.fromTimezone(e,h.getOption("timezone")):p||a.error('Datepicker directive: "ng-model" value must be a Date object')}this.refreshView()},this.refreshView=function(){if(this.element){e.selectedDt=null,this._refreshView(),e.activeDt&&(e.activeDateId=e.activeDt.uid);var t=f.$viewValue?new Date(f.$viewValue):null;t=u.fromTimezone(t,h.getOption("timezone")),f.$setValidity("dateDisabled",!t||this.element&&!this.isDisabled(t))}},this.createDateObject=function(t,n){var o=f.$viewValue?new Date(f.$viewValue):null;o=u.fromTimezone(o,h.getOption("timezone"));var r=new Date;r=u.fromTimezone(r,h.getOption("timezone"));var i=this.compare(t,r),a={date:t,label:u.filter(t,n),selected:o&&0===this.compare(t,o),disabled:this.isDisabled(t),past:i<0,current:0===i,future:i>0,customClass:this.customClass(t)||null};return o&&0===this.compare(t,o)&&(e.selectedDt=a),d.activeDate&&0===this.compare(a.date,d.activeDate)&&(e.activeDt=a),a},this.isDisabled=function(t){return e.disabled||this.minDate&&this.compare(t,this.minDate)<0||this.maxDate&&this.compare(t,this.maxDate)>0||e.dateDisabled&&e.dateDisabled({date:t,mode:e.datepickerMode})},this.customClass=function(t){return e.customClass({date:t,mode:e.datepickerMode})},this.split=function(e,t){for(var n=[];e.length>0;)n.push(e.splice(0,t));return n},e.select=function(t){if(e.datepickerMode===d.minMode){var n=f.$viewValue?u.fromTimezone(new Date(f.$viewValue),h.getOption("timezone")):new Date(0,0,0,0,0,0,0);n.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),n=u.toTimezone(n,h.getOption("timezone")),f.$setViewValue(n),f.$render()}else d.activeDate=t,g(d.modes[d.modes.indexOf(e.datepickerMode)-1]),e.$emit("uib:datepicker.mode");e.$broadcast("uib:datepicker.focus")},e.move=function(e){var t=d.activeDate.getFullYear()+e*(d.step.years||0),n=d.activeDate.getMonth()+e*(d.step.months||0);d.activeDate.setFullYear(t,n,1),d.refreshView()},e.toggleMode=function(t){t=t||1,e.datepickerMode===d.maxMode&&1===t||e.datepickerMode===d.minMode&&-1===t||(g(d.modes[d.modes.indexOf(e.datepickerMode)+t]),e.$emit("uib:datepicker.mode"))},e.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};function g(t){e.datepickerMode=t,e.datepickerOptions.datepickerMode=t}e.$on("uib:datepicker.focus",function(){d.element[0].focus()}),e.keydown=function(t){var n=e.keys[t.which];if(n&&!t.shiftKey&&!t.altKey&&!e.disabled)if(t.preventDefault(),d.shortcutPropagation||t.stopPropagation(),"enter"===n||"space"===n){if(d.isDisabled(d.activeDate))return;e.select(d.activeDate)}else!t.ctrlKey||"up"!==n&&"down"!==n?(d.handleKeyDown(n,t),d.refreshView()):e.toggleMode("up"===n?1:-1)},t.on("keydown",function(t){e.$apply(function(){e.keydown(t)})}),e.$on("$destroy",function(){for(;m.length;)m.shift()()})}]).controller("UibDaypickerController",["$scope","$element","dateFilter",function(e,t,n){var o=[31,28,31,30,31,30,31,31,30,31,30,31];function r(e,t){return 1!==t||e%4!=0||e%100==0&&e%400!=0?o[t]:29}function i(e){var t=new Date(e);t.setDate(t.getDate()+4-(t.getDay()||7));var n=t.getTime();return t.setMonth(0),t.setDate(1),Math.floor(Math.round((n-t)/864e5)/7)+1}this.step={months:1},this.element=t,this.init=function(t){angular.extend(t,this),e.showWeeks=t.showWeeks,t.refreshView()},this.getDates=function(e,t){for(var n,o=new Array(t),r=new Date(e),i=0;i<t;)n=new Date(r),o[i++]=n,r.setDate(r.getDate()+1);return o},this._refreshView=function(){var t=this.activeDate.getFullYear(),o=this.activeDate.getMonth(),r=new Date(this.activeDate);r.setFullYear(t,o,1);var a=this.startingDay-r.getDay(),s=a>0?7-a:-a,l=new Date(r);s>0&&l.setDate(1-s);for(var c=this.getDates(l,42),p=0;p<42;p++)c[p]=angular.extend(this.createDateObject(c[p],this.formatDay),{secondary:c[p].getMonth()!==o,uid:e.uniqueId+"-"+p});e.labels=new Array(7);for(var u=0;u<7;u++)e.labels[u]={abbr:n(c[u].date,this.formatDayHeader),full:n(c[u].date,"EEEE")};if(e.title=n(this.activeDate,this.formatDayTitle),e.rows=this.split(c,7),e.showWeeks){e.weekNumbers=[];for(var d=(11-this.startingDay)%7,f=e.rows.length,h=0;h<f;h++)e.weekNumbers.push(i(e.rows[h][d].date))}},this.compare=function(e,t){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),o=new Date(t.getFullYear(),t.getMonth(),t.getDate());return n.setFullYear(e.getFullYear()),o.setFullYear(t.getFullYear()),n-o},this.handleKeyDown=function(e,t){var n=this.activeDate.getDate();if("left"===e)n-=1;else if("up"===e)n-=7;else if("right"===e)n+=1;else if("down"===e)n+=7;else if("pageup"===e||"pagedown"===e){var o=this.activeDate.getMonth()+("pageup"===e?-1:1);this.activeDate.setMonth(o,1),n=Math.min(r(this.activeDate.getFullYear(),this.activeDate.getMonth()),n)}else"home"===e?n=1:"end"===e&&(n=r(this.activeDate.getFullYear(),this.activeDate.getMonth()));this.activeDate.setDate(n)}}]).controller("UibMonthpickerController",["$scope","$element","dateFilter",function(e,t,n){this.step={years:1},this.element=t,this.init=function(e){angular.extend(e,this),e.refreshView()},this._refreshView=function(){for(var t,o=new Array(12),r=this.activeDate.getFullYear(),i=0;i<12;i++)(t=new Date(this.activeDate)).setFullYear(r,i,1),o[i]=angular.extend(this.createDateObject(t,this.formatMonth),{uid:e.uniqueId+"-"+i});e.title=n(this.activeDate,this.formatMonthTitle),e.rows=this.split(o,this.monthColumns),e.yearHeaderColspan=this.monthColumns>3?this.monthColumns-2:1},this.compare=function(e,t){var n=new Date(e.getFullYear(),e.getMonth()),o=new Date(t.getFullYear(),t.getMonth());return n.setFullYear(e.getFullYear()),o.setFullYear(t.getFullYear()),n-o},this.handleKeyDown=function(e,t){var n=this.activeDate.getMonth();if("left"===e)n-=1;else if("up"===e)n-=this.monthColumns;else if("right"===e)n+=1;else if("down"===e)n+=this.monthColumns;else if("pageup"===e||"pagedown"===e){var o=this.activeDate.getFullYear()+("pageup"===e?-1:1);this.activeDate.setFullYear(o)}else"home"===e?n=0:"end"===e&&(n=11);this.activeDate.setMonth(n)}}]).controller("UibYearpickerController",["$scope","$element","dateFilter",function(e,t,n){var o,r;function i(e){return parseInt((e-1)/r,10)*r+1}this.element=t,this.yearpickerInit=function(){o=this.yearColumns,r=this.yearRows*o,this.step={years:r}},this._refreshView=function(){for(var t,n=new Array(r),a=0,s=i(this.activeDate.getFullYear());a<r;a++)(t=new Date(this.activeDate)).setFullYear(s+a,0,1),n[a]=angular.extend(this.createDateObject(t,this.formatYear),{uid:e.uniqueId+"-"+a});e.title=[n[0].label,n[r-1].label].join(" - "),e.rows=this.split(n,o),e.columns=o},this.compare=function(e,t){return e.getFullYear()-t.getFullYear()},this.handleKeyDown=function(e,t){var n=this.activeDate.getFullYear();"left"===e?n-=1:"up"===e?n-=o:"right"===e?n+=1:"down"===e?n+=o:"pageup"===e||"pagedown"===e?n+=("pageup"===e?-1:1)*r:"home"===e?n=i(this.activeDate.getFullYear()):"end"===e&&(n=i(this.activeDate.getFullYear())+r-1),this.activeDate.setFullYear(n)}}]).directive("uibDatepicker",function(){return{templateUrl:function(e,t){return t.templateUrl||"uib/template/datepicker/datepicker.html"},scope:{datepickerOptions:"=?"},require:["uibDatepicker","^ngModel"],restrict:"A",controller:"UibDatepickerController",controllerAs:"datepicker",link:function(e,t,n,o){var r=o[0],i=o[1];r.init(i)}}}).directive("uibDaypicker",function(){return{templateUrl:function(e,t){return t.templateUrl||"uib/template/datepicker/day.html"},require:["^uibDatepicker","uibDaypicker"],restrict:"A",controller:"UibDaypickerController",link:function(e,t,n,o){var r=o[0];o[1].init(r)}}}).directive("uibMonthpicker",function(){return{templateUrl:function(e,t){return t.templateUrl||"uib/template/datepicker/month.html"},require:["^uibDatepicker","uibMonthpicker"],restrict:"A",controller:"UibMonthpickerController",link:function(e,t,n,o){var r=o[0];o[1].init(r)}}}).directive("uibYearpicker",function(){return{templateUrl:function(e,t){return t.templateUrl||"uib/template/datepicker/year.html"},require:["^uibDatepicker","uibYearpicker"],restrict:"A",controller:"UibYearpickerController",link:function(e,t,n,o){var r=o[0];angular.extend(r,o[1]),r.yearpickerInit(),r.refreshView()}}}),angular.module("ui.bootstrap.position",[]).factory("$uibPosition",["$document","$window",function(e,t){var n,o,r={normal:/(auto|scroll)/,hidden:/(auto|scroll|hidden)/},i={auto:/\s?auto?\s?/i,primary:/^(top|bottom|left|right)$/,secondary:/^(top|bottom|left|right|center)$/,vertical:/^(top|bottom)$/},a=/(HTML|BODY)/;return{getRawNode:function(e){return e.nodeName?e:e[0]||e},parseStyle:function(e){return e=parseFloat(e),isFinite(e)?e:0},offsetParent:function(n){var o,r=(n=this.getRawNode(n)).offsetParent||e[0].documentElement;for(;r&&r!==e[0].documentElement&&(o=r,"static"===(t.getComputedStyle(o).position||"static"));)r=r.offsetParent;return r||e[0].documentElement},scrollbarWidth:function(r){if(r){if(angular.isUndefined(o)){var i=e.find("body");i.addClass("uib-position-body-scrollbar-measure"),o=t.innerWidth-i[0].clientWidth,o=isFinite(o)?o:0,i.removeClass("uib-position-body-scrollbar-measure")}return o}if(angular.isUndefined(n)){var a=angular.element('<div class="uib-position-scrollbar-measure"></div>');e.find("body").append(a),n=a[0].offsetWidth-a[0].clientWidth,n=isFinite(n)?n:0,a.remove()}return n},scrollbarPadding:function(e){e=this.getRawNode(e);var n=t.getComputedStyle(e),o=this.parseStyle(n.paddingRight),r=this.parseStyle(n.paddingBottom),i=this.scrollParent(e,!1,!0),s=this.scrollbarWidth(a.test(i.tagName));return{scrollbarWidth:s,widthOverflow:i.scrollWidth>i.clientWidth,right:o+s,originalRight:o,heightOverflow:i.scrollHeight>i.clientHeight,bottom:r+s,originalBottom:r}},isScrollable:function(e,n){e=this.getRawNode(e);var o=n?r.hidden:r.normal,i=t.getComputedStyle(e);return o.test(i.overflow+i.overflowY+i.overflowX)},scrollParent:function(n,o,i){n=this.getRawNode(n);var a=o?r.hidden:r.normal,s=e[0].documentElement,l=t.getComputedStyle(n);if(i&&a.test(l.overflow+l.overflowY+l.overflowX))return n;var c="absolute"===l.position,p=n.parentElement||s;if(p===s||"fixed"===l.position)return s;for(;p.parentElement&&p!==s;){var u=t.getComputedStyle(p);if(c&&"static"!==u.position&&(c=!1),!c&&a.test(u.overflow+u.overflowY+u.overflowX))break;p=p.parentElement}return p},position:function(n,o){n=this.getRawNode(n);var r=this.offset(n);if(o){var i=t.getComputedStyle(n);r.top-=this.parseStyle(i.marginTop),r.left-=this.parseStyle(i.marginLeft)}var a=this.offsetParent(n),s={top:0,left:0};return a!==e[0].documentElement&&((s=this.offset(a)).top+=a.clientTop-a.scrollTop,s.left+=a.clientLeft-a.scrollLeft),{width:Math.round(angular.isNumber(r.width)?r.width:n.offsetWidth),height:Math.round(angular.isNumber(r.height)?r.height:n.offsetHeight),top:Math.round(r.top-s.top),left:Math.round(r.left-s.left)}},offset:function(n){var o=(n=this.getRawNode(n)).getBoundingClientRect();return{width:Math.round(angular.isNumber(o.width)?o.width:n.offsetWidth),height:Math.round(angular.isNumber(o.height)?o.height:n.offsetHeight),top:Math.round(o.top+(t.pageYOffset||e[0].documentElement.scrollTop)),left:Math.round(o.left+(t.pageXOffset||e[0].documentElement.scrollLeft))}},viewportOffset:function(n,o,r){r=!1!==r;var i=(n=this.getRawNode(n)).getBoundingClientRect(),a={top:0,left:0,bottom:0,right:0},s=o?e[0].documentElement:this.scrollParent(n),l=s.getBoundingClientRect();if(a.top=l.top+s.clientTop,a.left=l.left+s.clientLeft,s===e[0].documentElement&&(a.top+=t.pageYOffset,a.left+=t.pageXOffset),a.bottom=a.top+s.clientHeight,a.right=a.left+s.clientWidth,r){var c=t.getComputedStyle(s);a.top+=this.parseStyle(c.paddingTop),a.bottom-=this.parseStyle(c.paddingBottom),a.left+=this.parseStyle(c.paddingLeft),a.right-=this.parseStyle(c.paddingRight)}return{top:Math.round(i.top-a.top),bottom:Math.round(a.bottom-i.bottom),left:Math.round(i.left-a.left),right:Math.round(a.right-i.right)}},parsePlacement:function(e){var t=i.auto.test(e);return t&&(e=e.replace(i.auto,"")),(e=e.split("-"))[0]=e[0]||"top",i.primary.test(e[0])||(e[0]="top"),e[1]=e[1]||"center",i.secondary.test(e[1])||(e[1]="center"),e[2]=!!t,e},positionElements:function(e,n,o,r){e=this.getRawNode(e),n=this.getRawNode(n);var a=angular.isDefined(n.offsetWidth)?n.offsetWidth:n.prop("offsetWidth"),s=angular.isDefined(n.offsetHeight)?n.offsetHeight:n.prop("offsetHeight");o=this.parsePlacement(o);var l=r?this.offset(e):this.position(e),c={top:0,left:0,placement:""};if(o[2]){var p=this.viewportOffset(e,r),u=t.getComputedStyle(n),d={width:a+Math.round(Math.abs(this.parseStyle(u.marginLeft)+this.parseStyle(u.marginRight))),height:s+Math.round(Math.abs(this.parseStyle(u.marginTop)+this.parseStyle(u.marginBottom)))};if(o[0]="top"===o[0]&&d.height>p.top&&d.height<=p.bottom?"bottom":"bottom"===o[0]&&d.height>p.bottom&&d.height<=p.top?"top":"left"===o[0]&&d.width>p.left&&d.width<=p.right?"right":"right"===o[0]&&d.width>p.right&&d.width<=p.left?"left":o[0],o[1]="top"===o[1]&&d.height-l.height>p.bottom&&d.height-l.height<=p.top?"bottom":"bottom"===o[1]&&d.height-l.height>p.top&&d.height-l.height<=p.bottom?"top":"left"===o[1]&&d.width-l.width>p.right&&d.width-l.width<=p.left?"right":"right"===o[1]&&d.width-l.width>p.left&&d.width-l.width<=p.right?"left":o[1],"center"===o[1])if(i.vertical.test(o[0])){var f=l.width/2-a/2;p.left+f<0&&d.width-l.width<=p.right?o[1]="left":p.right+f<0&&d.width-l.width<=p.left&&(o[1]="right")}else{var h=l.height/2-d.height/2;p.top+h<0&&d.height-l.height<=p.bottom?o[1]="top":p.bottom+h<0&&d.height-l.height<=p.top&&(o[1]="bottom")}}switch(o[0]){case"top":c.top=l.top-s;break;case"bottom":c.top=l.top+l.height;break;case"left":c.left=l.left-a;break;case"right":c.left=l.left+l.width}switch(o[1]){case"top":c.top=l.top;break;case"bottom":c.top=l.top+l.height-s;break;case"left":c.left=l.left;break;case"right":c.left=l.left+l.width-a;break;case"center":i.vertical.test(o[0])?c.left=l.left+l.width/2-a/2:c.top=l.top+l.height/2-s/2}return c.top=Math.round(c.top),c.left=Math.round(c.left),c.placement="center"===o[1]?o[0]:o[0]+"-"+o[1],c},adjustTop:function(e,t,n,o){if(-1!==e.indexOf("top")&&n!==o)return{top:t.top-o+"px"}},positionArrow:function(e,n){var o=(e=this.getRawNode(e)).querySelector(".tooltip-inner, .popover-inner");if(o){var r=angular.element(o).hasClass("tooltip-inner"),a=r?e.querySelector(".tooltip-arrow"):e.querySelector(".arrow");if(a){var s={top:"",bottom:"",left:"",right:""};if("center"!==(n=this.parsePlacement(n))[1]){var l="border-"+n[0]+"-width",c=t.getComputedStyle(a)[l],p="border-";i.vertical.test(n[0])?p+=n[0]+"-"+n[1]:p+=n[1]+"-"+n[0],p+="-radius";var u=t.getComputedStyle(r?o:e)[p];switch(n[0]){case"top":s.bottom=r?"0":"-"+c;break;case"bottom":s.top=r?"0":"-"+c;break;case"left":s.right=r?"0":"-"+c;break;case"right":s.left=r?"0":"-"+c}s[n[1]]=u,angular.element(a).css(s)}else angular.element(a).css(s)}}}}}]),angular.module("ui.bootstrap.datepickerPopup",["ui.bootstrap.datepicker","ui.bootstrap.position"]).value("$datepickerPopupLiteralWarning",!0).constant("uibDatepickerPopupConfig",{altInputFormats:[],appendToBody:!1,clearText:"Clear",closeOnDateSelection:!0,closeText:"Done",currentText:"Today",datepickerPopup:"yyyy-MM-dd",datepickerPopupTemplateUrl:"uib/template/datepickerPopup/popup.html",datepickerTemplateUrl:"uib/template/datepicker/datepicker.html",html5Types:{date:"yyyy-MM-dd","datetime-local":"yyyy-MM-ddTHH:mm:ss.sss",month:"yyyy-MM"},onOpenFocus:!0,showButtonBar:!0,placement:"auto bottom-left"}).controller("UibDatepickerPopupController",["$scope","$element","$attrs","$compile","$log","$parse","$window","$document","$rootScope","$uibPosition","dateFilter","uibDateParser","uibDatepickerPopupConfig","$timeout","uibDatepickerConfig","$datepickerPopupLiteralWarning",function(e,t,n,o,r,i,a,s,l,c,p,u,d,f,h,m){var g,v,b,y,w,x,$,C,_,k,S,T,I,E=!1,N=[];function O(t){var n=u.parse(t,g,e.date);if(isNaN(n))for(var o=0;o<I.length;o++)if(n=u.parse(t,I[o],e.date),!isNaN(n))return n;return n}function D(e){if(angular.isNumber(e)&&(e=new Date(e)),!e)return null;if(angular.isDate(e)&&!isNaN(e))return e;if(angular.isString(e)){var t=O(e);if(!isNaN(t))return u.toTimezone(t,S.getOption("timezone"))}return S.getOption("allowInvalid")?e:void 0}function P(e,t){var o=e||t;return!n.ngRequired&&!o||(angular.isNumber(o)&&(o=new Date(o)),!o||(!(!angular.isDate(o)||isNaN(o))||!!angular.isString(o)&&!isNaN(O(o))))}function A(n){if(e.isOpen||!e.disabled){var o=T[0],r=t[0].contains(n.target),i=void 0!==o.contains&&o.contains(n.target);!e.isOpen||r||i||e.$apply(function(){e.isOpen=!1})}}function M(n){27===n.which&&e.isOpen?(n.preventDefault(),n.stopPropagation(),e.$apply(function(){e.isOpen=!1}),t[0].focus()):40!==n.which||e.isOpen||(n.preventDefault(),n.stopPropagation(),e.$apply(function(){e.isOpen=!0}))}function U(){if(e.isOpen){var o=angular.element(T[0].querySelector(".uib-datepicker-popup")),r=n.popupPlacement?n.popupPlacement:d.placement,i=c.positionElements(t,o,r,b);o.css({top:i.top+"px",left:i.left+"px"}),o.hasClass("uib-position-measure")&&o.removeClass("uib-position-measure")}}this.init=function(r){if(S=function(e){var t;angular.version.minor<6?(t=angular.isObject(e.$options)?e.$options:{timezone:null}).getOption=function(e){return t[e]}:t=e.$options;return t}(k=r),v=angular.isDefined(n.closeOnDateSelection)?e.$parent.$eval(n.closeOnDateSelection):d.closeOnDateSelection,b=angular.isDefined(n.datepickerAppendToBody)?e.$parent.$eval(n.datepickerAppendToBody):d.appendToBody,y=angular.isDefined(n.onOpenFocus)?e.$parent.$eval(n.onOpenFocus):d.onOpenFocus,w=angular.isDefined(n.datepickerPopupTemplateUrl)?n.datepickerPopupTemplateUrl:d.datepickerPopupTemplateUrl,x=angular.isDefined(n.datepickerTemplateUrl)?n.datepickerTemplateUrl:d.datepickerTemplateUrl,I=angular.isDefined(n.altInputFormats)?e.$parent.$eval(n.altInputFormats):d.altInputFormats,e.showButtonBar=angular.isDefined(n.showButtonBar)?e.$parent.$eval(n.showButtonBar):d.showButtonBar,d.html5Types[n.type]?(g=d.html5Types[n.type],E=!0):(g=n.uibDatepickerPopup||d.datepickerPopup,n.$observe("uibDatepickerPopup",function(e,t){var n=e||d.datepickerPopup;if(n!==g&&(g=n,k.$modelValue=null,!g))throw new Error("uibDatepickerPopup must have a date format specified.")})),!g)throw new Error("uibDatepickerPopup must have a date format specified.");if(E&&n.uibDatepickerPopup)throw new Error("HTML5 date input types do not support custom formats.");($=angular.element("<div uib-datepicker-popup-wrap><div uib-datepicker></div></div>")).attr({"ng-model":"date","ng-change":"dateSelection(date)","template-url":w}),(C=angular.element($.children()[0])).attr("template-url",x),e.datepickerOptions||(e.datepickerOptions={}),E&&"month"===n.type&&(e.datepickerOptions.datepickerMode="month",e.datepickerOptions.minMode="month"),C.attr("datepicker-options","datepickerOptions"),E?k.$formatters.push(function(t){return e.date=u.fromTimezone(t,S.getOption("timezone")),t}):(k.$$parserName="date",k.$validators.date=P,k.$parsers.unshift(D),k.$formatters.push(function(t){return k.$isEmpty(t)?(e.date=t,t):(angular.isNumber(t)&&(t=new Date(t)),e.date=u.fromTimezone(t,S.getOption("timezone")),u.filter(e.date,g))})),k.$viewChangeListeners.push(function(){e.date=O(k.$viewValue)}),t.on("keydown",M),T=o($)(e),$.remove(),b?s.find("body").append(T):t.after(T),e.$on("$destroy",function(){for(!0===e.isOpen&&(l.$$phase||e.$apply(function(){e.isOpen=!1})),T.remove(),t.off("keydown",M),s.off("click",A),_&&_.off("scroll",U),angular.element(a).off("resize",U);N.length;)N.shift()()})},e.getText=function(t){return e[t+"Text"]||d[t+"Text"]},e.isDisabled=function(t){"today"===t&&(t=u.fromTimezone(new Date,S.getOption("timezone")));var n={};return angular.forEach(["minDate","maxDate"],function(t){e.datepickerOptions[t]?angular.isDate(e.datepickerOptions[t])?n[t]=new Date(e.datepickerOptions[t]):(m&&r.warn("Literal date support has been deprecated, please switch to date object usage"),n[t]=new Date(p(e.datepickerOptions[t],"medium"))):n[t]=null}),e.datepickerOptions&&n.minDate&&e.compare(t,n.minDate)<0||n.maxDate&&e.compare(t,n.maxDate)>0},e.compare=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate())-new Date(t.getFullYear(),t.getMonth(),t.getDate())},e.dateSelection=function(n){e.date=n;var o=e.date?u.filter(e.date,g):null;t.val(o),k.$setViewValue(o),v&&(e.isOpen=!1,t[0].focus())},e.keydown=function(n){27===n.which&&(n.stopPropagation(),e.isOpen=!1,t[0].focus())},e.select=function(t,n){if(n.stopPropagation(),"today"===t){var o=new Date;angular.isDate(e.date)?(t=new Date(e.date)).setFullYear(o.getFullYear(),o.getMonth(),o.getDate()):(t=u.fromTimezone(o,S.getOption("timezone"))).setHours(0,0,0,0)}e.dateSelection(t)},e.close=function(n){n.stopPropagation(),e.isOpen=!1,t[0].focus()},e.disabled=angular.isDefined(n.disabled)||!1,n.ngDisabled&&N.push(e.$parent.$watch(i(n.ngDisabled),function(t){e.disabled=t})),e.$watch("isOpen",function(o){o?e.disabled?e.isOpen=!1:f(function(){U(),y&&e.$broadcast("uib:datepicker.focus"),s.on("click",A);var o=n.popupPlacement?n.popupPlacement:d.placement;b||c.parsePlacement(o)[2]?(_=_||angular.element(c.scrollParent(t)))&&_.on("scroll",U):_=null,angular.element(a).on("resize",U)},0,!1):(s.off("click",A),_&&_.off("scroll",U),angular.element(a).off("resize",U))}),e.$on("uib:datepicker.mode",function(){f(U,0,!1)})}]).directive("uibDatepickerPopup",function(){return{require:["ngModel","uibDatepickerPopup"],controller:"UibDatepickerPopupController",scope:{datepickerOptions:"=?",isOpen:"=?",currentText:"@",clearText:"@",closeText:"@"},link:function(e,t,n,o){var r=o[0];o[1].init(r)}}}).directive("uibDatepickerPopupWrap",function(){return{restrict:"A",transclude:!0,templateUrl:function(e,t){return t.templateUrl||"uib/template/datepickerPopup/popup.html"}}}),angular.module("ui.bootstrap.debounce",[]).factory("$$debounce",["$timeout",function(e){return function(t,n){var o;return function(){var r=this,i=Array.prototype.slice.call(arguments);o&&e.cancel(o),o=e(function(){t.apply(r,i)},n)}}}]),angular.module("ui.bootstrap.multiMap",[]).factory("$$multiMap",function(){return{createNew:function(){var e={};return{entries:function(){return Object.keys(e).map(function(t){return{key:t,value:e[t]}})},get:function(t){return e[t]},hasKey:function(t){return!!e[t]},keys:function(){return Object.keys(e)},put:function(t,n){e[t]||(e[t]=[]),e[t].push(n)},remove:function(t,n){var o=e[t];if(o){var r=o.indexOf(n);-1!==r&&o.splice(r,1),o.length||delete e[t]}}}}}}),angular.module("ui.bootstrap.dropdown",["ui.bootstrap.multiMap","ui.bootstrap.position"]).constant("uibDropdownConfig",{appendToOpenClass:"uib-dropdown-open",openClass:"open"}).service("uibDropdownService",["$document","$rootScope","$$multiMap",function(e,t,n){var o=null,r=n.createNew();this.isOnlyOpen=function(e,t){var n=r.get(t);if(n&&n.reduce(function(t,n){return n.scope===e?n:t},{}))return 1===n.length;return!1},this.open=function(t,n,a){if(o||e.on("click",i),o&&o!==t&&(o.isOpen=!1),o=t,a){var s=r.get(a);if(s)-1===s.map(function(e){return e.scope}).indexOf(t)&&r.put(a,{scope:t});else r.put(a,{scope:t})}},this.close=function(t,n,a){if(o===t&&(e.off("click",i),e.off("keydown",this.keybindFilter),o=null),a){var s=r.get(a);if(s){var l=s.reduce(function(e,n){return n.scope===t?n:e},{});l&&r.remove(a,l)}}};var i=function(e){if(o&&o.isOpen&&!(e&&"disabled"===o.getAutoClose()||e&&3===e.which)){var n=o.getToggleElement();if(!(e&&n&&n[0].contains(e.target))){var r=o.getDropdownElement();e&&"outsideClick"===o.getAutoClose()&&r&&r[0].contains(e.target)||(o.focusToggleElement(),o.isOpen=!1,t.$$phase||o.$apply())}}};this.keybindFilter=function(e){if(o){var t=o.getDropdownElement(),n=o.getToggleElement(),r=t&&t[0].contains(e.target),a=n&&n[0].contains(e.target);27===e.which?(e.stopPropagation(),o.focusToggleElement(),i()):o.isKeynavEnabled()&&-1!==[38,40].indexOf(e.which)&&o.isOpen&&(r||a)&&(e.preventDefault(),e.stopPropagation(),o.focusDropdownEntry(e.which))}}}]).controller("UibDropdownController",["$scope","$element","$attrs","$parse","uibDropdownConfig","uibDropdownService","$animate","$uibPosition","$document","$compile","$templateRequest",function(e,t,n,o,r,i,a,s,l,c,p){var u,d,f=this,h=e.$new(),m=r.appendToOpenClass,g=r.openClass,v=angular.noop,b=n.onToggle?o(n.onToggle):angular.noop,y=!1,w=l.find("body");function x(){t.append(f.dropdownMenu)}t.addClass("dropdown"),this.init=function(){n.isOpen&&(d=o(n.isOpen),v=d.assign,e.$watch(d,function(e){h.isOpen=!!e})),y=angular.isDefined(n.keyboardNav)},this.toggle=function(e){return h.isOpen=arguments.length?!!e:!h.isOpen,angular.isFunction(v)&&v(h,h.isOpen),h.isOpen},this.isOpen=function(){return h.isOpen},h.getToggleElement=function(){return f.toggleElement},h.getAutoClose=function(){return n.autoClose||"always"},h.getElement=function(){return t},h.isKeynavEnabled=function(){return y},h.focusDropdownEntry=function(e){var n=f.dropdownMenu?angular.element(f.dropdownMenu).find("a"):t.find("ul").eq(0).find("a");switch(e){case 40:angular.isNumber(f.selectedOption)?f.selectedOption=f.selectedOption===n.length-1?f.selectedOption:f.selectedOption+1:f.selectedOption=0;break;case 38:angular.isNumber(f.selectedOption)?f.selectedOption=0===f.selectedOption?0:f.selectedOption-1:f.selectedOption=n.length-1}n[f.selectedOption].focus()},h.getDropdownElement=function(){return f.dropdownMenu},h.focusToggleElement=function(){f.toggleElement&&f.toggleElement[0].focus()},h.$watch("isOpen",function(r,d){var y=null,$=!1;if(angular.isDefined(n.dropdownAppendTo)){var C=o(n.dropdownAppendTo)(h);C&&(y=angular.element(C))}angular.isDefined(n.dropdownAppendToBody)&&(!1!==o(n.dropdownAppendToBody)(h)&&($=!0));if($&&!y&&(y=w),y&&f.dropdownMenu&&(r?(y.append(f.dropdownMenu),t.on("$destroy",x)):(t.off("$destroy",x),x())),y&&f.dropdownMenu){var _,k,S,T=s.positionElements(t,f.dropdownMenu,"bottom-left",!0),I=0;if(_={top:T.top+"px",display:r?"block":"none"},(k=f.dropdownMenu.hasClass("dropdown-menu-right"))?(_.left="auto",(S=s.scrollbarPadding(y)).heightOverflow&&S.scrollbarWidth&&(I=S.scrollbarWidth),_.right=window.innerWidth-I-(T.left+t.prop("offsetWidth"))+"px"):(_.left=T.left+"px",_.right="auto"),!$){var E=s.offset(y);_.top=T.top-E.top+"px",k?_.right=window.innerWidth-(T.left-E.left+t.prop("offsetWidth"))+"px":_.left=T.left-E.left+"px"}f.dropdownMenu.css(_)}var N=y||t,O=y?m:g,D=N.hasClass(O),P=i.isOnlyOpen(e,y);D===!r&&a[y?P?"removeClass":"addClass":r?"addClass":"removeClass"](N,O).then(function(){angular.isDefined(r)&&r!==d&&b(e,{open:!!r})});if(r)f.dropdownMenuTemplateUrl?p(f.dropdownMenuTemplateUrl).then(function(e){u=h.$new(),c(e.trim())(u,function(e){var t=e;f.dropdownMenu.replaceWith(t),f.dropdownMenu=t,l.on("keydown",i.keybindFilter)})}):l.on("keydown",i.keybindFilter),h.focusToggleElement(),i.open(h,t,y);else{if(i.close(h,t,y),f.dropdownMenuTemplateUrl){u&&u.$destroy();var A=angular.element('<ul class="dropdown-menu"></ul>');f.dropdownMenu.replaceWith(A),f.dropdownMenu=A}f.selectedOption=null}angular.isFunction(v)&&v(e,r)})}]).directive("uibDropdown",function(){return{controller:"UibDropdownController",link:function(e,t,n,o){o.init()}}}).directive("uibDropdownMenu",function(){return{restrict:"A",require:"?^uibDropdown",link:function(e,t,n,o){if(o&&!angular.isDefined(n.dropdownNested)){t.addClass("dropdown-menu");var r=n.templateUrl;r&&(o.dropdownMenuTemplateUrl=r),o.dropdownMenu||(o.dropdownMenu=t)}}}}).directive("uibDropdownToggle",function(){return{require:"?^uibDropdown",link:function(e,t,n,o){if(o){t.addClass("dropdown-toggle"),o.toggleElement=t;var r=function(r){r.preventDefault(),t.hasClass("disabled")||n.disabled||e.$apply(function(){o.toggle()})};t.on("click",r),t.attr({"aria-haspopup":!0,"aria-expanded":!1}),e.$watch(o.isOpen,function(e){t.attr("aria-expanded",!!e)}),e.$on("$destroy",function(){t.off("click",r)})}}}}),angular.module("ui.bootstrap.stackedMap",[]).factory("$$stackedMap",function(){return{createNew:function(){var e=[];return{add:function(t,n){e.push({key:t,value:n})},get:function(t){for(var n=0;n<e.length;n++)if(t===e[n].key)return e[n]},keys:function(){for(var t=[],n=0;n<e.length;n++)t.push(e[n].key);return t},top:function(){return e[e.length-1]},remove:function(t){for(var n=-1,o=0;o<e.length;o++)if(t===e[o].key){n=o;break}return e.splice(n,1)[0]},removeTop:function(){return e.pop()},length:function(){return e.length}}}}}),angular.module("ui.bootstrap.modal",["ui.bootstrap.multiMap","ui.bootstrap.stackedMap","ui.bootstrap.position"]).provider("$uibResolve",function(){var e=this;this.resolver=null,this.setResolver=function(e){this.resolver=e},this.$get=["$injector","$q",function(t,n){var o=e.resolver?t.get(e.resolver):null;return{resolve:function(e,r,i,a){if(o)return o.resolve(e,r,i,a);var s=[];return angular.forEach(e,function(e){angular.isFunction(e)||angular.isArray(e)?s.push(n.resolve(t.invoke(e))):angular.isString(e)?s.push(n.resolve(t.get(e))):s.push(n.resolve(e))}),n.all(s).then(function(t){var n={},o=0;return angular.forEach(e,function(e,r){n[r]=t[o++]}),n})}}}]}).directive("uibModalBackdrop",["$animate","$injector","$uibModalStack",function(e,t,n){return{restrict:"A",compile:function(e,t){return e.addClass(t.backdropClass),o}};function o(t,o,r){r.modalInClass&&(e.addClass(o,r.modalInClass),t.$on(n.NOW_CLOSING_EVENT,function(n,i){var a=i();t.modalOptions.animation?e.removeClass(o,r.modalInClass).then(a):a()}))}}]).directive("uibModalWindow",["$uibModalStack","$q","$animateCss","$document",function(e,t,n,o){return{scope:{index:"@"},restrict:"A",transclude:!0,templateUrl:function(e,t){return t.templateUrl||"uib/template/modal/window.html"},link:function(r,i,a){i.addClass(a.windowTopClass||""),r.size=a.size,r.close=function(t){var n=e.getTop();n&&n.value.backdrop&&"static"!==n.value.backdrop&&t.target===t.currentTarget&&(t.preventDefault(),t.stopPropagation(),e.dismiss(n.key,"backdrop click"))},i.on("click",r.close),r.$isRendered=!0;var s=t.defer();r.$$postDigest(function(){s.resolve()}),s.promise.then(function(){var s=null;a.modalInClass&&(s=n(i,{addClass:a.modalInClass}).start(),r.$on(e.NOW_CLOSING_EVENT,function(e,t){var o=t();n(i,{removeClass:a.modalInClass}).start().then(o)})),t.when(s).then(function(){var t=e.getTop();if(t&&e.modalRendered(t.key),!o[0].activeElement||!i[0].contains(o[0].activeElement)){var n=i[0].querySelector("[autofocus]");n?n.focus():i[0].focus()}})})}}}]).directive("uibModalAnimationClass",function(){return{compile:function(e,t){t.modalAnimation&&e.addClass(t.uibModalAnimationClass)}}}).directive("uibModalTransclude",["$animate",function(e){return{link:function(t,n,o,r,i){i(t.$parent,function(t){n.empty(),e.enter(t,n)})}}}]).factory("$uibModalStack",["$animate","$animateCss","$document","$compile","$rootScope","$q","$$multiMap","$$stackedMap","$uibPosition",function(e,t,n,o,r,i,a,s,l){var c,p,u,d="modal-open",f=s.createNew(),h=a.createNew(),m={NOW_CLOSING_EVENT:"modal.stack.now-closing"},g=0,v=null,b="data-bootstrap-modal-aria-hidden-count",y=/[A-Z]/g;function w(){for(var e=-1,t=f.keys(),n=0;n<t.length;n++)f.get(t[n]).value.backdrop&&(e=n);return e>-1&&e<g&&(e=g),e}function x(e,t){var n=f.get(e).value,o=n.appendTo;f.remove(e),(v=f.top())&&(g=parseInt(v.value.modalDomEl.attr("index"),10)),C(n.modalDomEl,n.modalScope,function(){var t=n.openedClass||d;h.remove(t,e);var r=h.hasKey(t);o.toggleClass(t,r),!r&&u&&u.heightOverflow&&u.scrollbarWidth&&(u.originalRight?o.css({paddingRight:u.originalRight+"px"}):o.css({paddingRight:""}),u=null),$(!0)},n.closedDeferred),function(){if(c&&-1===w()){C(c,p,function(){null}),c=void 0,p=void 0}}(),t&&t.focus?t.focus():o.focus&&o.focus()}function $(e){var t;f.length()>0&&(t=f.top().value).modalDomEl.toggleClass(t.windowTopClass||"",e)}function C(t,n,o,r){var a,s=null;return n.$broadcast(m.NOW_CLOSING_EVENT,function(){return a||(a=i.defer(),s=a.promise),function(){a.resolve()}}),i.when(s).then(function i(){if(i.done)return;i.done=!0;e.leave(t).then(function(){o&&o(),t.remove(),r&&r.resolve()});n.$destroy()})}function _(e){if(e.isDefaultPrevented())return e;var t=f.top();if(t)switch(e.which){case 27:t.value.keyboard&&(e.preventDefault(),r.$apply(function(){m.dismiss(t.key,"escape key press")}));break;case 9:var n=m.loadFocusElementList(t),o=!1;e.shiftKey?(m.isFocusInFirstItem(e,n)||m.isModalFocused(e,t))&&(o=m.focusLastFocusableElement(n)):m.isFocusInLastItem(e,n)&&(o=m.focusFirstFocusableElement(n)),o&&(e.preventDefault(),e.stopPropagation())}}function k(e,t,n){return!e.value.modalScope.$broadcast("modal.closing",t,n).defaultPrevented}function S(){Array.prototype.forEach.call(document.querySelectorAll("["+b+"]"),function(e){var t=parseInt(e.getAttribute(b),10)-1;e.setAttribute(b,t),t||(e.removeAttribute(b),e.removeAttribute("aria-hidden"))})}return r.$watch(w,function(e){p&&(p.index=e)}),n.on("keydown",_),r.$on("$destroy",function(){n.off("keydown",_)}),m.open=function(t,i){var a=n[0].activeElement,s=i.openedClass||d;$(!1),v=f.top(),f.add(t,{deferred:i.deferred,renderDeferred:i.renderDeferred,closedDeferred:i.closedDeferred,modalScope:i.scope,backdrop:i.backdrop,keyboard:i.keyboard,openedClass:i.openedClass,windowTopClass:i.windowTopClass,animation:i.animation,appendTo:i.appendTo}),h.put(s,t);var m,x=i.appendTo,C=w();C>=0&&!c&&((p=r.$new(!0)).modalOptions=i,p.index=C,(c=angular.element('<div uib-modal-backdrop="modal-backdrop"></div>')).attr({class:"modal-backdrop","ng-style":"{'z-index': 1040 + (index && 1 || 0) + index*10}","uib-modal-animation-class":"fade","modal-in-class":"in"}),i.backdropClass&&c.addClass(i.backdropClass),i.animation&&c.attr("modal-animation","true"),o(c)(p),e.enter(c,x),l.isScrollable(x)&&(u=l.scrollbarPadding(x)).heightOverflow&&u.scrollbarWidth&&x.css({paddingRight:u.right+"px"})),i.component?(m=document.createElement(i.component.name.replace(y,function(e,t){return(t?"-":"")+e.toLowerCase()})),(m=angular.element(m)).attr({resolve:"$resolve","modal-instance":"$uibModalInstance",close:"$close($value)",dismiss:"$dismiss($value)"})):m=i.content,g=v?parseInt(v.value.modalDomEl.attr("index"),10)+1:0;var _=angular.element('<div uib-modal-window="modal-window"></div>');_.attr({class:"modal","template-url":i.windowTemplateUrl,"window-top-class":i.windowTopClass,role:"dialog","aria-labelledby":i.ariaLabelledBy,"aria-describedby":i.ariaDescribedBy,size:i.size,index:g,animate:"animate","ng-style":"{'z-index': 1050 + $$topModalIndex*10, display: 'block'}",tabindex:-1,"uib-modal-animation-class":"fade","modal-in-class":"in"}).append(m),i.windowClass&&_.addClass(i.windowClass),i.animation&&_.attr("modal-animation","true"),x.addClass(s),i.scope&&(i.scope.$$topModalIndex=g),e.enter(o(_)(i.scope),x),f.top().value.modalDomEl=_,f.top().value.modalOpener=a,function e(t){if(!t||"BODY"===t[0].tagName)return;(function(e){var t=e.parent()?e.parent().children():[];return Array.prototype.filter.call(t,function(t){return t!==e[0]})})(t).forEach(function(e){var t="true"===e.getAttribute("aria-hidden"),n=parseInt(e.getAttribute(b),10);n||(n=t?1:0),e.setAttribute(b,n+1),e.setAttribute("aria-hidden","true")});return e(t.parent())}(_)},m.close=function(e,t){var n=f.get(e);return S(),n&&k(n,t,!0)?(n.value.modalScope.$$uibDestructionScheduled=!0,n.value.deferred.resolve(t),x(e,n.value.modalOpener),!0):!n},m.dismiss=function(e,t){var n=f.get(e);return S(),n&&k(n,t,!1)?(n.value.modalScope.$$uibDestructionScheduled=!0,n.value.deferred.reject(t),x(e,n.value.modalOpener),!0):!n},m.dismissAll=function(e){for(var t=this.getTop();t&&this.dismiss(t.key,e);)t=this.getTop()},m.getTop=function(){return f.top()},m.modalRendered=function(e){var t=f.get(e);t&&t.value.renderDeferred.resolve()},m.focusFirstFocusableElement=function(e){return e.length>0&&(e[0].focus(),!0)},m.focusLastFocusableElement=function(e){return e.length>0&&(e[e.length-1].focus(),!0)},m.isModalFocused=function(e,t){if(e&&t){var n=t.value.modalDomEl;if(n&&n.length)return(e.target||e.srcElement)===n[0]}return!1},m.isFocusInFirstItem=function(e,t){return t.length>0&&(e.target||e.srcElement)===t[0]},m.isFocusInLastItem=function(e,t){return t.length>0&&(e.target||e.srcElement)===t[t.length-1]},m.loadFocusElementList=function(e){if(e){var t=e.value.modalDomEl;if(t&&t.length){var n=t[0].querySelectorAll("a[href], area[href], input:not([disabled]):not([tabindex='-1']), button:not([disabled]):not([tabindex='-1']),select:not([disabled]):not([tabindex='-1']), textarea:not([disabled]):not([tabindex='-1']), iframe, object, embed, *[tabindex]:not([tabindex='-1']), *[contenteditable=true]");return n?Array.prototype.filter.call(n,function(e){return function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}(e)}):n}}},m}]).provider("$uibModal",function(){var e={options:{animation:!0,backdrop:!0,keyboard:!0},$get:["$rootScope","$q","$document","$templateRequest","$controller","$uibResolve","$uibModalStack",function(t,n,o,r,i,a,s){var l={};var c=null;return l.getPromiseChain=function(){return c},l.open=function(l){var p,u,d,f=n.defer(),h=n.defer(),m=n.defer(),g=n.defer(),v={result:f.promise,opened:h.promise,closed:m.promise,rendered:g.promise,close:function(e){return s.close(v,e)},dismiss:function(e){return s.dismiss(v,e)}};if((l=angular.extend({},e.options,l)).resolve=l.resolve||{},l.appendTo=l.appendTo||o.find("body").eq(0),!l.appendTo.length)throw new Error("appendTo element not found. Make sure that the element passed is in DOM.");if(!l.component&&!l.template&&!l.templateUrl)throw new Error("One of component or template or templateUrl options is required.");function b(){return p}return p=l.component?n.when(a.resolve(l.resolve,{},null,null)):n.all([(u=l,u.template?n.when(u.template):r(angular.isFunction(u.templateUrl)?u.templateUrl():u.templateUrl)),a.resolve(l.resolve,{},null,null)]),d=c=n.all([c]).then(b,b).then(function(e){var n=l.scope||t,o=n.$new();o.$close=v.close,o.$dismiss=v.dismiss,o.$on("$destroy",function(){o.$$uibDestructionScheduled||o.$dismiss("$uibUnscheduledDestruction")});var r,a,c={scope:o,deferred:f,renderDeferred:g,closedDeferred:m,animation:l.animation,backdrop:l.backdrop,keyboard:l.keyboard,backdropClass:l.backdropClass,windowTopClass:l.windowTopClass,windowClass:l.windowClass,windowTemplateUrl:l.windowTemplateUrl,ariaLabelledBy:l.ariaLabelledBy,ariaDescribedBy:l.ariaDescribedBy,size:l.size,openedClass:l.openedClass,appendTo:l.appendTo},p={},u={};function d(t,n,r,i){t.$scope=o,t.$scope.$resolve={},r?t.$scope.$uibModalInstance=v:t.$uibModalInstance=v;var a=n?e[1]:e;angular.forEach(a,function(e,n){i&&(t[n]=e),t.$scope.$resolve[n]=e})}l.component?(d(p,!1,!0,!1),p.name=l.component,c.component=p):l.controller&&(d(u,!0,!1,!0),a=i(l.controller,u,!0,l.controllerAs),l.controllerAs&&l.bindToController&&((r=a.instance).$close=o.$close,r.$dismiss=o.$dismiss,angular.extend(r,{$resolve:u.$scope.$resolve},n)),r=a(),angular.isFunction(r.$onInit)&&r.$onInit()),l.component||(c.content=e[0]),s.open(v,c),h.resolve(!0)},function(e){h.reject(e),f.reject(e)}).finally(function(){c===d&&(c=null)}),v},l}]};return e}),angular.module("ui.bootstrap.paging",[]).factory("uibPaging",["$parse",function(e){return{create:function(t,n,o){t.setNumPages=o.numPages?e(o.numPages).assign:angular.noop,t.ngModelCtrl={$setViewValue:angular.noop},t._watchers=[],t.init=function(e,r){t.ngModelCtrl=e,t.config=r,e.$render=function(){t.render()},o.itemsPerPage?t._watchers.push(n.$parent.$watch(o.itemsPerPage,function(e){t.itemsPerPage=parseInt(e,10),n.totalPages=t.calculateTotalPages(),t.updatePage()})):t.itemsPerPage=r.itemsPerPage,n.$watch("totalItems",function(e,o){(angular.isDefined(e)||e!==o)&&(n.totalPages=t.calculateTotalPages(),t.updatePage())})},t.calculateTotalPages=function(){var e=t.itemsPerPage<1?1:Math.ceil(n.totalItems/t.itemsPerPage);return Math.max(e||0,1)},t.render=function(){n.page=parseInt(t.ngModelCtrl.$viewValue,10)||1},n.selectPage=function(e,o){o&&o.preventDefault(),(!n.ngDisabled||!o)&&n.page!==e&&e>0&&e<=n.totalPages&&(o&&o.target&&o.target.blur(),t.ngModelCtrl.$setViewValue(e),t.ngModelCtrl.$render())},n.getText=function(e){return n[e+"Text"]||t.config[e+"Text"]},n.noPrevious=function(){return 1===n.page},n.noNext=function(){return n.page===n.totalPages},t.updatePage=function(){t.setNumPages(n.$parent,n.totalPages),n.page>n.totalPages?n.selectPage(n.totalPages):t.ngModelCtrl.$render()},n.$on("$destroy",function(){for(;t._watchers.length;)t._watchers.shift()()})}}}]),angular.module("ui.bootstrap.pager",["ui.bootstrap.paging","ui.bootstrap.tabindex"]).controller("UibPagerController",["$scope","$attrs","uibPaging","uibPagerConfig",function(e,t,n,o){e.align=angular.isDefined(t.align)?e.$parent.$eval(t.align):o.align,n.create(this,e,t)}]).constant("uibPagerConfig",{itemsPerPage:10,previousText:"« Previous",nextText:"Next »",align:!0}).directive("uibPager",["uibPagerConfig",function(e){return{scope:{totalItems:"=",previousText:"@",nextText:"@",ngDisabled:"="},require:["uibPager","?ngModel"],restrict:"A",controller:"UibPagerController",controllerAs:"pager",templateUrl:function(e,t){return t.templateUrl||"uib/template/pager/pager.html"},link:function(t,n,o,r){n.addClass("pager");var i=r[0],a=r[1];a&&i.init(a,e)}}}]),angular.module("ui.bootstrap.pagination",["ui.bootstrap.paging","ui.bootstrap.tabindex"]).controller("UibPaginationController",["$scope","$attrs","$parse","uibPaging","uibPaginationConfig",function(e,t,n,o,r){var i=this,a=angular.isDefined(t.maxSize)?e.$parent.$eval(t.maxSize):r.maxSize,s=angular.isDefined(t.rotate)?e.$parent.$eval(t.rotate):r.rotate,l=angular.isDefined(t.forceEllipses)?e.$parent.$eval(t.forceEllipses):r.forceEllipses,c=angular.isDefined(t.boundaryLinkNumbers)?e.$parent.$eval(t.boundaryLinkNumbers):r.boundaryLinkNumbers,p=angular.isDefined(t.pageLabel)?function(n){return e.$parent.$eval(t.pageLabel,{$page:n})}:angular.identity;function u(e,t,n){return{number:e,text:t,active:n}}e.boundaryLinks=angular.isDefined(t.boundaryLinks)?e.$parent.$eval(t.boundaryLinks):r.boundaryLinks,e.directionLinks=angular.isDefined(t.directionLinks)?e.$parent.$eval(t.directionLinks):r.directionLinks,t.$set("role","menu"),o.create(this,e,t),t.maxSize&&i._watchers.push(e.$parent.$watch(n(t.maxSize),function(e){a=parseInt(e,10),i.render()}));var d=this.render;this.render=function(){d(),e.page>0&&e.page<=e.totalPages&&(e.pages=function(e,t){var n=[],o=1,r=t,i=angular.isDefined(a)&&a<t;i&&(s?(r=(o=Math.max(e-Math.floor(a/2),1))+a-1)>t&&(o=(r=t)-a+1):(o=(Math.ceil(e/a)-1)*a+1,r=Math.min(o+a-1,t)));for(var d=o;d<=r;d++){var f=u(d,p(d),d===e);n.push(f)}if(i&&a>0&&(!s||l||c)){if(o>1){if(!c||o>3){var h=u(o-1,"...",!1);n.unshift(h)}if(c){if(3===o){var m=u(2,"2",!1);n.unshift(m)}var g=u(1,"1",!1);n.unshift(g)}}if(r<t){if(!c||r<t-2){var v=u(r+1,"...",!1);n.push(v)}if(c){if(r===t-2){var b=u(t-1,t-1,!1);n.push(b)}var y=u(t,t,!1);n.push(y)}}}return n}(e.page,e.totalPages))}}]).constant("uibPaginationConfig",{itemsPerPage:10,boundaryLinks:!1,boundaryLinkNumbers:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0,forceEllipses:!1}).directive("uibPagination",["$parse","uibPaginationConfig",function(e,t){return{scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@",ngDisabled:"="},require:["uibPagination","?ngModel"],restrict:"A",controller:"UibPaginationController",controllerAs:"pagination",templateUrl:function(e,t){return t.templateUrl||"uib/template/pagination/pagination.html"},link:function(e,n,o,r){n.addClass("pagination");var i=r[0],a=r[1];a&&i.init(a,t)}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.stackedMap"]).provider("$uibTooltip",function(){var e={placement:"top",placementClassPrefix:"",animation:!0,popupDelay:0,popupCloseDelay:0,useContentExp:!1},t={mouseenter:"mouseleave",click:"click",outsideClick:"outsideClick",focus:"blur",none:""},n={};this.options=function(e){angular.extend(n,e)},this.setTriggers=function(e){angular.extend(t,e)},this.$get=["$window","$compile","$timeout","$document","$uibPosition","$interpolate","$rootScope","$parse","$$stackedMap",function(o,r,i,a,s,l,c,p,u){var d=u.createNew();function f(e){if(27===e.which){var t=d.top();t&&(t.value.close(),t=null)}}return a.on("keyup",f),c.$on("$destroy",function(){a.off("keyup",f)}),function(o,c,u,f){function h(e){var n=(e||f.trigger||u).split(" ");return{show:n,hide:n.map(function(e){return t[e]||e})}}f=angular.extend({},e,n,f);var m=o.replace(/[A-Z]/g,function(e,t){return(t?"-":"")+e.toLowerCase()}),g=l.startSymbol(),v=l.endSymbol(),b="<div "+m+'-popup uib-title="'+g+"title"+v+'" '+(f.useContentExp?'content-exp="contentExp()" ':'content="'+g+"content"+v+'" ')+'origin-scope="origScope" class="uib-position-measure '+c+'" tooltip-animation-class="fade"uib-tooltip-classes ng-class="{ in: isOpen }" ></div>';return{compile:function(e,t){var n=r(b);return function(e,t,r,l){var u,m,g,v,b,y,w,x,$=!!angular.isDefined(f.appendToBody)&&f.appendToBody,C=h(void 0),_=angular.isDefined(r[c+"Enable"]),k=e.$new(!0),S=!1,T=!!angular.isDefined(r[c+"IsOpen"])&&p(r[c+"IsOpen"]),I=!!f.useContentExp&&p(r[o]),E=[],N=function(){u&&u.html()&&(y||(y=i(function(){var e=s.positionElements(t,u,k.placement,$),n=angular.isDefined(u.offsetHeight)?u.offsetHeight:u.prop("offsetHeight"),o=$?s.offset(t):s.position(t);u.css({top:e.top+"px",left:e.left+"px"});var r=e.placement.split("-");u.hasClass(r[0])||(u.removeClass(x.split("-")[0]),u.addClass(r[0])),u.hasClass(f.placementClassPrefix+e.placement)||(u.removeClass(f.placementClassPrefix+x),u.addClass(f.placementClassPrefix+e.placement)),w=i(function(){var e=angular.isDefined(u.offsetHeight)?u.offsetHeight:u.prop("offsetHeight"),t=s.adjustTop(r,o,n,e);t&&u.css(t),w=null},0,!1),u.hasClass("uib-position-measure")?(s.positionArrow(u,e.placement),u.removeClass("uib-position-measure")):x!==e.placement&&s.positionArrow(u,e.placement),x=e.placement,y=null},0,!1)))};function O(){k.isOpen?P():D()}function D(){_&&!e.$eval(r[c+"Enable"])||(R(),function(){k.title=r[c+"Title"],k.content=I?I(e):r[o];k.popupClass=r[c+"Class"],k.placement=angular.isDefined(r[c+"Placement"])?r[c+"Placement"]:f.placement;var t=s.parsePlacement(k.placement);x=t[1]?t[0]+"-"+t[1]:t[0];var n=parseInt(r[c+"PopupDelay"],10),i=parseInt(r[c+"PopupCloseDelay"],10);k.popupDelay=isNaN(n)?f.popupDelay:n,k.popupCloseDelay=isNaN(i)?f.popupCloseDelay:i}(),k.popupDelay?v||(v=i(A,k.popupDelay,!1)):A())}function P(){M(),k.popupCloseDelay?b||(b=i(U,k.popupCloseDelay,!1)):U()}function A(){if(M(),R(),!k.content)return angular.noop;!function(){if(u)return;m=k.$new(),u=n(m,function(e){$?a.find("body").append(e):t.after(e)}),d.add(k,{close:U}),function(){E.length=0,I?(E.push(e.$watch(I,function(e){k.content=e,!e&&k.isOpen&&U()})),E.push(m.$watch(function(){S||(S=!0,m.$$postDigest(function(){S=!1,k&&k.isOpen&&N()}))}))):E.push(r.$observe(o,function(e){k.content=e,!e&&k.isOpen?U():N()}));E.push(r.$observe(c+"Title",function(e){k.title=e,k.isOpen&&N()})),E.push(r.$observe(c+"Placement",function(e){k.placement=e||f.placement,k.isOpen&&N()}))}()}(),k.$evalAsync(function(){k.isOpen=!0,z(!0),N()})}function M(){v&&(i.cancel(v),v=null),y&&(i.cancel(y),y=null)}function U(){k&&k.$evalAsync(function(){k&&(k.isOpen=!1,z(!1),k.animation?g||(g=i(L,150,!1)):L())})}function R(){b&&(i.cancel(b),b=null),g&&(i.cancel(g),g=null)}function L(){M(),R(),E.length&&(angular.forEach(E,function(e){e()}),E.length=0),u&&(u.remove(),u=null,w&&i.cancel(w)),d.remove(k),m&&(m.$destroy(),m=null)}function z(t){T&&angular.isFunction(T.assign)&&T.assign(e,t)}function F(e){k&&k.isOpen&&u&&(t[0].contains(e.target)||u[0].contains(e.target)||P())}function j(e){27===e.which&&P()}k.origScope=e,k.isOpen=!1,k.contentExp=function(){return k.content},r.$observe("disabled",function(e){e&&M(),e&&k.isOpen&&U()}),T&&e.$watch(T,function(e){k&&!e===k.isOpen&&O()});var B,G,H,V=function(){C.show.forEach(function(e){"outsideClick"===e?t.off("click",O):(t.off(e,D),t.off(e,O)),t.off("keypress",j)}),C.hide.forEach(function(e){"outsideClick"===e?a.off("click",F):t.off(e,P)})};B=[],G=[],H=e.$eval(r[c+"Trigger"]),V(),angular.isObject(H)?(Object.keys(H).forEach(function(e){B.push(e),G.push(H[e])}),C={show:B,hide:G}):C=h(H),"none"!==C.show&&C.show.forEach(function(e,n){"outsideClick"===e?(t.on("click",O),a.on("click",F)):e===C.hide[n]?t.on(e,O):e&&(t.on(e,D),t.on(C.hide[n],P)),t.on("keypress",j)});var Y,q=e.$eval(r[c+"Animation"]);k.animation=angular.isDefined(q)?!!q:f.animation;var W=c+"AppendToBody";Y=W in r&&void 0===r[W]||e.$eval(r[W]),$=angular.isDefined(Y)?Y:$,e.$on("$destroy",function(){V(),L(),k=null})}}}}}]}).directive("uibTooltipTemplateTransclude",["$animate","$sce","$compile","$templateRequest",function(e,t,n,o){return{link:function(r,i,a){var s,l,c,p=r.$eval(a.tooltipTemplateTranscludeScope),u=0,d=function(){l&&(l.remove(),l=null),s&&(s.$destroy(),s=null),c&&(e.leave(c).then(function(){l=null}),l=c,c=null)};r.$watch(t.parseAsResourceUrl(a.uibTooltipTemplateTransclude),function(t){var a=++u;t?(o(t,!0).then(function(o){if(a===u){var r=p.$new(),l=n(o)(r,function(t){d(),e.enter(t,i)});c=l,(s=r).$emit("$includeContentLoaded",t)}},function(){a===u&&(d(),r.$emit("$includeContentError",t))}),r.$emit("$includeContentRequested",t)):d()}),r.$on("$destroy",d)}}}]).directive("uibTooltipClasses",["$uibPosition",function(e){return{restrict:"A",link:function(t,n,o){if(t.placement){var r=e.parsePlacement(t.placement);n.addClass(r[0])}t.popupClass&&n.addClass(t.popupClass),t.animation&&n.addClass(o.tooltipAnimationClass)}}}]).directive("uibTooltipPopup",function(){return{restrict:"A",scope:{content:"@"},templateUrl:"uib/template/tooltip/tooltip-popup.html"}}).directive("uibTooltip",["$uibTooltip",function(e){return e("uibTooltip","tooltip","mouseenter")}]).directive("uibTooltipTemplatePopup",function(){return{restrict:"A",scope:{contentExp:"&",originScope:"&"},templateUrl:"uib/template/tooltip/tooltip-template-popup.html"}}).directive("uibTooltipTemplate",["$uibTooltip",function(e){return e("uibTooltipTemplate","tooltip","mouseenter",{useContentExp:!0})}]).directive("uibTooltipHtmlPopup",function(){return{restrict:"A",scope:{contentExp:"&"},templateUrl:"uib/template/tooltip/tooltip-html-popup.html"}}).directive("uibTooltipHtml",["$uibTooltip",function(e){return e("uibTooltipHtml","tooltip","mouseenter",{useContentExp:!0})}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("uibPopoverTemplatePopup",function(){return{restrict:"A",scope:{uibTitle:"@",contentExp:"&",originScope:"&"},templateUrl:"uib/template/popover/popover-template.html"}}).directive("uibPopoverTemplate",["$uibTooltip",function(e){return e("uibPopoverTemplate","popover","click",{useContentExp:!0})}]).directive("uibPopoverHtmlPopup",function(){return{restrict:"A",scope:{contentExp:"&",uibTitle:"@"},templateUrl:"uib/template/popover/popover-html.html"}}).directive("uibPopoverHtml",["$uibTooltip",function(e){return e("uibPopoverHtml","popover","click",{useContentExp:!0})}]).directive("uibPopoverPopup",function(){return{restrict:"A",scope:{uibTitle:"@",content:"@"},templateUrl:"uib/template/popover/popover.html"}}).directive("uibPopover",["$uibTooltip",function(e){return e("uibPopover","popover","click")}]),angular.module("ui.bootstrap.progressbar",[]).constant("uibProgressConfig",{animate:!0,max:100}).controller("UibProgressController",["$scope","$attrs","uibProgressConfig",function(e,t,n){var o=this,r=angular.isDefined(t.animate)?e.$parent.$eval(t.animate):n.animate;function i(){return angular.isDefined(e.maxParam)?e.maxParam:n.max}this.bars=[],e.max=i(),this.addBar=function(e,t,n){r||t.css({transition:"none"}),this.bars.push(e),e.max=i(),e.title=n&&angular.isDefined(n.title)?n.title:"progressbar",e.$watch("value",function(t){e.recalculatePercentage()}),e.recalculatePercentage=function(){var t=o.bars.reduce(function(e,t){return t.percent=+(100*t.value/t.max).toFixed(2),e+t.percent},0);t>100&&(e.percent-=t-100)},e.$on("$destroy",function(){t=null,o.removeBar(e)})},this.removeBar=function(e){this.bars.splice(this.bars.indexOf(e),1),this.bars.forEach(function(e){e.recalculatePercentage()})},e.$watch("maxParam",function(e){o.bars.forEach(function(e){e.max=i(),e.recalculatePercentage()})})}]).directive("uibProgress",function(){return{replace:!0,transclude:!0,controller:"UibProgressController",require:"uibProgress",scope:{maxParam:"=?max"},templateUrl:"uib/template/progressbar/progress.html"}}).directive("uibBar",function(){return{replace:!0,transclude:!0,require:"^uibProgress",scope:{value:"=",type:"@"},templateUrl:"uib/template/progressbar/bar.html",link:function(e,t,n,o){o.addBar(e,t,n)}}}).directive("uibProgressbar",function(){return{replace:!0,transclude:!0,controller:"UibProgressController",scope:{value:"=",maxParam:"=?max",type:"@"},templateUrl:"uib/template/progressbar/progressbar.html",link:function(e,t,n,o){o.addBar(e,angular.element(t.children()[0]),{title:n.title})}}}),angular.module("ui.bootstrap.rating",[]).constant("uibRatingConfig",{max:5,stateOn:null,stateOff:null,enableReset:!0,titles:["one","two","three","four","five"]}).controller("UibRatingController",["$scope","$attrs","uibRatingConfig",function(e,t,n){var o={$setViewValue:angular.noop},r=this;this.init=function(r){(o=r).$render=this.render,o.$formatters.push(function(e){return angular.isNumber(e)&&e<<0!==e&&(e=Math.round(e)),e}),this.stateOn=angular.isDefined(t.stateOn)?e.$parent.$eval(t.stateOn):n.stateOn,this.stateOff=angular.isDefined(t.stateOff)?e.$parent.$eval(t.stateOff):n.stateOff,this.enableReset=angular.isDefined(t.enableReset)?e.$parent.$eval(t.enableReset):n.enableReset;var i=angular.isDefined(t.titles)?e.$parent.$eval(t.titles):n.titles;this.titles=angular.isArray(i)&&i.length>0?i:n.titles;var a=angular.isDefined(t.ratingStates)?e.$parent.$eval(t.ratingStates):new Array(angular.isDefined(t.max)?e.$parent.$eval(t.max):n.max);e.range=this.buildTemplateObjects(a)},this.buildTemplateObjects=function(e){for(var t=0,n=e.length;t<n;t++)e[t]=angular.extend({index:t},{stateOn:this.stateOn,stateOff:this.stateOff,title:this.getTitle(t)},e[t]);return e},this.getTitle=function(e){return e>=this.titles.length?e+1:this.titles[e]},e.rate=function(t){if(!e.readonly&&t>=0&&t<=e.range.length){var n=r.enableReset&&o.$viewValue===t?0:t;o.$setViewValue(n),o.$render()}},e.enter=function(t){e.readonly||(e.value=t),e.onHover({value:t})},e.reset=function(){e.value=o.$viewValue,e.onLeave()},e.onKeydown=function(t){/(37|38|39|40)/.test(t.which)&&(t.preventDefault(),t.stopPropagation(),e.rate(e.value+(38===t.which||39===t.which?1:-1)))},this.render=function(){e.value=o.$viewValue,e.title=r.getTitle(e.value-1)}}]).directive("uibRating",function(){return{require:["uibRating","ngModel"],restrict:"A",scope:{readonly:"=?readOnly",onHover:"&",onLeave:"&"},controller:"UibRatingController",templateUrl:"uib/template/rating/rating.html",link:function(e,t,n,o){var r=o[0],i=o[1];r.init(i)}}}),angular.module("ui.bootstrap.tabs",[]).controller("UibTabsetController",["$scope",function(e){var t,n,o=this;function r(e){for(var t=0;t<o.tabs.length;t++)if(o.tabs[t].index===e)return t}o.tabs=[],o.select=function(e,i){if(!n){var a=r(t),s=o.tabs[a];if(s){if(s.tab.onDeselect({$event:i,$selectedIndex:e}),i&&i.isDefaultPrevented())return;s.tab.active=!1}var l=o.tabs[e];l?(l.tab.onSelect({$event:i}),l.tab.active=!0,o.active=l.index,t=l.index):!l&&angular.isDefined(t)&&(o.active=null,t=null)}},o.addTab=function(e){if(o.tabs.push({tab:e,index:e.index}),o.tabs.sort(function(e,t){return e.index>t.index?1:e.index<t.index?-1:0}),e.index===o.active||!angular.isDefined(o.active)&&1===o.tabs.length){var t=r(e.index);o.select(t)}},o.removeTab=function(e){for(var t,n=0;n<o.tabs.length;n++)if(o.tabs[n].tab===e){t=n;break}if(o.tabs[t].index===o.active){var r=t===o.tabs.length-1?t-1:t+1%o.tabs.length;o.select(r)}o.tabs.splice(t,1)},e.$watch("tabset.active",function(e){angular.isDefined(e)&&e!==t&&o.select(r(e))}),e.$on("$destroy",function(){n=!0})}]).directive("uibTabset",function(){return{transclude:!0,replace:!0,scope:{},bindToController:{active:"=?",type:"@"},controller:"UibTabsetController",controllerAs:"tabset",templateUrl:function(e,t){return t.templateUrl||"uib/template/tabs/tabset.html"},link:function(e,t,n){e.vertical=!!angular.isDefined(n.vertical)&&e.$parent.$eval(n.vertical),e.justified=!!angular.isDefined(n.justified)&&e.$parent.$eval(n.justified)}}}).directive("uibTab",["$parse",function(e){return{require:"^uibTabset",replace:!0,templateUrl:function(e,t){return t.templateUrl||"uib/template/tabs/tab.html"},transclude:!0,scope:{heading:"@",index:"=?",classes:"@?",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},controllerAs:"tab",link:function(t,n,o,r,i){t.disabled=!1,o.disable&&t.$parent.$watch(e(o.disable),function(e){t.disabled=!!e}),angular.isUndefined(o.index)&&(r.tabs&&r.tabs.length?t.index=Math.max.apply(null,r.tabs.map(function(e){return e.index}))+1:t.index=0),angular.isUndefined(o.classes)&&(t.classes=""),t.select=function(e){if(!t.disabled){for(var n,o=0;o<r.tabs.length;o++)if(r.tabs[o].tab===t){n=o;break}r.select(n,e)}},r.addTab(t),t.$on("$destroy",function(){r.removeTab(t)}),t.$transcludeFn=i}}}]).directive("uibTabHeadingTransclude",function(){return{restrict:"A",require:"^uibTab",link:function(e,t){e.$watch("headingElement",function(e){e&&(t.html(""),t.append(e))})}}}).directive("uibTabContentTransclude",function(){return{restrict:"A",require:"^uibTabset",link:function(e,t,n){var o=e.$eval(n.uibTabContentTransclude).tab;o.$transcludeFn(o.$parent,function(e){angular.forEach(e,function(e){!function(e){return e.tagName&&(e.hasAttribute("uib-tab-heading")||e.hasAttribute("data-uib-tab-heading")||e.hasAttribute("x-uib-tab-heading")||"uib-tab-heading"===e.tagName.toLowerCase()||"data-uib-tab-heading"===e.tagName.toLowerCase()||"x-uib-tab-heading"===e.tagName.toLowerCase()||"uib:tab-heading"===e.tagName.toLowerCase())}(e)?t.append(e):o.headingElement=e})})}}}),angular.module("ui.bootstrap.timepicker",[]).constant("uibTimepickerConfig",{hourStep:1,minuteStep:1,secondStep:1,showMeridian:!0,showSeconds:!1,meridians:null,readonlyInput:!1,mousewheel:!0,arrowkeys:!0,showSpinners:!0,templateUrl:"uib/template/timepicker/timepicker.html"}).controller("UibTimepickerController",["$scope","$element","$attrs","$parse","$log","$locale","uibTimepickerConfig",function(e,t,n,o,r,i,a){var s,l,c,p=new Date,u=[],d={$setViewValue:angular.noop},f=angular.isDefined(n.meridians)?e.$parent.$eval(n.meridians):a.meridians||i.DATETIME_FORMATS.AMPMS,h=!angular.isDefined(n.padHours)||e.$parent.$eval(n.padHours);e.tabindex=angular.isDefined(n.tabindex)?n.tabindex:0,t.removeAttr("tabindex"),this.init=function(t,o){(d=t).$render=this.render,d.$formatters.unshift(function(e){return e?new Date(e):null});var r=o.eq(0),i=o.eq(1),p=o.eq(2);s=r.controller("ngModel"),l=i.controller("ngModel"),c=p.controller("ngModel"),(angular.isDefined(n.mousewheel)?e.$parent.$eval(n.mousewheel):a.mousewheel)&&this.setupMousewheelEvents(r,i,p),(angular.isDefined(n.arrowkeys)?e.$parent.$eval(n.arrowkeys):a.arrowkeys)&&this.setupArrowkeyEvents(r,i,p),e.readonlyInput=angular.isDefined(n.readonlyInput)?e.$parent.$eval(n.readonlyInput):a.readonlyInput,this.setupInputEvents(r,i,p)};var m=a.hourStep;n.hourStep&&u.push(e.$parent.$watch(o(n.hourStep),function(e){m=+e}));var g,v,b=a.minuteStep;n.minuteStep&&u.push(e.$parent.$watch(o(n.minuteStep),function(e){b=+e})),u.push(e.$parent.$watch(o(n.min),function(e){var t=new Date(e);g=isNaN(t)?void 0:t})),u.push(e.$parent.$watch(o(n.max),function(e){var t=new Date(e);v=isNaN(t)?void 0:t}));var y=!1;n.ngDisabled&&u.push(e.$parent.$watch(o(n.ngDisabled),function(e){y=e})),e.noIncrementHours=function(){var e=I(p,60*m);return y||e>v||e<p&&e<g},e.noDecrementHours=function(){var e=I(p,60*-m);return y||e<g||e>p&&e>v},e.noIncrementMinutes=function(){var e=I(p,b);return y||e>v||e<p&&e<g},e.noDecrementMinutes=function(){var e=I(p,-b);return y||e<g||e>p&&e>v},e.noIncrementSeconds=function(){var e=E(p,w);return y||e>v||e<p&&e<g},e.noDecrementSeconds=function(){var e=E(p,-w);return y||e<g||e>p&&e>v},e.noToggleMeridian=function(){return p.getHours()<12?y||I(p,720)>v:y||I(p,-720)<g};var w=a.secondStep;function x(){var t=+e.hours;if((e.showMeridian?t>0&&t<13:t>=0&&t<24)&&""!==e.hours)return e.showMeridian&&(12===t&&(t=0),e.meridian===f[1]&&(t+=12)),t}function $(){var t=+e.minutes;if(t>=0&&t<60&&""!==e.minutes)return t}function C(e,t){return null===e?"":angular.isDefined(e)&&e.toString().length<2&&!t?"0"+e:e.toString()}function _(e){k(),d.$setViewValue(new Date(p)),S(e)}function k(){s&&s.$setValidity("hours",!0),l&&l.$setValidity("minutes",!0),c&&c.$setValidity("seconds",!0),d.$setValidity("time",!0),e.invalidHours=!1,e.invalidMinutes=!1,e.invalidSeconds=!1}function S(t){if(d.$modelValue){var n=p.getHours(),o=p.getMinutes(),r=p.getSeconds();e.showMeridian&&(n=0===n||12===n?12:n%12),e.hours="h"===t?n:C(n,!h),"m"!==t&&(e.minutes=C(o)),e.meridian=p.getHours()<12?f[0]:f[1],"s"!==t&&(e.seconds=C(r)),e.meridian=p.getHours()<12?f[0]:f[1]}else e.hours=null,e.minutes=null,e.seconds=null,e.meridian=f[0]}function T(e){p=E(p,e),_()}function I(e,t){return E(e,60*t)}function E(e,t){var n=new Date(e.getTime()+1e3*t),o=new Date(e);return o.setHours(n.getHours(),n.getMinutes(),n.getSeconds()),o}function N(){return(null===e.hours||""===e.hours)&&(null===e.minutes||""===e.minutes)&&(!e.showSeconds||e.showSeconds&&(null===e.seconds||""===e.seconds))}n.secondStep&&u.push(e.$parent.$watch(o(n.secondStep),function(e){w=+e})),e.showSeconds=a.showSeconds,n.showSeconds&&u.push(e.$parent.$watch(o(n.showSeconds),function(t){e.showSeconds=!!t})),e.showMeridian=a.showMeridian,n.showMeridian&&u.push(e.$parent.$watch(o(n.showMeridian),function(t){if(e.showMeridian=!!t,d.$error.time){var n=x(),o=$();angular.isDefined(n)&&angular.isDefined(o)&&(p.setHours(n),_())}else S()})),this.setupMousewheelEvents=function(t,n,o){var r=function(e){e.originalEvent&&(e=e.originalEvent);var t=e.wheelDelta?e.wheelDelta:-e.deltaY;return e.detail||t>0};t.on("mousewheel wheel",function(t){y||e.$apply(r(t)?e.incrementHours():e.decrementHours()),t.preventDefault()}),n.on("mousewheel wheel",function(t){y||e.$apply(r(t)?e.incrementMinutes():e.decrementMinutes()),t.preventDefault()}),o.on("mousewheel wheel",function(t){y||e.$apply(r(t)?e.incrementSeconds():e.decrementSeconds()),t.preventDefault()})},this.setupArrowkeyEvents=function(t,n,o){t.on("keydown",function(t){y||(38===t.which?(t.preventDefault(),e.incrementHours(),e.$apply()):40===t.which&&(t.preventDefault(),e.decrementHours(),e.$apply()))}),n.on("keydown",function(t){y||(38===t.which?(t.preventDefault(),e.incrementMinutes(),e.$apply()):40===t.which&&(t.preventDefault(),e.decrementMinutes(),e.$apply()))}),o.on("keydown",function(t){y||(38===t.which?(t.preventDefault(),e.incrementSeconds(),e.$apply()):40===t.which&&(t.preventDefault(),e.decrementSeconds(),e.$apply()))})},this.setupInputEvents=function(t,n,o){if(e.readonlyInput)return e.updateHours=angular.noop,e.updateMinutes=angular.noop,void(e.updateSeconds=angular.noop);var r=function(t,n,o){d.$setViewValue(null),d.$setValidity("time",!1),angular.isDefined(t)&&(e.invalidHours=t,s&&s.$setValidity("hours",!1)),angular.isDefined(n)&&(e.invalidMinutes=n,l&&l.$setValidity("minutes",!1)),angular.isDefined(o)&&(e.invalidSeconds=o,c&&c.$setValidity("seconds",!1))};e.updateHours=function(){var e=x(),t=$();d.$setDirty(),angular.isDefined(e)&&angular.isDefined(t)?(p.setHours(e),p.setMinutes(t),p<g||p>v?r(!0):_("h")):r(!0)},t.on("blur",function(t){d.$setTouched(),N()?k():null===e.hours||""===e.hours?r(!0):!e.invalidHours&&e.hours<10&&e.$apply(function(){e.hours=C(e.hours,!h)})}),e.updateMinutes=function(){var e=$(),t=x();d.$setDirty(),angular.isDefined(e)&&angular.isDefined(t)?(p.setHours(t),p.setMinutes(e),p<g||p>v?r(void 0,!0):_("m")):r(void 0,!0)},n.on("blur",function(t){d.$setTouched(),N()?k():null===e.minutes?r(void 0,!0):!e.invalidMinutes&&e.minutes<10&&e.$apply(function(){e.minutes=C(e.minutes)})}),e.updateSeconds=function(){var t=function(){var t=+e.seconds;return t>=0&&t<60?t:void 0}();d.$setDirty(),angular.isDefined(t)?(p.setSeconds(t),_("s")):r(void 0,void 0,!0)},o.on("blur",function(t){N()?k():!e.invalidSeconds&&e.seconds<10&&e.$apply(function(){e.seconds=C(e.seconds)})})},this.render=function(){var t=d.$viewValue;isNaN(t)?(d.$setValidity("time",!1),r.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(t&&(p=t),p<g||p>v?(d.$setValidity("time",!1),e.invalidHours=!0,e.invalidMinutes=!0):k(),S())},e.showSpinners=angular.isDefined(n.showSpinners)?e.$parent.$eval(n.showSpinners):a.showSpinners,e.incrementHours=function(){e.noIncrementHours()||T(60*m*60)},e.decrementHours=function(){e.noDecrementHours()||T(60*-m*60)},e.incrementMinutes=function(){e.noIncrementMinutes()||T(60*b)},e.decrementMinutes=function(){e.noDecrementMinutes()||T(60*-b)},e.incrementSeconds=function(){e.noIncrementSeconds()||T(w)},e.decrementSeconds=function(){e.noDecrementSeconds()||T(-w)},e.toggleMeridian=function(){var t=$(),n=x();e.noToggleMeridian()||(angular.isDefined(t)&&angular.isDefined(n)?T(720*(p.getHours()<12?60:-60)):e.meridian=e.meridian===f[0]?f[1]:f[0])},e.blur=function(){d.$setTouched()},e.$on("$destroy",function(){for(;u.length;)u.shift()()})}]).directive("uibTimepicker",["uibTimepickerConfig",function(e){return{require:["uibTimepicker","?^ngModel"],restrict:"A",controller:"UibTimepickerController",controllerAs:"timepicker",scope:{},templateUrl:function(t,n){return n.templateUrl||e.templateUrl},link:function(e,t,n,o){var r=o[0],i=o[1];i&&r.init(i,t.find("input"))}}}]),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.debounce","ui.bootstrap.position"]).factory("uibTypeaheadParser",["$parse",function(e){var t=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(n){var o=n.match(t);if(!o)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+n+'".');return{itemName:o[3],source:e(o[4]),viewMapper:e(o[2]||o[1]),modelMapper:e(o[1])}}}}]).controller("UibTypeaheadController",["$scope","$element","$attrs","$compile","$parse","$q","$timeout","$document","$window","$rootScope","$$debounce","$uibPosition","uibTypeaheadParser",function(e,t,n,o,r,i,a,s,l,c,p,u,d){var f,h,m=[9,13,27,38,40],g=e.$eval(n.typeaheadMinLength);g||0===g||(g=1),e.$watch(n.typeaheadMinLength,function(e){g=e||0===e?e:1});var v=e.$eval(n.typeaheadWaitMs)||0,b=!1!==e.$eval(n.typeaheadEditable);e.$watch(n.typeaheadEditable,function(e){b=!1!==e});var y,w,x=r(n.typeaheadLoading).assign||angular.noop,$=n.typeaheadShouldSelect?r(n.typeaheadShouldSelect):function(e,t){var n=t.$event;return 13===n.which||9===n.which},C=r(n.typeaheadOnSelect),_=!!angular.isDefined(n.typeaheadSelectOnBlur)&&e.$eval(n.typeaheadSelectOnBlur),k=r(n.typeaheadNoResults).assign||angular.noop,S=n.typeaheadInputFormatter?r(n.typeaheadInputFormatter):void 0,T=!!n.typeaheadAppendToBody&&e.$eval(n.typeaheadAppendToBody),I=n.typeaheadAppendTo?e.$eval(n.typeaheadAppendTo):null,E=!1!==e.$eval(n.typeaheadFocusFirst),N=!!n.typeaheadSelectOnExact&&e.$eval(n.typeaheadSelectOnExact),O=r(n.typeaheadIsOpen).assign||angular.noop,D=e.$eval(n.typeaheadShowHint)||!1,P=r(n.ngModel),A=r(n.ngModel+"($$$p)"),M=d.parse(n.uibTypeahead),U=e.$new(),R=e.$on("$destroy",function(){U.$destroy()});U.$on("$destroy",R);var L,z,F="typeahead-"+U.$id+"-"+Math.floor(1e4*Math.random());t.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":F}),D&&((L=angular.element("<div></div>")).css("position","relative"),t.after(L),(z=t.clone()).attr("placeholder",""),z.attr("tabindex","-1"),z.val(""),z.css({position:"absolute",top:"0px",left:"0px","border-color":"transparent","box-shadow":"none",opacity:1,background:"none 0% 0% / auto repeat scroll padding-box border-box rgb(255, 255, 255)",color:"#999"}),t.css({position:"relative","vertical-align":"top","background-color":"transparent"}),z.attr("id")&&z.removeAttr("id"),L.append(z),z.after(t));var j=angular.element("<div uib-typeahead-popup></div>");j.attr({id:F,matches:"matches",active:"activeIdx",select:"select(activeIdx, evt)","move-in-progress":"moveInProgress",query:"query",position:"position","assign-is-open":"assignIsOpen(isOpen)",debounce:"debounceUpdate"}),angular.isDefined(n.typeaheadTemplateUrl)&&j.attr("template-url",n.typeaheadTemplateUrl),angular.isDefined(n.typeaheadPopupTemplateUrl)&&j.attr("popup-template-url",n.typeaheadPopupTemplateUrl);var B=function(){U.matches=[],U.activeIdx=-1,t.attr("aria-expanded",!1),D&&z.val("")},G=function(e){return F+"-option-"+e};U.$watch("activeIdx",function(e){e<0?t.removeAttr("aria-activedescendant"):t.attr("aria-activedescendant",G(e))});var H=function(n,o){var r={$viewValue:n};x(e,!0),k(e,!1),i.when(M.source(e,r)).then(function(i){var a=n===f.$viewValue;if(a&&y)if(i&&i.length>0){U.activeIdx=E?0:-1,k(e,!1),U.matches.length=0;for(var s=0;s<i.length;s++)r[M.itemName]=i[s],U.matches.push({id:G(s),label:M.viewMapper(U,r),model:i[s]});if(U.query=n,W(),t.attr("aria-expanded",!0),N&&1===U.matches.length&&function(e,t){return!!(U.matches.length>t&&e)&&e.toUpperCase()===U.matches[t].label.toUpperCase()}(n,0)&&(angular.isNumber(U.debounceUpdate)||angular.isObject(U.debounceUpdate)?p(function(){U.select(0,o)},angular.isNumber(U.debounceUpdate)?U.debounceUpdate:U.debounceUpdate.default):U.select(0,o)),D){var l=U.matches[0].label;angular.isString(n)&&n.length>0&&l.slice(0,n.length).toUpperCase()===n.toUpperCase()?z.val(n+l.slice(n.length)):z.val("")}}else B(),k(e,!0);a&&x(e,!1)},function(){B(),x(e,!1),k(e,!0)})};T&&(angular.element(l).on("resize",q),s.find("body").on("scroll",q));var V,Y=p(function(){U.matches.length&&W(),U.moveInProgress=!1},200);function q(){U.moveInProgress||(U.moveInProgress=!0,U.$digest()),Y()}function W(){U.position=T?u.offset(t):u.position(t),U.position.top+=t.prop("offsetHeight")}U.moveInProgress=!1,U.query=void 0;var K=function(){V&&a.cancel(V)};B(),U.assignIsOpen=function(t){O(e,t)},U.select=function(o,r){var i,s,l={};w=!0,l[M.itemName]=s=U.matches[o].model,i=M.modelMapper(e,l),function(t,n){angular.isFunction(P(e))&&h.getOption("getterSetter")?A(t,{$$$p:n}):P.assign(t,n)}(e,i),f.$setValidity("editable",!0),f.$setValidity("parse",!0),C(e,{$item:s,$model:i,$label:M.viewMapper(e,l),$event:r}),B(),!1!==U.$eval(n.typeaheadFocusOnSelect)&&a(function(){t[0].focus()},0,!1)},t.on("keydown",function(t){if(0!==U.matches.length&&-1!==m.indexOf(t.which)){var n,o=$(e,{$event:t});if(-1===U.activeIdx&&o||9===t.which&&t.shiftKey)return B(),void U.$digest();switch(t.preventDefault(),t.which){case 27:t.stopPropagation(),B(),e.$digest();break;case 38:U.activeIdx=(U.activeIdx>0?U.activeIdx:U.matches.length)-1,U.$digest(),(n=j[0].querySelectorAll(".uib-typeahead-match")[U.activeIdx]).parentNode.scrollTop=n.offsetTop;break;case 40:U.activeIdx=(U.activeIdx+1)%U.matches.length,U.$digest(),(n=j[0].querySelectorAll(".uib-typeahead-match")[U.activeIdx]).parentNode.scrollTop=n.offsetTop;break;default:o&&U.$apply(function(){angular.isNumber(U.debounceUpdate)||angular.isObject(U.debounceUpdate)?p(function(){U.select(U.activeIdx,t)},angular.isNumber(U.debounceUpdate)?U.debounceUpdate:U.debounceUpdate.default):U.select(U.activeIdx,t)})}}}),t.on("focus",function(e){y=!0,0!==g||f.$viewValue||a(function(){H(f.$viewValue,e)},0)}),t.on("blur",function(e){_&&U.matches.length&&-1!==U.activeIdx&&!w&&(w=!0,U.$apply(function(){angular.isObject(U.debounceUpdate)&&angular.isNumber(U.debounceUpdate.blur)?p(function(){U.select(U.activeIdx,e)},U.debounceUpdate.blur):U.select(U.activeIdx,e)})),!b&&f.$error.editable&&(f.$setViewValue(),U.$apply(function(){f.$setValidity("editable",!0),f.$setValidity("parse",!0)}),t.val("")),y=!1,w=!1});var X=function(n){t[0]!==n.target&&3!==n.which&&0!==U.matches.length&&(B(),c.$$phase||e.$digest())};s.on("click",X),e.$on("$destroy",function(){s.off("click",X),(T||I)&&Z.remove(),T&&(angular.element(l).off("resize",q),s.find("body").off("scroll",q)),j.remove(),D&&L.remove()});var Z=o(j)(U);T?s.find("body").append(Z):I?angular.element(I).eq(0).append(Z):t.after(Z),this.init=function(t){h=function(e){var t;angular.version.minor<6?(t=e.$options||{}).getOption=function(e){return t[e]}:t=e.$options;return t}(f=t),U.debounceUpdate=r(h.getOption("debounce"))(e),f.$parsers.unshift(function(t){return y=!0,0===g||t&&t.length>=g?v>0?(K(),function(e){V=a(function(){H(e)},v)}(t)):H(t):(x(e,!1),K(),B()),b?t:t?void f.$setValidity("editable",!1):(f.$setValidity("editable",!0),null)}),f.$formatters.push(function(t){var n,o={};return b||f.$setValidity("editable",!0),S?(o.$model=t,S(e,o)):(o[M.itemName]=t,n=M.viewMapper(e,o),o[M.itemName]=void 0,n!==M.viewMapper(e,o)?n:t)})}}]).directive("uibTypeahead",function(){return{controller:"UibTypeaheadController",require:["ngModel","uibTypeahead"],link:function(e,t,n,o){o[1].init(o[0])}}}).directive("uibTypeaheadPopup",["$$debounce",function(e){return{scope:{matches:"=",query:"=",active:"=",position:"&",moveInProgress:"=",select:"&",assignIsOpen:"&",debounce:"&"},replace:!0,templateUrl:function(e,t){return t.popupTemplateUrl||"uib/template/typeahead/typeahead-popup.html"},link:function(t,n,o){t.templateUrl=o.templateUrl,t.isOpen=function(){var e=t.matches.length>0;return t.assignIsOpen({isOpen:e}),e},t.isActive=function(e){return t.active===e},t.selectActive=function(e){t.active=e},t.selectMatch=function(n,o){var r=t.debounce();angular.isNumber(r)||angular.isObject(r)?e(function(){t.select({activeIdx:n,evt:o})},angular.isNumber(r)?r:r.default):t.select({activeIdx:n,evt:o})}}}}]).directive("uibTypeaheadMatch",["$templateRequest","$compile","$parse",function(e,t,n){return{scope:{index:"=",match:"=",query:"="},link:function(o,r,i){var a=n(i.templateUrl)(o.$parent)||"uib/template/typeahead/typeahead-match.html";e(a).then(function(e){var n=angular.element(e.trim());r.replaceWith(n),t(n)(o)})}}}]).filter("uibTypeaheadHighlight",["$sce","$injector","$log",function(e,t,n){var o;return o=t.has("$sanitize"),function(t,r){return!o&&function(e){return/<.*>/g.test(e)}(t)&&n.warn("Unsafe use of typeahead please use ngSanitize"),t=r?(""+t).replace(new RegExp(r.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"gi"),"<strong>$&</strong>"):t,o||(t=e.trustAsHtml(t)),t}}]),angular.module("uib/template/accordion/accordion-group.html",[]).run(["$templateCache",function(e){e.put("uib/template/accordion/accordion-group.html",'<div role="tab" id="{{::headingId}}" aria-selected="{{isOpen}}" class="panel-heading" ng-keypress="toggleOpen($event)">\n  <h4 class="panel-title">\n    <a role="button" data-toggle="collapse" href aria-expanded="{{isOpen}}" aria-controls="{{::panelId}}" tabindex="0" class="accordion-toggle" ng-click="toggleOpen()" uib-accordion-transclude="heading" ng-disabled="isDisabled" uib-tabindex-toggle><span uib-accordion-header ng-class="{\'text-muted\': isDisabled}">{{heading}}</span></a>\n  </h4>\n</div>\n<div id="{{::panelId}}" aria-labelledby="{{::headingId}}" aria-hidden="{{!isOpen}}" role="tabpanel" class="panel-collapse collapse" uib-collapse="!isOpen">\n  <div class="panel-body" ng-transclude></div>\n</div>\n')}]),angular.module("uib/template/accordion/accordion.html",[]).run(["$templateCache",function(e){e.put("uib/template/accordion/accordion.html",'<div role="tablist" class="panel-group" ng-transclude></div>')}]),angular.module("uib/template/alert/alert.html",[]).run(["$templateCache",function(e){e.put("uib/template/alert/alert.html",'<button ng-show="closeable" type="button" class="close" ng-click="close({$event: $event})">\n  <span aria-hidden="true">&times;</span>\n  <span class="sr-only">Close</span>\n</button>\n<div ng-transclude></div>\n')}]),angular.module("uib/template/carousel/carousel.html",[]).run(["$templateCache",function(e){e.put("uib/template/carousel/carousel.html",'<div class="carousel-inner" ng-transclude></div>\n<a role="button" href class="left carousel-control" ng-click="prev()" ng-class="{ disabled: isPrevDisabled() }" ng-show="slides.length > 1">\n  <span aria-hidden="true" class="glyphicon glyphicon-chevron-left"></span>\n  <span class="sr-only">previous</span>\n</a>\n<a role="button" href class="right carousel-control" ng-click="next()" ng-class="{ disabled: isNextDisabled() }" ng-show="slides.length > 1">\n  <span aria-hidden="true" class="glyphicon glyphicon-chevron-right"></span>\n  <span class="sr-only">next</span>\n</a>\n<ol class="carousel-indicators" ng-show="slides.length > 1">\n  <li ng-repeat="slide in slides | orderBy:indexOfSlide track by $index" ng-class="{ active: isActive(slide) }" ng-click="select(slide)">\n    <span class="sr-only">slide {{ $index + 1 }} of {{ slides.length }}<span ng-if="isActive(slide)">, currently active</span></span>\n  </li>\n</ol>\n')}]),angular.module("uib/template/carousel/slide.html",[]).run(["$templateCache",function(e){e.put("uib/template/carousel/slide.html",'<div class="text-center" ng-transclude></div>\n')}]),angular.module("uib/template/datepicker/datepicker.html",[]).run(["$templateCache",function(e){e.put("uib/template/datepicker/datepicker.html",'<div ng-switch="datepickerMode">\n  <div uib-daypicker ng-switch-when="day" tabindex="0" class="uib-daypicker"></div>\n  <div uib-monthpicker ng-switch-when="month" tabindex="0" class="uib-monthpicker"></div>\n  <div uib-yearpicker ng-switch-when="year" tabindex="0" class="uib-yearpicker"></div>\n</div>\n')}]),angular.module("uib/template/datepicker/day.html",[]).run(["$templateCache",function(e){e.put("uib/template/datepicker/day.html",'<table role="grid" aria-labelledby="{{::uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left uib-left" ng-click="move(-1)" tabindex="-1"><i aria-hidden="true" class="glyphicon glyphicon-chevron-left"></i><span class="sr-only">previous</span></button></th>\n      <th colspan="{{::5 + showWeeks}}"><button id="{{::uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm uib-title" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right uib-right" ng-click="move(1)" tabindex="-1"><i aria-hidden="true" class="glyphicon glyphicon-chevron-right"></i><span class="sr-only">next</span></button></th>\n    </tr>\n    <tr>\n      <th ng-if="showWeeks" class="text-center"></th>\n      <th ng-repeat="label in ::labels track by $index" class="text-center"><small aria-label="{{::label.full}}">{{::label.abbr}}</small></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr class="uib-weeks" ng-repeat="row in rows track by $index" role="row">\n      <td ng-if="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}</em></td>\n      <td ng-repeat="dt in row" class="uib-day text-center" role="gridcell"\n        id="{{::dt.uid}}"\n        ng-class="::dt.customClass">\n        <button type="button" class="btn btn-default btn-sm"\n          uib-is-class="\n            \'btn-info\' for selectedDt,\n            \'active\' for activeDt\n            on dt"\n          ng-click="select(dt.date)"\n          ng-disabled="::dt.disabled"\n          tabindex="-1"><span ng-class="::{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{::dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("uib/template/datepicker/month.html",[]).run(["$templateCache",function(e){e.put("uib/template/datepicker/month.html",'<table role="grid" aria-labelledby="{{::uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left uib-left" ng-click="move(-1)" tabindex="-1"><i aria-hidden="true" class="glyphicon glyphicon-chevron-left"></i><span class="sr-only">previous</span></button></th>\n      <th colspan="{{::yearHeaderColspan}}"><button id="{{::uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm uib-title" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right uib-right" ng-click="move(1)" tabindex="-1"><i aria-hidden="true" class="glyphicon glyphicon-chevron-right"></i><span class="sr-only">next</span></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr class="uib-months" ng-repeat="row in rows track by $index" role="row">\n      <td ng-repeat="dt in row" class="uib-month text-center" role="gridcell"\n        id="{{::dt.uid}}"\n        ng-class="::dt.customClass">\n        <button type="button" class="btn btn-default"\n          uib-is-class="\n            \'btn-info\' for selectedDt,\n            \'active\' for activeDt\n            on dt"\n          ng-click="select(dt.date)"\n          ng-disabled="::dt.disabled"\n          tabindex="-1"><span ng-class="::{\'text-info\': dt.current}">{{::dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("uib/template/datepicker/popup.html",[]).run(["$templateCache",function(e){e.put("uib/template/datepicker/popup.html",'<div>\n  <ul class="uib-datepicker-popup dropdown-menu uib-position-measure" dropdown-nested ng-if="isOpen" ng-keydown="keydown($event)" ng-click="$event.stopPropagation()">\n    <li ng-transclude></li>\n    <li ng-if="showButtonBar" class="uib-button-bar">\n      <span class="btn-group pull-left">\n        <button type="button" class="btn btn-sm btn-info uib-datepicker-current" ng-click="select(\'today\', $event)" ng-disabled="isDisabled(\'today\')">{{ getText(\'current\') }}</button>\n        <button type="button" class="btn btn-sm btn-danger uib-clear" ng-click="select(null, $event)">{{ getText(\'clear\') }}</button>\n      </span>\n      <button type="button" class="btn btn-sm btn-success pull-right uib-close" ng-click="close($event)">{{ getText(\'close\') }}</button>\n    </li>\n  </ul>\n</div>\n')}]),angular.module("uib/template/datepicker/year.html",[]).run(["$templateCache",function(e){e.put("uib/template/datepicker/year.html",'<table role="grid" aria-labelledby="{{::uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left uib-left" ng-click="move(-1)" tabindex="-1"><i aria-hidden="true" class="glyphicon glyphicon-chevron-left"></i><span class="sr-only">previous</span></button></th>\n      <th colspan="{{::columns - 2}}"><button id="{{::uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm uib-title" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right uib-right" ng-click="move(1)" tabindex="-1"><i aria-hidden="true" class="glyphicon glyphicon-chevron-right"></i><span class="sr-only">next</span></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr class="uib-years" ng-repeat="row in rows track by $index" role="row">\n      <td ng-repeat="dt in row" class="uib-year text-center" role="gridcell"\n        id="{{::dt.uid}}"\n        ng-class="::dt.customClass">\n        <button type="button" class="btn btn-default"\n          uib-is-class="\n            \'btn-info\' for selectedDt,\n            \'active\' for activeDt\n            on dt"\n          ng-click="select(dt.date)"\n          ng-disabled="::dt.disabled"\n          tabindex="-1"><span ng-class="::{\'text-info\': dt.current}">{{::dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("uib/template/datepickerPopup/popup.html",[]).run(["$templateCache",function(e){e.put("uib/template/datepickerPopup/popup.html",'<ul role="presentation" class="uib-datepicker-popup dropdown-menu uib-position-measure" dropdown-nested ng-if="isOpen" ng-keydown="keydown($event)" ng-click="$event.stopPropagation()">\n  <li ng-transclude></li>\n  <li ng-if="showButtonBar" class="uib-button-bar">\n    <span class="btn-group pull-left">\n      <button type="button" class="btn btn-sm btn-info uib-datepicker-current" ng-click="select(\'today\', $event)" ng-disabled="isDisabled(\'today\')">{{ getText(\'current\') }}</button>\n      <button type="button" class="btn btn-sm btn-danger uib-clear" ng-click="select(null, $event)">{{ getText(\'clear\') }}</button>\n    </span>\n    <button type="button" class="btn btn-sm btn-success pull-right uib-close" ng-click="close($event)">{{ getText(\'close\') }}</button>\n  </li>\n</ul>\n')}]),angular.module("uib/template/modal/backdrop.html",[]).run(["$templateCache",function(e){e.put("uib/template/modal/backdrop.html",'<div class="modal-backdrop"\n     uib-modal-animation-class="fade"\n     modal-in-class="in"\n     ng-style="{\'z-index\': 1040 + (index && 1 || 0) + index*10}"\n></div>\n')}]),angular.module("uib/template/modal/window.html",[]).run(["$templateCache",function(e){e.put("uib/template/modal/window.html","<div class=\"modal-dialog {{size ? 'modal-' + size : ''}}\"><div class=\"modal-content\" uib-modal-transclude></div></div>\n")}]),angular.module("uib/template/pager/pager.html",[]).run(["$templateCache",function(e){e.put("uib/template/pager/pager.html",'<li ng-class="{disabled: noPrevious()||ngDisabled, previous: align}"><a href ng-click="selectPage(page - 1, $event)" ng-disabled="noPrevious()||ngDisabled" uib-tabindex-toggle>{{::getText(\'previous\')}}</a></li>\n<li ng-class="{disabled: noNext()||ngDisabled, next: align}"><a href ng-click="selectPage(page + 1, $event)" ng-disabled="noNext()||ngDisabled" uib-tabindex-toggle>{{::getText(\'next\')}}</a></li>\n')}]),angular.module("uib/template/pagination/pagination.html",[]).run(["$templateCache",function(e){e.put("uib/template/pagination/pagination.html",'<li role="menuitem" ng-if="::boundaryLinks" ng-class="{disabled: noPrevious()||ngDisabled}" class="pagination-first"><a href ng-click="selectPage(1, $event)" ng-disabled="noPrevious()||ngDisabled" uib-tabindex-toggle>{{::getText(\'first\')}}</a></li>\n<li role="menuitem" ng-if="::directionLinks" ng-class="{disabled: noPrevious()||ngDisabled}" class="pagination-prev"><a href ng-click="selectPage(page - 1, $event)" ng-disabled="noPrevious()||ngDisabled" uib-tabindex-toggle>{{::getText(\'previous\')}}</a></li>\n<li role="menuitem" ng-repeat="page in pages track by $index" ng-class="{active: page.active,disabled: ngDisabled&&!page.active}" class="pagination-page"><a href ng-click="selectPage(page.number, $event)" ng-disabled="ngDisabled&&!page.active" uib-tabindex-toggle>{{page.text}}</a></li>\n<li role="menuitem" ng-if="::directionLinks" ng-class="{disabled: noNext()||ngDisabled}" class="pagination-next"><a href ng-click="selectPage(page + 1, $event)" ng-disabled="noNext()||ngDisabled" uib-tabindex-toggle>{{::getText(\'next\')}}</a></li>\n<li role="menuitem" ng-if="::boundaryLinks" ng-class="{disabled: noNext()||ngDisabled}" class="pagination-last"><a href ng-click="selectPage(totalPages, $event)" ng-disabled="noNext()||ngDisabled" uib-tabindex-toggle>{{::getText(\'last\')}}</a></li>\n')}]),angular.module("uib/template/tooltip/tooltip-html-popup.html",[]).run(["$templateCache",function(e){e.put("uib/template/tooltip/tooltip-html-popup.html",'<div class="tooltip-arrow"></div>\n<div class="tooltip-inner" ng-bind-html="contentExp()"></div>\n')}]),angular.module("uib/template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function(e){e.put("uib/template/tooltip/tooltip-popup.html",'<div class="tooltip-arrow"></div>\n<div class="tooltip-inner" ng-bind="content"></div>\n')}]),angular.module("uib/template/tooltip/tooltip-template-popup.html",[]).run(["$templateCache",function(e){e.put("uib/template/tooltip/tooltip-template-popup.html",'<div class="tooltip-arrow"></div>\n<div class="tooltip-inner"\n  uib-tooltip-template-transclude="contentExp()"\n  tooltip-template-transclude-scope="originScope()"></div>\n')}]),angular.module("uib/template/popover/popover-html.html",[]).run(["$templateCache",function(e){e.put("uib/template/popover/popover-html.html",'<div class="arrow"></div>\n\n<div class="popover-inner">\n    <h3 class="popover-title" ng-bind="uibTitle" ng-if="uibTitle"></h3>\n    <div class="popover-content" ng-bind-html="contentExp()"></div>\n</div>\n')}]),angular.module("uib/template/popover/popover-template.html",[]).run(["$templateCache",function(e){e.put("uib/template/popover/popover-template.html",'<div class="arrow"></div>\n\n<div class="popover-inner">\n    <h3 class="popover-title" ng-bind="uibTitle" ng-if="uibTitle"></h3>\n    <div class="popover-content"\n      uib-tooltip-template-transclude="contentExp()"\n      tooltip-template-transclude-scope="originScope()"></div>\n</div>\n')}]),angular.module("uib/template/popover/popover.html",[]).run(["$templateCache",function(e){e.put("uib/template/popover/popover.html",'<div class="arrow"></div>\n\n<div class="popover-inner">\n    <h3 class="popover-title" ng-bind="uibTitle" ng-if="uibTitle"></h3>\n    <div class="popover-content" ng-bind="content"></div>\n</div>\n')}]),angular.module("uib/template/progressbar/bar.html",[]).run(["$templateCache",function(e){e.put("uib/template/progressbar/bar.html",'<div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: (percent < 100 ? percent : 100) + \'%\'}" aria-valuetext="{{percent | number:0}}%" aria-labelledby="{{::title}}" ng-transclude></div>\n')}]),angular.module("uib/template/progressbar/progress.html",[]).run(["$templateCache",function(e){e.put("uib/template/progressbar/progress.html",'<div class="progress" ng-transclude aria-labelledby="{{::title}}"></div>')}]),angular.module("uib/template/progressbar/progressbar.html",[]).run(["$templateCache",function(e){e.put("uib/template/progressbar/progressbar.html",'<div class="progress">\n  <div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: (percent < 100 ? percent : 100) + \'%\'}" aria-valuetext="{{percent | number:0}}%" aria-labelledby="{{::title}}" ng-transclude></div>\n</div>\n')}]),angular.module("uib/template/rating/rating.html",[]).run(["$templateCache",function(e){e.put("uib/template/rating/rating.html",'<span ng-mouseleave="reset()" ng-keydown="onKeydown($event)" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="{{range.length}}" aria-valuenow="{{value}}" aria-valuetext="{{title}}">\n    <span ng-repeat-start="r in range track by $index" class="sr-only">({{ $index < value ? \'*\' : \' \' }})</span>\n    <i ng-repeat-end ng-mouseenter="enter($index + 1)" ng-click="rate($index + 1)" class="glyphicon" ng-class="$index < value && (r.stateOn || \'glyphicon-star\') || (r.stateOff || \'glyphicon-star-empty\')" ng-attr-title="{{r.title}}"></i>\n</span>\n')}]),angular.module("uib/template/tabs/tab.html",[]).run(["$templateCache",function(e){e.put("uib/template/tabs/tab.html",'<li ng-class="[{active: active, disabled: disabled}, classes]" class="uib-tab nav-item">\n  <a href ng-click="select($event)" class="nav-link" uib-tab-heading-transclude>{{heading}}</a>\n</li>\n')}]),angular.module("uib/template/tabs/tabset.html",[]).run(["$templateCache",function(e){e.put("uib/template/tabs/tabset.html",'<div>\n  <ul class="nav nav-{{tabset.type || \'tabs\'}}" ng-class="{\'nav-stacked\': vertical, \'nav-justified\': justified}" ng-transclude></ul>\n  <div class="tab-content">\n    <div class="tab-pane"\n         ng-repeat="tab in tabset.tabs"\n         ng-class="{active: tabset.active === tab.index}"\n         uib-tab-content-transclude="tab">\n    </div>\n  </div>\n</div>\n')}]),angular.module("uib/template/timepicker/timepicker.html",[]).run(["$templateCache",function(e){e.put("uib/template/timepicker/timepicker.html",'<table class="uib-timepicker">\n  <tbody>\n    <tr class="text-center" ng-show="::showSpinners">\n      <td class="uib-increment hours"><a ng-click="incrementHours()" ng-class="{disabled: noIncrementHours()}" class="btn btn-link" ng-disabled="noIncrementHours()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n      <td>&nbsp;</td>\n      <td class="uib-increment minutes"><a ng-click="incrementMinutes()" ng-class="{disabled: noIncrementMinutes()}" class="btn btn-link" ng-disabled="noIncrementMinutes()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n      <td ng-show="showSeconds">&nbsp;</td>\n      <td ng-show="showSeconds" class="uib-increment seconds"><a ng-click="incrementSeconds()" ng-class="{disabled: noIncrementSeconds()}" class="btn btn-link" ng-disabled="noIncrementSeconds()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n      <td ng-show="showMeridian"></td>\n    </tr>\n    <tr>\n      <td class="form-group uib-time hours" ng-class="{\'has-error\': invalidHours}">\n        <input type="text" placeholder="HH" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-readonly="::readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementHours()" ng-blur="blur()">\n      </td>\n      <td class="uib-separator">:</td>\n      <td class="form-group uib-time minutes" ng-class="{\'has-error\': invalidMinutes}">\n        <input type="text" placeholder="MM" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="::readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementMinutes()" ng-blur="blur()">\n      </td>\n      <td ng-show="showSeconds" class="uib-separator">:</td>\n      <td class="form-group uib-time seconds" ng-class="{\'has-error\': invalidSeconds}" ng-show="showSeconds">\n        <input type="text" placeholder="SS" ng-model="seconds" ng-change="updateSeconds()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementSeconds()" ng-blur="blur()">\n      </td>\n      <td ng-show="showMeridian" class="uib-time am-pm"><button type="button" ng-class="{disabled: noToggleMeridian()}" class="btn btn-default text-center" ng-click="toggleMeridian()" ng-disabled="noToggleMeridian()" tabindex="{{::tabindex}}">{{meridian}}</button></td>\n    </tr>\n    <tr class="text-center" ng-show="::showSpinners">\n      <td class="uib-decrement hours"><a ng-click="decrementHours()" ng-class="{disabled: noDecrementHours()}" class="btn btn-link" ng-disabled="noDecrementHours()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n      <td>&nbsp;</td>\n      <td class="uib-decrement minutes"><a ng-click="decrementMinutes()" ng-class="{disabled: noDecrementMinutes()}" class="btn btn-link" ng-disabled="noDecrementMinutes()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n      <td ng-show="showSeconds">&nbsp;</td>\n      <td ng-show="showSeconds" class="uib-decrement seconds"><a ng-click="decrementSeconds()" ng-class="{disabled: noDecrementSeconds()}" class="btn btn-link" ng-disabled="noDecrementSeconds()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n      <td ng-show="showMeridian"></td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("uib/template/typeahead/typeahead-match.html",[]).run(["$templateCache",function(e){e.put("uib/template/typeahead/typeahead-match.html",'<a href\n   tabindex="-1"\n   ng-bind-html="match.label | uibTypeaheadHighlight:query"\n   ng-attr-title="{{match.label}}"></a>\n')}]),angular.module("uib/template/typeahead/typeahead-popup.html",[]).run(["$templateCache",function(e){e.put("uib/template/typeahead/typeahead-popup.html",'<ul class="dropdown-menu" ng-show="isOpen() && !moveInProgress" ng-style="{top: position().top+\'px\', left: position().left+\'px\'}" role="listbox" aria-hidden="{{!isOpen()}}">\n    <li class="uib-typeahead-match" ng-repeat="match in matches track by $index" ng-class="{active: isActive($index) }" ng-mouseenter="selectActive($index)" ng-click="selectMatch($index, $event)" role="option" id="{{::match.id}}">\n        <div uib-typeahead-match index="$index" match="match" query="query" template-url="templateUrl"></div>\n    </li>\n</ul>\n')}]),angular.module("ui.bootstrap.carousel").run(function(){!angular.$$csp().noInlineStyle&&!angular.$$uibCarouselCss&&angular.element(document).find("head").prepend('<style type="text/css">.ng-animate.item:not(.left):not(.right){-webkit-transition:0s ease-in-out left;transition:0s ease-in-out left}</style>'),angular.$$uibCarouselCss=!0}),angular.module("ui.bootstrap.datepicker").run(function(){!angular.$$csp().noInlineStyle&&!angular.$$uibDatepickerCss&&angular.element(document).find("head").prepend('<style type="text/css">.uib-datepicker .uib-title{width:100%;}.uib-day button,.uib-month button,.uib-year button{min-width:100%;}.uib-left,.uib-right{width:100%}</style>'),angular.$$uibDatepickerCss=!0}),angular.module("ui.bootstrap.position").run(function(){!angular.$$csp().noInlineStyle&&!angular.$$uibPositionCss&&angular.element(document).find("head").prepend('<style type="text/css">.uib-position-measure{display:block !important;visibility:hidden !important;position:absolute !important;top:-9999px !important;left:-9999px !important;}.uib-position-scrollbar-measure{position:absolute !important;top:-9999px !important;width:50px !important;height:50px !important;overflow:scroll !important;}.uib-position-body-scrollbar-measure{overflow:scroll !important;}</style>'),angular.$$uibPositionCss=!0}),angular.module("ui.bootstrap.datepickerPopup").run(function(){!angular.$$csp().noInlineStyle&&!angular.$$uibDatepickerpopupCss&&angular.element(document).find("head").prepend('<style type="text/css">.uib-datepicker-popup.dropdown-menu{display:block;float:none;margin:0;}.uib-button-bar{padding:10px 9px 2px;}</style>'),angular.$$uibDatepickerpopupCss=!0}),angular.module("ui.bootstrap.tooltip").run(function(){!angular.$$csp().noInlineStyle&&!angular.$$uibTooltipCss&&angular.element(document).find("head").prepend('<style type="text/css">[uib-tooltip-popup].tooltip.top-left > .tooltip-arrow,[uib-tooltip-popup].tooltip.top-right > .tooltip-arrow,[uib-tooltip-popup].tooltip.bottom-left > .tooltip-arrow,[uib-tooltip-popup].tooltip.bottom-right > .tooltip-arrow,[uib-tooltip-popup].tooltip.left-top > .tooltip-arrow,[uib-tooltip-popup].tooltip.left-bottom > .tooltip-arrow,[uib-tooltip-popup].tooltip.right-top > .tooltip-arrow,[uib-tooltip-popup].tooltip.right-bottom > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.top-left > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.top-right > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.bottom-left > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.bottom-right > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.left-top > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.left-bottom > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.right-top > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.right-bottom > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.top-left > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.top-right > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.bottom-left > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.bottom-right > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.left-top > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.left-bottom > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.right-top > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.right-bottom > .tooltip-arrow,[uib-popover-popup].popover.top-left > .arrow,[uib-popover-popup].popover.top-right > .arrow,[uib-popover-popup].popover.bottom-left > .arrow,[uib-popover-popup].popover.bottom-right > .arrow,[uib-popover-popup].popover.left-top > .arrow,[uib-popover-popup].popover.left-bottom > .arrow,[uib-popover-popup].popover.right-top > .arrow,[uib-popover-popup].popover.right-bottom > .arrow,[uib-popover-html-popup].popover.top-left > .arrow,[uib-popover-html-popup].popover.top-right > .arrow,[uib-popover-html-popup].popover.bottom-left > .arrow,[uib-popover-html-popup].popover.bottom-right > .arrow,[uib-popover-html-popup].popover.left-top > .arrow,[uib-popover-html-popup].popover.left-bottom > .arrow,[uib-popover-html-popup].popover.right-top > .arrow,[uib-popover-html-popup].popover.right-bottom > .arrow,[uib-popover-template-popup].popover.top-left > .arrow,[uib-popover-template-popup].popover.top-right > .arrow,[uib-popover-template-popup].popover.bottom-left > .arrow,[uib-popover-template-popup].popover.bottom-right > .arrow,[uib-popover-template-popup].popover.left-top > .arrow,[uib-popover-template-popup].popover.left-bottom > .arrow,[uib-popover-template-popup].popover.right-top > .arrow,[uib-popover-template-popup].popover.right-bottom > .arrow{top:auto;bottom:auto;left:auto;right:auto;margin:0;}[uib-popover-popup].popover,[uib-popover-html-popup].popover,[uib-popover-template-popup].popover{display:block !important;}</style>'),angular.$$uibTooltipCss=!0}),angular.module("ui.bootstrap.timepicker").run(function(){!angular.$$csp().noInlineStyle&&!angular.$$uibTimepickerCss&&angular.element(document).find("head").prepend('<style type="text/css">.uib-time input{width:50px;}</style>'),angular.$$uibTimepickerCss=!0}),angular.module("ui.bootstrap.typeahead").run(function(){!angular.$$csp().noInlineStyle&&!angular.$$uibTypeaheadCss&&angular.element(document).find("head").prepend('<style type="text/css">[uib-typeahead-popup].dropdown-menu{display:block;}</style>'),angular.$$uibTypeaheadCss=!0}),function(e,t){t.module("ui.bootstrap.contextMenu",[]).service("CustomService",function(){return{initialize:function(e){}}}).constant("ContextMenuEvents",{ContextMenuAllClosed:"context-menu-all-closed",ContextMenuClosed:"context-menu-closed",ContextMenuOpening:"context-menu-opening",ContextMenuOpened:"context-menu-opened"}).directive("contextMenu",["$rootScope","ContextMenuEvents","$parse","$q","CustomService","$sce","$document","$window","$compile",function(n,o,r,i,a,s,l,c,p){var u=[],d=null,f='"New Item',h="empty";function m(n){var o=function(e){var n=e.item;return n.children?t.isFunction(n.children)?n.children():t.isFunction(n.children.then)||t.isArray(n.children)?n.children:null:t.isArray(n[1])||n[1]&&t.isFunction(n[1].then)?n[1]:t.isArray(n[2])||n[2]&&t.isFunction(n[2].then)?n[2]:t.isArray(n[3])||n[3]&&t.isFunction(n[3].then)?n[3]:null}(n),r=t.extend({},n),a=n.item,s=void 0===a.enabled?a[2]:a.enabled;r.nestedMenu=o,r.enabled=$(s,n),r.text=function(n){var o=n.$scope,r=n.item,a=n.event,s=n.modelValue,l=n.$promises,c=n.nestedMenu,u=n.$li,d="left"===String(n.orientation).toLowerCase(),h=null;if(r.html)h=t.isFunction(r.html)?r.html(o):r.compile?p(r.html)(o):r.html;else{var m=e("<a>"),g={};d?(g.textAlign="right",g.paddingLeft="8px"):(g.textAlign="left",g.paddingRight="8px"),m.css(g),m.addClass("dropdown-item"),m.attr({tabindex:"-1",href:"#"});var v=r.text||r[0],b=f;"string"==typeof v?b=v:"function"==typeof v&&(b=v.call(o,o,a,s));var y=i.when(b);l.push(y),y.then(function(t){if(c){var n,o={fontFamily:"monospace",fontWeight:"bold"};d?(n="&lt;",o.float="left"):(n="&gt;",o.float="right");var r=e('<strong style="font-family:monospace;font-weight:bold;float:right;">'+n+"</strong>");r.css(o),m.css("cursor","default"),m.append(r)}m.append(t)}),h=m}return u.append(h),h}(r),function(n){var o=n.item,r=n.$ul,a=n.$li,s=n.$scope,l=n.modelValue,c=n.level,p=n.event,u=n.text,d=n.nestedMenu,f=n.enabled,h=String(n.orientation).toLowerCase(),m=n.customClass;if(f){a.on("click",function(n){1==n.which&&(n.preventDefault(),s.$apply(function(){var n=function(){e(p.currentTarget).removeClass("context"),w()},r=t.isFunction(o.click)?o.click:t.isFunction(o[1])?o[1]:null;if(r){var i=r.call(s,s,p,l,u,a);(void 0===i||i)&&n()}else n()}))}),a.on("mouseover",function(e){s.$apply(function(){d?function(e){v(c+1);var n={pageX:"left"===h?p.pageX-r[0].offsetWidth+1:p.pageX+r[0].offsetWidth-1,pageY:r[0].offsetTop+a[0].offsetTop-3,view:p.view||window,target:p.target,event:e};i.when(d).then(function(e){t.isFunction(e)&&(e=e.call(s,s,p,l,u,a));var o={$scope:s,event:n,options:e,modelValue:l,level:c+1,orientation:h,customClass:m};g(o)})}(e):v(c+1)})})}else _(a)}(r)}function g(r){r.$scope,r.event;var s=r.options,p=(r.modelValue,r.level,r.customClass,function(t){var n=t.customClass,o=e("<ul>");o.addClass("dropdown-menu"),o.attr({role:"menu"}),o.css({display:"block",position:"absolute",left:t.event.pageX+"px",top:t.event.pageY+"px","z-index":1e4}),n&&o.addClass(n);return o}(r));r.$ul=p,u.push(p);if(r.$promises=[],t.forEach(s,function(n){if(null===n)C(p);else if($(n.displayed,r)){var o=e("<li>"),i=t.extend({},r);i.item=n,i.$li=o,"object"==typeof n[0]?a.initialize(o,n):m(i),$(n.hasTopDivider,i,!1)&&C(p),p.append(o),$(n.hasBottomDivider,i,!1)&&C(p)}}),0===p.children().length){var f=t.element("<li>");_(f),f.html("<a>"+h+"</a>"),p.append(f)}l.find("body").append(p),function(e){var n=e.$ul,o=e.$promises,r=e.level,a=e.event,s="left"===String(e.orientation).toLowerCase();i.all(o).then(function(){var e=a.pageY,o=t.element(n[0]).prop("offsetHeight"),i=c.pageYOffset+a.view.innerHeight;if(e>o&&i-e<o+20)e=a.pageY-o,r&&r>0&&(e+=a.event.currentTarget.offsetHeight);else if(i<=o)t.element(n[0]).css({height:i-5,"overflow-y":"scroll"}),e=0;else if(i-e<o){var l=5;e<l&&(l=e),e=i-o-l}var p=a.pageX,u=t.element(n[0]).prop("offsetWidth"),d=a.view.innerWidth+window.pageXOffset;if(s)if(d-p>u&&p<u+5)p=5;else if(p<u){var f=5;d-p<f+5&&(f=d-p+5),p=u+f+5}else p-=u;else if(p>u&&d-p-5<u)p=d-u-5;else if(d-p<u){var f=5;p<f+5&&(f=p+5),p=d-u-f-5}n.css({display:"block",position:"absolute",left:p+"px",top:e+"px"})})}(r),n.$broadcast(o.ContextMenuOpened,{context:d,contextMenu:p,params:r})}function v(e){for(;u.length&&(!e||u.length>e);){var t=u.pop();n.$broadcast(o.ContextMenuClosed,{context:d,contextMenu:t}),t.remove()}e||n.$broadcast(o.ContextMenuAllClosed,{context:d})}function b(e){w(e)}function y(t){for(var n=e(t.target),o=!0;n.length;){if(n.hasClass("dropdown-menu")){o=!1;break}n=n.parent()}o&&w(t)}function w(t){l.find("body").off("mousedown touchstart",y),l.off("scroll",b),e(d).removeClass("context"),v(),n.$broadcast("")}function x(e){return!1===e||!0===e}function $(e,n,o){n.item;var r=n.$scope,i=n.event,a=n.modelValue;return o=!x(o)||o,x(e)?e:t.isFunction(e)?e.call(r,r,i,a):o}function C(e){var n=t.element("<li>");n.addClass("divider"),e.append(n)}function _(e){e.on("click",function(e){e.preventDefault()}),e.addClass("disabled")}return function(r,a,s){var c=["contextmenu"];h=r.$eval(s.contextMenuEmptyText)||"empty",s.contextMenuOn&&"string"==typeof s.contextMenuOn&&(c=s.contextMenuOn.split(",")),t.forEach(c,function(c){a.on(c.trim(),function(c){if(w(),s.allowEventPropagation||(c.stopPropagation(),c.preventDefault()),("ontouchstart"in window||navigator.maxTouchPoints)&&"true"===a.attr("draggable"))return!1;l.find("body").on("mousedown touchstart",y),l.on("scroll",b),d=c.currentTarget,e(d).addClass("context"),r.$apply(function(){var e=r.$eval(s.contextMenu),a=s.contextMenuClass,l=r.$eval(s.model),p=s.contextMenuOrientation;i.when(e).then(function(e){t.isFunction(e)&&(e=e.call(r,r,c,l));var i={$scope:r,event:c,options:e,modelValue:l,level:0,customClass:a,orientation:p};n.$broadcast(o.ContextMenuOpening,{context:d}),g(i)})}),r.$on("$destroy",function(){w()})})}),s.closeMenuOn&&r.$on(s.closeMenuOn,function(){w()})}}])}(window.angular.element,window.angular),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@uirouter/core")):"function"==typeof define&&define.amd?define(["exports","@uirouter/core"],t):t((e=e||self)["@uirouter/sticky-states"]={},e["@uirouter/core"])}(this,function(e,t){var n,o=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=function(e){return function(t){return t.state.parent===e.state}},i=function(e){return e.parent?i(e.parent).concat(e):[e]},a=function(e){return function(n){return e.map(function(e){return function(e){var t=e.state;return function(e){return-1!==i(e.state).indexOf(t)}}(e)(n)}).reduce(t.anyTrueR,!1)}},s=function(e){return function(t){return e.find(function(e){return e.state==t.state})}},l=function(e){return t.not(s(e))},c=function(e,n){var o,r,i=s(e)(n);if(!i)throw new Error("Could not find matching node for "+n.state.name+" in source path ["+e.map(function(e){return e.state.name}).join(", ")+"]");return t.extend((r=o=n,t.isFunction(r.clone)&&r.clone()||t.PathNode.clone(o)),{paramValues:i.paramValues})};var p=function(e){function n(t){var n=e.call(this)||this;return n.router=t,n.name="sticky-states",n._inactives=[],n.pluginAPI=t.transitionService._pluginapi,n._defineStickyPaths(),n._defineStickyEvents(),n._addCreateHook(),n._addStateCallbacks(),n._addDefaultTransitionOption(),n}return o(n,e),n.prototype.inactives=function(){return this._inactives.map(function(e){return e.state.self})},n.prototype._addCreateHook=function(){var e=this;this.router.transitionService.onCreate({},function(t){t._treeChanges=e._calculateStickyTreeChanges(t)},{priority:100})},n.prototype._defineStickyPaths=function(){this.pluginAPI._definePathType("inactivating",t.TransitionHookScope.STATE),this.pluginAPI._definePathType("reactivating",t.TransitionHookScope.STATE)},n.prototype._defineStickyEvents=function(){var e=this.pluginAPI._getPathTypes();this.pluginAPI._defineEvent("onInactivate",t.TransitionHookPhase.RUN,5,e.inactivating,!0),this.pluginAPI._defineEvent("onReactivate",t.TransitionHookPhase.RUN,35,e.reactivating)},n.prototype._addStateCallbacks=function(){this.router.transitionService.onInactivate({inactivating:function(e){return!!e.onInactivate}},function(e,t){return t.onInactivate(e,t)});this.router.transitionService.onReactivate({reactivating:function(e){return!!e.onReactivate}},function(e,t){return t.onReactivate(e,t)})},n.prototype._calculateExitSticky=function(e,n){var o=n.options().exitSticky||[];t.isArray(o)||(o=[o]);var r=n.router.stateService,i=o.map(t.assertMap(function(e){return r.get(e)},function(e){return"State not found: "+e})).map(function(e){return e.$$state()}),s=this._inactives.concat(e.inactivating).reduce(t.uniqR,[]),l=i.map(t.assertMap(function(e){return s.find(function(t){return t.state===e})},function(e){return"State not inactive: "+e})),c=s.filter(a(l));return c.map(t.assertMap(function(n){return!t.inArray(e.to,n)},function(e){return"Can not exit a sticky state that is currently active/activating: "+e.state.name})),c},n.prototype._calculateStickyTreeChanges=function(e){var n=this,o=this._inactives,i=e.treeChanges();i.inactivating=[],i.reactivating=[],i.entering.length&&i.exiting[0]&&i.exiting[0].state.sticky&&(i.inactivating=i.exiting,i.exiting=[]);var p=i.retained.concat(i.entering.map(s(o))).filter(t.identity),u=t.PathUtils.treeChanges(p,i.to,e.options().reloadState);if(["retained","entering","exiting"].some(function(e){return!!u[e].length})){var d=u.retained.slice(i.retained.length);i.reactivating=d.map(function(e){return c(i.to,e)}),i.entering=u.entering,i.exiting=i.exiting.concat(u.exiting);var f=i.retained.map(function(e){return c(i.to,e)});i.to=f.concat(i.reactivating).concat(i.entering)}var h,m=o.filter(r(t.tail(i.to))),g=o.filter((h=i.to,function(e){return h.map(function(t){return r(t)(e)}).reduce(t.anyTrueR,!1)})).filter(l(i.to)).filter(function(e){return!e.state.sticky}),v=m.concat(g).filter(l(i.exiting)),b=i.exiting.concat(v),y=o.filter(a(b)).filter(l(b)).concat(v).reduce(t.uniqR,[]).sort(function(e){return function(t,n){var o=t.state.path.length-n.state.path.length;return 0!==o?o:e.indexOf(n)-e.indexOf(t)}}(o));i.exiting=y.concat(i.exiting),e.onSuccess({},function(){i.exiting.map(s(o)).forEach(t.removeFrom(o)),i.entering.map(s(o)).forEach(t.removeFrom(o)),i.reactivating.map(s(o)).forEach(t.removeFrom(o)),i.inactivating.forEach(t.pushTo(n._inactives))});var w=this._calculateExitSticky(i,e);return w.filter(function(e){return!s(i.exiting)(e)}).forEach(t.pushTo(i.exiting)),w.filter(s(i.inactivating)).forEach(t.removeFrom(i.inactivating)),i},n.prototype._addDefaultTransitionOption=function(){t.defaultTransOpts.exitSticky=[]},n.prototype.exitSticky=function(e){var n=this.router.stateService;return void 0===e&&(e=this._inactives.map(function(e){return e.state.name})),t.isString(e)&&(e=[e]),n.go(n.current,{},{inherit:!0,exitSticky:e})},n}(t.UIRouterPluginBase);e.StickyStatesPlugin=p,Object.defineProperty(e,"__esModule",{value:!0})}),function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).JSZip=e()}(function(){return function e(t,n,o){function r(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var p=n[a]={exports:{}};t[a][0].call(p.exports,function(e){return r(t[a][1][e]||e)},p,p.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,t,n){var o=e("./utils"),r=e("./support"),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,r,a,s,l,c,p=[],u=0,d=e.length,f=d,h="string"!==o.getTypeOf(e);u<e.length;)f=d-u,r=h?(t=e[u++],n=u<d?e[u++]:0,u<d?e[u++]:0):(t=e.charCodeAt(u++),n=u<d?e.charCodeAt(u++):0,u<d?e.charCodeAt(u++):0),a=t>>2,s=(3&t)<<4|n>>4,l=1<f?(15&n)<<2|r>>6:64,c=2<f?63&r:64,p.push(i.charAt(a)+i.charAt(s)+i.charAt(l)+i.charAt(c));return p.join("")},n.decode=function(e){var t,n,o,a,s,l,c=0,p=0,u="data:";if(e.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");var d,f=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===i.charAt(64)&&f--,e.charAt(e.length-2)===i.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(d=r.uint8array?new Uint8Array(0|f):new Array(0|f);c<e.length;)t=i.indexOf(e.charAt(c++))<<2|(a=i.indexOf(e.charAt(c++)))>>4,n=(15&a)<<4|(s=i.indexOf(e.charAt(c++)))>>2,o=(3&s)<<6|(l=i.indexOf(e.charAt(c++))),d[p++]=t,64!==s&&(d[p++]=n),64!==l&&(d[p++]=o);return d}},{"./support":30,"./utils":32}],2:[function(e,t,n){var o=e("./external"),r=e("./stream/DataWorker"),i=e("./stream/DataLengthProbe"),a=e("./stream/Crc32Probe");function s(e,t,n,o,r){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=o,this.compressedContent=r}i=e("./stream/DataLengthProbe"),s.prototype={getContentWorker:function(){var e=new r(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new i("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new r(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,n){return e.pipe(new a).pipe(new i("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new i("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){var o=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(e){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){var o=e("./utils"),r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var o=0;o<8;o++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==o.getTypeOf(e)?function(e,t,n,o){var i=r,a=0+n;e^=-1;for(var s=0;s<a;s++)e=e>>>8^i[255&(e^t[s])];return-1^e}(0|t,e,e.length):function(e,t,n,o){var i=r,a=0+n;e^=-1;for(var s=0;s<a;s++)e=e>>>8^i[255&(e^t.charCodeAt(s))];return-1^e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,n){n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){var o;o="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:o}},{lie:37}],7:[function(e,t,n){var o="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,r=e("pako"),i=e("./utils"),a=e("./stream/GenericWorker"),s=o?"uint8array":"array";function l(e,t){a.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}n.magic="\b\0",i.inherits(l,a),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(i.transformTo(s,e.data),!1)},l.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new l("Deflate",e)},n.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){function o(e,t){var n,o="";for(n=0;n<t;n++)o+=String.fromCharCode(255&e),e>>>=8;return o}function r(e,t,n,r,a,p){var u,d,f=e.file,h=e.compression,m=p!==s.utf8encode,g=i.transformTo("string",p(f.name)),v=i.transformTo("string",s.utf8encode(f.name)),b=f.comment,y=i.transformTo("string",p(b)),w=i.transformTo("string",s.utf8encode(b)),x=v.length!==f.name.length,$=w.length!==b.length,C="",_="",k="",S=f.dir,T=f.date,I={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(I.crc32=e.crc32,I.compressedSize=e.compressedSize,I.uncompressedSize=e.uncompressedSize);var E=0;t&&(E|=8),m||!x&&!$||(E|=2048);var N=0,O=0;S&&(N|=16),"UNIX"===a?(O=798,N|=function(e,t){var n=e;return e||(n=S?16893:33204),(65535&n)<<16}(f.unixPermissions)):(O=20,N|=63&(f.dosPermissions||0)),u=T.getUTCHours(),u<<=6,u|=T.getUTCMinutes(),u<<=5,u|=T.getUTCSeconds()/2,d=T.getUTCFullYear()-1980,d<<=4,d|=T.getUTCMonth()+1,d<<=5,d|=T.getUTCDate(),x&&(C+="up"+o((_=o(1,1)+o(l(g),4)+v).length,2)+_),$&&(C+="uc"+o((k=o(1,1)+o(l(y),4)+w).length,2)+k);var D="";return D+="\n\0",D+=o(E,2),D+=h.magic,D+=o(u,2),D+=o(d,2),D+=o(I.crc32,4),D+=o(I.compressedSize,4),D+=o(I.uncompressedSize,4),D+=o(g.length,2),D+=o(C.length,2),{fileRecord:c.LOCAL_FILE_HEADER+D+g+C,dirRecord:c.CENTRAL_FILE_HEADER+o(O,2)+D+o(y.length,2)+"\0\0\0\0"+o(N,4)+o(r,4)+g+C+y}}var i=e("../utils"),a=e("../stream/GenericWorker"),s=e("../utf8"),l=e("../crc32"),c=e("../signature");function p(e,t,n,o){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=o,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}i.inherits(p,a),p.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,o=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,a.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-o-1))/n:100}}))},p.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=r(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=r(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:function(e){return c.DATA_DESCRIPTOR+o(e.crc32,4)+o(e.compressedSize,4)+o(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=this.bytesWritten-e,r=function(e,t,n,r,a){var s=i.transformTo("string",a(r));return c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(e,2)+o(e,2)+o(t,4)+o(n,4)+o(s.length,2)+s}(this.dirRecords.length,n,e,this.zipComment,this.encodeFileName);this.push({data:r,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},p.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},p.prototype.error=function(e){var t=this._sources;if(!a.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(e){}return!0},p.prototype.lock=function(){a.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=p},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){var o=e("../compressions"),r=e("./ZipFileWorker");n.generateWorker=function(e,t,n){var i=new r(t.streamFiles,n,t.platform,t.encodeFileName),a=0;try{e.forEach(function(e,n){a++;var r=function(e,t){var n=e||t,r=o[n];if(!r)throw new Error(n+" is not a valid compression method !");return r}(n.options.compression,t.compression),s=n.options.compressionOptions||t.compressionOptions||{},l=n.dir,c=n.date;n._compressWorker(r,s).withStreamInfo("file",{name:e,dir:l,date:c,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(i)}),i.entriesCount=a}catch(e){i.error(e)}return i}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var e=new o;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(o.prototype=e("./object")).loadAsync=e("./load"),o.support=e("./support"),o.defaults=e("./defaults"),o.version="3.5.0",o.loadAsync=function(e,t){return(new o).loadAsync(e,t)},o.external=e("./external"),t.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){var o=e("./utils"),r=e("./external"),i=e("./utf8"),a=(o=e("./utils"),e("./zipEntries")),s=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function c(e){return new r.Promise(function(t,n){var o=e.decompressed.getContentWorker().pipe(new s);o.on("error",function(e){n(e)}).on("end",function(){o.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}t.exports=function(e,t){var n=this;return t=o.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:i.utf8decode}),l.isNode&&l.isStream(e)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var n=new a(t);return n.load(e),n}).then(function(e){var n=[r.Promise.resolve(e)],o=e.files;if(t.checkCRC32)for(var i=0;i<o.length;i++)n.push(c(o[i]));return r.Promise.all(n)}).then(function(e){for(var o=e.shift(),r=o.files,i=0;i<r.length;i++){var a=r[i];n.file(a.fileNameStr,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileCommentStr.length?a.fileCommentStr:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:t.createFolders})}return o.zipComment.length&&(n.comment=o.zipComment),n})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){var o=e("../utils"),r=e("../stream/GenericWorker");function i(e,t){r.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}o.inherits(i,r),i.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},i.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},i.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=i},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){var o=e("readable-stream").Readable;function r(e,t,n){o.call(this,t),this._helper=e;var r=this;e.on("data",function(e,t){r.push(e)||r._helper.pause(),n&&n(t)}).on("error",function(e){r.emit("error",e)}).on("end",function(){r.push(null)})}e("../utils").inherits(r,o),r.prototype._read=function(){this._helper.resume()},t.exports=r},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){function o(e,t,n){var o,r=i.getTypeOf(t),s=i.extend(n||{},l);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(e=m(e)),s.createFolders&&(o=h(e))&&g.call(this,o,!0);var u="string"===r&&!1===s.binary&&!1===s.base64;n&&void 0!==n.binary||(s.binary=!u),(t instanceof c&&0===t.uncompressedSize||s.dir||!t||0===t.length)&&(s.base64=!1,s.binary=!0,t="",s.compression="STORE",r="string");var v;v=t instanceof c||t instanceof a?t:d.isNode&&d.isStream(t)?new f(e,t):i.prepareContent(e,t,s.binary,s.optimizedBinaryString,s.base64);var b=new p(e,v,s);this.files[e]=b}var r=e("./utf8"),i=e("./utils"),a=e("./stream/GenericWorker"),s=e("./stream/StreamHelper"),l=e("./defaults"),c=e("./compressedObject"),p=e("./zipObject"),u=e("./generate"),d=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),h=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:l.createFolders,e=m(e),this.files[e]||o.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function v(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var b={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,o;for(t in this.files)this.files.hasOwnProperty(t)&&(o=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,o))},filter:function(e){var t=[];return this.forEach(function(n,o){e(n,o)&&t.push(o)}),t},file:function(e,t,n){if(1!==arguments.length)return e=this.root+e,o.call(this,e,t,n),this;if(v(e)){var r=e;return this.filter(function(e,t){return!t.dir&&r.test(e)})}var i=this.files[this.root+e];return i&&!i.dir?i:null},folder:function(e){if(!e)return this;if(v(e))return this.filter(function(t,n){return n.dir&&e.test(t)});var t=this.root+e,n=g.call(this,t),o=this.clone();return o.root=n.name,o},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e}),o=0;o<n.length;o++)delete this.files[n[o].name];return this},generate:function(e){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=i.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");i.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var o=n.comment||this.comment||"";t=u.generateWorker(this,n,o)}catch(e){(t=new a("error")).error(e)}return new s(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=b},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){var o=e("./DataReader");function r(e){o.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(r,o),r.prototype.byteAt=function(e){return this.data[this.zero+e]},r.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),o=e.charCodeAt(2),r=e.charCodeAt(3),i=this.length-4;0<=i;--i)if(this.data[i]===t&&this.data[i+1]===n&&this.data[i+2]===o&&this.data[i+3]===r)return i-this.zero;return-1},r.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),o=e.charCodeAt(2),r=e.charCodeAt(3),i=this.readData(4);return t===i[0]&&n===i[1]&&o===i[2]&&r===i[3]},r.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){var o=e("../utils");function r(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return o.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readAndCheckSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=r},{"../utils":32}],19:[function(e,t,n){var o=e("./Uint8ArrayReader");function r(e){o.call(this,e)}e("../utils").inherits(r,o),r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){var o=e("./DataReader");function r(e){o.call(this,e)}e("../utils").inherits(r,o),r.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},r.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},r.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){var o=e("./ArrayReader");function r(e){o.call(this,e)}e("../utils").inherits(r,o),r.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){var o=e("../utils"),r=e("../support"),i=e("./ArrayReader"),a=e("./StringReader"),s=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=o.getTypeOf(e);return o.checkSupport(t),"string"!==t||r.uint8array?"nodebuffer"===t?new s(e):r.uint8array?new l(o.transformTo("uint8array",e)):new i(o.transformTo("array",e)):new a(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,n){var o=e("./GenericWorker"),r=e("../utils");function i(e){o.call(this,"ConvertWorker to "+e),this.destType=e}r.inherits(i,o),i.prototype.processChunk=function(e){this.push({data:r.transformTo(this.destType,e.data),meta:e.meta})},t.exports=i},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){var o=e("./GenericWorker"),r=e("../crc32");function i(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(i,o),i.prototype.processChunk=function(e){this.streamInfo.crc32=r(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=i},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){var o=e("../utils"),r=e("./GenericWorker");function i(e){r.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}o.inherits(i,r),i.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}r.prototype.processChunk.call(this,e)},t.exports=i},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){var o=e("../utils"),r=e("./GenericWorker");function i(e){r.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=o.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}o.inherits(i,r),i.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},i.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},i.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},i.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=i},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){function o(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=o},{}],29:[function(e,t,n){var o=e("../utils"),r=e("./ConvertWorker"),i=e("./GenericWorker"),a=e("../base64"),s=e("../support"),l=e("../external"),c=null;if(s.nodestream)try{c=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function p(e,t,n){var a=t;switch(t){case"blob":case"arraybuffer":a="uint8array";break;case"base64":a="string"}try{this._internalType=a,this._outputType=t,this._mimeType=n,o.checkSupport(a),this._worker=e.pipe(new r(a)),e.lock()}catch(e){this._worker=new i("error"),this._worker.error(e)}}p.prototype={accumulate:function(e){return function(e,t){return new l.Promise(function(n,r){var i=[],s=e._internalType,l=e._outputType,c=e._mimeType;e.on("data",function(e,n){i.push(e),t&&t(n)}).on("error",function(e){i=[],r(e)}).on("end",function(){try{var e=function(e,t,n){switch(e){case"blob":return o.newBlob(o.transformTo("arraybuffer",t),n);case"base64":return a.encode(t);default:return o.transformTo(e,t)}}(l,function(e,t){var n,o=0,r=null,i=0;for(n=0;n<t.length;n++)i+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(r=new Uint8Array(i),n=0;n<t.length;n++)r.set(t[n],o),o+=t[n].length;return r;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(s,i),c);n(e)}catch(e){r(e)}i=[]}).resume()})}(this,e)},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,function(e){t.call(n,e.data,e.meta)}):this._worker.on(e,function(){o.delay(t,arguments,n)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(o.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var o=new ArrayBuffer(0);try{n.blob=0===new Blob([o],{type:"application/zip"}).size}catch(e){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(o),n.blob=0===r.getBlob("application/zip").size}catch(e){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(e){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){for(var o=e("./utils"),r=e("./support"),i=e("./nodejsUtils"),a=e("./stream/GenericWorker"),s=new Array(256),l=0;l<256;l++)s[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){a.call(this,"utf-8 decode"),this.leftOver=null}function p(){a.call(this,"utf-8 encode")}s[254]=s[254]=1,n.utf8encode=function(e){return r.nodebuffer?i.newBufferFrom(e,"utf-8"):function(e){var t,n,o,i,a,s=e.length,l=0;for(i=0;i<s;i++)55296==(64512&(n=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(o=e.charCodeAt(i+1)))&&(n=65536+(n-55296<<10)+(o-56320),i++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=r.uint8array?new Uint8Array(l):new Array(l),i=a=0;a<l;i++)55296==(64512&(n=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(o=e.charCodeAt(i+1)))&&(n=65536+(n-55296<<10)+(o-56320),i++),n<128?t[a++]=n:(n<2048?t[a++]=192|n>>>6:(n<65536?t[a++]=224|n>>>12:(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63),t[a++]=128|n>>>6&63),t[a++]=128|63&n);return t}(e)},n.utf8decode=function(e){return r.nodebuffer?o.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,r,i,a=e.length,l=new Array(2*a);for(t=n=0;t<a;)if((r=e[t++])<128)l[n++]=r;else if(4<(i=s[r]))l[n++]=65533,t+=i-1;else{for(r&=2===i?31:3===i?15:7;1<i&&t<a;)r=r<<6|63&e[t++],i--;1<i?l[n++]=65533:r<65536?l[n++]=r:(r-=65536,l[n++]=55296|r>>10&1023,l[n++]=56320|1023&r)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),o.applyFromCharCode(l)}(e=o.transformTo(r.uint8array?"uint8array":"array",e))},o.inherits(c,a),c.prototype.processChunk=function(e){var t=o.transformTo(r.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var i=t;(t=new Uint8Array(i.length+this.leftOver.length)).set(this.leftOver,0),t.set(i,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var a=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0?t:0===n?t:n+s[e[n]]>t?n:t}(t),l=t;a!==t.length&&(r.uint8array?(l=t.subarray(0,a),this.leftOver=t.subarray(a,t.length)):(l=t.slice(0,a),this.leftOver=t.slice(a,t.length))),this.push({data:n.utf8decode(l),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=c,o.inherits(p,a),p.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=p},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){var o=e("./support"),r=e("./base64"),i=e("./nodejsUtils"),a=e("set-immediate-shim"),s=e("./external");function l(e){return e}function c(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}n.newBlob=function(e,t){n.checkSupport("blob");try{return new Blob([e],{type:t})}catch(n){try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return o.append(e),o.getBlob(t)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(e,t,n){var o=[],r=0,i=e.length;if(i<=n)return String.fromCharCode.apply(null,e);for(;r<i;)"array"===t||"nodebuffer"===t?o.push(String.fromCharCode.apply(null,e.slice(r,Math.min(r+n,i)))):o.push(String.fromCharCode.apply(null,e.subarray(r,Math.min(r+n,i)))),r+=n;return o.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&1===String.fromCharCode.apply(null,i.allocBuffer(1)).length}catch(e){return!1}}()}};function u(e){var t=65536,o=n.getTypeOf(e),r=!0;if("uint8array"===o?r=p.applyCanBeUsed.uint8array:"nodebuffer"===o&&(r=p.applyCanBeUsed.nodebuffer),r)for(;1<t;)try{return p.stringifyByChunk(e,o,t)}catch(e){t=Math.floor(t/2)}return p.stringifyByChar(e)}function d(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}n.applyFromCharCode=u;var f={};f.string={string:l,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return f.string.uint8array(e).buffer},uint8array:function(e){return c(e,new Uint8Array(e.length))},nodebuffer:function(e){return c(e,i.allocBuffer(e.length))}},f.array={string:u,array:l,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return i.newBufferFrom(e)}},f.arraybuffer={string:function(e){return u(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:l,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return i.newBufferFrom(new Uint8Array(e))}},f.uint8array={string:u,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:l,nodebuffer:function(e){return i.newBufferFrom(e)}},f.nodebuffer={string:u,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return f.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:l},n.transformTo=function(e,t){if(t=t||"",!e)return t;n.checkSupport(e);var o=n.getTypeOf(t);return f[o][e](t)},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":o.nodebuffer&&i.isBuffer(e)?"nodebuffer":o.uint8array&&e instanceof Uint8Array?"uint8array":o.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!o[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,o="";for(n=0;n<(e||"").length;n++)o+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return o},n.delay=function(e,t,n){a(function(){e.apply(n||null,t||[])})},n.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,i,a,l){return s.Promise.resolve(t).then(function(e){return o.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new s.Promise(function(t,n){var o=new FileReader;o.onload=function(e){t(e.target.result)},o.onerror=function(e){n(e.target.error)},o.readAsArrayBuffer(e)}):e}).then(function(t){var p=n.getTypeOf(t);return p?("arraybuffer"===p?t=n.transformTo("uint8array",t):"string"===p&&(l?t=r.decode(t):i&&!0!==a&&(t=function(e){return c(e,o.uint8array?new Uint8Array(e.length):new Array(e.length))}(t))),t):s.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(e,t,n){var o=e("./reader/readerFor"),r=e("./utils"),i=e("./signature"),a=e("./zipEntry"),s=(e("./utf8"),e("./support"));function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(t)+", expected "+r.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var o=this.reader.readString(4)===t;return this.reader.setIndex(n),o},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",n=r.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,o=this.zip64EndOfCentralSize-44;0<o;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(i.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(i.CENTRAL_FILE_HEADER);)(e=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(i.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,i.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(i.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,i.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var o=t-n;if(0<o)this.isSignature(t,i.CENTRAL_FILE_HEADER)||(this.reader.zero=o);else if(o<0)throw new Error("Corrupted zip: missing "+Math.abs(o)+" bytes.")},prepareReader:function(e){this.reader=o(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){var o=e("./reader/readerFor"),r=e("./utils"),i=e("./compressedObject"),a=e("./crc32"),s=e("./utf8"),l=e("./compressions"),c=e("./support");function p(e,t){this.options=e,this.loadOptions=t}p.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(l.hasOwnProperty(t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new i(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var t=o(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(e){var t,n,o,r=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<r;)t=e.readInt(2),n=e.readInt(2),o=e.readData(n),this.extraFields[t]={id:t,length:n,value:o};e.setIndex(r)},handleUTF8:function(){var e=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=r.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var o=this.findExtraFieldUnicodeComment();if(null!==o)this.fileCommentStr=o;else{var i=r.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(i)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=o(e.value);return 1!==t.readInt(1)?null:a(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=o(e.value);return 1!==t.readInt(1)?null:a(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},t.exports=p},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){function o(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var r=e("./stream/StreamHelper"),i=e("./stream/DataWorker"),a=e("./utf8"),s=e("./compressedObject"),l=e("./stream/GenericWorker");o.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var o="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var i=!this._dataBinary;i&&!o&&(t=t.pipe(new a.Utf8EncodeWorker)),!i&&o&&(t=t.pipe(new a.Utf8DecodeWorker))}catch(e){(t=new l("error")).error(e)}return new r(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof s&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new a.Utf8EncodeWorker)),s.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof l?this._data:new i(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],p=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<c.length;u++)o.prototype[c[u]]=p;t.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,n){(function(e){var n,o,r=e.MutationObserver||e.WebKitMutationObserver;if(r){var i=0,a=new r(p),s=e.document.createTextNode("");a.observe(s,{characterData:!0}),n=function(){s.data=i=++i%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){p(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(p,0)};else{var l=new e.MessageChannel;l.port1.onmessage=p,n=function(){l.port2.postMessage(0)}}var c=[];function p(){var e,t;o=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}o=!1}t.exports=function(e){1!==c.push(e)||o||n()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,n){var o=e("immediate");function r(){}var i={},a=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==r&&f(this,e)}function p(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function u(e,t,n){o(function(){var o;try{o=t(n)}catch(o){return i.reject(e,o)}o===e?i.reject(e,new TypeError("Cannot resolve promise with itself")):i.resolve(e,o)})}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var n=!1;function o(t){n||(n=!0,i.reject(e,t))}function r(t){n||(n=!0,i.resolve(e,t))}var a=h(function(){t(r,o)});"error"===a.status&&o(a.value)}function h(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}(t.exports=c).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===a)return this;var n=new this.constructor(r);return this.state!==l?u(n,this.state===s?e:t,this.outcome):this.queue.push(new p(n,e,t)),n},p.prototype.callFulfilled=function(e){i.resolve(this.promise,e)},p.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},p.prototype.callRejected=function(e){i.reject(this.promise,e)},p.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},i.resolve=function(e,t){var n=h(d,t);if("error"===n.status)return i.reject(e,n.value);var o=n.value;if(o)f(e,o);else{e.state=s,e.outcome=t;for(var r=-1,a=e.queue.length;++r<a;)e.queue[r].callFulfilled(t)}return e},i.reject=function(e,t){e.state=a,e.outcome=t;for(var n=-1,o=e.queue.length;++n<o;)e.queue[n].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:i.resolve(new this(r),e)},c.reject=function(e){var t=new this(r);return i.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,o=!1;if(!n)return this.resolve([]);for(var a=new Array(n),s=0,l=-1,c=new this(r);++l<n;)p(e[l],l);return c;function p(e,r){t.resolve(e).then(function(e){a[r]=e,++s!==n||o||(o=!0,i.resolve(c,a))},function(e){o||(o=!0,i.reject(c,e))})}},c.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,n=!1;if(!t)return this.resolve([]);for(var o,a=-1,s=new this(r);++a<t;)o=e[a],this.resolve(o).then(function(e){n||(n=!0,i.resolve(s,e))},function(e){n||(n=!0,i.reject(s,e))});return s}},{immediate:36}],38:[function(e,t,n){var o={};(0,e("./lib/utils/common").assign)(o,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){var o=e("./zlib/deflate"),r=e("./utils/common"),i=e("./utils/strings"),a=e("./zlib/messages"),s=e("./zlib/zstream"),l=Object.prototype.toString,c=0,p=-1,u=0,d=8;function f(e){if(!(this instanceof f))return new f(e);this.options=r.assign({level:p,method:d,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=o.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==c)throw new Error(a[n]);if(t.header&&o.deflateSetHeader(this.strm,t.header),t.dictionary){var h;if(h="string"==typeof t.dictionary?i.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=o.deflateSetDictionary(this.strm,h))!==c)throw new Error(a[n]);this._dict_set=!0}}function h(e,t){var n=new f(t);if(n.push(e,!0),n.err)throw n.msg||a[n.err];return n.result}f.prototype.push=function(e,t){var n,a,s=this.strm,p=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=i.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new r.Buf8(p),s.next_out=0,s.avail_out=p),1!==(n=o.deflate(s,a))&&n!==c)return this.onEnd(n),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(i.buf2binstring(r.shrinkBuf(s.output,s.next_out))):this.onData(r.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==n);return 4===a?(n=o.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===c):2!==a||(this.onEnd(c),!(s.avail_out=0))},f.prototype.onData=function(e){this.chunks.push(e)},f.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=f,n.deflate=h,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,h(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){var o=e("./zlib/inflate"),r=e("./utils/common"),i=e("./utils/strings"),a=e("./zlib/constants"),s=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),p=Object.prototype.toString;function u(e){if(!(this instanceof u))return new u(e);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=o.inflateInit2(this.strm,t.windowBits);if(n!==a.Z_OK)throw new Error(s[n]);this.header=new c,o.inflateGetHeader(this.strm,this.header)}function d(e,t){var n=new u(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}u.prototype.push=function(e,t){var n,s,l,c,u,d,f=this.strm,h=this.options.chunkSize,m=this.options.dictionary,g=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?f.input=i.binstring2buf(e):"[object ArrayBuffer]"===p.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new r.Buf8(h),f.next_out=0,f.avail_out=h),(n=o.inflate(f,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&m&&(d="string"==typeof m?i.string2buf(m):"[object ArrayBuffer]"===p.call(m)?new Uint8Array(m):m,n=o.inflateSetDictionary(this.strm,d)),n===a.Z_BUF_ERROR&&!0===g&&(n=a.Z_OK,g=!1),n!==a.Z_STREAM_END&&n!==a.Z_OK)return this.onEnd(n),!(this.ended=!0);f.next_out&&(0!==f.avail_out&&n!==a.Z_STREAM_END&&(0!==f.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=i.utf8border(f.output,f.next_out),c=f.next_out-l,u=i.buf2string(f.output,l),f.next_out=c,f.avail_out=h-c,c&&r.arraySet(f.output,f.output,l,c,0),this.onData(u)):this.onData(r.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(g=!0)}while((0<f.avail_in||0===f.avail_out)&&n!==a.Z_STREAM_END);return n===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(n=o.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),!(f.avail_out=0))},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=u,n.inflate=d,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},n.ungzip=d},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){var o="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,o,r){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+o),r);else for(var i=0;i<o;i++)e[r+i]=t[n+i]},flattenChunks:function(e){var t,n,o,r,i,a;for(t=o=0,n=e.length;t<n;t++)o+=e[t].length;for(a=new Uint8Array(o),t=r=0,n=e.length;t<n;t++)i=e[t],a.set(i,r),r+=i.length;return a}},i={arraySet:function(e,t,n,o,r){for(var i=0;i<o;i++)e[r+i]=t[n+i]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,r)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,i))},n.setTyped(o)},{}],42:[function(e,t,n){var o=e("./common"),r=!0,i=!0;try{String.fromCharCode.apply(null,[0])}catch(e){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){i=!1}for(var a=new o.Buf8(256),s=0;s<256;s++)a[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function l(e,t){if(t<65537&&(e.subarray&&i||!e.subarray&&r))return String.fromCharCode.apply(null,o.shrinkBuf(e,t));for(var n="",a=0;a<t;a++)n+=String.fromCharCode(e[a]);return n}a[254]=a[254]=1,n.string2buf=function(e){var t,n,r,i,a,s=e.length,l=0;for(i=0;i<s;i++)55296==(64512&(n=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(r=e.charCodeAt(i+1)))&&(n=65536+(n-55296<<10)+(r-56320),i++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new o.Buf8(l),i=a=0;a<l;i++)55296==(64512&(n=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(r=e.charCodeAt(i+1)))&&(n=65536+(n-55296<<10)+(r-56320),i++),n<128?t[a++]=n:(n<2048?t[a++]=192|n>>>6:(n<65536?t[a++]=224|n>>>12:(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63),t[a++]=128|n>>>6&63),t[a++]=128|63&n);return t},n.buf2binstring=function(e){return l(e,e.length)},n.binstring2buf=function(e){for(var t=new o.Buf8(e.length),n=0,r=t.length;n<r;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,o,r,i,s=t||e.length,c=new Array(2*s);for(n=o=0;n<s;)if((r=e[n++])<128)c[o++]=r;else if(4<(i=a[r]))c[o++]=65533,n+=i-1;else{for(r&=2===i?31:3===i?15:7;1<i&&n<s;)r=r<<6|63&e[n++],i--;1<i?c[o++]=65533:r<65536?c[o++]=r:(r-=65536,c[o++]=55296|r>>10&1023,c[o++]=56320|1023&r)}return l(c,o)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0?t:0===n?t:n+a[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){t.exports=function(e,t,n,o){for(var r=65535&e|0,i=e>>>16&65535|0,a=0;0!==n;){for(n-=a=2e3<n?2e3:n;i=i+(r=r+t[o++]|0)|0,--a;);r%=65521,i%=65521}return r|i<<16|0}},{}],44:[function(e,t,n){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){var o=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var o=0;o<8;o++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,r){var i=o,a=r+n;e^=-1;for(var s=r;s<a;s++)e=e>>>8^i[255&(e^t[s])];return-1^e}},{}],46:[function(e,t,n){var o,r=e("../utils/common"),i=e("./trees"),a=e("./adler32"),s=e("./crc32"),l=e("./messages"),c=0,p=4,u=0,d=-2,f=-1,h=4,m=2,g=8,v=9,b=286,y=30,w=19,x=2*b+1,$=15,C=3,_=258,k=_+C+1,S=42,T=113,I=1,E=2,N=3,O=4;function D(e,t){return e.msg=l[t],t}function P(e){return(e<<1)-(4<e?9:0)}function A(e){for(var t=e.length;0<=--t;)e[t]=0}function M(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(r.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function U(e,t){i._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,M(e.strm)}function R(e,t){e.pending_buf[e.pending++]=t}function L(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function z(e,t){var n,o,r=e.max_chain_length,i=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-k?e.strstart-(e.w_size-k):0,c=e.window,p=e.w_mask,u=e.prev,d=e.strstart+_,f=c[i+a-1],h=c[i+a];e.prev_length>=e.good_match&&(r>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(n=t)+a]===h&&c[n+a-1]===f&&c[n]===c[i]&&c[++n]===c[i+1]){i+=2,n++;do{}while(c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&i<d);if(o=_-(d-i),i=d-_,a<o){if(e.match_start=t,s<=(a=o))break;f=c[i+a-1],h=c[i+a]}}}while((t=u[t&p])>l&&0!=--r);return a<=e.lookahead?a:e.lookahead}function F(e){var t,n,o,i,l,c,p,u,d,f,h=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=h+(h-k)){for(r.arraySet(e.window,e.window,h,h,0),e.match_start-=h,e.strstart-=h,e.block_start-=h,t=n=e.hash_size;o=e.head[--t],e.head[t]=h<=o?o-h:0,--n;);for(t=n=h;o=e.prev[--t],e.prev[t]=h<=o?o-h:0,--n;);i+=h}if(0===e.strm.avail_in)break;if(c=e.strm,p=e.window,u=e.strstart+e.lookahead,f=void 0,(d=i)<(f=c.avail_in)&&(f=d),n=0===f?0:(c.avail_in-=f,r.arraySet(p,c.input,c.next_in,f,u),1===c.state.wrap?c.adler=a(c.adler,p,f,u):2===c.state.wrap&&(c.adler=s(c.adler,p,f,u)),c.next_in+=f,c.total_in+=f,f),e.lookahead+=n,e.lookahead+e.insert>=C)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+C-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<C)););}while(e.lookahead<k&&0!==e.strm.avail_in)}function j(e,t){for(var n,o;;){if(e.lookahead<k){if(F(e),e.lookahead<k&&t===c)return I;if(0===e.lookahead)break}if(n=0,e.lookahead>=C&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+C-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-k&&(e.match_length=z(e,n)),e.match_length>=C)if(o=i._tr_tally(e,e.strstart-e.match_start,e.match_length-C),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=C){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+C-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else o=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(o&&(U(e,!1),0===e.strm.avail_out))return I}return e.insert=e.strstart<C-1?e.strstart:C-1,t===p?(U(e,!0),0===e.strm.avail_out?N:O):e.last_lit&&(U(e,!1),0===e.strm.avail_out)?I:E}function B(e,t){for(var n,o,r;;){if(e.lookahead<k){if(F(e),e.lookahead<k&&t===c)return I;if(0===e.lookahead)break}if(n=0,e.lookahead>=C&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+C-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=C-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-k&&(e.match_length=z(e,n),e.match_length<=5&&(1===e.strategy||e.match_length===C&&4096<e.strstart-e.match_start)&&(e.match_length=C-1)),e.prev_length>=C&&e.match_length<=e.prev_length){for(r=e.strstart+e.lookahead-C,o=i._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-C),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+C-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=C-1,e.strstart++,o&&(U(e,!1),0===e.strm.avail_out))return I}else if(e.match_available){if((o=i._tr_tally(e,0,e.window[e.strstart-1]))&&U(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return I}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(o=i._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<C-1?e.strstart:C-1,t===p?(U(e,!0),0===e.strm.avail_out?N:O):e.last_lit&&(U(e,!1),0===e.strm.avail_out)?I:E}function G(e,t,n,o,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=o,this.func=r}function H(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*x),this.dyn_dtree=new r.Buf16(2*(2*y+1)),this.bl_tree=new r.Buf16(2*(2*w+1)),A(this.dyn_ltree),A(this.dyn_dtree),A(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16($+1),this.heap=new r.Buf16(2*b+1),A(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*b+1),A(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function V(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=m,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?S:T,e.adler=2===t.wrap?0:1,t.last_flush=c,i._tr_init(t),u):D(e,d)}function Y(e){var t=V(e);return t===u&&function(e){e.window_size=2*e.w_size,A(e.head),e.max_lazy_match=o[e.level].max_lazy,e.good_match=o[e.level].good_length,e.nice_match=o[e.level].nice_length,e.max_chain_length=o[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=C-1,e.match_available=0,e.ins_h=0}(e.state),t}function q(e,t,n,o,i,a){if(!e)return d;var s=1;if(t===f&&(t=6),o<0?(s=0,o=-o):15<o&&(s=2,o-=16),i<1||v<i||n!==g||o<8||15<o||t<0||9<t||a<0||h<a)return D(e,d);8===o&&(o=9);var l=new H;return(e.state=l).strm=e,l.wrap=s,l.gzhead=null,l.w_bits=o,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=i+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+C-1)/C),l.window=new r.Buf8(2*l.w_size),l.head=new r.Buf16(l.hash_size),l.prev=new r.Buf16(l.w_size),l.lit_bufsize=1<<i+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new r.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=n,Y(e)}o=[new G(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(F(e),0===e.lookahead&&t===c)return I;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var o=e.block_start+n;if((0===e.strstart||e.strstart>=o)&&(e.lookahead=e.strstart-o,e.strstart=o,U(e,!1),0===e.strm.avail_out))return I;if(e.strstart-e.block_start>=e.w_size-k&&(U(e,!1),0===e.strm.avail_out))return I}return e.insert=0,t===p?(U(e,!0),0===e.strm.avail_out?N:O):(e.strstart>e.block_start&&(U(e,!1),e.strm.avail_out),I)}),new G(4,4,8,4,j),new G(4,5,16,8,j),new G(4,6,32,32,j),new G(4,4,16,16,B),new G(8,16,32,32,B),new G(8,16,128,128,B),new G(8,32,128,256,B),new G(32,128,258,1024,B),new G(32,258,258,4096,B)],n.deflateInit=function(e,t){return q(e,t,g,15,8,0)},n.deflateInit2=q,n.deflateReset=Y,n.deflateResetKeep=V,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?d:(e.state.gzhead=t,u):d},n.deflate=function(e,t){var n,r,a,l;if(!e||!e.state||5<t||t<0)return e?D(e,d):d;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||666===r.status&&t!==p)return D(e,0===e.avail_out?-5:d);if(r.strm=e,n=r.last_flush,r.last_flush=t,r.status===S)if(2===r.wrap)e.adler=0,R(r,31),R(r,139),R(r,8),r.gzhead?(R(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),R(r,255&r.gzhead.time),R(r,r.gzhead.time>>8&255),R(r,r.gzhead.time>>16&255),R(r,r.gzhead.time>>24&255),R(r,9===r.level?2:2<=r.strategy||r.level<2?4:0),R(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(R(r,255&r.gzhead.extra.length),R(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=s(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(R(r,0),R(r,0),R(r,0),R(r,0),R(r,0),R(r,9===r.level?2:2<=r.strategy||r.level<2?4:0),R(r,3),r.status=T);else{var f=g+(r.w_bits-8<<4)<<8;f|=(2<=r.strategy||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(f|=32),f+=31-f%31,r.status=T,L(r,f),0!==r.strstart&&(L(r,e.adler>>>16),L(r,65535&e.adler)),e.adler=1}if(69===r.status)if(r.gzhead.extra){for(a=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),M(e),a=r.pending,r.pending!==r.pending_buf_size));)R(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),M(e),a=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,R(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),0===l&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),M(e),a=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,R(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),0===l&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&M(e),r.pending+2<=r.pending_buf_size&&(R(r,255&e.adler),R(r,e.adler>>8&255),e.adler=0,r.status=T)):r.status=T),0!==r.pending){if(M(e),0===e.avail_out)return r.last_flush=-1,u}else if(0===e.avail_in&&P(t)<=P(n)&&t!==p)return D(e,-5);if(666===r.status&&0!==e.avail_in)return D(e,-5);if(0!==e.avail_in||0!==r.lookahead||t!==c&&666!==r.status){var h=2===r.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(F(e),0===e.lookahead)){if(t===c)return I;break}if(e.match_length=0,n=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(U(e,!1),0===e.strm.avail_out))return I}return e.insert=0,t===p?(U(e,!0),0===e.strm.avail_out?N:O):e.last_lit&&(U(e,!1),0===e.strm.avail_out)?I:E}(r,t):3===r.strategy?function(e,t){for(var n,o,r,a,s=e.window;;){if(e.lookahead<=_){if(F(e),e.lookahead<=_&&t===c)return I;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=C&&0<e.strstart&&(o=s[r=e.strstart-1])===s[++r]&&o===s[++r]&&o===s[++r]){a=e.strstart+_;do{}while(o===s[++r]&&o===s[++r]&&o===s[++r]&&o===s[++r]&&o===s[++r]&&o===s[++r]&&o===s[++r]&&o===s[++r]&&r<a);e.match_length=_-(a-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=C?(n=i._tr_tally(e,1,e.match_length-C),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(U(e,!1),0===e.strm.avail_out))return I}return e.insert=0,t===p?(U(e,!0),0===e.strm.avail_out?N:O):e.last_lit&&(U(e,!1),0===e.strm.avail_out)?I:E}(r,t):o[r.level].func(r,t);if(h!==N&&h!==O||(r.status=666),h===I||h===N)return 0===e.avail_out&&(r.last_flush=-1),u;if(h===E&&(1===t?i._tr_align(r):5!==t&&(i._tr_stored_block(r,0,0,!1),3===t&&(A(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),M(e),0===e.avail_out))return r.last_flush=-1,u}return t!==p?u:r.wrap<=0?1:(2===r.wrap?(R(r,255&e.adler),R(r,e.adler>>8&255),R(r,e.adler>>16&255),R(r,e.adler>>24&255),R(r,255&e.total_in),R(r,e.total_in>>8&255),R(r,e.total_in>>16&255),R(r,e.total_in>>24&255)):(L(r,e.adler>>>16),L(r,65535&e.adler)),M(e),0<r.wrap&&(r.wrap=-r.wrap),0!==r.pending?u:1)},n.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==S&&69!==t&&73!==t&&91!==t&&103!==t&&t!==T&&666!==t?D(e,d):(e.state=null,t===T?D(e,-3):u):d},n.deflateSetDictionary=function(e,t){var n,o,i,s,l,c,p,f,h=t.length;if(!e||!e.state)return d;if(2===(s=(n=e.state).wrap)||1===s&&n.status!==S||n.lookahead)return d;for(1===s&&(e.adler=a(e.adler,t,h,0)),n.wrap=0,h>=n.w_size&&(0===s&&(A(n.head),n.strstart=0,n.block_start=0,n.insert=0),f=new r.Buf8(n.w_size),r.arraySet(f,t,h-n.w_size,n.w_size,0),t=f,h=n.w_size),l=e.avail_in,c=e.next_in,p=e.input,e.avail_in=h,e.next_in=0,e.input=t,F(n);n.lookahead>=C;){for(o=n.strstart,i=n.lookahead-(C-1);n.ins_h=(n.ins_h<<n.hash_shift^n.window[o+C-1])&n.hash_mask,n.prev[o&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=o,o++,--i;);n.strstart=o,n.lookahead=C-1,F(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=C-1,n.match_available=0,e.next_in=c,e.input=p,e.avail_in=l,n.wrap=s,u},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){t.exports=function(e,t){var n,o,r,i,a,s,l,c,p,u,d,f,h,m,g,v,b,y,w,x,$,C,_,k,S;n=e.state,o=e.next_in,k=e.input,r=o+(e.avail_in-5),i=e.next_out,S=e.output,a=i-(t-e.avail_out),s=i+(e.avail_out-257),l=n.dmax,c=n.wsize,p=n.whave,u=n.wnext,d=n.window,f=n.hold,h=n.bits,m=n.lencode,g=n.distcode,v=(1<<n.lenbits)-1,b=(1<<n.distbits)-1;e:do{h<15&&(f+=k[o++]<<h,h+=8,f+=k[o++]<<h,h+=8),y=m[f&v];t:for(;;){if(f>>>=w=y>>>24,h-=w,0==(w=y>>>16&255))S[i++]=65535&y;else{if(!(16&w)){if(0==(64&w)){y=m[(65535&y)+(f&(1<<w)-1)];continue t}if(32&w){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}x=65535&y,(w&=15)&&(h<w&&(f+=k[o++]<<h,h+=8),x+=f&(1<<w)-1,f>>>=w,h-=w),h<15&&(f+=k[o++]<<h,h+=8,f+=k[o++]<<h,h+=8),y=g[f&b];n:for(;;){if(f>>>=w=y>>>24,h-=w,!(16&(w=y>>>16&255))){if(0==(64&w)){y=g[(65535&y)+(f&(1<<w)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if($=65535&y,h<(w&=15)&&(f+=k[o++]<<h,(h+=8)<w&&(f+=k[o++]<<h,h+=8)),l<($+=f&(1<<w)-1)){e.msg="invalid distance too far back",n.mode=30;break e}if(f>>>=w,h-=w,(w=i-a)<$){if(p<(w=$-w)&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(_=d,(C=0)===u){if(C+=c-w,w<x){for(x-=w;S[i++]=d[C++],--w;);C=i-$,_=S}}else if(u<w){if(C+=c+u-w,(w-=u)<x){for(x-=w;S[i++]=d[C++],--w;);if(C=0,u<x){for(x-=w=u;S[i++]=d[C++],--w;);C=i-$,_=S}}}else if(C+=u-w,w<x){for(x-=w;S[i++]=d[C++],--w;);C=i-$,_=S}for(;2<x;)S[i++]=_[C++],S[i++]=_[C++],S[i++]=_[C++],x-=3;x&&(S[i++]=_[C++],1<x&&(S[i++]=_[C++]))}else{for(C=i-$;S[i++]=S[C++],S[i++]=S[C++],S[i++]=S[C++],2<(x-=3););x&&(S[i++]=S[C++],1<x&&(S[i++]=S[C++]))}break}}break}}while(o<r&&i<s);o-=x=h>>3,f&=(1<<(h-=x<<3))-1,e.next_in=o,e.next_out=i,e.avail_in=o<r?r-o+5:5-(o-r),e.avail_out=i<s?s-i+257:257-(i-s),n.hold=f,n.bits=h}},{}],49:[function(e,t,n){var o=e("../utils/common"),r=e("./adler32"),i=e("./crc32"),a=e("./inffast"),s=e("./inftrees"),l=1,c=2,p=0,u=-2,d=1,f=852,h=592;function m(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function g(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=d,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new o.Buf32(f),t.distcode=t.distdyn=new o.Buf32(h),t.sane=1,t.back=-1,p):u}function v(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,g(e)):u}function b(e,t){var n,o;return e&&e.state?(o=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?u:(null!==o.window&&o.wbits!==t&&(o.window=null),o.wrap=n,o.wbits=t,v(e))):u}function y(e,t){var n,r;return e?(r=new function(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0},(e.state=r).window=null,(n=b(e,t))!==p&&(e.state=null),n):u}var w,x,$=!0;function C(e){if($){var t;for(w=new o.Buf32(512),x=new o.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(l,e.lens,0,288,w,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(c,e.lens,0,32,x,0,e.work,{bits:5}),$=!1}e.lencode=w,e.lenbits=9,e.distcode=x,e.distbits=5}function _(e,t,n,r){var i,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new o.Buf8(a.wsize)),r>=a.wsize?(o.arraySet(a.window,t,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(r<(i=a.wsize-a.wnext)&&(i=r),o.arraySet(a.window,t,n-r,i,a.wnext),(r-=i)?(o.arraySet(a.window,t,n-r,r,0),a.wnext=r,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0}n.inflateReset=v,n.inflateReset2=b,n.inflateResetKeep=g,n.inflateInit=function(e){return y(e,15)},n.inflateInit2=y,n.inflate=function(e,t){var n,f,h,g,v,b,y,w,x,$,k,S,T,I,E,N,O,D,P,A,M,U,R,L,z=0,F=new o.Buf8(4),j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return u;12===(n=e.state).mode&&(n.mode=13),v=e.next_out,h=e.output,y=e.avail_out,g=e.next_in,f=e.input,b=e.avail_in,w=n.hold,x=n.bits,$=b,k=y,U=p;e:for(;;)switch(n.mode){case d:if(0===n.wrap){n.mode=13;break}for(;x<16;){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}if(2&n.wrap&&35615===w){F[n.check=0]=255&w,F[1]=w>>>8&255,n.check=i(n.check,F,2,0),x=w=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&w)<<8)+(w>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&w)){e.msg="unknown compression method",n.mode=30;break}if(x-=4,M=8+(15&(w>>>=4)),0===n.wbits)n.wbits=M;else if(M>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<M,e.adler=n.check=1,n.mode=512&w?10:12,x=w=0;break;case 2:for(;x<16;){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}if(n.flags=w,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=w>>8&1),512&n.flags&&(F[0]=255&w,F[1]=w>>>8&255,n.check=i(n.check,F,2,0)),x=w=0,n.mode=3;case 3:for(;x<32;){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}n.head&&(n.head.time=w),512&n.flags&&(F[0]=255&w,F[1]=w>>>8&255,F[2]=w>>>16&255,F[3]=w>>>24&255,n.check=i(n.check,F,4,0)),x=w=0,n.mode=4;case 4:for(;x<16;){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}n.head&&(n.head.xflags=255&w,n.head.os=w>>8),512&n.flags&&(F[0]=255&w,F[1]=w>>>8&255,n.check=i(n.check,F,2,0)),x=w=0,n.mode=5;case 5:if(1024&n.flags){for(;x<16;){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}n.length=w,n.head&&(n.head.extra_len=w),512&n.flags&&(F[0]=255&w,F[1]=w>>>8&255,n.check=i(n.check,F,2,0)),x=w=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(b<(S=n.length)&&(S=b),S&&(n.head&&(M=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),o.arraySet(n.head.extra,f,g,S,M)),512&n.flags&&(n.check=i(n.check,f,S,g)),b-=S,g+=S,n.length-=S),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===b)break e;for(S=0;M=f[g+S++],n.head&&M&&n.length<65536&&(n.head.name+=String.fromCharCode(M)),M&&S<b;);if(512&n.flags&&(n.check=i(n.check,f,S,g)),b-=S,g+=S,M)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===b)break e;for(S=0;M=f[g+S++],n.head&&M&&n.length<65536&&(n.head.comment+=String.fromCharCode(M)),M&&S<b;);if(512&n.flags&&(n.check=i(n.check,f,S,g)),b-=S,g+=S,M)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;x<16;){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}if(w!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}x=w=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;x<32;){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}e.adler=n.check=m(w),x=w=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=v,e.avail_out=y,e.next_in=g,e.avail_in=b,n.hold=w,n.bits=x,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){w>>>=7&x,x-=7&x,n.mode=27;break}for(;x<3;){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}switch(n.last=1&w,x-=1,3&(w>>>=1)){case 0:n.mode=14;break;case 1:if(C(n),n.mode=20,6!==t)break;w>>>=2,x-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}w>>>=2,x-=2;break;case 14:for(w>>>=7&x,x-=7&x;x<32;){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}if((65535&w)!=(w>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&w,x=w=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(S=n.length){if(b<S&&(S=b),y<S&&(S=y),0===S)break e;o.arraySet(h,f,g,S,v),b-=S,g+=S,y-=S,v+=S,n.length-=S;break}n.mode=12;break;case 17:for(;x<14;){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}if(n.nlen=257+(31&w),w>>>=5,x-=5,n.ndist=1+(31&w),w>>>=5,x-=5,n.ncode=4+(15&w),w>>>=4,x-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;x<3;){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}n.lens[j[n.have++]]=7&w,w>>>=3,x-=3}for(;n.have<19;)n.lens[j[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,R={bits:n.lenbits},U=s(0,n.lens,0,19,n.lencode,0,n.work,R),n.lenbits=R.bits,U){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;N=(z=n.lencode[w&(1<<n.lenbits)-1])>>>16&255,O=65535&z,!((E=z>>>24)<=x);){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}if(O<16)w>>>=E,x-=E,n.lens[n.have++]=O;else{if(16===O){for(L=E+2;x<L;){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}if(w>>>=E,x-=E,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}M=n.lens[n.have-1],S=3+(3&w),w>>>=2,x-=2}else if(17===O){for(L=E+3;x<L;){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}x-=E,M=0,S=3+(7&(w>>>=E)),w>>>=3,x-=3}else{for(L=E+7;x<L;){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}x-=E,M=0,S=11+(127&(w>>>=E)),w>>>=7,x-=7}if(n.have+S>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;S--;)n.lens[n.have++]=M}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,R={bits:n.lenbits},U=s(l,n.lens,0,n.nlen,n.lencode,0,n.work,R),n.lenbits=R.bits,U){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,R={bits:n.distbits},U=s(c,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,R),n.distbits=R.bits,U){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=b&&258<=y){e.next_out=v,e.avail_out=y,e.next_in=g,e.avail_in=b,n.hold=w,n.bits=x,a(e,k),v=e.next_out,h=e.output,y=e.avail_out,g=e.next_in,f=e.input,b=e.avail_in,w=n.hold,x=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;N=(z=n.lencode[w&(1<<n.lenbits)-1])>>>16&255,O=65535&z,!((E=z>>>24)<=x);){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}if(N&&0==(240&N)){for(D=E,P=N,A=O;N=(z=n.lencode[A+((w&(1<<D+P)-1)>>D)])>>>16&255,O=65535&z,!(D+(E=z>>>24)<=x);){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}w>>>=D,x-=D,n.back+=D}if(w>>>=E,x-=E,n.back+=E,n.length=O,0===N){n.mode=26;break}if(32&N){n.back=-1,n.mode=12;break}if(64&N){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&N,n.mode=22;case 22:if(n.extra){for(L=n.extra;x<L;){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}n.length+=w&(1<<n.extra)-1,w>>>=n.extra,x-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;N=(z=n.distcode[w&(1<<n.distbits)-1])>>>16&255,O=65535&z,!((E=z>>>24)<=x);){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}if(0==(240&N)){for(D=E,P=N,A=O;N=(z=n.distcode[A+((w&(1<<D+P)-1)>>D)])>>>16&255,O=65535&z,!(D+(E=z>>>24)<=x);){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}w>>>=D,x-=D,n.back+=D}if(w>>>=E,x-=E,n.back+=E,64&N){e.msg="invalid distance code",n.mode=30;break}n.offset=O,n.extra=15&N,n.mode=24;case 24:if(n.extra){for(L=n.extra;x<L;){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}n.offset+=w&(1<<n.extra)-1,w>>>=n.extra,x-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===y)break e;if(S=k-y,n.offset>S){if((S=n.offset-S)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}T=S>n.wnext?(S-=n.wnext,n.wsize-S):n.wnext-S,S>n.length&&(S=n.length),I=n.window}else I=h,T=v-n.offset,S=n.length;for(y<S&&(S=y),y-=S,n.length-=S;h[v++]=I[T++],--S;);0===n.length&&(n.mode=21);break;case 26:if(0===y)break e;h[v++]=n.length,y--,n.mode=21;break;case 27:if(n.wrap){for(;x<32;){if(0===b)break e;b--,w|=f[g++]<<x,x+=8}if(k-=y,e.total_out+=k,n.total+=k,k&&(e.adler=n.check=n.flags?i(n.check,h,k,v-k):r(n.check,h,k,v-k)),k=y,(n.flags?w:m(w))!==n.check){e.msg="incorrect data check",n.mode=30;break}x=w=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;x<32;){if(0===b)break e;b--,w+=f[g++]<<x,x+=8}if(w!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}x=w=0}n.mode=29;case 29:U=1;break e;case 30:U=-3;break e;case 31:return-4;case 32:default:return u}return e.next_out=v,e.avail_out=y,e.next_in=g,e.avail_in=b,n.hold=w,n.bits=x,(n.wsize||k!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&_(e,e.output,e.next_out,k-e.avail_out)?(n.mode=31,-4):($-=e.avail_in,k-=e.avail_out,e.total_in+=$,e.total_out+=k,n.total+=k,n.wrap&&k&&(e.adler=n.check=n.flags?i(n.check,h,k,e.next_out-k):r(n.check,h,k,e.next_out-k)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==$&&0===k||4===t)&&U===p&&(U=-5),U)},n.inflateEnd=function(e){if(!e||!e.state)return u;var t=e.state;return t.window&&(t.window=null),e.state=null,p},n.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?u:((n.head=t).done=!1,p):u},n.inflateSetDictionary=function(e,t){var n,o=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?u:11===n.mode&&r(1,t,o,0)!==n.check?-3:_(e,t,o,o)?(n.mode=31,-4):(n.havedict=1,p):u},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){var o=e("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,l,c,p,u,d){var f,h,m,g,v,b,y,w,x,$=d.bits,C=0,_=0,k=0,S=0,T=0,I=0,E=0,N=0,O=0,D=0,P=null,A=0,M=new o.Buf16(16),U=new o.Buf16(16),R=null,L=0;for(C=0;C<=15;C++)M[C]=0;for(_=0;_<l;_++)M[t[n+_]]++;for(T=$,S=15;1<=S&&0===M[S];S--);if(S<T&&(T=S),0===S)return c[p++]=20971520,c[p++]=20971520,d.bits=1,0;for(k=1;k<S&&0===M[k];k++);for(T<k&&(T=k),C=N=1;C<=15;C++)if(N<<=1,(N-=M[C])<0)return-1;if(0<N&&(0===e||1!==S))return-1;for(U[1]=0,C=1;C<15;C++)U[C+1]=U[C]+M[C];for(_=0;_<l;_++)0!==t[n+_]&&(u[U[t[n+_]]++]=_);if(b=0===e?(P=R=u,19):1===e?(P=r,A-=257,R=i,L-=257,256):(P=a,R=s,-1),C=k,v=p,E=_=D=0,m=-1,g=(O=1<<(I=T))-1,1===e&&852<O||2===e&&592<O)return 1;for(;;){for(y=C-E,x=u[_]<b?(w=0,u[_]):u[_]>b?(w=R[L+u[_]],P[A+u[_]]):(w=96,0),f=1<<C-E,k=h=1<<I;c[v+(D>>E)+(h-=f)]=y<<24|w<<16|x|0,0!==h;);for(f=1<<C-1;D&f;)f>>=1;if(0!==f?(D&=f-1,D+=f):D=0,_++,0==--M[C]){if(C===S)break;C=t[n+u[_]]}if(T<C&&(D&g)!==m){for(0===E&&(E=T),v+=k,N=1<<(I=C-E);I+E<S&&!((N-=M[I+E])<=0);)I++,N<<=1;if(O+=1<<I,1===e&&852<O||2===e&&592<O)return 1;c[m=D&g]=T<<24|I<<16|v-p|0}}return 0!==D&&(c[v+D]=C-E<<24|64<<16|0),d.bits=T,0}},{"../utils/common":41}],51:[function(e,t,n){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){var o=e("../utils/common");function r(e){for(var t=e.length;0<=--t;)e[t]=0}var i=0,a=256,s=a+1+29,l=30,c=19,p=2*s+1,u=15,d=16,f=256,h=16,m=17,g=18,v=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],b=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],w=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],x=new Array(2*(s+2));r(x);var $=new Array(2*l);r($);var C=new Array(512);r(C);var _=new Array(256);r(_);var k=new Array(29);r(k);var S,T,I,E=new Array(l);function N(e,t,n,o,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=o,this.max_length=r,this.has_stree=e&&e.length}function O(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function D(e){return e<256?C[e]:C[256+(e>>>7)]}function P(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function A(e,t,n){e.bi_valid>d-n?(e.bi_buf|=t<<e.bi_valid&65535,P(e,e.bi_buf),e.bi_buf=t>>d-e.bi_valid,e.bi_valid+=n-d):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function M(e,t,n){A(e,n[2*t],n[2*t+1])}function U(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function R(e,t,n){var o,r,i=new Array(u+1),a=0;for(o=1;o<=u;o++)i[o]=a=a+n[o-1]<<1;for(r=0;r<=t;r++){var s=e[2*r+1];0!==s&&(e[2*r]=U(i[s]++,s))}}function L(e){var t;for(t=0;t<s;t++)e.dyn_ltree[2*t]=0;for(t=0;t<l;t++)e.dyn_dtree[2*t]=0;for(t=0;t<c;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*f]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function z(e){8<e.bi_valid?P(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function F(e,t,n,o){var r=2*t,i=2*n;return e[r]<e[i]||e[r]===e[i]&&o[t]<=o[n]}function j(e,t,n){for(var o=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&F(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!F(t,o,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=o}function B(e,t,n){var o,r,i,s,l=0;if(0!==e.last_lit)for(;o=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],r=e.pending_buf[e.l_buf+l],l++,0===o?M(e,r,t):(M(e,(i=_[r])+a+1,t),0!==(s=v[i])&&A(e,r-=k[i],s),M(e,i=D(--o),n),0!==(s=b[i])&&A(e,o-=E[i],s)),l<e.last_lit;);M(e,f,t)}function G(e,t){var n,o,r,i=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=p,n=0;n<l;n++)0!==i[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):i[2*n+1]=0;for(;e.heap_len<2;)i[2*(r=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[r]=0,e.opt_len--,s&&(e.static_len-=a[2*r+1]);for(t.max_code=c,n=e.heap_len>>1;1<=n;n--)j(e,i,n);for(r=l;n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],j(e,i,1),o=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=o,i[2*r]=i[2*n]+i[2*o],e.depth[r]=(e.depth[n]>=e.depth[o]?e.depth[n]:e.depth[o])+1,i[2*n+1]=i[2*o+1]=r,e.heap[1]=r++,j(e,i,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,o,r,i,a,s,l=t.dyn_tree,c=t.max_code,d=t.stat_desc.static_tree,f=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,m=t.stat_desc.extra_base,g=t.stat_desc.max_length,v=0;for(i=0;i<=u;i++)e.bl_count[i]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<p;n++)g<(i=l[2*l[2*(o=e.heap[n])+1]+1]+1)&&(i=g,v++),l[2*o+1]=i,c<o||(e.bl_count[i]++,a=0,m<=o&&(a=h[o-m]),s=l[2*o],e.opt_len+=s*(i+a),f&&(e.static_len+=s*(d[2*o+1]+a)));if(0!==v){do{for(i=g-1;0===e.bl_count[i];)i--;e.bl_count[i]--,e.bl_count[i+1]+=2,e.bl_count[g]--,v-=2}while(0<v);for(i=g;0!==i;i--)for(o=e.bl_count[i];0!==o;)c<(r=e.heap[--n])||(l[2*r+1]!==i&&(e.opt_len+=(i-l[2*r+1])*l[2*r],l[2*r+1]=i),o--)}}(e,t),R(i,c,e.bl_count)}function H(e,t,n){var o,r,i=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(n+1)+1]=65535,o=0;o<=n;o++)r=a,a=t[2*(o+1)+1],++s<l&&r===a||(s<c?e.bl_tree[2*r]+=s:0!==r?(r!==i&&e.bl_tree[2*r]++,e.bl_tree[2*h]++):s<=10?e.bl_tree[2*m]++:e.bl_tree[2*g]++,i=r,c=(s=0)===a?(l=138,3):r===a?(l=6,3):(l=7,4))}function V(e,t,n){var o,r,i=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),o=0;o<=n;o++)if(r=a,a=t[2*(o+1)+1],!(++s<l&&r===a)){if(s<c)for(;M(e,r,e.bl_tree),0!=--s;);else 0!==r?(r!==i&&(M(e,r,e.bl_tree),s--),M(e,h,e.bl_tree),A(e,s-3,2)):s<=10?(M(e,m,e.bl_tree),A(e,s-3,3)):(M(e,g,e.bl_tree),A(e,s-11,7));i=r,c=(s=0)===a?(l=138,3):r===a?(l=6,3):(l=7,4)}}r(E);var Y=!1;function q(e,t,n,r){A(e,(i<<1)+(r?1:0),3),function(e,t,n,r){z(e),P(e,n),P(e,~n),o.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n)}n._tr_init=function(e){Y||(function(){var e,t,n,o,r,i=new Array(u+1);for(o=n=0;o<28;o++)for(k[o]=n,e=0;e<1<<v[o];e++)_[n++]=o;for(_[n-1]=o,o=r=0;o<16;o++)for(E[o]=r,e=0;e<1<<b[o];e++)C[r++]=o;for(r>>=7;o<l;o++)for(E[o]=r<<7,e=0;e<1<<b[o]-7;e++)C[256+r++]=o;for(t=0;t<=u;t++)i[t]=0;for(e=0;e<=143;)x[2*e+1]=8,e++,i[8]++;for(;e<=255;)x[2*e+1]=9,e++,i[9]++;for(;e<=279;)x[2*e+1]=7,e++,i[7]++;for(;e<=287;)x[2*e+1]=8,e++,i[8]++;for(R(x,s+1,i),e=0;e<l;e++)$[2*e+1]=5,$[2*e]=U(e,5);S=new N(x,v,a+1,s,u),T=new N($,b,0,l,u),I=new N(new Array(0),y,0,c,7)}(),Y=!0),e.l_desc=new O(e.dyn_ltree,S),e.d_desc=new O(e.dyn_dtree,T),e.bl_desc=new O(e.bl_tree,I),e.bi_buf=0,e.bi_valid=0,L(e)},n._tr_stored_block=q,n._tr_flush_block=function(e,t,n,o){var r,i,s=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<a;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),G(e,e.l_desc),G(e,e.d_desc),s=function(e){var t;for(H(e,e.dyn_ltree,e.l_desc.max_code),H(e,e.dyn_dtree,e.d_desc.max_code),G(e,e.bl_desc),t=c-1;3<=t&&0===e.bl_tree[2*w[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),r=e.opt_len+3+7>>>3,(i=e.static_len+3+7>>>3)<=r&&(r=i)):r=i=n+5,n+4<=r&&-1!==t?q(e,t,n,o):4===e.strategy||i===r?(A(e,2+(o?1:0),3),B(e,x,$)):(A(e,4+(o?1:0),3),function(e,t,n,o){var r;for(A(e,t-257,5),A(e,n-1,5),A(e,o-4,4),r=0;r<o;r++)A(e,e.bl_tree[2*w[r]+1],3);V(e,e.dyn_ltree,t-1),V(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),B(e,e.dyn_ltree,e.dyn_dtree)),L(e),o&&z(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(_[n]+a+1)]++,e.dyn_dtree[2*D(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){A(e,2,3),M(e,f,x),function(e){16===e.bi_valid?(P(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,n){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,n){t.exports="function"==typeof setImmediate?setImmediate:function(){var e=[].slice.apply(arguments);e.splice(1,0,0),setTimeout.apply(null,e)}},{}]},{},[10])(10)}),function(){var e={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,COMMAND:91,MAP:{91:"COMMAND",8:"BACKSPACE",9:"TAB",13:"ENTER",16:"SHIFT",17:"CTRL",18:"ALT",19:"PAUSEBREAK",20:"CAPSLOCK",27:"ESC",32:"SPACE",33:"PAGE_UP",34:"PAGE_DOWN",35:"END",36:"HOME",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN",43:"+",44:"PRINTSCREEN",45:"INSERT",46:"DELETE",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NUMLOCK",145:"SCROLLLOCK",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},isControl:function(t){switch(t.which){case e.COMMAND:case e.SHIFT:case e.CTRL:case e.ALT:return!0}return!!(t.metaKey||t.ctrlKey||t.altKey)},isFunctionKey:function(e){return(e=e.which?e.which:e)>=112&&e<=123},isVerticalMovement:function(t){return~[e.UP,e.DOWN].indexOf(t)},isHorizontalMovement:function(t){return~[e.LEFT,e.RIGHT,e.BACKSPACE,e.DELETE].indexOf(t)},toSeparator:function(t){var n={ENTER:"\n",TAB:"\t",SPACE:" "}[t];return n||(e[t]?void 0:t)}};function t(e){return angular.isUndefined(e)||null===e}void 0===angular.element.prototype.querySelectorAll&&(angular.element.prototype.querySelectorAll=function(e){return angular.element(this[0].querySelectorAll(e))}),void 0===angular.element.prototype.closest&&(angular.element.prototype.closest=function(e){for(var t=this[0],n=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector;t;){if(n.bind(t)(e))return t;t=t.parentElement}return!1});var n=0,o=angular.module("ui.select",[]).constant("uiSelectConfig",{theme:"bootstrap",searchEnabled:!0,sortable:!1,placeholder:"",refreshDelay:1e3,closeOnSelect:!0,skipFocusser:!1,dropdownPosition:"auto",removeSelected:!0,resetSearchInput:!1,generateId:function(){return n++},appendToBody:!1,spinnerEnabled:!1,spinnerClass:"glyphicon glyphicon-refresh ui-select-spin",backspaceReset:!0}).service("uiSelectMinErr",function(){var e=angular.$$minErr("ui.select");return function(){var t=e.apply(this,arguments).message.replace(new RegExp("\nhttp://errors.angularjs.org/.*"),"");return new Error(t)}}).directive("uisTranscludeAppend",function(){return{link:function(e,t,n,o,r){r(e,function(e){t.append(e)})}}}).filter("highlight",function(){return function(e,t){return t&&e?(""+e).replace(new RegExp((""+t).replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"gi"),'<span class="ui-select-highlight">$&</span>'):e}}).factory("uisOffset",["$document","$window",function(e,t){return function(n){var o=n[0].getBoundingClientRect();return{width:o.width||n.prop("offsetWidth"),height:o.height||n.prop("offsetHeight"),top:o.top+(t.pageYOffset||e[0].documentElement.scrollTop),left:o.left+(t.pageXOffset||e[0].documentElement.scrollLeft)}}}]);o.directive("uiSelectChoices",["uiSelectConfig","uisRepeatParser","uiSelectMinErr","$compile","$window",function(e,t,n,o,r){return{restrict:"EA",require:"^uiSelect",replace:!0,transclude:!0,templateUrl:function(t){return t.addClass("ui-select-choices"),(t.parent().attr("theme")||e.theme)+"/choices.tpl.html"},compile:function(o,i){if(!i.repeat)throw n("repeat","Expected 'repeat' expression.");var a=i.groupBy,s=i.groupFilter;if(a){var l=o.querySelectorAll(".ui-select-choices-group");if(1!==l.length)throw n("rows","Expected 1 .ui-select-choices-group but got '{0}'.",l.length);l.attr("ng-repeat",t.getGroupNgRepeatExpression())}var c=t.parse(i.repeat),p=o.querySelectorAll(".ui-select-choices-row");if(1!==p.length)throw n("rows","Expected 1 .ui-select-choices-row but got '{0}'.",p.length);p.attr("ng-repeat",c.repeatExpression(a)).attr("ng-if","$select.open");var u=o.querySelectorAll(".ui-select-choices-row-inner");if(1!==u.length)throw n("rows","Expected 1 .ui-select-choices-row-inner but got '{0}'.",u.length);return u.attr("uis-transclude-append",""),(r.document.addEventListener?p:u).attr("ng-click","$select.select("+c.itemName+",$select.skipFocusser,$event)"),function(t,n,r,i){i.parseRepeatAttr(r.repeat,a,s),i.disableChoiceExpression=r.uiDisableChoice,i.onHighlightCallback=r.onHighlight,i.minimumInputLength=parseInt(r.minimumInputLength)||0,i.dropdownPosition=r.position?r.position.toLowerCase():e.dropdownPosition,t.$watch("$select.search",function(e){e&&!i.open&&i.multiple&&i.activate(!1,!0),i.activeIndex=i.tagging.isActivated?-1:0,!r.minimumInputLength||i.search.length>=r.minimumInputLength?i.refresh(r.refresh):i.items=[]}),r.$observe("refreshDelay",function(){var n=t.$eval(r.refreshDelay);i.refreshDelay=void 0!==n?n:e.refreshDelay}),t.$watch("$select.open",function(e){e?(o.attr("role","listbox"),i.refresh(r.refresh)):n.removeAttr("role")})}}}}]),o.controller("uiSelectCtrl",["$scope","$element","$timeout","$filter","$$uisDebounce","uisRepeatParser","uiSelectMinErr","uiSelectConfig","$parse","$injector","$window",function(n,o,r,i,a,s,l,c,p,u,d){var f,h=this,m="";if(h.placeholder=c.placeholder,h.searchEnabled=c.searchEnabled,h.sortable=c.sortable,h.refreshDelay=c.refreshDelay,h.paste=c.paste,h.resetSearchInput=c.resetSearchInput,h.refreshing=!1,h.spinnerEnabled=c.spinnerEnabled,h.spinnerClass=c.spinnerClass,h.removeSelected=c.removeSelected,h.closeOnSelect=!0,h.skipFocusser=!1,h.search=m,h.activeIndex=0,h.items=[],h.open=!1,h.focus=!1,h.disabled=!1,h.selected=void 0,h.dropdownPosition="auto",h.focusser=void 0,h.multiple=void 0,h.disableChoiceExpression=void 0,h.tagging={isActivated:!1,fct:void 0},h.taggingTokens={isActivated:!1,tokens:void 0},h.lockChoiceExpression=void 0,h.clickTriggeredSelect=!1,h.$filter=i,h.$element=o,h.$animate=function(){try{return u.get("$animate")}catch(e){return null}}(),h.searchInput=o.querySelectorAll("input.ui-select-search"),1!==h.searchInput.length)throw l("searchInput","Expected 1 input.ui-select-search but got '{0}'.",h.searchInput.length);function g(){h.resetSearchInput&&(h.search=m,h.selected&&h.items.length&&!h.multiple&&(h.activeIndex=function(e,t,n){if(e.findIndex)return e.findIndex(t,n);for(var o,r=Object(e),i=r.length>>>0,a=0;a<i;a++)if(o=r[a],t.call(n,o,a,r))return a;return-1}(h.items,function(e){return angular.equals(this,e)},h.selected)))}h.isEmpty=function(){return t(h.selected)||""===h.selected||h.multiple&&0===h.selected.length},h.activate=function(e,t){if(h.disabled||h.open)h.open&&!h.searchEnabled&&h.close();else{t||g(),n.$broadcast("uis:activate"),h.open=!0,h.activeIndex=h.activeIndex>=h.items.length?0:h.activeIndex,-1===h.activeIndex&&!1!==h.taggingLabel&&(h.activeIndex=0);var i=o.querySelectorAll(".ui-select-choices-content"),a=o.querySelectorAll(".ui-select-search");if(h.$animate&&h.$animate.on&&h.$animate.enabled(i[0])){var s=function(t,n){"start"===n&&0===h.items.length?(h.$animate.off("removeClass",a[0],s),r(function(){h.focusSearchInput(e)})):"close"===n&&(h.$animate.off("enter",i[0],s),r(function(){h.focusSearchInput(e)}))};h.items.length>0?h.$animate.on("enter",i[0],s):h.$animate.on("removeClass",a[0],s)}else r(function(){h.focusSearchInput(e),!h.tagging.isActivated&&h.items.length>1&&$()})}},h.focusSearchInput=function(e){h.search=e||h.search,h.searchInput[0].focus()},h.findGroupByName=function(e){return h.groups&&h.groups.filter(function(t){return t.name===e})[0]},h.parseRepeatAttr=function(e,t,o){h.setItemsFn=t?function(e){var r=n.$eval(t);if(h.groups=[],angular.forEach(e,function(e){var t=angular.isFunction(r)?r(e):e[r],n=h.findGroupByName(t);n?n.items.push(e):h.groups.push({name:t,items:[e]})}),o){var i=n.$eval(o);angular.isFunction(i)?h.groups=i(h.groups):angular.isArray(i)&&(h.groups=function(e,t){var n,o,r=[];for(n=0;n<t.length;n++)for(o=0;o<e.length;o++)e[o].name==[t[n]]&&r.push(e[o]);return r}(h.groups,i))}h.items=[],h.groups.forEach(function(e){h.items=h.items.concat(e.items)})}:function(e){h.items=e||[]},h.parserResult=s.parse(e),h.isGrouped=!!t,h.itemProperty=h.parserResult.itemName;var r=h.parserResult.source,i=function(){var e=r(n);n.$uisSource=Object.keys(e).map(function(t){var n={};return n[h.parserResult.keyName]=t,n.value=e[t],n})};h.parserResult.keyName&&(i(),h.parserResult.source=p("$uisSource"+h.parserResult.filters),n.$watch(r,function(e,t){e!==t&&i()},!0)),h.refreshItems=function(e){e=e||h.parserResult.source(n);var t=h.selected;if(h.isEmpty()||angular.isArray(t)&&!t.length||!h.multiple||!h.removeSelected)h.setItemsFn(e);else if(null!=e){var o=e.filter(function(e){return angular.isArray(t)?t.every(function(t){return!angular.equals(e,t)}):!angular.equals(e,t)});h.setItemsFn(o)}"auto"!==h.dropdownPosition&&"up"!==h.dropdownPosition||n.calculateDropdownPos(),n.$broadcast("uis:refresh")},n.$watchCollection(h.parserResult.source,function(e){if(null==e)h.items=[];else{if(!angular.isArray(e))throw l("items","Expected an array but got '{0}'.",e);h.refreshItems(e),angular.isDefined(h.ngModel.$modelValue)&&(h.ngModel.$modelValue=null)}})},h.refresh=function(e){void 0!==e&&(f&&r.cancel(f),f=r(function(){if(n.$select.search.length>=n.$select.minimumInputLength){var t=n.$eval(e);t&&angular.isFunction(t.then)&&!h.refreshing&&(h.refreshing=!0,t.finally(function(){h.refreshing=!1}))}},h.refreshDelay))},h.isActive=function(e){if(!h.open)return!1;var t=h.items.indexOf(e[h.itemProperty]),n=t==h.activeIndex;return!(!n||t<0)&&(n&&!angular.isUndefined(h.onHighlightCallback)&&e.$eval(h.onHighlightCallback),n)};var v=function(e){return h.selected&&angular.isArray(h.selected)&&h.selected.filter(function(t){return angular.equals(t,e)}).length>0},b=[];function y(e){return b.indexOf(e)>-1}h.isDisabled=function(e){if(h.open){var t=e[h.itemProperty],n=!1;if(h.items.indexOf(t)>=0&&(angular.isDefined(h.disableChoiceExpression)||h.multiple)){if(t.isTag)return!1;h.multiple&&(n=v(t)),!n&&angular.isDefined(h.disableChoiceExpression)&&(n=!!e.$eval(h.disableChoiceExpression)),function(e,t){var n=b.indexOf(e);t&&-1===n&&b.push(e),!t&&n>-1&&b.splice(n,1)}(t,n)}return n}},h.select=function(e,o,r){if(t(e)||!y(e)){if(!h.items&&!h.search&&!h.tagging.isActivated)return;if(!e||!y(e)){if(h.clickTriggeredSelect=!1,r&&("click"===r.type||"touchend"===r.type)&&e&&(h.clickTriggeredSelect=!0),h.tagging.isActivated&&!1===h.clickTriggeredSelect){if(!1===h.taggingLabel)if(h.activeIndex<0){if(void 0===e&&(e=void 0!==h.tagging.fct?h.tagging.fct(h.search):h.search),!e||angular.equals(h.items[0],e))return}else e=h.items[h.activeIndex];else if(0===h.activeIndex){if(void 0===e)return;if(void 0!==h.tagging.fct&&"string"==typeof e){if(!(e=h.tagging.fct(e)))return}else"string"==typeof e&&(e=e.replace(h.taggingLabel,"").trim())}if(v(e))return void h.close(o)}g(),n.$broadcast("uis:select",e),h.closeOnSelect&&h.close(o)}}},h.close=function(e){h.open&&(h.ngModel&&h.ngModel.$setTouched&&h.ngModel.$setTouched(),h.open=!1,g(),n.$broadcast("uis:close",e))},h.setFocus=function(){h.focus||h.focusInput[0].focus()},h.clear=function(e){h.select(null),e.stopPropagation(),r(function(){h.focusser[0].focus()},0,!1)},h.toggle=function(e){h.open?(h.close(),e.preventDefault(),e.stopPropagation()):h.activate()},h.isLocked=function(){return!1},n.$watch(function(){return angular.isDefined(h.lockChoiceExpression)&&""!==h.lockChoiceExpression},function(e){if(!e)return;var t=[];h.isLocked=function(e,n){var o=!1,r=h.selected[n];return r&&(e?(o=!!e.$eval(h.lockChoiceExpression),function(e,n){var o=t.indexOf(e);n&&-1===o&&t.push(e);!n&&o>-1&&t.splice(o,1)}(r,o)):o=function(e){return t.indexOf(e)>-1}(r)),o}});var w=null,x=!1;function $(){var e=o.querySelectorAll(".ui-select-choices-content"),t=e.querySelectorAll(".ui-select-choices-row");if(t.length<1)throw l("choices","Expected multiple .ui-select-choices-row but got '{0}'.",t.length);if(!(h.activeIndex<0)){var n=t[h.activeIndex],r=n.offsetTop+n.clientHeight-e[0].scrollTop,i=e[0].offsetHeight;r>i?e[0].scrollTop+=r-i:r<n.clientHeight&&(h.isGrouped&&0===h.activeIndex?e[0].scrollTop=0:e[0].scrollTop-=n.clientHeight-r)}}h.sizeSearchInput=function(){var e=h.searchInput[0],t=h.$element[0],o=function(){return t.clientWidth*!!e.offsetParent},i=function(t){if(0===t)return!1;var n=t-e.offsetLeft;return n<50&&(n=t),h.searchInput.css("width",n+"px"),!0};h.searchInput.css("width","10px"),r(function(){null!==w||i(o())||(w=n.$watch(function(){x||(x=!0,n.$$postDigest(function(){x=!1,i(o())&&(w(),w=null)}))},angular.noop))})},h.searchInput.on("keydown",function(t){var o=t.which;~[e.ENTER,e.ESC].indexOf(o)&&(t.preventDefault(),t.stopPropagation()),n.$apply(function(){var n=!1;if((h.items.length>0||h.tagging.isActivated)&&(function(t){var n=!0;switch(t){case e.DOWN:if(!h.open&&h.multiple)h.activate(!1,!0);else if(h.activeIndex<h.items.length-1)for(var o=++h.activeIndex;y(h.items[o])&&o<h.items.length;)h.activeIndex=++o;break;case e.UP:var r=0===h.search.length&&h.tagging.isActivated?-1:0;if(!h.open&&h.multiple)h.activate(!1,!0);else if(h.activeIndex>r)for(var i=--h.activeIndex;y(h.items[i])&&i>r;)h.activeIndex=--i;break;case e.TAB:h.multiple&&!h.open||h.select(h.items[h.activeIndex],!0);break;case e.ENTER:h.open&&(h.tagging.isActivated||h.activeIndex>=0)?h.select(h.items[h.activeIndex],h.skipFocusser):h.activate(!1,!0);break;case e.ESC:h.close();break;default:n=!1}return n}(o)||h.searchEnabled||(t.preventDefault(),t.stopPropagation()),h.taggingTokens.isActivated)){for(var i=0;i<h.taggingTokens.tokens.length;i++)h.taggingTokens.tokens[i]===e.MAP[t.keyCode]&&h.search.length>0&&(n=!0);n&&r(function(){h.searchInput.triggerHandler("tagged");var n=h.search.replace(e.MAP[t.keyCode],"").trim();h.tagging.fct&&(n=h.tagging.fct(n)),n&&h.select(n,!0)})}}),e.isVerticalMovement(o)&&h.items.length>0&&$(),o!==e.ENTER&&o!==e.ESC||(t.preventDefault(),t.stopPropagation())}),h.searchInput.on("paste",function(t){var n;if(n=window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):(t.originalEvent||t).clipboardData.getData("text/plain"),(n=h.search+n)&&n.length>0)if(h.taggingTokens.isActivated){for(var o=[],r=0;r<h.taggingTokens.tokens.length;r++){var i=e.toSeparator(h.taggingTokens.tokens[r])||h.taggingTokens.tokens[r];if(n.indexOf(i)>-1){o=n.split(i);break}}0===o.length&&(o=[n]);var a=h.search;angular.forEach(o,function(e){var t=h.tagging.fct?h.tagging.fct(e):e;t&&h.select(t,!0)}),h.search=a||m,t.preventDefault(),t.stopPropagation()}else h.paste&&(h.paste(n),h.search=m,t.preventDefault(),t.stopPropagation())}),h.searchInput.on("tagged",function(){r(function(){g()})});var C=a(function(){h.sizeSearchInput()},50);angular.element(d).bind("resize",C),n.$on("$destroy",function(){h.searchInput.off("keyup keydown tagged blur paste"),angular.element(d).off("resize",C)}),n.$watch("$select.activeIndex",function(e){e&&o.find("input").attr("aria-activedescendant","ui-select-choices-row-"+h.generatedId+"-"+e)}),n.$watch("$select.open",function(e){e||o.find("input").removeAttr("aria-activedescendant")})}]),o.directive("uiSelect",["$document","uiSelectConfig","uiSelectMinErr","uisOffset","$compile","$parse","$timeout",function(e,t,n,o,r,i,a){return{restrict:"EA",templateUrl:function(e,n){return(n.theme||t.theme)+(angular.isDefined(n.multiple)?"/select-multiple.tpl.html":"/select.tpl.html")},replace:!0,transclude:!0,require:["uiSelect","^ngModel"],scope:!0,controller:"uiSelectCtrl",controllerAs:"$select",compile:function(r,s){var l=/{(.*)}\s*{(.*)}/.exec(s.ngClass);if(l){var c="{"+l[1]+", "+l[2]+"}";s.ngClass=c,r.attr("ng-class",c)}return angular.isDefined(s.multiple)?r.append("<ui-select-multiple/>").removeAttr("multiple"):r.append("<ui-select-single/>"),s.inputId&&(r.querySelectorAll("input.ui-select-search")[0].id=s.inputId),function(r,s,l,c,p){var u=c[0],d=c[1];function f(e){if(u.open){if(!(window.jQuery?window.jQuery.contains(s[0],e.target):s[0].contains(e.target))&&!u.clickTriggeredSelect){var t;if(u.skipFocusser)t=!0;else{var n=angular.element(e.target).controller("uiSelect");(t=n&&n!==u)||(t=~["input","button","textarea","select"].indexOf(e.target.tagName.toLowerCase()))}u.close(t),r.$digest()}u.clickTriggeredSelect=!1}}u.generatedId=t.generateId(),u.baseTitle=l.title||"Select box",u.focusserTitle=u.baseTitle+" focus",u.focusserId="focusser-"+u.generatedId,u.closeOnSelect=angular.isDefined(l.closeOnSelect)?i(l.closeOnSelect)():t.closeOnSelect,r.$watch("skipFocusser",function(){var e=r.$eval(l.skipFocusser);u.skipFocusser=void 0!==e?e:t.skipFocusser}),u.onSelectCallback=i(l.onSelect),u.onRemoveCallback=i(l.onRemove),u.ngModel=d,u.choiceGrouped=function(e){return u.isGrouped&&e&&e.name},l.tabindex&&l.$observe("tabindex",function(e){u.focusInput.attr("tabindex",e),s.removeAttr("tabindex")}),r.$watch(function(){return r.$eval(l.searchEnabled)},function(e){u.searchEnabled=void 0!==e?e:t.searchEnabled}),r.$watch("sortable",function(){var e=r.$eval(l.sortable);u.sortable=void 0!==e?e:t.sortable}),l.$observe("backspaceReset",function(){var e=r.$eval(l.backspaceReset);u.backspaceReset=void 0===e||e}),l.$observe("limit",function(){u.limit=angular.isDefined(l.limit)?parseInt(l.limit,10):void 0}),r.$watch("removeSelected",function(){var e=r.$eval(l.removeSelected);u.removeSelected=void 0!==e?e:t.removeSelected}),l.$observe("disabled",function(){u.disabled=void 0!==l.disabled&&l.disabled}),l.$observe("resetSearchInput",function(){var e=r.$eval(l.resetSearchInput);u.resetSearchInput=void 0===e||e}),l.$observe("paste",function(){u.paste=r.$eval(l.paste)}),l.$observe("tagging",function(){if(void 0!==l.tagging){var e=r.$eval(l.tagging);u.tagging={isActivated:!0,fct:!0!==e?e:void 0}}else u.tagging={isActivated:!1,fct:void 0}}),l.$observe("taggingLabel",function(){void 0!==l.tagging&&("false"===l.taggingLabel?u.taggingLabel=!1:u.taggingLabel=void 0!==l.taggingLabel?l.taggingLabel:"(new)")}),l.$observe("taggingTokens",function(){if(void 0!==l.tagging){var e=void 0!==l.taggingTokens?l.taggingTokens.split("|"):[",","ENTER"];u.taggingTokens={isActivated:!0,tokens:e}}}),l.$observe("spinnerEnabled",function(){var e=r.$eval(l.spinnerEnabled);u.spinnerEnabled=void 0!==e?e:t.spinnerEnabled}),l.$observe("spinnerClass",function(){var e=l.spinnerClass;u.spinnerClass=void 0!==e?l.spinnerClass:t.spinnerClass}),angular.isDefined(l.autofocus)&&a(function(){u.setFocus()}),angular.isDefined(l.focusOn)&&r.$on(l.focusOn,function(){a(function(){u.setFocus()})}),e.on("click",f),r.$on("$destroy",function(){e.off("click",f)}),p(r,function(e){var t=angular.element("<div>").append(e),o=t.querySelectorAll(".ui-select-match");if(o.removeAttr("ui-select-match"),o.removeAttr("data-ui-select-match"),1!==o.length)throw n("transcluded","Expected 1 .ui-select-match but got '{0}'.",o.length);s.querySelectorAll(".ui-select-match").replaceWith(o);var r=t.querySelectorAll(".ui-select-choices");if(r.removeAttr("ui-select-choices"),r.removeAttr("data-ui-select-choices"),1!==r.length)throw n("transcluded","Expected 1 .ui-select-choices but got '{0}'.",r.length);s.querySelectorAll(".ui-select-choices").replaceWith(r);var i=t.querySelectorAll(".ui-select-no-choice");i.removeAttr("ui-select-no-choice"),i.removeAttr("data-ui-select-no-choice"),1==i.length&&s.querySelectorAll(".ui-select-no-choice").replaceWith(i)});var h=r.$eval(l.appendToBody);(void 0!==h?h:t.appendToBody)&&(r.$watch("$select.open",function(t){var n;t?(n=o(s),(m=angular.element('<div class="ui-select-placeholder"></div>'))[0].style.width=n.width+"px",m[0].style.height=n.height+"px",s.after(m),g=s[0].style.width,e.find("body").append(s),s[0].style.position="absolute",s[0].style.left=n.left+"px",s[0].style.top=n.top+"px",s[0].style.width=n.width+"px"):v()}),r.$on("$destroy",function(){v()}));var m=null,g="";function v(){null!==m&&(m.replaceWith(s),m=null,s[0].style.position="",s[0].style.left="",s[0].style.top="",s[0].style.width=g,u.setFocus())}var b=null;r.$watch("$select.open",function(){"auto"!==u.dropdownPosition&&"up"!==u.dropdownPosition||r.calculateDropdownPos()});var y=function(e,t){e=e||o(s),t=t||o(b),b[0].style.position="absolute",b[0].style.top=-1*t.height+"px",s.addClass("direction-up")},w=function(){a(function(){if("up"===u.dropdownPosition)y();else{s.removeClass("direction-up");var t=o(s),n=o(b),r=e[0].documentElement.scrollTop||e[0].body.scrollTop;t.top+t.height+n.height>r+e[0].documentElement.clientHeight?y(t,n):function(e,t){s.removeClass("direction-up"),e=e||o(s),t=t||o(b),b[0].style.position="",b[0].style.top=""}(t,n)}b[0].style.opacity=1})},x=!1;r.calculateDropdownPos=function(){if(u.open){if(0===(b=angular.element(s).querySelectorAll(".ui-select-dropdown")).length)return;if(""!==u.search||x||(b[0].style.opacity=0,x=!0),!o(b).height&&u.$animate&&u.$animate.on&&u.$animate.enabled(b)){var e=!0;u.$animate.on("enter",b,function(t,n){"close"===n&&e&&(w(),e=!1)})}else w()}else{if(null===b||0===b.length)return;b[0].style.opacity=0,b[0].style.position="",b[0].style.top="",s.removeClass("direction-up")}}}}}}]),o.directive("uiSelectMatch",["uiSelectConfig",function(e){return{restrict:"EA",require:"^uiSelect",replace:!0,transclude:!0,templateUrl:function(n){n.addClass("ui-select-match");var o=n.parent();return(t(o,"theme")||e.theme)+(angular.isDefined(t(o,"multiple"))?"/match-multiple.tpl.html":"/match.tpl.html")},link:function(t,n,o,r){function i(e){r.allowClear=!!angular.isDefined(e)&&(""===e||"true"===e.toLowerCase())}r.lockChoiceExpression=o.uiLockChoice,o.$observe("placeholder",function(t){r.placeholder=void 0!==t?t:e.placeholder}),o.$observe("allowClear",i),i(o.allowClear),r.multiple&&r.sizeSearchInput()}};function t(e,t){return e[0].hasAttribute(t)?e.attr(t):e[0].hasAttribute("data-"+t)?e.attr("data-"+t):e[0].hasAttribute("x-"+t)?e.attr("x-"+t):void 0}}]),o.directive("uiSelectMultiple",["uiSelectMinErr","$timeout",function(n,o){return{restrict:"EA",require:["^uiSelect","^ngModel"],controller:["$scope","$timeout",function(e,t){var n,o=this,r=e.$select;angular.isUndefined(r.selected)&&(r.selected=[]),e.$evalAsync(function(){n=e.ngModel}),o.activeMatchIndex=-1,o.updateModel=function(){n.$setViewValue(Date.now()),o.refreshComponent()},o.refreshComponent=function(){r.refreshItems&&r.refreshItems(),r.sizeSearchInput&&r.sizeSearchInput()},o.removeChoice=function(n){if(r.isLocked(null,n))return!1;var i=r.selected[n],a={};return a[r.parserResult.itemName]=i,r.selected.splice(n,1),o.activeMatchIndex=-1,r.sizeSearchInput(),t(function(){r.onRemoveCallback(e,{$item:i,$model:r.parserResult.modelMapper(e,a)})}),o.updateModel(),!0},o.getPlaceholder=function(){if(!r.selected||!r.selected.length)return r.placeholder}}],controllerAs:"$selectMultiple",link:function(r,i,a,s){var l=s[0],c=r.ngModel=s[1],p=r.$selectMultiple;function u(e){return void 0!==e&&void 0!==l.search&&e.filter(function(e){return void 0!==l.search.toUpperCase()&&void 0!==e&&e.toUpperCase()===l.search.toUpperCase()}).length>0}function d(e,t){var n=-1;if(angular.isArray(e))for(var o=angular.copy(e),r=0;r<o.length;r++)if(void 0===l.tagging.fct)o[r]+" "+l.taggingLabel===t&&(n=r);else{var i=o[r];angular.isObject(i)&&(i.isTag=!0),angular.equals(i,t)&&(n=r)}return n}l.multiple=!0,l.focusInput=l.searchInput,c.$isEmpty=function(e){return!e||0===e.length},c.$parsers.unshift(function(){for(var e,t={},n=[],o=l.selected.length-1;o>=0;o--)(t={})[l.parserResult.itemName]=l.selected[o],e=l.parserResult.modelMapper(r,t),n.unshift(e);return n}),c.$formatters.unshift(function(e){var t,n=l.parserResult&&l.parserResult.source(r,{$select:{search:""}}),o={};if(!n)return e;var i=[],a=function(e,n){if(e&&e.length){for(var a=e.length-1;a>=0;a--){if(o[l.parserResult.itemName]=e[a],t=l.parserResult.modelMapper(r,o),l.parserResult.trackByExp){var s=/(\w*)\./.exec(l.parserResult.trackByExp),c=/\.([^\s]+)/.exec(l.parserResult.trackByExp);if(s&&s.length>0&&s[1]==l.parserResult.itemName&&c&&c.length>0&&t[c[1]]==n[c[1]])return i.unshift(e[a]),!0}if(angular.equals(t,n))return i.unshift(e[a]),!0}return!1}};if(!e)return i;for(var s=e.length-1;s>=0;s--)a(l.selected,e[s])||a(n,e[s])||i.unshift(e[s]);return i}),r.$watchCollection(function(){return c.$modelValue},function(e,t){t!=e&&(angular.isDefined(c.$modelValue)&&(c.$modelValue=null),p.refreshComponent())}),c.$render=function(){if(!angular.isArray(c.$viewValue)){if(!t(c.$viewValue))throw n("multiarr","Expected model value to be array but got '{0}'",c.$viewValue);c.$viewValue=[]}l.selected=c.$viewValue,p.refreshComponent(),r.$evalAsync()},r.$on("uis:select",function(e,t){if(!(l.selected.length>=l.limit)){l.selected.push(t);var n={};n[l.parserResult.itemName]=t,o(function(){l.onSelectCallback(r,{$item:t,$model:l.parserResult.modelMapper(r,n)})}),p.updateModel()}}),r.$on("uis:activate",function(){p.activeMatchIndex=-1}),r.$watch("$select.disabled",function(e,t){t&&!e&&l.sizeSearchInput()}),l.searchInput.on("keydown",function(t){var n=t.which;r.$apply(function(){var o=!1;e.isHorizontalMovement(n)&&(o=function(t){var n=(u=l.searchInput[0],angular.isNumber(u.selectionStart)?u.selectionStart:u.value.length),o=l.selected.length,r=o-1,i=p.activeMatchIndex,a=p.activeMatchIndex+1,s=p.activeMatchIndex-1,c=i;var u;if(n>0||l.search.length&&t==e.RIGHT)return!1;l.close(),c=function(){switch(t){case e.LEFT:return~p.activeMatchIndex?s:r;case e.RIGHT:return~p.activeMatchIndex&&i!==r?a:(l.activate(),!1);case e.BACKSPACE:return~p.activeMatchIndex?p.removeChoice(i)?s:i:r;case e.DELETE:return!!~p.activeMatchIndex&&(p.removeChoice(p.activeMatchIndex),i)}}(),l.selected.length&&!1!==c?p.activeMatchIndex=Math.min(r,Math.max(0,c)):p.activeMatchIndex=-1;return!0}(n)),o&&n!=e.TAB&&(t.preventDefault(),t.stopPropagation())})}),l.searchInput.on("keyup",function(t){if(e.isVerticalMovement(t.which)||r.$evalAsync(function(){l.activeIndex=!1===l.taggingLabel?-1:0}),l.tagging.isActivated&&l.search.length>0){if(t.which===e.TAB||e.isControl(t)||e.isFunctionKey(t)||t.which===e.ESC||e.isVerticalMovement(t.which))return;if(l.activeIndex=!1===l.taggingLabel?-1:0,!1===l.taggingLabel)return;var n,o,i,a=angular.copy(l.items),s=angular.copy(l.items),c=!1,p=-1;if(void 0!==l.tagging.fct){if((o=l.$filter("filter")(a,{isTag:!0})).length>0&&(i=o[0]),a.length>0&&i&&(c=!0,a=a.slice(1,a.length),s=s.slice(1,s.length)),n=l.tagging.fct(l.search),s.some(function(e){return angular.equals(e,n)})||l.selected.some(function(e){return angular.equals(e,n)}))return void r.$evalAsync(function(){l.activeIndex=0,l.items=a});n&&(n.isTag=!0)}else{if((o=l.$filter("filter")(a,function(e){return e.match(l.taggingLabel)})).length>0&&(i=o[0]),void 0!==a[0]&&a.length>0&&i&&(c=!0,a=a.slice(1,a.length),s=s.slice(1,s.length)),n=l.search+" "+l.taggingLabel,d(l.selected,l.search)>-1)return;if(u(s.concat(l.selected)))return void(c&&(a=s,r.$evalAsync(function(){l.activeIndex=0,l.items=a})));if(u(s))return void(c&&(l.items=s.slice(1,s.length)))}c&&(p=d(l.selected,n)),p>-1?a=a.slice(p+1,a.length-1):(a=[],n&&a.push(n),a=a.concat(s)),r.$evalAsync(function(){if(l.activeIndex=0,l.items=a,l.isGrouped){var e=n?a.slice(1):a;l.setItemsFn(e),n&&(l.items.unshift(n),l.groups.unshift({name:"",items:[n],tagging:!0}))}})}}),l.searchInput.on("blur",function(){o(function(){p.activeMatchIndex=-1})})}}}]),o.directive("uiSelectNoChoice",["uiSelectConfig",function(e){return{restrict:"EA",require:"^uiSelect",replace:!0,transclude:!0,templateUrl:function(t){return t.addClass("ui-select-no-choice"),(t.parent().attr("theme")||e.theme)+"/no-choice.tpl.html"}}}]),o.directive("uiSelectSingle",["$timeout","$compile",function(n,o){return{restrict:"EA",require:["^uiSelect","^ngModel"],link:function(r,i,a,s){var l=s[0],c=s[1];c.$parsers.unshift(function(e){if(t(e))return e;var n={};return n[l.parserResult.itemName]=e,l.parserResult.modelMapper(r,n)}),c.$formatters.unshift(function(e){if(t(e))return e;var n=l.parserResult&&l.parserResult.source(r,{$select:{search:""}}),o={};if(n){var i=function(t){return o[l.parserResult.itemName]=t,l.parserResult.modelMapper(r,o)===e};if(l.selected&&i(l.selected))return l.selected;for(var a=n.length-1;a>=0;a--)if(i(n[a]))return n[a]}return e}),r.$watch("$select.selected",function(e){c.$viewValue!==e&&c.$setViewValue(e)}),c.$render=function(){l.selected=c.$viewValue},r.$on("uis:select",function(e,o){l.selected=o;var i={};i[l.parserResult.itemName]=o,n(function(){l.onSelectCallback(r,{$item:o,$model:t(o)?o:l.parserResult.modelMapper(r,i)})})}),r.$on("uis:close",function(e,t){n(function(){l.focusser.prop("disabled",!1),t||l.focusser[0].focus()},0,!1)}),r.$on("uis:activate",function(){p.prop("disabled",!0)});var p=angular.element("<input ng-disabled='$select.disabled' class='ui-select-focusser ui-select-offscreen' type='text' id='{{ $select.focusserId }}' aria-label='{{ $select.focusserTitle }}' aria-haspopup='true' role='button' />");o(p)(r),l.focusser=p,l.focusInput=p,i.parent().append(p),p.bind("focus",function(){r.$evalAsync(function(){l.focus=!0})}),p.bind("blur",function(){r.$evalAsync(function(){l.focus=!1})}),p.bind("keydown",function(t){if(t.which===e.BACKSPACE&&!1!==l.backspaceReset)return t.preventDefault(),t.stopPropagation(),l.select(void 0),void r.$apply();t.which===e.TAB||e.isControl(t)||e.isFunctionKey(t)||t.which===e.ESC||(t.which!=e.DOWN&&t.which!=e.UP&&t.which!=e.ENTER&&t.which!=e.SPACE||(t.preventDefault(),t.stopPropagation(),l.activate()),r.$digest())}),p.bind("keyup input",function(t){t.which===e.TAB||e.isControl(t)||e.isFunctionKey(t)||t.which===e.ESC||t.which==e.ENTER||t.which===e.BACKSPACE||(l.activate(p.val()),p.val(""),r.$digest())})}}}]),o.directive("uiSelectSort",["$timeout","uiSelectConfig","uiSelectMinErr",function(e,t,n){return{require:["^^uiSelect","^ngModel"],link:function(t,o,r,i){if(null===t[r.uiSelectSort])throw n("sort","Expected a list to sort");var a=i[0],s=i[1],l=angular.extend({axis:"horizontal"},t.$eval(r.uiSelectSortOptions)).axis;t.$watch(function(){return a.sortable},function(e){e?o.attr("draggable",!0):o.removeAttr("draggable")}),o.on("dragstart",function(e){o.addClass("dragging"),(e.dataTransfer||e.originalEvent.dataTransfer).setData("text",t.$index.toString())}),o.on("dragend",function(){p("dragging")});var c,p=function(e){angular.forEach(a.$element.querySelectorAll("."+e),function(t){angular.element(t).removeClass(e)})},u=function(e){e.preventDefault(),("vertical"===l?e.offsetY||e.layerY||(e.originalEvent?e.originalEvent.offsetY:0):e.offsetX||e.layerX||(e.originalEvent?e.originalEvent.offsetX:0))<this["vertical"===l?"offsetHeight":"offsetWidth"]/2?(p("dropping-after"),o.addClass("dropping-before")):(p("dropping-before"),o.addClass("dropping-after"))},d=function(t){t.preventDefault();var n=parseInt((t.dataTransfer||t.originalEvent.dataTransfer).getData("text"),10);e.cancel(c),c=e(function(){f(n)},20)},f=function(e){var n=t.$eval(r.uiSelectSort),i=n[e],a=null;a=o.hasClass("dropping-before")?e<t.$index?t.$index-1:t.$index:e<t.$index?t.$index:t.$index+1,function(e,t){this.splice(t,0,this.splice(e,1)[0])}.apply(n,[e,a]),s.$setViewValue(Date.now()),t.$apply(function(){t.$emit("uiSelectSort:change",{array:n,item:i,from:e,to:a})}),p("dropping"),p("dropping-before"),p("dropping-after"),o.off("drop",d)};o.on("dragenter",function(){o.hasClass("dragging")||(o.addClass("dropping"),o.on("dragover",u),o.on("drop",d))}),o.on("dragleave",function(e){e.target==o&&(p("dropping"),p("dropping-before"),p("dropping-after"),o.off("dragover",u),o.off("drop",d))})}}}]),o.factory("$$uisDebounce",["$timeout",function(e){return function(t,n){var o;return function(){var r=this,i=Array.prototype.slice.call(arguments);o&&e.cancel(o),o=e(function(){t.apply(r,i)},n)}}}]),o.directive("uisOpenClose",["$parse","$timeout",function(e,t){return{restrict:"A",require:"uiSelect",link:function(n,o,r,i){i.onOpenCloseCallback=e(r.uisOpenClose),n.$watch("$select.open",function(e,o){e!==o&&t(function(){i.onOpenCloseCallback(n,{isOpen:e})})})}}}]),o.service("uisRepeatParser",["uiSelectMinErr","$parse",function(e,t){this.parse=function(n){var o;if(!(o=n.match(/^\s*(?:([\s\S]+?)\s+as\s+)?(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+(\s*[\s\S]+?)?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/)))throw e("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",n);var r=o[5],i="";if(o[3]){r=o[5].replace(/(^\()|(\)$)/g,"");var a=o[5].match(/^\s*(?:[\s\S]+?)(?:[^\|]|\|\|)+([\s\S]*)\s*$/);a&&a[1].trim()&&(i=a[1],r=r.replace(i,""))}return{itemName:o[4]||o[2],keyName:o[3],source:t(r),filters:i,trackByExp:o[6],modelMapper:t(o[1]||o[4]||o[2]),repeatExpression:function(e){var t=this.itemName+" in "+(e?"$group.items":"$select.items");return this.trackByExp&&(t+=" track by "+this.trackByExp),t}}},this.getGroupNgRepeatExpression=function(){return"$group in $select.groups track by $group.name"}}])}(),angular.module("ui.select").run(["$templateCache",function(e){e.put("selectize/choices.tpl.html",'<div ng-show="$select.open" class="ui-select-choices ui-select-dropdown selectize-dropdown" ng-class="{\'single\': !$select.multiple, \'multi\': $select.multiple}"><div class="ui-select-choices-content selectize-dropdown-content"><div class="ui-select-choices-group optgroup"><div ng-show="$select.isGrouped" class="ui-select-choices-group-label optgroup-header" ng-bind="$group.name"></div><div role="option" class="ui-select-choices-row" ng-class="{active: $select.isActive(this), disabled: $select.isDisabled(this)}"><div class="option ui-select-choices-row-inner" data-selectable=""></div></div></div></div></div>'),e.put("selectize/match-multiple.tpl.html",'<div class="ui-select-match" data-value="" ng-repeat="$item in $select.selected track by $index" ng-click="$selectMultiple.activeMatchIndex = $index;" ng-class="{\'active\':$selectMultiple.activeMatchIndex === $index}" ui-select-sort="$select.selected"><span class="ui-select-match-item" ng-class="{\'select-locked\':$select.isLocked(this, $index)}"><span uis-transclude-append=""></span> <span class="remove ui-select-match-close" ng-hide="$select.disabled" ng-click="$selectMultiple.removeChoice($index)">&times;</span></span></div>'),e.put("selectize/match.tpl.html",'<div ng-hide="$select.searchEnabled && ($select.open || $select.isEmpty())" class="ui-select-match"><span ng-show="!$select.searchEnabled && ($select.isEmpty() || $select.open)" class="ui-select-placeholder text-muted">{{$select.placeholder}}</span> <span ng-hide="$select.isEmpty() || $select.open" ng-transclude=""></span></div>'),e.put("selectize/no-choice.tpl.html",'<div class="ui-select-no-choice selectize-dropdown" ng-show="$select.items.length == 0"><div class="selectize-dropdown-content"><div data-selectable="" ng-transclude=""></div></div></div>'),e.put("selectize/select-multiple.tpl.html",'<div class="ui-select-container selectize-control multi plugin-remove_button" ng-class="{\'open\': $select.open}"><div class="selectize-input" ng-class="{\'focus\': $select.open, \'disabled\': $select.disabled, \'selectize-focus\' : $select.focus}" ng-click="$select.open && !$select.searchEnabled ? $select.toggle($event) : $select.activate()"><div class="ui-select-match"></div><input type="search" autocomplete="off" tabindex="-1" class="ui-select-search" ng-class="{\'ui-select-search-hidden\':!$select.searchEnabled}" placeholder="{{$selectMultiple.getPlaceholder()}}" ng-model="$select.search" ng-disabled="$select.disabled" aria-expanded="{{$select.open}}" aria-label="{{ $select.baseTitle }}" ondrop="return false;"></div><div class="ui-select-choices"></div><div class="ui-select-no-choice"></div></div>'),e.put("selectize/select.tpl.html",'<div class="ui-select-container selectize-control single" ng-class="{\'open\': $select.open}"><div class="selectize-input" ng-class="{\'focus\': $select.open, \'disabled\': $select.disabled, \'selectize-focus\' : $select.focus, \'refreshing\': $select.open && $select.refreshing && $select.spinnerEnabled }" ng-click="$select.open && !$select.searchEnabled ? $select.toggle($event) : $select.activate()"><i class="iconfont iconspinner fa-pulse"></i><div class="ui-select-match"></div><input type="search" autocomplete="off" tabindex="-1" class="ui-select-search ui-select-toggle" ng-class="{\'ui-select-search-hidden\':!$select.searchEnabled}" ng-click="$select.toggle($event)" placeholder="{{$select.placeholder}}" ng-model="$select.search" ng-hide="!$select.isEmpty() && !$select.open" ng-disabled="$select.disabled" aria-label="{{ $select.baseTitle }}"></div><div class="ui-select-choices"></div><div class="ui-select-no-choice"></div></div>'),e.put("bootstrap/choices.tpl.html",'<ul class="ui-select-choices ui-select-choices-content ui-select-dropdown dropdown-menu" ng-show="$select.open && $select.items.length > 0"><li class="ui-select-choices-group" id="ui-select-choices-{{ $select.generatedId }}"><div class="divider" ng-show="$select.isGrouped && $index > 0"></div><div ng-show="$select.isGrouped" class="ui-select-choices-group-label dropdown-header" ng-bind="$group.name"></div><div ng-attr-id="ui-select-choices-row-{{ $select.generatedId }}-{{$index}}" class="ui-select-choices-row" ng-class="{active: $select.isActive(this), disabled: $select.isDisabled(this)}" role="option"><span class="ui-select-choices-row-inner"></span></div></li></ul>'),e.put("bootstrap/match-multiple.tpl.html",'<span class="ui-select-match"><span ng-repeat="$item in $select.selected track by $index"><span class="ui-select-match-item btn btn-default btn-xs" tabindex="-1" type="button" ng-disabled="$select.disabled" ng-click="$selectMultiple.activeMatchIndex = $index;" ng-class="{\'btn-primary\':$selectMultiple.activeMatchIndex === $index, \'select-locked\':$select.isLocked(this, $index)}" ui-select-sort="$select.selected"><span class="close ui-select-match-close" ng-hide="$select.disabled" ng-click="$selectMultiple.removeChoice($index)">&nbsp;&times;</span> <span uis-transclude-append=""></span></span></span></span>'),e.put("bootstrap/match.tpl.html",'<div class="ui-select-match" ng-hide="$select.open && $select.searchEnabled" ng-disabled="$select.disabled" ng-class="{\'btn-default-focus\':$select.focus}"><span tabindex="-1" class="btn btn-default form-control ui-select-toggle" aria-label="{{ $select.baseTitle }} activate" ng-disabled="$select.disabled" ng-click="$select.activate()" style="outline: 0;"><span ng-show="$select.isEmpty()" class="ui-select-placeholder text-muted">{{$select.placeholder}}</span> <span ng-hide="$select.isEmpty()" class="ui-select-match-text pull-left" ng-class="{\'ui-select-allow-clear\': $select.allowClear && !$select.isEmpty()}" ng-transclude=""></span> <i class="caret pull-right" ng-click="$select.toggle($event)"></i> <a ng-show="$select.allowClear && !$select.isEmpty() && ($select.disabled !== true)" aria-label="{{ $select.baseTitle }} clear" style="margin-right: 10px" ng-click="$select.clear($event)" class="btn btn-xs btn-link pull-right"><i class="glyphicon glyphicon-remove" aria-hidden="true"></i></a></span></div>'),e.put("bootstrap/no-choice.tpl.html",'<ul class="ui-select-no-choice dropdown-menu" ng-show="$select.items.length == 0"><li ng-transclude=""></li></ul>'),e.put("bootstrap/select-multiple.tpl.html",'<div class="ui-select-container ui-select-multiple ui-select-bootstrap dropdown form-control" ng-class="{open: $select.open}"><div><div class="ui-select-match"></div><input type="search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="ui-select-search input-xs" placeholder="{{$selectMultiple.getPlaceholder()}}" ng-disabled="$select.disabled" ng-click="$select.activate()" ng-model="$select.search" role="combobox" aria-expanded="{{$select.open}}" aria-label="{{$select.baseTitle}}" ng-class="{\'spinner\': $select.refreshing}" ondrop="return false;"></div><div class="ui-select-choices"></div><div class="ui-select-no-choice"></div></div>'),e.put("bootstrap/select.tpl.html",'<div class="ui-select-container ui-select-bootstrap dropdown" ng-class="{open: $select.open}"><div class="ui-select-match"></div><span ng-show="$select.open && $select.refreshing && $select.spinnerEnabled" class="ui-select-refreshing {{$select.spinnerClass}}"></span> <input type="search" autocomplete="off" tabindex="-1" aria-expanded="true" aria-label="{{ $select.baseTitle }}" aria-owns="ui-select-choices-{{ $select.generatedId }}" class="form-control ui-select-search" ng-class="{ \'ui-select-search-hidden\' : !$select.searchEnabled }" placeholder="{{$select.placeholder}}" ng-model="$select.search" ng-show="$select.open"><div class="ui-select-choices"></div><div class="ui-select-no-choice"></div></div>')}]),window,document,angular.module("toaster",[]).constant("toasterConfig",{limit:0,"tap-to-dismiss":!0,"close-button":!1,"close-html":'<button class="toast-close-button" type="button">&times;</button>',"newest-on-top":!0,"time-out":5e3,"icon-classes":{error:"toast-error",info:"toast-info",wait:"toast-wait",success:"toast-success",warning:"toast-warning"},"body-output-type":"","body-template":"toasterBodyTmpl.html","icon-class":"toast-info","position-class":"toast-top-right","title-class":"toast-title","message-class":"toast-message","prevent-duplicates":!1,"mouseover-timer-stop":!0}).run(["$templateCache",function(e){e.put("angularjs-toaster/toast.html",'<div id="toast-container" ng-class="[config.position, config.animation]"><div ng-repeat="toaster in toasters" class="toast" ng-class="toaster.type" ng-click="click($event, toaster)" ng-mouseover="stopTimer(toaster)" ng-mouseout="restartTimer(toaster)"><div ng-if="toaster.showCloseButton" ng-click="click($event, toaster, true)" ng-bind-html="toaster.closeHtml"></div><div ng-class="config.title">{{toaster.title}}</div><div ng-class="config.message" ng-switch on="toaster.bodyOutputType"><div ng-switch-when="trustedHtml" ng-bind-html="toaster.html"></div><div ng-switch-when="template"><div ng-include="toaster.bodyTemplate"></div></div><div ng-switch-when="templateWithData"><div ng-include="toaster.bodyTemplate"></div></div><div ng-switch-when="directive"><div directive-template directive-name="{{toaster.html}}" directive-data="{{toaster.directiveData}}"></div></div><div ng-switch-default >{{toaster.body}}</div></div></div></div>')}]).service("toaster",["$rootScope","toasterConfig",function(e,t){var n=function(){var e={newGuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}};return e}();for(var o in this.pop=function(t,o,r,i,a,s,l,c,p,u){if(angular.isObject(t)){var d=t;this.toast={type:d.type,title:d.title,body:d.body,timeout:d.timeout,bodyOutputType:d.bodyOutputType,clickHandler:d.clickHandler,showCloseButton:d.showCloseButton,closeHtml:d.closeHtml,toastId:d.toastId,onShowCallback:d.onShowCallback,onHideCallback:d.onHideCallback,directiveData:d.directiveData,tapToDismiss:d.tapToDismiss},l=d.toasterId}else this.toast={type:t,title:o,body:r,timeout:i,bodyOutputType:a,clickHandler:s,showCloseButton:c,toastId:p,onHideCallback:u};return this.toast.toastId&&this.toast.toastId.length||(this.toast.toastId=n.newGuid()),e.$emit("toaster-newToast",l,this.toast.toastId),{toasterId:l,toastId:this.toast.toastId,toaster:this.toast}},this.clear=function(t,n){angular.isObject(t)?e.$emit("toaster-clearToasts",t.toasterId,t.toastId):e.$emit("toaster-clearToasts",t,n)},this.reset=function(t){e.$emit("toaster-resetToasts",t.toasterId,t.toastId)},t["icon-classes"])this[o]=r(o);function r(e){return function(t,n,o,r,i,a,s,l,c){return angular.isString(t)?this.pop(e,t,n,o,r,i,a,s,l,c):this.pop(angular.extend(t,{type:e}))}}}]).factory("toasterEventRegistry",["$rootScope",function(e){var t,n=null,o=null,r=null,i=[],a=[],s=[];return{setup:(t={setup:function(){n||(n=e.$on("toaster-newToast",function(e,t,n){for(var o=0,r=i.length;o<r;o++)i[o](e,t,n)})),o||(o=e.$on("toaster-clearToasts",function(e,t,n){for(var o=0,r=a.length;o<r;o++)a[o](e,t,n)})),r||(r=e.$on("toaster-resetToasts",function(e,t,n){for(var o=0,r=s.length;o<r;o++)s[o](e,t,n)}))},subscribeToNewToastEvent:function(e){i.push(e)},subscribeToClearToastsEvent:function(e){a.push(e)},subscribeToResetToastsEvent:function(e){s.push(e)},unsubscribeToNewToastEvent:function(e){var t=i.indexOf(e);t>=0&&i.splice(t,1),0===i.length&&(n(),n=null)},unsubscribeToClearToastsEvent:function(e){var t=a.indexOf(e);t>=0&&a.splice(t,1),0===a.length&&(o(),o=null)},unsubscribeToResetToastsEvent:function(e){var t=s.indexOf(e);t>=0&&s.splice(t,1),0===s.length&&(r(),r=null)}}).setup,subscribeToNewToastEvent:t.subscribeToNewToastEvent,subscribeToClearToastsEvent:t.subscribeToClearToastsEvent,subscribeToResetToastsEvent:t.subscribeToResetToastsEvent,unsubscribeToNewToastEvent:t.unsubscribeToNewToastEvent,unsubscribeToClearToastsEvent:t.unsubscribeToClearToastsEvent,unsubscribeToResetToastsEvent:t.unsubscribeToResetToastsEvent}}]).directive("directiveTemplate",["$compile","$injector","$interval",function(e,t,n){return{restrict:"A",scope:{directiveName:"@directiveName",directiveData:"@directiveData"},replace:!0,link:function(n,o,r){n.$watch("directiveName",function(i){if(angular.isUndefined(i)||i.length<=0)throw new Error("A valid directive name must be provided via the toast body argument when using bodyOutputType: directive");var a;try{a=t.get(r.$normalize(i)+"Directive")}catch(e){throw new Error(i+" could not be found. The name should appear as it exists in the markup, not camelCased as it would appear in the directive declaration, e.g. directive-name not directiveName.")}var s=a[0];if(!0!==s.scope&&s.scope)throw new Error("Cannot use a directive with an isolated scope. The scope must be either true or falsy (e.g. false/null/undefined). Occurred for directive "+i+".");if(s.restrict.indexOf("A")<0)throw new Error('Directives must be usable as attributes. Add "A" to the restrict option (or remove the option entirely). Occurred for directive '+i+".");n.directiveData&&(n.directiveData=angular.fromJson(n.directiveData));var l=e("<div "+i+"></div>")(n);o.append(l)})}}}]).directive("toasterContainer",["$parse","$rootScope","$interval","$sce","toasterConfig","toaster","toasterEventRegistry",function(e,t,n,o,r,i,a){return{replace:!0,restrict:"EA",scope:!0,link:function(t,s,l){var c;function p(e){var o=t.toasters[e];o.timeoutPromise&&n.cancel(o.timeoutPromise),t.toasters.splice(e,1),angular.isFunction(o.onHideCallback)&&o.onHideCallback(o)}function u(e){return angular.isUndefined(e)||null===e}c=angular.extend({},r,t.$eval(l.toasterOptions)),t.config={toasterId:c["toaster-id"],position:c["position-class"],title:c["title-class"],message:c["message-class"],tap:c["tap-to-dismiss"],closeButton:c["close-button"],closeHtml:c["close-html"],animation:c["animation-class"],mouseoverTimer:c["mouseover-timer-stop"]},t.$on("$destroy",function(){a.unsubscribeToNewToastEvent(t._onNewToast),a.unsubscribeToClearToastsEvent(t._onClearToasts),a.unsubscribeToResetToastsEvent(t._onResetToasts)}),t.configureTimer=function(e){var o=angular.isNumber(e.timeout)?e.timeout:c["time-out"];"object"==typeof o&&(o=o[e.type]),o>0&&function(e,o){e.timeoutPromise=n(function(){t.removeToast(e.toastId)},o,1)}(e,o)},t.removeToast=function(e){var n,o;for(n=0,o=t.toasters.length;n<o;n++)if(t.toasters[n].toastId===e){p(n);break}},t.toasters=[],t._onNewToast=function(n,r,a){(u(t.config.toasterId)&&u(r)||!u(t.config.toasterId)&&!u(r)&&t.config.toasterId==r)&&function(n,r){if(n.type=c["icon-classes"][n.type],n.type||(n.type=c["icon-class"]),!0===c["prevent-duplicates"]&&t.toasters.length){if(t.toasters[t.toasters.length-1].body===n.body)return;var i,a,s=!1;for(i=0,a=t.toasters.length;i<a;i++)if(t.toasters[i].toastId===r){s=!0;break}if(s)return}var l=c["close-button"];if("boolean"==typeof n.showCloseButton);else if("boolean"==typeof l)n.showCloseButton=l;else if("object"==typeof l){var p=l[n.type];null!=p&&(n.showCloseButton=p)}else n.showCloseButton=!1;switch(n.showCloseButton&&(n.closeHtml=o.trustAsHtml(n.closeHtml||t.config.closeHtml)),n.bodyOutputType=n.bodyOutputType||c["body-output-type"],n.bodyOutputType){case"trustedHtml":n.html=o.trustAsHtml(n.body);break;case"template":n.bodyTemplate=n.body||c["body-template"];break;case"templateWithData":var u=e(n.body||c["body-template"])(t);n.bodyTemplate=u.template,n.data=u.data;break;case"directive":n.html=n.body}t.configureTimer(n),!0===c["newest-on-top"]?(t.toasters.unshift(n),c.limit>0&&t.toasters.length>c.limit&&t.toasters.pop()):(t.toasters.push(n),c.limit>0&&t.toasters.length>c.limit&&t.toasters.shift()),angular.isFunction(n.onShowCallback)&&n.onShowCallback(n)}(i.toast,a)},t._onClearToasts=function(e,n,o){("*"==n||u(t.config.toasterId)&&u(n)||!u(t.config.toasterId)&&!u(n)&&t.config.toasterId==n)&&function(e){for(var n=t.toasters.length-1;n>=0;n--)u(e)?p(n):t.toasters[n].toastId==e&&p(n)}(o)},t._onResetToasts=function(e,o,r){i.toast.timeoutPromise&&(n.cancel(i.toast.timeoutPromise),i.toast.timeoutPromise=null),t.configureTimer(i.toast)},a.setup(),a.subscribeToNewToastEvent(t._onNewToast),a.subscribeToClearToastsEvent(t._onClearToasts),a.subscribeToResetToastsEvent(t._onResetToasts)},controller:["$scope","$element","$attrs",function(e,t,o){e.stopTimer=function(t){!0===e.config.mouseoverTimer&&t.timeoutPromise&&(n.cancel(t.timeoutPromise),t.timeoutPromise=null)},e.restartTimer=function(t){!0===e.config.mouseoverTimer?t.timeoutPromise||e.configureTimer(t):null===t.timeoutPromise&&e.removeToast(t.toastId)},e.click=function(t,n,o){if(t.stopPropagation(),!0===("boolean"==typeof n.tapToDismiss?n.tapToDismiss:e.config.tap)||!0===n.showCloseButton&&!0===o){var r=!0;n.clickHandler&&(angular.isFunction(n.clickHandler)?r=n.clickHandler(n,o):angular.isFunction(e.$parent.$eval(n.clickHandler))&&(r=e.$parent.$eval(n.clickHandler)(n,o))),r&&e.removeToast(n.toastId)}}}],templateUrl:"angularjs-toaster/toast.html"}}]),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).TheGraph=e()}}(function(){return function(){return function e(t,n,o){function r(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var p=n[a]={exports:{}};t[a][0].call(p.exports,function(e){return r(t[a][1][e]||e)},p,p.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}}()({1:[function(e,t,n){var o={};o.fbpGraph=e("fbp-graph"),o.Ease=e("ease-component"),"undefined"!=typeof window&&void 0===window.Ease&&(window.Ease=o.Ease);var r={TheGraph:o};o.factories=e("./the-graph/factories.js"),o.merge=e("./the-graph/merge.js"),e("./the-graph/the-graph.js").register(r),e("./the-graph/the-graph-app.js").register(r),e("./the-graph/the-graph-graph.js").register(r),e("./the-graph/the-graph-node.js").register(r),e("./the-graph/the-graph-port.js").register(r),e("./the-graph/the-graph-edge.js").register(r),e("./the-graph/the-graph-iip.js").register(r),e("./the-graph/the-graph-group.js").register(r),e("./the-graph/iconfont-unicode-map.js").register(r),o.tooltip=e("./the-graph/the-graph-tooltip.js"),o.Tooltip=o.tooltip.Tooltip,o.config.tooltip=o.tooltip.config,o.factories.tooltip=o.tooltip.factories,o.mixins=e("./the-graph/mixins.js"),o.arcs=e("./the-graph/arcs.js"),o.thumb=e("./the-graph-thumb/the-graph-thumb.js"),o.nav=e("./the-graph-nav/the-graph-nav.js"),o.autolayout=e("./the-graph/the-graph-autolayout.js"),o.library=e("./the-graph/the-graph-library.js"),o.EdgeAnimator=e("./the-graph/the-graph-edge-animator.js"),t.exports=o},{"./the-graph-nav/the-graph-nav.js":19,"./the-graph-thumb/the-graph-thumb.js":20,"./the-graph/arcs.js":21,"./the-graph/factories.js":23,"./the-graph/iconfont-unicode-map.js":24,"./the-graph/merge.js":25,"./the-graph/mixins.js":26,"./the-graph/the-graph-app.js":27,"./the-graph/the-graph-autolayout.js":28,"./the-graph/the-graph-edge-animator.js":29,"./the-graph/the-graph-edge.js":30,"./the-graph/the-graph-graph.js":31,"./the-graph/the-graph-group.js":32,"./the-graph/the-graph-iip.js":33,"./the-graph/the-graph-library.js":34,"./the-graph/the-graph-node.js":35,"./the-graph/the-graph-port.js":36,"./the-graph/the-graph-tooltip.js":37,"./the-graph/the-graph.js":38,"ease-component":6,"fbp-graph":8}],2:[function(e,t,n){n.byteLength=function(e){var t=c(e),n=t[0],o=t[1];return 3*(n+o)/4-o},n.toByteArray=function(e){var t,n,o=c(e),a=o[0],s=o[1],l=new i(function(e,t,n){return 3*(t+n)/4-n}(0,a,s)),p=0,u=s>0?a-4:a;for(n=0;n<u;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],l[p++]=t>>16&255,l[p++]=t>>8&255,l[p++]=255&t;2===s&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,l[p++]=255&t);1===s&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,l[p++]=t>>8&255,l[p++]=255&t);return l},n.fromByteArray=function(e){for(var t,n=e.length,r=n%3,i=[],a=0,s=n-r;a<s;a+=16383)i.push(p(e,a,a+16383>s?s:a+16383));1===r?(t=e[n-1],i.push(o[t>>2]+o[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],i.push(o[t>>10]+o[t>>4&63]+o[t<<2&63]+"="));return i.join("")};for(var o=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=a.length;s<l;++s)o[s]=a[s],r[a.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function p(e,t,n){for(var r,i,a=[],s=t;s<n;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(o[(i=r)>>18&63]+o[i>>12&63]+o[i>>6&63]+o[63&i]);return a.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},{}],3:[function(e,t,n){},{}],4:[function(e,t,n){(function(t){(function(){var t=e("base64-js"),o=e("ieee754"),r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=s,n.SlowBuffer=function(e){+e!=e&&(e=0);return s.alloc(+e)},n.INSPECT_MAX_BYTES=50;var i=2147483647;function a(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,s.prototype),t}function s(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return p(e)}return l(e,t,n)}function l(e,t,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!s.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|h(e,t),o=a(n),r=o.write(e,t);r!==n&&(o=o.slice(0,r));return o}(e,t);if(ArrayBuffer.isView(e))return function(e){if(z(e,Uint8Array)){var t=new Uint8Array(e);return d(t.buffer,t.byteOffset,t.byteLength)}return u(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(z(e,ArrayBuffer)||e&&z(e.buffer,ArrayBuffer))return d(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(z(e,SharedArrayBuffer)||e&&z(e.buffer,SharedArrayBuffer)))return d(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var o=e.valueOf&&e.valueOf();if(null!=o&&o!==e)return s.from(o,t,n);var r=function(e){if(s.isBuffer(e)){var t=0|f(e.length),n=a(t);return 0===n.length?n:(e.copy(n,0,0,t),n)}if(void 0!==e.length)return"number"!=typeof e.length||F(e.length)?a(0):u(e);if("Buffer"===e.type&&Array.isArray(e.data))return u(e.data)}(e);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function p(e){return c(e),a(e<0?0:0|f(e))}function u(e){for(var t=e.length<0?0:0|f(e.length),n=a(t),o=0;o<t;o+=1)n[o]=255&e[o];return n}function d(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var o;return o=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(o,s.prototype),o}function f(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function h(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||z(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,o=arguments.length>2&&!0===arguments[2];if(!o&&0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return R(e).length;default:if(r)return o?-1:U(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var o=e[t];e[t]=e[n],e[n]=o}function g(e,t,n,o,r){if(0===e.length)return-1;if("string"==typeof n?(o=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),F(n=+n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=s.from(t,o)),s.isBuffer(t))return 0===t.length?-1:v(e,t,n,o,r);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,o,r);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,o,r){var i,a=1,s=e.length,l=t.length;if(void 0!==o&&("ucs2"===(o=String(o).toLowerCase())||"ucs-2"===o||"utf16le"===o||"utf-16le"===o)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(r){var p=-1;for(i=n;i<s;i++)if(c(e,i)===c(t,-1===p?0:i-p)){if(-1===p&&(p=i),i-p+1===l)return p*a}else-1!==p&&(i-=i-p),p=-1}else for(n+l>s&&(n=s-l),i=n;i>=0;i--){for(var u=!0,d=0;d<l;d++)if(c(e,i+d)!==c(t,d)){u=!1;break}if(u)return i}return-1}function b(e,t,n,o){n=Number(n)||0;var r=e.length-n;o?(o=Number(o))>r&&(o=r):o=r;var i=t.length;o>i/2&&(o=i/2);for(var a=0;a<o;++a){var s=parseInt(t.substr(2*a,2),16);if(F(s))return a;e[n+a]=s}return a}function y(e,t,n,o){return L(U(t,e.length-n),e,n,o)}function w(e,t,n,o){return L(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,o)}function x(e,t,n,o){return L(R(t),e,n,o)}function $(e,t,n,o){return L(function(e,t){for(var n,o,r,i=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),o=n>>8,r=n%256,i.push(r),i.push(o);return i}(t,e.length-n),e,n,o)}function C(e,n,o){return 0===n&&o===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(n,o))}function _(e,t,n){n=Math.min(e.length,n);for(var o=[],r=t;r<n;){var i,a,s,l,c=e[r],p=null,u=c>239?4:c>223?3:c>191?2:1;if(r+u<=n)switch(u){case 1:c<128&&(p=c);break;case 2:128==(192&(i=e[r+1]))&&(l=(31&c)<<6|63&i)>127&&(p=l);break;case 3:i=e[r+1],a=e[r+2],128==(192&i)&&128==(192&a)&&(l=(15&c)<<12|(63&i)<<6|63&a)>2047&&(l<55296||l>57343)&&(p=l);break;case 4:i=e[r+1],a=e[r+2],s=e[r+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(p=l)}null===p?(p=65533,u=1):p>65535&&(p-=65536,o.push(p>>>10&1023|55296),p=56320|1023&p),o.push(p),r+=u}return function(e){var t=e.length;if(t<=k)return String.fromCharCode.apply(String,e);var n="",o=0;for(;o<t;)n+=String.fromCharCode.apply(String,e.slice(o,o+=k));return n}(o)}n.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(e,t,n){return l(e,t,n)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(e,t,n){return function(e,t,n){return c(e),e<=0?a(e):void 0!==t?"string"==typeof n?a(e).fill(t,n):a(e).fill(t):a(e)}(e,t,n)},s.allocUnsafe=function(e){return p(e)},s.allocUnsafeSlow=function(e){return p(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==s.prototype},s.compare=function(e,t){if(z(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),z(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,o=t.length,r=0,i=Math.min(n,o);r<i;++r)if(e[r]!==t[r]){n=e[r],o=t[r];break}return n<o?-1:o<n?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var o=s.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var i=e[n];if(z(i,Uint8Array))r+i.length>o.length?s.from(i).copy(o,r):Uint8Array.prototype.set.call(o,i,r);else{if(!s.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(o,r)}r+=i.length}return o},s.byteLength=h,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},s.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?_(this,0,e):function(e,t,n){var o=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return I(this,t,n);case"utf8":case"utf-8":return _(this,t,n);case"ascii":return S(this,t,n);case"latin1":case"binary":return T(this,t,n);case"base64":return C(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,n);default:if(o)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},r&&(s.prototype[r]=s.prototype.inspect),s.prototype.compare=function(e,t,n,o,r){if(z(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===o&&(o=0),void 0===r&&(r=this.length),t<0||n>e.length||o<0||r>this.length)throw new RangeError("out of range index");if(o>=r&&t>=n)return 0;if(o>=r)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(r>>>=0)-(o>>>=0),a=(n>>>=0)-(t>>>=0),l=Math.min(i,a),c=this.slice(o,r),p=e.slice(t,n),u=0;u<l;++u)if(c[u]!==p[u]){i=c[u],a=p[u];break}return i<a?-1:a<i?1:0},s.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},s.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},s.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},s.prototype.write=function(e,t,n,o){if(void 0===t)o="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)o=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===o&&(o="utf8")):(o=n,n=void 0)}var r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");o||(o="utf8");for(var i=!1;;)switch(o){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return y(this,e,t,n);case"ascii":case"latin1":case"binary":return w(this,e,t,n);case"base64":return x(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),i=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var k=4096;function S(e,t,n){var o="";n=Math.min(e.length,n);for(var r=t;r<n;++r)o+=String.fromCharCode(127&e[r]);return o}function T(e,t,n){var o="";n=Math.min(e.length,n);for(var r=t;r<n;++r)o+=String.fromCharCode(e[r]);return o}function I(e,t,n){var o=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>o)&&(n=o);for(var r="",i=t;i<n;++i)r+=j[e[i]];return r}function E(e,t,n){for(var o=e.slice(t,n),r="",i=0;i<o.length-1;i+=2)r+=String.fromCharCode(o[i]+256*o[i+1]);return r}function N(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function O(e,t,n,o,r,i){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<i)throw new RangeError('"value" argument is out of bounds');if(n+o>e.length)throw new RangeError("Index out of range")}function D(e,t,n,o,r,i){if(n+o>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function P(e,t,n,r,i){return t=+t,n>>>=0,i||D(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function A(e,t,n,r,i){return t=+t,n>>>=0,i||D(e,0,n,8),o.write(e,t,n,r,52,8),n+8}s.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var o=this.subarray(e,t);return Object.setPrototypeOf(o,s.prototype),o},s.prototype.readUintLE=s.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||N(e,t,this.length);for(var o=this[e],r=1,i=0;++i<t&&(r*=256);)o+=this[e+i]*r;return o},s.prototype.readUintBE=s.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||N(e,t,this.length);for(var o=this[e+--t],r=1;t>0&&(r*=256);)o+=this[e+--t]*r;return o},s.prototype.readUint8=s.prototype.readUInt8=function(e,t){return e>>>=0,t||N(e,1,this.length),this[e]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||N(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||N(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||N(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||N(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||N(e,t,this.length);for(var o=this[e],r=1,i=0;++i<t&&(r*=256);)o+=this[e+i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*t)),o},s.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||N(e,t,this.length);for(var o=t,r=1,i=this[e+--o];o>0&&(r*=256);)i+=this[e+--o]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*t)),i},s.prototype.readInt8=function(e,t){return e>>>=0,t||N(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||N(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(e,t){e>>>=0,t||N(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||N(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||N(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return e>>>=0,t||N(e,4,this.length),o.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||N(e,4,this.length),o.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||N(e,8,this.length),o.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||N(e,8,this.length),o.read(this,e,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(e,t,n,o){(e=+e,t>>>=0,n>>>=0,o)||O(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,i=0;for(this[t]=255&e;++i<n&&(r*=256);)this[t+i]=e/r&255;return t+n},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(e,t,n,o){(e=+e,t>>>=0,n>>>=0,o)||O(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,i=1;for(this[t+r]=255&e;--r>=0&&(i*=256);)this[t+r]=e/i&255;return t+n},s.prototype.writeUint8=s.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeIntLE=function(e,t,n,o){if(e=+e,t>>>=0,!o){var r=Math.pow(2,8*n-1);O(this,e,t,n,r-1,-r)}var i=0,a=1,s=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},s.prototype.writeIntBE=function(e,t,n,o){if(e=+e,t>>>=0,!o){var r=Math.pow(2,8*n-1);O(this,e,t,n,r-1,-r)}var i=n-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},s.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||O(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeFloatLE=function(e,t,n){return P(this,e,t,!0,n)},s.prototype.writeFloatBE=function(e,t,n){return P(this,e,t,!1,n)},s.prototype.writeDoubleLE=function(e,t,n){return A(this,e,t,!0,n)},s.prototype.writeDoubleBE=function(e,t,n){return A(this,e,t,!1,n)},s.prototype.copy=function(e,t,n,o){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),o||0===o||(o=this.length),t>=e.length&&(t=e.length),t||(t=0),o>0&&o<n&&(o=n),o===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),e.length-t<o-n&&(o=e.length-t+n);var r=o-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,o):Uint8Array.prototype.set.call(e,this.subarray(n,o),t),r},s.prototype.fill=function(e,t,n,o){if("string"==typeof e){if("string"==typeof t?(o=t,t=0,n=this.length):"string"==typeof n&&(o=n,n=this.length),void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!s.isEncoding(o))throw new TypeError("Unknown encoding: "+o);if(1===e.length){var r=e.charCodeAt(0);("utf8"===o&&r<128||"latin1"===o)&&(e=r)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var a=s.isBuffer(e)?e:s.from(e,o),l=a.length;if(0===l)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=a[i%l]}return this};var M=/[^+/0-9A-Za-z-_]/g;function U(e,t){var n;t=t||1/0;for(var o=e.length,r=null,i=[],a=0;a<o;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===o){(t-=3)>-1&&i.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&i.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function R(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(M,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function L(e,t,n,o){for(var r=0;r<o&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}function z(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function F(e){return e!=e}var j=function(){for(var e=new Array(256),t=0;t<16;++t)for(var n=16*t,o=0;o<16;++o)e[n+o]="0123456789abcdef"[t]+"0123456789abcdef"[o];return e}()}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":2,buffer:4,ieee754:16}],5:[function(e,t,n){(function(e){(function(){var n=function(){function t(e,t){return null!=t&&e instanceof t}var n,o,r;try{n=Map}catch(e){n=function(){}}try{o=Set}catch(e){o=function(){}}try{r=Promise}catch(e){r=function(){}}function i(a,l,c,p,u){"object"==typeof l&&(c=l.depth,p=l.prototype,u=l.includeNonEnumerable,l=l.circular);var d=[],f=[],h=void 0!==e;return void 0===l&&(l=!0),void 0===c&&(c=1/0),function a(c,m){if(null===c)return null;if(0===m)return c;var g,v;if("object"!=typeof c)return c;if(t(c,n))g=new n;else if(t(c,o))g=new o;else if(t(c,r))g=new r(function(e,t){c.then(function(t){e(a(t,m-1))},function(e){t(a(e,m-1))})});else if(i.__isArray(c))g=[];else if(i.__isRegExp(c))g=new RegExp(c.source,s(c)),c.lastIndex&&(g.lastIndex=c.lastIndex);else if(i.__isDate(c))g=new Date(c.getTime());else{if(h&&e.isBuffer(c))return g=e.allocUnsafe?e.allocUnsafe(c.length):new e(c.length),c.copy(g),g;t(c,Error)?g=Object.create(c):void 0===p?(v=Object.getPrototypeOf(c),g=Object.create(v)):(g=Object.create(p),v=p)}if(l){var b=d.indexOf(c);if(-1!=b)return f[b];d.push(c),f.push(g)}for(var y in t(c,n)&&c.forEach(function(e,t){var n=a(t,m-1),o=a(e,m-1);g.set(n,o)}),t(c,o)&&c.forEach(function(e){var t=a(e,m-1);g.add(t)}),c){var w;v&&(w=Object.getOwnPropertyDescriptor(v,y)),w&&null==w.set||(g[y]=a(c[y],m-1))}if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(c);for(y=0;y<x.length;y++){var $=x[y];(!(_=Object.getOwnPropertyDescriptor(c,$))||_.enumerable||u)&&(g[$]=a(c[$],m-1),_.enumerable||Object.defineProperty(g,$,{enumerable:!1}))}}if(u){var C=Object.getOwnPropertyNames(c);for(y=0;y<C.length;y++){var _,k=C[y];(_=Object.getOwnPropertyDescriptor(c,k))&&_.enumerable||(g[k]=a(c[k],m-1),Object.defineProperty(g,k,{enumerable:!1}))}}return g}(a,c)}function a(e){return Object.prototype.toString.call(e)}function s(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return i.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},i.__objToStr=a,i.__isDate=function(e){return"object"==typeof e&&"[object Date]"===a(e)},i.__isArray=function(e){return"object"==typeof e&&"[object Array]"===a(e)},i.__isRegExp=function(e){return"object"==typeof e&&"[object RegExp]"===a(e)},i.__getRegExpFlags=s,i}();"object"==typeof t&&t.exports&&(t.exports=n)}).call(this)}).call(this,e("buffer").Buffer)},{buffer:4}],6:[function(e,t,n){n.linear=function(e){return e},n.inQuad=function(e){return e*e},n.outQuad=function(e){return e*(2-e)},n.inOutQuad=function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},n.inCube=function(e){return e*e*e},n.outCube=function(e){return--e*e*e+1},n.inOutCube=function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},n.inQuart=function(e){return e*e*e*e},n.outQuart=function(e){return 1- --e*e*e*e},n.inOutQuart=function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},n.inQuint=function(e){return e*e*e*e*e},n.outQuint=function(e){return--e*e*e*e*e+1},n.inOutQuint=function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},n.inSine=function(e){return 1-Math.cos(e*Math.PI/2)},n.outSine=function(e){return Math.sin(e*Math.PI/2)},n.inOutSine=function(e){return.5*(1-Math.cos(Math.PI*e))},n.inExpo=function(e){return 0==e?0:Math.pow(1024,e-1)},n.outExpo=function(e){return 1==e?e:1-Math.pow(2,-10*e)},n.inOutExpo=function(e){return 0==e?0:1==e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},n.inCirc=function(e){return 1-Math.sqrt(1-e*e)},n.outCirc=function(e){return Math.sqrt(1- --e*e)},n.inOutCirc=function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},n.inBack=function(e){var t=1.70158;return e*e*((t+1)*e-t)},n.outBack=function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},n.inOutBack=function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)},n.inBounce=function(e){return 1-n.outBounce(1-e)},n.outBounce=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},n.inOutBounce=function(e){return e<.5?.5*n.inBounce(2*e):.5*n.outBounce(2*e-1)+.5},n["in-quad"]=n.inQuad,n["out-quad"]=n.outQuad,n["in-out-quad"]=n.inOutQuad,n["in-cube"]=n.inCube,n["out-cube"]=n.outCube,n["in-out-cube"]=n.inOutCube,n["in-quart"]=n.inQuart,n["out-quart"]=n.outQuart,n["in-out-quart"]=n.inOutQuart,n["in-quint"]=n.inQuint,n["out-quint"]=n.outQuint,n["in-out-quint"]=n.inOutQuint,n["in-sine"]=n.inSine,n["out-sine"]=n.outSine,n["in-out-sine"]=n.inOutSine,n["in-expo"]=n.inExpo,n["out-expo"]=n.outExpo,n["in-out-expo"]=n.inOutExpo,n["in-circ"]=n.inCirc,n["out-circ"]=n.outCirc,n["in-out-circ"]=n.inOutCirc,n["in-back"]=n.inBack,n["out-back"]=n.outBack,n["in-out-back"]=n.inOutBack,n["in-bounce"]=n.inBounce,n["out-bounce"]=n.outBounce,n["in-out-bounce"]=n.inOutBounce},{}],7:[function(e,t,n){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},o.prototype.emit=function(e){var t,n,o,s,l,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var p=new Error('Uncaught, unspecified "error" event. ('+t+")");throw p.context=t,p}if(a(n=this._events[e]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(i(n))for(s=Array.prototype.slice.call(arguments,1),o=(c=n.slice()).length,l=0;l<o;l++)c[l].apply(this,s);return!0},o.prototype.addListener=function(e,t){var n;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(n=a(this._maxListeners)?o.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(e,t){if(!r(t))throw TypeError("listener must be a function");var n=!1;function o(){this.removeListener(e,o),n||(n=!0,t.apply(this,arguments))}return o.listener=t,this.on(e,o),this},o.prototype.removeListener=function(e,t){var n,o,a,s;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(a=(n=this._events[e]).length,o=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(n)){for(s=a;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){o=s;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},o.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},o.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},o.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},o.listenerCount=function(e,t){return e.listenerCount(t)}},{}],8:[function(e,t,n){n.graph=e("./lib/Graph"),n.Graph=n.graph.Graph,n.journal=e("./lib/Journal"),n.Journal=n.journal.Journal},{"./lib/Graph":9,"./lib/Journal":10}],9:[function(e,t,n){(function(){var t,o,r,i,a,s,l={}.hasOwnProperty;t=e("events").EventEmitter,r=e("clone"),a=e("./Platform"),o=function(n){function o(e,t){this.name=null!=e?e:"",null==t&&(t={}),this.properties={},this.nodes=[],this.edges=[],this.initializers=[],this.exports=[],this.inports={},this.outports={},this.groups=[],this.transaction={id:null,depth:0},this.caseSensitive=t.caseSensitive||!1}return function(e,t){for(var n in t)l.call(t,n)&&(e[n]=t[n]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(o,t),o.prototype.name="",o.prototype.caseSensitive=!1,o.prototype.properties={},o.prototype.nodes=[],o.prototype.edges=[],o.prototype.initializers=[],o.prototype.exports=[],o.prototype.inports={},o.prototype.outports={},o.prototype.groups=[],o.prototype.getPortName=function(e){return this.caseSensitive?e:e.toLowerCase()},o.prototype.startTransaction=function(e,t){if(this.transaction.id)throw Error("Nested transactions not supported");return this.transaction.id=e,this.transaction.depth=1,this.emit("startTransaction",e,t)},o.prototype.endTransaction=function(e,t){if(!this.transaction.id)throw Error("Attempted to end non-existing transaction");return this.transaction.id=null,this.transaction.depth=0,this.emit("endTransaction",e,t)},o.prototype.checkTransactionStart=function(){return this.transaction.id?"implicit"===this.transaction.id?this.transaction.depth+=1:void 0:this.startTransaction("implicit")},o.prototype.checkTransactionEnd=function(){if("implicit"===this.transaction.id&&(this.transaction.depth-=1),0===this.transaction.depth)return this.endTransaction("implicit")},o.prototype.setProperties=function(e){var t,n,o;for(n in this.checkTransactionStart(),t=r(this.properties),e)o=e[n],this.properties[n]=o;return this.emit("changeProperties",this.properties,t),this.checkTransactionEnd()},o.prototype.addExport=function(e,t,n,o){var r;if(null==o&&(o={x:0,y:0}),a.deprecated("fbp-graph.Graph exports is deprecated: please use specific inport or outport instead"),this.getNode(t))return this.checkTransactionStart(),r={public:this.getPortName(e),process:t,port:this.getPortName(n),metadata:o},this.exports.push(r),this.emit("addExport",r),this.checkTransactionEnd()},o.prototype.removeExport=function(e){var t,n,o,r,i,s;for(a.deprecated("fbp-graph.Graph exports is deprecated: please use specific inport or outport instead"),e=this.getPortName(e),n=null,r=o=0,i=(s=this.exports).length;o<i;r=++o)(t=s[r]).public===e&&(n=t);if(n)return this.checkTransactionStart(),this.exports.splice(this.exports.indexOf(n),1),this.emit("removeExport",n),this.checkTransactionEnd()},o.prototype.addInport=function(e,t,n,o){if(this.getNode(t))return e=this.getPortName(e),this.checkTransactionStart(),this.inports[e]={process:t,port:this.getPortName(n),metadata:o},this.emit("addInport",e,this.inports[e]),this.checkTransactionEnd()},o.prototype.removeInport=function(e){var t;if(e=this.getPortName(e),this.inports[e])return this.checkTransactionStart(),t=this.inports[e],this.setInportMetadata(e,{}),delete this.inports[e],this.emit("removeInport",e,t),this.checkTransactionEnd()},o.prototype.renameInport=function(e,t){if(e=this.getPortName(e),t=this.getPortName(t),this.inports[e])return this.checkTransactionStart(),this.inports[t]=this.inports[e],delete this.inports[e],this.emit("renameInport",e,t),this.checkTransactionEnd()},o.prototype.setInportMetadata=function(e,t){var n,o,i;if(e=this.getPortName(e),this.inports[e]){for(o in this.checkTransactionStart(),n=r(this.inports[e].metadata),this.inports[e].metadata||(this.inports[e].metadata={}),t)null!=(i=t[o])?this.inports[e].metadata[o]=i:delete this.inports[e].metadata[o];return this.emit("changeInport",e,this.inports[e],n),this.checkTransactionEnd()}},o.prototype.addOutport=function(e,t,n,o){if(this.getNode(t))return e=this.getPortName(e),this.checkTransactionStart(),this.outports[e]={process:t,port:this.getPortName(n),metadata:o},this.emit("addOutport",e,this.outports[e]),this.checkTransactionEnd()},o.prototype.removeOutport=function(e){var t;if(e=this.getPortName(e),this.outports[e])return this.checkTransactionStart(),t=this.outports[e],this.setOutportMetadata(e,{}),delete this.outports[e],this.emit("removeOutport",e,t),this.checkTransactionEnd()},o.prototype.renameOutport=function(e,t){if(e=this.getPortName(e),t=this.getPortName(t),this.outports[e])return this.checkTransactionStart(),this.outports[t]=this.outports[e],delete this.outports[e],this.emit("renameOutport",e,t),this.checkTransactionEnd()},o.prototype.setOutportMetadata=function(e,t){var n,o,i;if(e=this.getPortName(e),this.outports[e]){for(o in this.checkTransactionStart(),n=r(this.outports[e].metadata),this.outports[e].metadata||(this.outports[e].metadata={}),t)null!=(i=t[o])?this.outports[e].metadata[o]=i:delete this.outports[e].metadata[o];return this.emit("changeOutport",e,this.outports[e],n),this.checkTransactionEnd()}},o.prototype.addGroup=function(e,t,n){var o;return this.checkTransactionStart(),o={name:e,nodes:t,metadata:n},this.groups.push(o),this.emit("addGroup",o),this.checkTransactionEnd()},o.prototype.renameGroup=function(e,t){var n,o,r,i;for(this.checkTransactionStart(),o=0,r=(i=this.groups).length;o<r;o++)(n=i[o])&&n.name===e&&(n.name=t,this.emit("renameGroup",e,t));return this.checkTransactionEnd()},o.prototype.removeGroup=function(e){var t,n,o,r;for(this.checkTransactionStart(),n=0,o=(r=this.groups).length;n<o;n++)(t=r[n])&&t.name===e&&(this.setGroupMetadata(t.name,{}),this.groups.splice(this.groups.indexOf(t),1),this.emit("removeGroup",t));return this.checkTransactionEnd()},o.prototype.setGroupMetadata=function(e,t){var n,o,i,a,s,l,c;for(this.checkTransactionStart(),i=0,s=(l=this.groups).length;i<s;i++)if((o=l[i])&&o.name===e){for(a in n=r(o.metadata),t)null!=(c=t[a])?o.metadata[a]=c:delete o.metadata[a];this.emit("changeGroup",o,n)}return this.checkTransactionEnd()},o.prototype.addNode=function(e,t,n){var o;return this.checkTransactionStart(),n||(n={}),o={id:e,component:t,metadata:n},this.nodes.push(o),this.emit("addNode",o),this.checkTransactionEnd(),o},o.prototype.removeNode=function(e){var t,n,o,r,i,a,s,l,c,p,u,d,f,h,m,g,v,b,y,w,x,$,C,_,k,S,T,I,E,N,O,D;if(x=this.getNode(e)){for(this.checkTransactionStart(),D=[],r=0,p=(S=this.edges).length;r<p;r++)(t=S[r]).from.node!==x.id&&t.to.node!==x.id||D.push(t);for(s=0,u=D.length;s<u;s++)t=D[s],this.removeEdge(t.from.node,t.from.port,t.to.node,t.to.port);for(D=[],l=0,d=(T=this.initializers).length;l<d;l++)(a=T[l]).to.node===x.id&&D.push(a);for(c=0,f=D.length;c<f;c++)a=D[c],this.removeInitial(a.to.node,a.to.port);for(D=[],y=0,h=(I=this.exports).length;y<h;y++)n=I[y],this.getPortName(e)===n.process&&D.push(n);for(w=0,m=D.length;w<m;w++)n=D[w],this.removeExport(n.public);for(_ in D=[],E=this.inports)E[_].process===e&&D.push(_);for($=0,g=D.length;$<g;$++)_=D[$],this.removeInport(_);for(_ in D=[],N=this.outports)N[_].process===e&&D.push(_);for(C=0,v=D.length;C<v;C++)_=D[C],this.removeOutport(_);for(k=0,b=(O=this.groups).length;k<b;k++)(o=O[k])&&-1!==(i=o.nodes.indexOf(e))&&o.nodes.splice(i,1);return this.setNodeMetadata(e,{}),-1!==this.nodes.indexOf(x)&&this.nodes.splice(this.nodes.indexOf(x),1),this.emit("removeNode",x),this.checkTransactionEnd()}},o.prototype.getNode=function(e){var t,n,o,r;for(t=0,n=(r=this.nodes).length;t<n;t++)if((o=r[t])&&o.id===e)return o;return null},o.prototype.renameNode=function(e,t){var n,o,r,i,a,s,l,c,p,u,d,f,h,m,g,v,b,y,w,x,$,C;if(this.checkTransactionStart(),m=this.getNode(e)){for(m.id=t,i=0,u=(b=this.edges).length;i<u;i++)(n=b[i])&&(n.from.node===e&&(n.from.node=t),n.to.node===e&&(n.to.node=t));for(l=0,d=(y=this.initializers).length;l<d;l++)(a=y[l])&&a.to.node===e&&(a.to.node=t);for(v in w=this.inports)(g=w[v]).process===e&&(g.process=t);for(v in x=this.outports)(g=x[v]).process===e&&(g.process=t);for(c=0,f=($=this.exports).length;c<f;c++)(o=$[c]).process===e&&(o.process=t);for(p=0,h=(C=this.groups).length;p<h;p++)(r=C[p])&&-1!==(s=r.nodes.indexOf(e))&&(r.nodes[s]=t);return this.emit("renameNode",e,t),this.checkTransactionEnd()}},o.prototype.setNodeMetadata=function(e,t){var n,o,i,a;if(i=this.getNode(e)){for(o in this.checkTransactionStart(),n=r(i.metadata),i.metadata||(i.metadata={}),t)null!=(a=t[o])?i.metadata[o]=a:delete i.metadata[o];return this.emit("changeNode",i,n),this.checkTransactionEnd()}},o.prototype.addEdge=function(e,t,n,o,r){var i,a,s,l;for(null==r&&(r={}),t=this.getPortName(t),o=this.getPortName(o),a=0,s=(l=this.edges).length;a<s;a++)if((i=l[a]).from.node===e&&i.from.port===t&&i.to.node===n&&i.to.port===o)return;if(this.getNode(e)&&this.getNode(n))return this.checkTransactionStart(),i={from:{node:e,port:t},to:{node:n,port:o},metadata:r},this.edges.push(i),this.emit("addEdge",i),this.checkTransactionEnd(),i},o.prototype.addEdgeIndex=function(e,t,n,o,r,i,a){var s;if(null==a&&(a={}),this.getNode(e)&&this.getNode(o))return t=this.getPortName(t),r=this.getPortName(r),null===i&&(i=void 0),null===n&&(n=void 0),a||(a={}),this.checkTransactionStart(),s={from:{node:e,port:t,index:n},to:{node:o,port:r,index:i},metadata:a},this.edges.push(s),this.emit("addEdge",s),this.checkTransactionEnd(),s},o.prototype.removeEdge=function(e,t,n,o){var r,i,a,s,l,c,p,u,d,f,h,m;if(this.checkTransactionStart(),t=this.getPortName(t),o=this.getPortName(o),m=[],h=[],n&&o)for(a=i=0,c=(d=this.edges).length;i<c;a=++i)(r=d[a]).from.node===e&&r.from.port===t&&r.to.node===n&&r.to.port===o?(this.setEdgeMetadata(r.from.node,r.from.port,r.to.node,r.to.port,{}),m.push(r)):h.push(r);else for(a=s=0,p=(f=this.edges).length;s<p;a=++s)(r=f[a]).from.node===e&&r.from.port===t||r.to.node===e&&r.to.port===t?(this.setEdgeMetadata(r.from.node,r.from.port,r.to.node,r.to.port,{}),m.push(r)):h.push(r);for(this.edges=h,l=0,u=m.length;l<u;l++)r=m[l],this.emit("removeEdge",r);return this.checkTransactionEnd()},o.prototype.getEdge=function(e,t,n,o){var r,i,a,s,l;for(t=this.getPortName(t),o=this.getPortName(o),a=i=0,s=(l=this.edges).length;i<s;a=++i)if((r=l[a])&&r.from.node===e&&r.from.port===t&&r.to.node===n&&r.to.port===o)return r;return null},o.prototype.setEdgeMetadata=function(e,t,n,o,i){var a,s,l,c;if(s=this.getEdge(e,t,n,o)){for(l in this.checkTransactionStart(),a=r(s.metadata),s.metadata||(s.metadata={}),i)null!=(c=i[l])?s.metadata[l]=c:delete s.metadata[l];return this.emit("changeEdge",s,a),this.checkTransactionEnd()}},o.prototype.addInitial=function(e,t,n,o){var r;if(this.getNode(t))return n=this.getPortName(n),this.checkTransactionStart(),r={from:{data:e},to:{node:t,port:n},metadata:o},this.initializers.push(r),this.emit("addInitial",r),this.checkTransactionEnd(),r},o.prototype.addInitialIndex=function(e,t,n,o,r){var i;if(this.getNode(t))return null===o&&(o=void 0),n=this.getPortName(n),this.checkTransactionStart(),i={from:{data:e},to:{node:t,port:n,index:o},metadata:r},this.initializers.push(i),this.emit("addInitial",i),this.checkTransactionEnd(),i},o.prototype.addGraphInitial=function(e,t,n){var o;if(o=this.inports[t])return this.addInitial(e,o.process,o.port,n)},o.prototype.addGraphInitialIndex=function(e,t,n,o){var r;if(r=this.inports[t])return this.addInitialIndex(e,r.process,r.port,n,o)},o.prototype.removeInitial=function(e,t){var n,o,r,i,a,s,l,c,p;for(t=this.getPortName(t),this.checkTransactionStart(),p=[],c=[],r=o=0,a=(l=this.initializers).length;o<a;r=++o)(n=l[r]).to.node===e&&n.to.port===t?p.push(n):c.push(n);for(this.initializers=c,i=0,s=p.length;i<s;i++)n=p[i],this.emit("removeInitial",n);return this.checkTransactionEnd()},o.prototype.removeGraphInitial=function(e){var t;if(t=this.inports[e])return this.removeInitial(t.process,t.port)},o.prototype.toDOT=function(){var e,t,n,o,r,i,a,s,l,c,p,u,d,f,h,m;for(e=function(e){return e.replace(/\s*/g,"")},t=function(e){return e.replace(/\./g,"")},n="digraph {\n",r=0,c=(f=this.nodes).length;r<c;r++)n+="    "+e((d=f[r]).id)+" [label="+d.id+" shape=box]\n";for(i=s=0,p=(h=this.initializers).length;s<p;i=++s)n+="    data"+i+" [label=\"'"+("function"==typeof(a=h[i]).from.data?"Function":a.from.data)+"'\" shape=plaintext]\n",n+="    data"+i+" -> "+e(a.to.node)+"[headlabel="+t(a.to.port)+" labelfontcolor=blue labelfontsize=8.0]\n";for(l=0,u=(m=this.edges).length;l<u;l++)n+="    "+e((o=m[l]).from.node)+" -> "+e(o.to.node)+"[taillabel="+t(o.from.port)+" headlabel="+t(o.to.port)+" labelfontcolor=blue labelfontsize=8.0]\n";return n+="}"},o.prototype.toYUML=function(){var e,t,n,o,r,i,a,s,l;for(l=[],t=0,r=(a=this.initializers).length;t<r;t++)n=a[t],l.push("(start)["+n.to.port+"]->("+n.to.node+")");for(o=0,i=(s=this.edges).length;o<i;o++)e=s[o],l.push("("+e.from.node+")["+e.from.port+"]->("+e.to.node+")");return l.join(",")},o.prototype.toJSON=function(){var e,t,n,o,r,i,a,s,l,c,p,u,d,f,h,m,g,v,b,y,w,x,$,C,_,k,S,T,I,E;for(y in l={caseSensitive:this.caseSensitive,properties:{},inports:{},outports:{},groups:[],processes:{},connections:[]},this.name&&(l.properties.name=this.name),x=this.properties)E=x[y],l.properties[y]=E;for(w in $=this.inports)b=$[w],l.inports[w]=b;for(w in C=this.outports)b=C[w],l.outports[w]=b;for(i=0,u=(_=this.exports).length;i<u;i++)n=_[i],l.exports||(l.exports=[]),l.exports.push(n);for(s=0,d=(k=this.groups).length;s<d;s++)r={name:(o=k[s]).name,nodes:o.nodes},Object.keys(o.metadata).length&&(r.metadata=o.metadata),l.groups.push(r);for(c=0,f=(S=this.nodes).length;c<f;c++)v=S[c],l.processes[v.id]={component:v.component},v.metadata&&(l.processes[v.id].metadata=v.metadata);for(p=0,h=(T=this.edges).length;p<h;p++)e={src:{process:(t=T[p]).from.node,port:t.from.port,index:t.from.index},tgt:{process:t.to.node,port:t.to.port,index:t.to.index}},Object.keys(t.metadata).length&&(e.metadata=t.metadata),l.connections.push(e);for(g=0,m=(I=this.initializers).length;g<m;g++)a=I[g],l.connections.push({data:a.from.data,tgt:{process:a.to.node,port:a.to.port,index:a.to.index}});return l},o.prototype.save=function(t,n){var o;return a.isBrowser()?n(new Error("Saving graphs not supported on browser")):(o=JSON.stringify(this.toJSON(),null,4),e("fs").writeFile(t+".json",o,"utf-8",function(e,o){if(e)throw e;return n(t)}))},o}(),n.Graph=o,n.createGraph=function(e,t){return new o(e,t)},n.loadJSON=function(e,t,n){var r,i,a,s,l,c,p,u,d,f,h,m,g,v,b,y,w,x,$,C,_,k,S,T,I,E,N,O;for(x in null==n&&(n={}),"string"==typeof e&&(e=JSON.parse(e)),e.properties||(e.properties={}),e.processes||(e.processes={}),e.connections||(e.connections=[]),r=e.caseSensitive||!1,(l=new o(e.properties.name,{caseSensitive:r})).startTransaction("loadJSON",n),w={},C=e.properties)O=C[x],"name"!==x&&(w[x]=O);for(u in l.setProperties(w),_=e.processes)(a=_[u]).metadata||(a.metadata={}),l.addNode(u,a.component,a.metadata);for(p=0,h=(k=e.connections).length;p<h;p++)n=(i=k[p]).metadata?i.metadata:{},void 0===i.data?"number"!=typeof i.src.index&&"number"!=typeof i.tgt.index?l.addEdge(i.src.process,l.getPortName(i.src.port),i.tgt.process,l.getPortName(i.tgt.port),n):l.addEdgeIndex(i.src.process,l.getPortName(i.src.port),i.src.index,i.tgt.process,l.getPortName(i.tgt.port),i.tgt.index,n):"number"==typeof i.tgt.index?l.addInitialIndex(i.data,i.tgt.process,l.getPortName(i.tgt.port),i.tgt.index,n):l.addInitial(i.data,i.tgt.process,l.getPortName(i.tgt.port),n);if(e.exports&&e.exports.length)for(d=0,m=(S=e.exports).length;d<m;d++){if((s=S[d]).private){if(2!==(N=s.private.split(".")).length)continue;for(u in y=N[0],v=N[1],e.processes)l.getPortName(u)===l.getPortName(y)&&(y=u)}else y=s.process,v=l.getPortName(s.port);l.addExport(s.public,y,v,s.metadata)}if(e.inports)for($ in T=e.inports)b=T[$],l.addInport($,b.process,l.getPortName(b.port),b.metadata);if(e.outports)for($ in I=e.outports)b=I[$],l.addOutport($,b.process,l.getPortName(b.port),b.metadata);if(e.groups)for(f=0,g=(E=e.groups).length;f<g;f++)c=E[f],l.addGroup(c.name,c.nodes,c.metadata||{});return l.endTransaction("loadJSON"),t(null,l)},n.loadFBP=function(t,o,r,i){var a,s;null==r&&(r={}),null==i&&(i=!1);try{a=e("fbp").parse(t,{caseSensitive:i})}catch(s){return o(s)}return n.loadJSON(a,o,r)},n.loadHTTP=function(e,t){var n;return(n=new XMLHttpRequest).onreadystatechange=function(){if(4===n.readyState)return 200!==n.status?t(new Error("Failed to load "+e+": HTTP "+n.status)):t(null,n.responseText)},n.open("GET",e,!0),n.send()},n.loadFile=function(t,o,r,i){if(null==r&&(r={}),null==i&&(i=!1),!a.isBrowser())return e("fs").readFile(t,"utf-8",function(e,r){var a;return e?o(e):"fbp"===t.split(".").pop()?n.loadFBP(r,o,{},i):(a=JSON.parse(r),n.loadJSON(a,o,{}))});n.loadHTTP(t,function(e,i){var a;return e?o(e):"fbp"===t.split(".").pop()?n.loadFBP(i,o,r):(a=JSON.parse(i),n.loadJSON(a,o,r))})},s=function(e){var t,n,o,i,a,s,l,c,p,u,d,f,h,m,g,v,b,y,w,x,$,C,_,k;for(i=0,p=(b=r(e.groups).reverse()).length;i<p;i++)null!=(o=b[i])&&e.removeGroup(o.name);for(v in y=r(e.outports))y[v],e.removeOutport(v);for(v in w=r(e.inports))w[v],e.removeInport(v);for(s=0,u=(x=r(e.exports.reverse())).length;s<u;s++)n=x[s],e.removeExport(n.public);for(e.setProperties({}),l=0,d=($=r(e.initializers).reverse()).length;l<d;l++)a=$[l],e.removeInitial(a.to.node,a.to.port);for(c=0,f=(C=r(e.edges).reverse()).length;c<f;c++)t=C[c],e.removeEdge(t.from.node,t.from.port,t.to.node,t.to.port);for(k=[],m=0,h=(_=r(e.nodes).reverse()).length;m<h;m++)g=_[m],k.push(e.removeNode(g.id));return k},i=function(e,t){var n,o,r,i,a,l,c,p,u,d,f,h,m,g,v,b,y,w,x,$,C,_,k,S,T;for(s(e),i=0,u=(w=t.nodes).length;i<u;i++)v=w[i],e.addNode(v.id,v.component,v.metadata);for(l=0,d=(x=t.edges).length;l<d;l++)n=x[l],e.addEdge(n.from.node,n.from.port,n.to.node,n.to.port,n.metadata);for(c=0,f=($=t.initializers).length;c<f;c++)a=$[c],e.addInitial(a.from.data,a.to.node,a.to.port,a.metadata);for(p=0,h=(C=t.exports).length;p<h;p++)o=C[p],e.addExport(o.public,o.node,o.port,o.metadata);for(y in e.setProperties(t.properties),_=t.inports)b=_[y],e.addInport(y,b.process,b.port,b.metadata);for(y in k=t.outports)b=k[y],e.addOutport(y,b.process,b.port,b.metadata);for(T=[],g=0,m=(S=t.groups).length;g<m;g++)r=S[g],T.push(e.addGroup(r.name,r.nodes,r.metadata));return T},n.equivalent=function(e,t,n){return null==n&&(n={}),JSON.stringify(e)===JSON.stringify(t)},n.mergeResolveTheirs=i}).call(this)},{"./Platform":11,clone:5,events:7,fbp:13,fs:3}],10:[function(e,t,n){(function(){var t,o,r,i,a,s,l,c=function(e,t){for(var n in t)p.call(t,n)&&(e[n]=t[n]);function o(){this.constructor=e}return o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype,e},p={}.hasOwnProperty,u=function(e,t){return function(){return e.apply(t,arguments)}};t=e("events").EventEmitter,s=e("clone"),l=function(e){var t;switch(t=e.args,e.cmd){case"addNode":return t.id+"("+t.component+")";case"removeNode":return"DEL "+t.id+"("+t.component+")";case"renameNode":return"RENAME "+t.oldId+" "+t.newId;case"changeNode":return"META "+t.id;case"addEdge":return t.from.node+" "+t.from.port+" -> "+t.to.port+" "+t.to.node;case"removeEdge":return t.from.node+" "+t.from.port+" -X> "+t.to.port+" "+t.to.node;case"changeEdge":return"META "+t.from.node+" "+t.from.port+" -> "+t.to.port+" "+t.to.node;case"addInitial":return"'"+t.from.data+"' -> "+t.to.port+" "+t.to.node;case"removeInitial":return"'"+t.from.data+"' -X> "+t.to.port+" "+t.to.node;case"startTransaction":return">>> "+e.rev+": "+t.id;case"endTransaction":return"<<< "+e.rev+": "+t.id;case"changeProperties":return"PROPERTIES";case"addGroup":return"GROUP "+t.name;case"renameGroup":return"RENAME GROUP "+t.oldName+" "+t.newName;case"removeGroup":return"DEL GROUP "+t.name;case"changeGroup":return"META GROUP "+t.name;case"addInport":return"INPORT "+t.name;case"removeInport":return"DEL INPORT "+t.name;case"renameInport":return"RENAME INPORT "+t.oldId+" "+t.newId;case"changeInport":return"META INPORT "+t.name;case"addOutport":return"OUTPORT "+t.name;case"removeOutport":return"DEL OUTPORT "+t.name;case"renameOutport":return"RENAME OUTPORT "+t.oldId+" "+t.newId;case"changeOutport":return"META OUTPORT "+t.name;default:throw new Error("Unknown journal entry: "+e.cmd)}},a=function(e,t){var n,o,r;for(n in o={},e)r=e[n],o[n]=null;for(n in t)r=t[n],o[n]=r;return o},r=function(e){function n(e){this.graph=e,this.lastRevision=0}return c(n,t),n.prototype.lastRevision=0,n.prototype.putTransaction=function(e,t){return e>this.lastRevision&&(this.lastRevision=e),this.emit("transaction",e)},n.prototype.fetchTransaction=function(e,t){},n}(),i=function(e){function t(e){t.__super__.constructor.call(this,e),this.transactions=[]}return c(t,r),t.prototype.putTransaction=function(e,n){return t.__super__.putTransaction.call(this,e,n),this.transactions[e]=n},t.prototype.fetchTransaction=function(e){return this.transactions[e]},t}(),o=function(n){function o(e,t,n){var o,r,a,s,l,c,p,d,f,h,m,g,v,b,y,w,x,$,C,_,k;if(this.endTransaction=u(this.endTransaction,this),this.startTransaction=u(this.startTransaction,this),this.graph=e,this.entries=[],this.subscribed=!0,this.store=n||new i(this.graph),0===this.store.transactions.length){for(this.currentRevision=-1,this.startTransaction("initial",t),s=0,p=(b=this.graph.nodes).length;s<p;s++)v=b[s],this.appendCommand("addNode",v);for(c=0,d=(y=this.graph.edges).length;c<d;c++)o=y[c],this.appendCommand("addEdge",o);for(m=0,f=(w=this.graph.initializers).length;m<f;m++)a=w[m],this.appendCommand("addInitial",a);for(l in Object.keys(this.graph.properties).length>0&&this.appendCommand("changeProperties",this.graph.properties,{}),x=this.graph.inports)_=x[l],this.appendCommand("addInport",{name:l,port:_});for(l in $=this.graph.outports)_=$[l],this.appendCommand("addOutport",{name:l,port:_});for(g=0,h=(C=this.graph.groups).length;g<h;g++)r=C[g],this.appendCommand("addGroup",r);this.endTransaction("initial",t)}else this.currentRevision=this.store.lastRevision;this.graph.on("addNode",(k=this,function(e){return k.appendCommand("addNode",e)})),this.graph.on("removeNode",function(e){return function(t){return e.appendCommand("removeNode",t)}}(this)),this.graph.on("renameNode",function(e){return function(t,n){var o;return o={oldId:t,newId:n},e.appendCommand("renameNode",o)}}(this)),this.graph.on("changeNode",function(e){return function(t,n){return e.appendCommand("changeNode",{id:t.id,new:t.metadata,old:n})}}(this)),this.graph.on("addEdge",function(e){return function(t){return e.appendCommand("addEdge",t)}}(this)),this.graph.on("removeEdge",function(e){return function(t){return e.appendCommand("removeEdge",t)}}(this)),this.graph.on("changeEdge",function(e){return function(t,n){return e.appendCommand("changeEdge",{from:t.from,to:t.to,new:t.metadata,old:n})}}(this)),this.graph.on("addInitial",function(e){return function(t){return e.appendCommand("addInitial",t)}}(this)),this.graph.on("removeInitial",function(e){return function(t){return e.appendCommand("removeInitial",t)}}(this)),this.graph.on("changeProperties",function(e){return function(t,n){return e.appendCommand("changeProperties",{new:t,old:n})}}(this)),this.graph.on("addGroup",function(e){return function(t){return e.appendCommand("addGroup",t)}}(this)),this.graph.on("renameGroup",function(e){return function(t,n){return e.appendCommand("renameGroup",{oldName:t,newName:n})}}(this)),this.graph.on("removeGroup",function(e){return function(t){return e.appendCommand("removeGroup",t)}}(this)),this.graph.on("changeGroup",function(e){return function(t,n){return e.appendCommand("changeGroup",{name:t.name,new:t.metadata,old:n})}}(this)),this.graph.on("addExport",function(e){return function(t){return e.appendCommand("addExport",t)}}(this)),this.graph.on("removeExport",function(e){return function(t){return e.appendCommand("removeExport",t)}}(this)),this.graph.on("addInport",function(e){return function(t,n){return e.appendCommand("addInport",{name:t,port:n})}}(this)),this.graph.on("removeInport",function(e){return function(t,n){return e.appendCommand("removeInport",{name:t,port:n})}}(this)),this.graph.on("renameInport",function(e){return function(t,n){return e.appendCommand("renameInport",{oldId:t,newId:n})}}(this)),this.graph.on("changeInport",function(e){return function(t,n,o){return e.appendCommand("changeInport",{name:t,new:n.metadata,old:o})}}(this)),this.graph.on("addOutport",function(e){return function(t,n){return e.appendCommand("addOutport",{name:t,port:n})}}(this)),this.graph.on("removeOutport",function(e){return function(t,n){return e.appendCommand("removeOutport",{name:t,port:n})}}(this)),this.graph.on("renameOutport",function(e){return function(t,n){return e.appendCommand("renameOutport",{oldId:t,newId:n})}}(this)),this.graph.on("changeOutport",function(e){return function(t,n,o){return e.appendCommand("changeOutport",{name:t,new:n.metadata,old:o})}}(this)),this.graph.on("startTransaction",function(e){return function(t,n){return e.startTransaction(t,n)}}(this)),this.graph.on("endTransaction",function(e){return function(t,n){return e.endTransaction(t,n)}}(this))}return c(o,t),o.prototype.graph=null,o.prototype.entries=[],o.prototype.subscribed=!0,o.prototype.startTransaction=function(e,t){if(this.subscribed){if(this.entries.length>0)throw Error("Inconsistent @entries");return this.currentRevision++,this.appendCommand("startTransaction",{id:e,metadata:t},this.currentRevision)}},o.prototype.endTransaction=function(e,t){if(this.subscribed)return this.appendCommand("endTransaction",{id:e,metadata:t},this.currentRevision),this.store.putTransaction(this.currentRevision,this.entries),this.entries=[]},o.prototype.appendCommand=function(e,t,n){var o;if(this.subscribed)return o={cmd:e,args:s(t)},null!=n&&(o.rev=n),this.entries.push(o)},o.prototype.executeEntry=function(e){var t;switch(t=e.args,e.cmd){case"addNode":return this.graph.addNode(t.id,t.component);case"removeNode":return this.graph.removeNode(t.id);case"renameNode":return this.graph.renameNode(t.oldId,t.newId);case"changeNode":return this.graph.setNodeMetadata(t.id,a(t.old,t.new));case"addEdge":return this.graph.addEdge(t.from.node,t.from.port,t.to.node,t.to.port);case"removeEdge":return this.graph.removeEdge(t.from.node,t.from.port,t.to.node,t.to.port);case"changeEdge":return this.graph.setEdgeMetadata(t.from.node,t.from.port,t.to.node,t.to.port,a(t.old,t.new));case"addInitial":return this.graph.addInitial(t.from.data,t.to.node,t.to.port);case"removeInitial":return this.graph.removeInitial(t.to.node,t.to.port);case"startTransaction":case"endTransaction":return null;case"changeProperties":return this.graph.setProperties(t.new);case"addGroup":return this.graph.addGroup(t.name,t.nodes,t.metadata);case"renameGroup":return this.graph.renameGroup(t.oldName,t.newName);case"removeGroup":return this.graph.removeGroup(t.name);case"changeGroup":return this.graph.setGroupMetadata(t.name,a(t.old,t.new));case"addInport":return this.graph.addInport(t.name,t.port.process,t.port.port,t.port.metadata);case"removeInport":return this.graph.removeInport(t.name);case"renameInport":return this.graph.renameInport(t.oldId,t.newId);case"changeInport":return this.graph.setInportMetadata(t.name,a(t.old,t.new));case"addOutport":return this.graph.addOutport(t.name,t.port.process,t.port.port,t.port.metadata(t.name));case"removeOutport":return this.graph.removeOutport;case"renameOutport":return this.graph.renameOutport(t.oldId,t.newId);case"changeOutport":return this.graph.setOutportMetadata(t.name,a(t.old,t.new));default:throw new Error("Unknown journal entry: "+e.cmd)}},o.prototype.executeEntryInversed=function(e){var t;switch(t=e.args,e.cmd){case"addNode":return this.graph.removeNode(t.id);case"removeNode":return this.graph.addNode(t.id,t.component);case"renameNode":return this.graph.renameNode(t.newId,t.oldId);case"changeNode":return this.graph.setNodeMetadata(t.id,a(t.new,t.old));case"addEdge":return this.graph.removeEdge(t.from.node,t.from.port,t.to.node,t.to.port);case"removeEdge":return this.graph.addEdge(t.from.node,t.from.port,t.to.node,t.to.port);case"changeEdge":return this.graph.setEdgeMetadata(t.from.node,t.from.port,t.to.node,t.to.port,a(t.new,t.old));case"addInitial":return this.graph.removeInitial(t.to.node,t.to.port);case"removeInitial":return this.graph.addInitial(t.from.data,t.to.node,t.to.port);case"startTransaction":case"endTransaction":return null;case"changeProperties":return this.graph.setProperties(t.old);case"addGroup":return this.graph.removeGroup(t.name);case"renameGroup":return this.graph.renameGroup(t.newName,t.oldName);case"removeGroup":return this.graph.addGroup(t.name,t.nodes,t.metadata);case"changeGroup":return this.graph.setGroupMetadata(t.name,a(t.new,t.old));case"addInport":return this.graph.removeInport(t.name);case"removeInport":return this.graph.addInport(t.name,t.port.process,t.port.port,t.port.metadata);case"renameInport":return this.graph.renameInport(t.newId,t.oldId);case"changeInport":return this.graph.setInportMetadata(t.name,a(t.new,t.old));case"addOutport":return this.graph.removeOutport(t.name);case"removeOutport":return this.graph.addOutport(t.name,t.port.process,t.port.port,t.port.metadata);case"renameOutport":return this.graph.renameOutport(t.newId,t.oldId);case"changeOutport":return this.graph.setOutportMetadata(t.name,a(t.new,t.old));default:throw new Error("Unknown journal entry: "+e.cmd)}},o.prototype.moveToRevision=function(e){var t,n,o,r,i,a,s,l,c,p,u,d,f;if(e!==this.currentRevision){if(this.subscribed=!1,e>this.currentRevision)for(c=r=p=this.currentRevision+1,u=e;p<=u?r<=u:r>=u;c=p<=u?++r:--r)for(i=0,a=(d=this.store.fetchTransaction(c)).length;i<a;i++)n=d[i],this.executeEntry(n);else for(c=s=this.currentRevision,f=e+1;s>=f;c=s+=-1)for(o=l=(t=this.store.fetchTransaction(c)).length-1;l>=0;o=l+=-1)this.executeEntryInversed(t[o]);return this.currentRevision=e,this.subscribed=!0}},o.prototype.undo=function(){if(this.canUndo())return this.moveToRevision(this.currentRevision-1)},o.prototype.canUndo=function(){return this.currentRevision>0},o.prototype.redo=function(){if(this.canRedo())return this.moveToRevision(this.currentRevision+1)},o.prototype.canRedo=function(){return this.currentRevision<this.store.lastRevision},o.prototype.toPrettyString=function(e,t){var n,o,r,i,a,s,c,p,u;for(s=[],c=r=p=e|=0,u=t|=this.store.lastRevision;p<=u?r<u:r>u;c=p<=u?++r:--r)for(i=0,a=(n=this.store.fetchTransaction(c)).length;i<a;i++)o=n[i],s.push(l(o));return s.join("\n")},o.prototype.toJSON=function(e,t){var n,o,r,i,a,s,c,p;for(n=[],s=r=e|=0,c=t|=this.store.lastRevision;r<c;s=r+=1)for(i=0,a=(p=this.store.fetchTransaction(s)).length;i<a;i++)o=p[i],n.push(l(o));return n},o.prototype.save=function(t,n){var o;return o=JSON.stringify(this.toJSON(),null,4),e("fs").writeFile(t+".json",o,"utf-8",function(e,o){if(e)throw e;return n(t)})},o}(),n.Journal=o,n.JournalStore=r,n.MemoryJournalStore=i}).call(this)},{clone:5,events:7,fs:3}],11:[function(e,t,n){(function(e){(function(){(function(){n.isBrowser=function(){return void 0===e||!e.execPath||!e.execPath.match(/node|iojs/)},n.deprecated=function(t){if(!n.isBrowser()){if(e.env.NOFLO_FATAL_DEPRECATED)throw new Error(t);return console.warn(t)}if(window.NOFLO_FATAL_DEPRECATED)throw new Error(t);console.warn(t)}}).call(this)}).call(this)}).call(this,e("_process"))},{_process:17}],12:[function(e,t,n){t.exports=function(){function t(e,n,o,r){this.message=e,this.expected=n,this.found=o,this.location=r,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}return function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(t,Error),{SyntaxError:t,parse:function(n){var o,r,i=arguments.length>1?arguments[1]:{},a=this,s={},l={start:cn},c=cn,p=function(){return a.getResult()},u="INPORT=",d={type:"literal",value:"INPORT=",description:'"INPORT="'},f=".",h={type:"literal",value:".",description:'"."'},m=":",g={type:"literal",value:":",description:'":"'},v=function(e,t,n){return a.registerInports(e,t,n)},b="OUTPORT=",y={type:"literal",value:"OUTPORT=",description:'"OUTPORT="'},w=function(e,t,n){return a.registerOutports(e,t,n)},x="DEFAULT_INPORT=",$={type:"literal",value:"DEFAULT_INPORT=",description:'"DEFAULT_INPORT="'},C=function(e){Ln=e},_="DEFAULT_OUTPORT=",k={type:"literal",value:"DEFAULT_OUTPORT=",description:'"DEFAULT_OUTPORT="'},S=function(e){zn=e},T=function(e){return a.registerAnnotation(e[0],e[1])},I=function(e){return a.registerEdges(e)},E=",",N={type:"literal",value:",",description:'","'},O=/^[\n\r\u2028\u2029]/,D={type:"class",value:"[\\n\\r\\u2028\\u2029]",description:"[\\n\\r\\u2028\\u2029]"},P="#",A={type:"literal",value:"#",description:'"#"'},M="->",U={type:"literal",value:"->",description:'"->"'},R=function(e,t){return[e,t]},L=function(e,t,n){return[{tgt:Vn(t,e)},{src:Yn(t,n)}]},z=function(e,t){return{src:Yn(e,t)}},F=function(e,t){return{tgt:Vn(t,e)}},j="'",B={type:"literal",value:"'",description:'"\'"'},G=function(e){return{data:e.join("")}},H=function(e){return{data:e}},V=function(e){return e},Y=/^[a-zA-Z_]/,q={type:"class",value:"[a-zA-Z_]",description:"[a-zA-Z_]"},W=/^[a-zA-Z0-9_\-]/,K={type:"class",value:"[a-zA-Z0-9_\\-]",description:"[a-zA-Z0-9_\\-]"},X=function(e){return Gn(e)},Z=function(e,t){return a.addNode(e,t),e},J=function(e){return a.addAnonymousNode(e,an(Qt,Jt).start.offset)},Q="(",ee={type:"literal",value:"(",description:'"("'},te=/^[a-zA-Z\/\-0-9_]/,ne={type:"class",value:"[a-zA-Z/\\-0-9_]",description:"[a-zA-Z/\\-0-9_]"},oe=")",re={type:"literal",value:")",description:'")"'},ie=function(e,t){var n={};return n.comp=e?e.join(""):"",t&&(n.meta=t.join("").split(",")),n},ae=/^[a-zA-Z\/=_,0-9]/,se={type:"class",value:"[a-zA-Z/=_,0-9]",description:"[a-zA-Z/=_,0-9]"},le=function(e){return e},ce="@",pe={type:"literal",value:"@",description:'"@"'},ue=/^[a-zA-Z0-9\-_]/,de={type:"class",value:"[a-zA-Z0-9\\-_]",description:"[a-zA-Z0-9\\-_]"},fe=/^[a-zA-Z0-9\-_ .]/,he={type:"class",value:"[a-zA-Z0-9\\-_ \\.]",description:"[a-zA-Z0-9\\-_ \\.]"},me=function(e,t){return[e.join(""),t.join("")]},ge=function(e,t){return{port:i.caseSensitive?e:e.toLowerCase(),index:null!=t?t:void 0}},ve=function(e){return e},be=/^[a-zA-Z.0-9_]/,ye={type:"class",value:"[a-zA-Z.0-9_]",description:"[a-zA-Z.0-9_]"},we=function(e){return Gn(e)},xe="[",$e={type:"literal",value:"[",description:'"["'},Ce=/^[0-9]/,_e={type:"class",value:"[0-9]",description:"[0-9]"},ke="]",Se={type:"literal",value:"]",description:'"]"'},Te=function(e){return parseInt(e.join(""))},Ie=/^[^\n\r\u2028\u2029]/,Ee={type:"class",value:"[^\\n\\r\\u2028\\u2029]",description:"[^\\n\\r\\u2028\\u2029]"},Ne=/^[\\]/,Oe={type:"class",value:"[\\\\]",description:"[\\\\]"},De=/^[']/,Pe={type:"class",value:"[']",description:"[']"},Ae=function(){return"'"},Me=/^[^']/,Ue={type:"class",value:"[^']",description:"[^']"},Re=" ",Le={type:"literal",value:" ",description:'" "'},ze=function(e){return e},Fe="{",je={type:"literal",value:"{",description:'"{"'},Be="}",Ge={type:"literal",value:"}",description:'"}"'},He={type:"other",description:"whitespace"},Ve=/^[ \t\n\r]/,Ye={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},qe="false",We={type:"literal",value:"false",description:'"false"'},Ke=function(){return!1},Xe="null",Ze={type:"literal",value:"null",description:'"null"'},Je=function(){return null},Qe="true",et={type:"literal",value:"true",description:'"true"'},tt=function(){return!0},nt=function(e,t){return t},ot=function(e,t){var n,o={};for(o[e.name]=e.value,n=0;n<t.length;n++)o[t[n].name]=t[n].value;return o},rt=function(e){return null!==e?e:{}},it=function(e,t){return{name:e,value:t}},at=function(e,t){return t},st=function(e,t){return[e].concat(t)},lt=function(e){return null!==e?e:[]},ct={type:"other",description:"number"},pt=function(){return parseFloat(n.substring(Qt,Jt))},ut=/^[1-9]/,dt={type:"class",value:"[1-9]",description:"[1-9]"},ft=/^[eE]/,ht={type:"class",value:"[eE]",description:"[eE]"},mt="-",gt={type:"literal",value:"-",description:'"-"'},vt="+",bt={type:"literal",value:"+",description:'"+"'},yt="0",wt={type:"literal",value:"0",description:'"0"'},xt={type:"other",description:"string"},$t=function(e){return e.join("")},Ct='"',_t={type:"literal",value:'"',description:'"\\""'},kt="\\",St={type:"literal",value:"\\",description:'"\\\\"'},Tt="/",It={type:"literal",value:"/",description:'"/"'},Et="b",Nt={type:"literal",value:"b",description:'"b"'},Ot=function(){return"\b"},Dt="f",Pt={type:"literal",value:"f",description:'"f"'},At=function(){return"\f"},Mt="n",Ut={type:"literal",value:"n",description:'"n"'},Rt=function(){return"\n"},Lt="r",zt={type:"literal",value:"r",description:'"r"'},Ft=function(){return"\r"},jt="t",Bt={type:"literal",value:"t",description:'"t"'},Gt=function(){return"\t"},Ht="u",Vt={type:"literal",value:"u",description:'"u"'},Yt=function(e){return String.fromCharCode(parseInt(e,16))},qt=function(e){return e},Wt=/^[^\0-\x1F"\\]/,Kt={type:"class",value:"[^\\0-\\x1F\\x22\\x5C]",description:"[^\\0-\\x1F\\x22\\x5C]"},Xt=/^[0-9a-f]/i,Zt={type:"class",value:"[0-9a-f]i",description:"[0-9a-f]i"},Jt=0,Qt=0,en=[{line:1,column:1,seenCR:!1}],tn=0,nn=[],on=0;if("startRule"in i){if(!(i.startRule in l))throw new Error("Can't start parsing from rule \""+i.startRule+'".');c=l[i.startRule]}function rn(e){var t,o,r=en[e];if(r)return r;for(t=e-1;!en[t];)t--;for(r={line:(r=en[t]).line,column:r.column,seenCR:r.seenCR};t<e;)"\n"===(o=n.charAt(t))?(r.seenCR||r.line++,r.column=1,r.seenCR=!1):"\r"===o||"\u2028"===o||"\u2029"===o?(r.line++,r.column=1,r.seenCR=!0):(r.column++,r.seenCR=!1),t++;return en[e]=r,r}function an(e,t){var n=rn(e),o=rn(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:o.line,column:o.column}}}function sn(e){Jt<tn||(Jt>tn&&(tn=Jt,nn=[]),nn.push(e))}function ln(e,n,o,r){return null!==n&&function(e){var t=1;for(e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}(n),new t(null!==e?e:function(e,t){var n,o=new Array(e.length);for(n=0;n<e.length;n++)o[n]=e[n].description;return"Expected "+(e.length>1?o.slice(0,-1).join(", ")+" or "+o[e.length-1]:o[0])+" but "+(t?'"'+function(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0100-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1000-\uFFFF]/g,function(e){return"\\u"+t(e)})}(t)+'"':"end of input")+" found."}(n,o),n,o,r)}function cn(){var e,t,n;for(e=Jt,t=[],n=pn();n!==s;)t.push(n),n=pn();return t!==s&&(Qt=e,t=p()),e=t}function pn(){var e,t,o,r,i,a,l,c,p;return e=Jt,(t=Sn())!==s?(n.substr(Jt,7)===u?(o=u,Jt+=7):(o=s,0===on&&sn(d)),o!==s&&(r=mn())!==s?(46===n.charCodeAt(Jt)?(i=f,Jt++):(i=s,0===on&&sn(h)),i!==s&&(a=Cn())!==s?(58===n.charCodeAt(Jt)?(l=m,Jt++):(l=s,0===on&&sn(g)),l!==s&&(c=Cn())!==s&&Sn()!==s?((p=un())===s&&(p=null),p!==s?(Qt=e,e=t=v(r,a,c)):(Jt=e,e=s)):(Jt=e,e=s)):(Jt=e,e=s)):(Jt=e,e=s)):(Jt=e,e=s),e===s&&(e=Jt,(t=Sn())!==s?(n.substr(Jt,8)===b?(o=b,Jt+=8):(o=s,0===on&&sn(y)),o!==s&&(r=mn())!==s?(46===n.charCodeAt(Jt)?(i=f,Jt++):(i=s,0===on&&sn(h)),i!==s&&(a=Cn())!==s?(58===n.charCodeAt(Jt)?(l=m,Jt++):(l=s,0===on&&sn(g)),l!==s&&(c=Cn())!==s&&Sn()!==s?((p=un())===s&&(p=null),p!==s?(Qt=e,e=t=w(r,a,c)):(Jt=e,e=s)):(Jt=e,e=s)):(Jt=e,e=s)):(Jt=e,e=s)):(Jt=e,e=s),e===s&&(e=Jt,(t=Sn())!==s?(n.substr(Jt,15)===x?(o=x,Jt+=15):(o=s,0===on&&sn($)),o!==s&&(r=Cn())!==s&&(i=Sn())!==s?((a=un())===s&&(a=null),a!==s?(Qt=e,e=t=C(r)):(Jt=e,e=s)):(Jt=e,e=s)):(Jt=e,e=s),e===s&&(e=Jt,(t=Sn())!==s?(n.substr(Jt,16)===_?(o=_,Jt+=16):(o=s,0===on&&sn(k)),o!==s&&(r=Cn())!==s&&(i=Sn())!==s?((a=un())===s&&(a=null),a!==s?(Qt=e,e=t=S(r)):(Jt=e,e=s)):(Jt=e,e=s)):(Jt=e,e=s),e===s&&(e=Jt,(t=function(){var e,t,o,r,i,a,l;if(e=Jt,35===n.charCodeAt(Jt)?(t=P,Jt++):(t=s,0===on&&sn(A)),t!==s)if(Tn()!==s)if(64===n.charCodeAt(Jt)?(o=ce,Jt++):(o=s,0===on&&sn(pe)),o!==s){if(r=[],ue.test(n.charAt(Jt))?(i=n.charAt(Jt),Jt++):(i=s,0===on&&sn(de)),i!==s)for(;i!==s;)r.push(i),ue.test(n.charAt(Jt))?(i=n.charAt(Jt),Jt++):(i=s,0===on&&sn(de));else r=s;if(r!==s)if((i=Tn())!==s){if(a=[],fe.test(n.charAt(Jt))?(l=n.charAt(Jt),Jt++):(l=s,0===on&&sn(he)),l!==s)for(;l!==s;)a.push(l),fe.test(n.charAt(Jt))?(l=n.charAt(Jt),Jt++):(l=s,0===on&&sn(he));else a=s;a!==s?(Qt=e,t=me(r,a),e=t):(Jt=e,e=s)}else Jt=e,e=s;else Jt=e,e=s}else Jt=e,e=s;else Jt=e,e=s;else Jt=e,e=s;return e}())!==s&&(o=dn())!==s?(Qt=e,e=t=T(t)):(Jt=e,e=s),e===s&&(e=Jt,(t=fn())!==s?((o=dn())===s&&(o=null),o!==s?e=t=[t,o]:(Jt=e,e=s)):(Jt=e,e=s),e===s&&(e=Jt,(t=Sn())!==s&&(o=dn())!==s?e=t=[t,o]:(Jt=e,e=s),e===s&&(e=Jt,(t=Sn())!==s&&(o=function e(){var t,o,r,i;return t=Jt,(o=function(){var e;return(e=hn())===s&&(e=function(){var e,t,n;return e=Jt,(t=mn())!==s?((n=$n())===s&&(n=null),n!==s?(Qt=e,t=z(t,n),e=t):(Jt=e,e=s)):(Jt=e,e=s),e}())===s&&(e=function(){var e,t,o,r;if(e=Jt,39===n.charCodeAt(Jt)?(t=j,Jt++):(t=s,0===on&&sn(B)),t!==s){for(o=[],r=kn();r!==s;)o.push(r),r=kn();o!==s?(39===n.charCodeAt(Jt)?(r=j,Jt++):(r=s,0===on&&sn(B)),r!==s?(Qt=e,t=G(o),e=t):(Jt=e,e=s)):(Jt=e,e=s)}else Jt=e,e=s;return e===s&&(e=Jt,(t=function(){var e,t,n;return e=Jt,(t=En())!==s&&(n=Nn())!==s&&En()!==s?(Qt=e,t=ze(n),e=t):(Jt=e,e=s),e}())!==s&&(Qt=e,t=H(t)),e=t),e}()),e}())!==s&&Sn()!==s?(n.substr(Jt,2)===M?(r=M,Jt+=2):(r=s,0===on&&sn(U)),r!==s&&Sn()!==s&&(i=e())!==s?(Qt=t,o=R(o,i),t=o):(Jt=t,t=s)):(Jt=t,t=s),t===s&&(t=function(){var e;return(e=function(){var e,t,n;return e=Jt,(t=xn())===s&&(t=null),t!==s&&(n=mn())!==s?(Qt=e,t=F(t,n),e=t):(Jt=e,e=s),e}())===s&&(e=hn()),e}()),t}())!==s&&(r=Sn())!==s?((i=un())===s&&(i=null),i!==s?(Qt=e,e=t=I(o)):(Jt=e,e=s)):(Jt=e,e=s)))))))),e}function un(){var e,t,o,r,i;return e=Jt,(t=Sn())!==s?(44===n.charCodeAt(Jt)?(o=E,Jt++):(o=s,0===on&&sn(N)),o===s&&(o=null),o!==s?((r=fn())===s&&(r=null),r!==s?((i=dn())===s&&(i=null),i!==s?e=t=[t,o,r,i]:(Jt=e,e=s)):(Jt=e,e=s)):(Jt=e,e=s)):(Jt=e,e=s),e}function dn(){var e;return O.test(n.charAt(Jt))?(e=n.charAt(Jt),Jt++):(e=s,0===on&&sn(D)),e}function fn(){var e,t,o,r,i;if(e=Jt,(t=Sn())!==s)if(35===n.charCodeAt(Jt)?(o=P,Jt++):(o=s,0===on&&sn(A)),o!==s){for(r=[],i=_n();i!==s;)r.push(i),i=_n();r!==s?e=t=[t,o,r]:(Jt=e,e=s)}else Jt=e,e=s;else Jt=e,e=s;return e}function hn(){var e,t,n,o;return e=Jt,(t=xn())!==s&&(n=mn())!==s&&(o=$n())!==s?(Qt=e,e=t=L(t,n,o)):(Jt=e,e=s),e===s&&(e=Jt,(t=xn())===s&&(t=null),t!==s&&(n=function(){var e;return(e=vn())===s&&(e=bn()),e}())!==s?((o=$n())===s&&(o=null),o!==s?(Qt=e,e=t=L(t,n,o)):(Jt=e,e=s)):(Jt=e,e=s)),e}function mn(){var e,t;return e=Jt,(t=vn())!==s&&(Qt=e,t=V(t)),(e=t)===s&&(e=Jt,(t=gn())!==s&&(Qt=e,t=V(t)),(e=t)===s&&(e=Jt,(t=bn())!==s&&(Qt=e,t=V(t)),e=t)),e}function gn(){var e,t,o,r,i;if(e=Jt,t=Jt,Y.test(n.charAt(Jt))?(o=n.charAt(Jt),Jt++):(o=s,0===on&&sn(q)),o!==s){for(r=[],W.test(n.charAt(Jt))?(i=n.charAt(Jt),Jt++):(i=s,0===on&&sn(K));i!==s;)r.push(i),W.test(n.charAt(Jt))?(i=n.charAt(Jt),Jt++):(i=s,0===on&&sn(K));r!==s?t=o=[o,r]:(Jt=t,t=s)}else Jt=t,t=s;return t!==s&&(Qt=e,t=X(t)),e=t}function vn(){var e,t,n;return e=Jt,(t=gn())!==s&&(n=yn())!==s?(Qt=e,e=t=Z(t,n)):(Jt=e,e=s),e}function bn(){var e,t;return e=Jt,(t=yn())!==s&&(Qt=e,t=J(t)),e=t}function yn(){var e,t,o,r,i;if(e=Jt,40===n.charCodeAt(Jt)?(t=Q,Jt++):(t=s,0===on&&sn(ee)),t!==s){for(o=[],te.test(n.charAt(Jt))?(r=n.charAt(Jt),Jt++):(r=s,0===on&&sn(ne));r!==s;)o.push(r),te.test(n.charAt(Jt))?(r=n.charAt(Jt),Jt++):(r=s,0===on&&sn(ne));o===s&&(o=null),o!==s?((r=function(){var e,t,o,r;if(e=Jt,58===n.charCodeAt(Jt)?(t=m,Jt++):(t=s,0===on&&sn(g)),t!==s){if(o=[],ae.test(n.charAt(Jt))?(r=n.charAt(Jt),Jt++):(r=s,0===on&&sn(se)),r!==s)for(;r!==s;)o.push(r),ae.test(n.charAt(Jt))?(r=n.charAt(Jt),Jt++):(r=s,0===on&&sn(se));else o=s;o!==s?(Qt=e,t=le(o),e=t):(Jt=e,e=s)}else Jt=e,e=s;return e}())===s&&(r=null),r!==s?(41===n.charCodeAt(Jt)?(i=oe,Jt++):(i=s,0===on&&sn(re)),i!==s?(Qt=e,e=t=ie(o,r)):(Jt=e,e=s)):(Jt=e,e=s)):(Jt=e,e=s)}else Jt=e,e=s;return e}function wn(){var e,t,o;return e=Jt,(t=Cn())!==s?((o=function(){var e,t,o,r;if(e=Jt,91===n.charCodeAt(Jt)?(t=xe,Jt++):(t=s,0===on&&sn($e)),t!==s){if(o=[],Ce.test(n.charAt(Jt))?(r=n.charAt(Jt),Jt++):(r=s,0===on&&sn(_e)),r!==s)for(;r!==s;)o.push(r),Ce.test(n.charAt(Jt))?(r=n.charAt(Jt),Jt++):(r=s,0===on&&sn(_e));else o=s;o!==s?(93===n.charCodeAt(Jt)?(r=ke,Jt++):(r=s,0===on&&sn(Se)),r!==s?(Qt=e,t=Te(o),e=t):(Jt=e,e=s)):(Jt=e,e=s)}else Jt=e,e=s;return e}())===s&&(o=null),o!==s?(Qt=e,e=t=ge(t,o)):(Jt=e,e=s)):(Jt=e,e=s),e}function xn(){var e,t;return e=Jt,(t=wn())!==s&&Tn()!==s?(Qt=e,e=t=ve(t)):(Jt=e,e=s),e}function $n(){var e,t;return e=Jt,Tn()!==s&&(t=wn())!==s?(Qt=e,e=ve(t)):(Jt=e,e=s),e}function Cn(){var e,t,o,r,i;if(e=Jt,t=Jt,Y.test(n.charAt(Jt))?(o=n.charAt(Jt),Jt++):(o=s,0===on&&sn(q)),o!==s){for(r=[],be.test(n.charAt(Jt))?(i=n.charAt(Jt),Jt++):(i=s,0===on&&sn(ye));i!==s;)r.push(i),be.test(n.charAt(Jt))?(i=n.charAt(Jt),Jt++):(i=s,0===on&&sn(ye));r!==s?t=o=[o,r]:(Jt=t,t=s)}else Jt=t,t=s;return t!==s&&(Qt=e,t=we(t)),e=t}function _n(){var e;return Ie.test(n.charAt(Jt))?(e=n.charAt(Jt),Jt++):(e=s,0===on&&sn(Ee)),e}function kn(){var e,t,o;return e=Jt,Ne.test(n.charAt(Jt))?(t=n.charAt(Jt),Jt++):(t=s,0===on&&sn(Oe)),t!==s?(De.test(n.charAt(Jt))?(o=n.charAt(Jt),Jt++):(o=s,0===on&&sn(Pe)),o!==s?(Qt=e,e=t=Ae()):(Jt=e,e=s)):(Jt=e,e=s),e===s&&(Me.test(n.charAt(Jt))?(e=n.charAt(Jt),Jt++):(e=s,0===on&&sn(Ue))),e}function Sn(){var e,t;for(e=[],32===n.charCodeAt(Jt)?(t=Re,Jt++):(t=s,0===on&&sn(Le));t!==s;)e.push(t),32===n.charCodeAt(Jt)?(t=Re,Jt++):(t=s,0===on&&sn(Le));return e===s&&(e=null),e}function Tn(){var e,t;if(e=[],32===n.charCodeAt(Jt)?(t=Re,Jt++):(t=s,0===on&&sn(Le)),t!==s)for(;t!==s;)e.push(t),32===n.charCodeAt(Jt)?(t=Re,Jt++):(t=s,0===on&&sn(Le));else e=s;return e}function In(){var e,t,o,r;return e=Jt,(t=En())!==s?(44===n.charCodeAt(Jt)?(o=E,Jt++):(o=s,0===on&&sn(N)),o!==s&&(r=En())!==s?e=t=[t,o,r]:(Jt=e,e=s)):(Jt=e,e=s),e}function En(){var e,t;for(on++,e=[],Ve.test(n.charAt(Jt))?(t=n.charAt(Jt),Jt++):(t=s,0===on&&sn(Ye));t!==s;)e.push(t),Ve.test(n.charAt(Jt))?(t=n.charAt(Jt),Jt++):(t=s,0===on&&sn(Ye));return on--,e===s&&(t=s,0===on&&sn(He)),e}function Nn(){var e;return(e=function(){var e,t;return e=Jt,n.substr(Jt,5)===qe?(t=qe,Jt+=5):(t=s,0===on&&sn(We)),t!==s&&(Qt=e,t=Ke()),e=t}())===s&&(e=function(){var e,t;return e=Jt,n.substr(Jt,4)===Xe?(t=Xe,Jt+=4):(t=s,0===on&&sn(Ze)),t!==s&&(Qt=e,t=Je()),e=t}())===s&&(e=function(){var e,t;return e=Jt,n.substr(Jt,4)===Qe?(t=Qe,Jt+=4):(t=s,0===on&&sn(et)),t!==s&&(Qt=e,t=tt()),e=t}())===s&&(e=function(){var e,t,o,r,i,a,l,c;if(e=Jt,(t=function(){var e,t,o,r;return e=Jt,(t=En())!==s?(123===n.charCodeAt(Jt)?(o=Fe,Jt++):(o=s,0===on&&sn(je)),o!==s&&(r=En())!==s?e=t=[t,o,r]:(Jt=e,e=s)):(Jt=e,e=s),e}())!==s){if(o=Jt,(r=On())!==s){for(i=[],a=Jt,(l=In())!==s&&(c=On())!==s?(Qt=a,l=nt(r,c),a=l):(Jt=a,a=s);a!==s;)i.push(a),a=Jt,(l=In())!==s&&(c=On())!==s?(Qt=a,l=nt(r,c),a=l):(Jt=a,a=s);i!==s?(Qt=o,r=ot(r,i),o=r):(Jt=o,o=s)}else Jt=o,o=s;o===s&&(o=null),o!==s&&(r=function(){var e,t,o,r;return e=Jt,(t=En())!==s?(125===n.charCodeAt(Jt)?(o=Be,Jt++):(o=s,0===on&&sn(Ge)),o!==s&&(r=En())!==s?e=t=[t,o,r]:(Jt=e,e=s)):(Jt=e,e=s),e}())!==s?(Qt=e,t=rt(o),e=t):(Jt=e,e=s)}else Jt=e,e=s;return e}())===s&&(e=function(){var e,t,o,r,i,a,l,c;if(e=Jt,(t=function(){var e,t,o,r;return e=Jt,(t=En())!==s?(91===n.charCodeAt(Jt)?(o=xe,Jt++):(o=s,0===on&&sn($e)),o!==s&&(r=En())!==s?e=t=[t,o,r]:(Jt=e,e=s)):(Jt=e,e=s),e}())!==s){if(o=Jt,(r=Nn())!==s){for(i=[],a=Jt,(l=In())!==s&&(c=Nn())!==s?(Qt=a,l=at(r,c),a=l):(Jt=a,a=s);a!==s;)i.push(a),a=Jt,(l=In())!==s&&(c=Nn())!==s?(Qt=a,l=at(r,c),a=l):(Jt=a,a=s);i!==s?(Qt=o,r=st(r,i),o=r):(Jt=o,o=s)}else Jt=o,o=s;o===s&&(o=null),o!==s&&(r=function(){var e,t,o,r;return e=Jt,(t=En())!==s?(93===n.charCodeAt(Jt)?(o=ke,Jt++):(o=s,0===on&&sn(Se)),o!==s&&(r=En())!==s?e=t=[t,o,r]:(Jt=e,e=s)):(Jt=e,e=s),e}())!==s?(Qt=e,t=lt(o),e=t):(Jt=e,e=s)}else Jt=e,e=s;return e}())===s&&(e=function(){var e,t,o,r;return on++,e=Jt,(t=Dn())===s&&(t=null),t!==s&&function(){var e,t,o,r;if((e=function(){var e;return 48===n.charCodeAt(Jt)?(e=yt,Jt++):(e=s,0===on&&sn(wt)),e}())===s)if(e=Jt,(t=function(){var e;return ut.test(n.charAt(Jt))?(e=n.charAt(Jt),Jt++):(e=s,0===on&&sn(dt)),e}())!==s){for(o=[],r=Un();r!==s;)o.push(r),r=Un();o!==s?e=t=[t,o]:(Jt=e,e=s)}else Jt=e,e=s;return e}()!==s?((o=function(){var e,t,o,r;if(e=Jt,(t=function(){var e;return 46===n.charCodeAt(Jt)?(e=f,Jt++):(e=s,0===on&&sn(h)),e}())!==s){if(o=[],(r=Un())!==s)for(;r!==s;)o.push(r),r=Un();else o=s;o!==s?e=t=[t,o]:(Jt=e,e=s)}else Jt=e,e=s;return e}())===s&&(o=null),o!==s?((r=function(){var e,t,o,r,i;if(e=Jt,(t=function(){var e;return ft.test(n.charAt(Jt))?(e=n.charAt(Jt),Jt++):(e=s,0===on&&sn(ht)),e}())!==s)if((o=Dn())===s&&(o=function(){var e;return 43===n.charCodeAt(Jt)?(e=vt,Jt++):(e=s,0===on&&sn(bt)),e}()),o===s&&(o=null),o!==s){if(r=[],(i=Un())!==s)for(;i!==s;)r.push(i),i=Un();else r=s;r!==s?e=t=[t,o,r]:(Jt=e,e=s)}else Jt=e,e=s;else Jt=e,e=s;return e}())===s&&(r=null),r!==s?(Qt=e,t=pt(),e=t):(Jt=e,e=s)):(Jt=e,e=s)):(Jt=e,e=s),on--,e===s&&(t=s,0===on&&sn(ct)),e}())===s&&(e=Pn()),e}function On(){var e,t,o;return e=Jt,(t=Pn())!==s&&function(){var e,t,o,r;return e=Jt,(t=En())!==s?(58===n.charCodeAt(Jt)?(o=m,Jt++):(o=s,0===on&&sn(g)),o!==s&&(r=En())!==s?e=t=[t,o,r]:(Jt=e,e=s)):(Jt=e,e=s),e}()!==s&&(o=Nn())!==s?(Qt=e,e=t=it(t,o)):(Jt=e,e=s),e}function Dn(){var e;return 45===n.charCodeAt(Jt)?(e=mt,Jt++):(e=s,0===on&&sn(gt)),e}function Pn(){var e,t,n;if(on++,e=Jt,Mn()!==s){for(t=[],n=An();n!==s;)t.push(n),n=An();t!==s&&(n=Mn())!==s?(Qt=e,e=$t(t)):(Jt=e,e=s)}else Jt=e,e=s;return on--,e===s&&0===on&&sn(xt),e}function An(){var e,t,o,r,i,a,l,c,p;return(e=function(){var e;return Wt.test(n.charAt(Jt))?(e=n.charAt(Jt),Jt++):(e=s,0===on&&sn(Kt)),e}())===s&&(e=Jt,function(){var e;return 92===n.charCodeAt(Jt)?(e=kt,Jt++):(e=s,0===on&&sn(St)),e}()!==s?(34===n.charCodeAt(Jt)?(t=Ct,Jt++):(t=s,0===on&&sn(_t)),t===s&&(92===n.charCodeAt(Jt)?(t=kt,Jt++):(t=s,0===on&&sn(St)),t===s&&(47===n.charCodeAt(Jt)?(t=Tt,Jt++):(t=s,0===on&&sn(It)),t===s&&(t=Jt,98===n.charCodeAt(Jt)?(o=Et,Jt++):(o=s,0===on&&sn(Nt)),o!==s&&(Qt=t,o=Ot()),(t=o)===s&&(t=Jt,102===n.charCodeAt(Jt)?(o=Dt,Jt++):(o=s,0===on&&sn(Pt)),o!==s&&(Qt=t,o=At()),(t=o)===s&&(t=Jt,110===n.charCodeAt(Jt)?(o=Mt,Jt++):(o=s,0===on&&sn(Ut)),o!==s&&(Qt=t,o=Rt()),(t=o)===s&&(t=Jt,114===n.charCodeAt(Jt)?(o=Lt,Jt++):(o=s,0===on&&sn(zt)),o!==s&&(Qt=t,o=Ft()),(t=o)===s&&(t=Jt,116===n.charCodeAt(Jt)?(o=jt,Jt++):(o=s,0===on&&sn(Bt)),o!==s&&(Qt=t,o=Gt()),(t=o)===s&&(t=Jt,117===n.charCodeAt(Jt)?(o=Ht,Jt++):(o=s,0===on&&sn(Vt)),o!==s?(r=Jt,i=Jt,(a=Rn())!==s&&(l=Rn())!==s&&(c=Rn())!==s&&(p=Rn())!==s?i=a=[a,l,c,p]:(Jt=i,i=s),(r=i!==s?n.substring(r,Jt):i)!==s?(Qt=t,t=o=Yt(r)):(Jt=t,t=s)):(Jt=t,t=s))))))))),t!==s?(Qt=e,e=qt(t)):(Jt=e,e=s)):(Jt=e,e=s)),e}function Mn(){var e;return 34===n.charCodeAt(Jt)?(e=Ct,Jt++):(e=s,0===on&&sn(_t)),e}function Un(){var e;return Ce.test(n.charAt(Jt))?(e=n.charAt(Jt),Jt++):(e=s,0===on&&sn(_e)),e}function Rn(){var e;return Xt.test(n.charAt(Jt))?(e=n.charAt(Jt),Jt++):(e=s,0===on&&sn(Zt)),e}var Ln="IN",zn="OUT";delete(a=this).properties,delete a.inports,delete a.outports,delete a.groups,a.edges=[],r={},a.validateContents=function(e,t){e.processes&&Object.keys(e.processes).forEach(function(t){if(!e.processes[t].component)throw new Error('Node "'+t+'" does not have a component defined')}),e.inports&&Object.keys(e.inports).forEach(function(t){var n=e.inports[t];if(!e.processes[n.process])throw new Error('Inport "'+t+'" is connected to an undefined target node "'+n.process+'"')}),e.outports&&Object.keys(e.outports).forEach(function(t){var n=e.outports[t];if(!e.processes[n.process])throw new Error('Outport "'+t+'" is connected to an undefined source node "'+n.process+'"')}),e.connections&&e.connections.forEach(function(t){if(t.tgt&&!e.processes[t.tgt.process]){if(t.data)throw new Error('IIP containing "'+t.data+'" is connected to an undefined target node "'+t.tgt.process+'"');throw new Error('Edge from "'+t.src.process+'" port "'+t.src.port+'" is connected to an undefined target node "'+t.tgt.process+'"')}if(t.src&&!e.processes[t.src.process])throw new Error('Edge to "'+t.tgt.process+'" port "'+t.tgt.port+'" is connected to an undefined source node "'+t.src.process+'"')})},a.addNode=function(e,t){if(r[e]||(r[e]={}),t.comp&&(r[e].component=t.comp),t.meta){for(var n={},o=0;o<t.meta.length;o++){var i=t.meta[o].split("=");1===i.length&&(i=["routes",i[0]]);var a=i[0],s=i[1];"x"!==a&&"y"!==a||(s=parseFloat(s)),n[a]=s}r[e].metadata=n}};var Fn={},jn={};a.addAnonymousNode=function(e,t){if(!jn[t]){var n=e.comp.replace(/[^a-zA-Z0-9]+/,"_");Fn[n]=(Fn[n]||0)+1,jn[t]="_"+n+"_"+Fn[n],this.addNode(jn[t],e)}return jn[t]},a.getResult=function(){var t={inports:a.inports||{},outports:a.outports||{},groups:a.groups||[],processes:r||{},connections:a.processEdges()};a.properties&&(t.properties=a.properties),t.caseSensitive=i.caseSensitive||!1;var n=a.validateSchema;if(void 0!==i.validateSchema&&(n=i.validateSchema),n){if(void 0===o)var o=e("tv4");var s=e("../schema/graph.json"),l=o.validateMultiple(t,s);if(!l.valid)throw new Error("fbp: Did not validate againt graph schema:\n"+JSON.stringify(l.errors,null,2))}return(void 0===i.validateContents||i.validateContents)&&a.validateContents(t),t};var Bn=function(e,t){for(var n=-1,o=e?e.length:0,r=[];++n<o;){var i=e[n];i instanceof Array?Array.prototype.push.apply(r,t?i:Bn(i)):r.push(i)}return r};function Gn(e){return e[0]+e[1].join("")}function Hn(e,t,n){i.caseSensitive||(n=n.toLowerCase());var o={process:e,port:t?t.port:n};return t&&null!=t.index&&(o.index=t.index),o}function Vn(e,t){return Hn(e,t,Ln)}function Yn(e,t){return Hn(e,t,zn)}if(a.registerAnnotation=function(e,t){if(a.properties||(a.properties={}),"runtime"===e)return a.properties.environment={},void(a.properties.environment.type=t);a.properties[e]=t},a.registerInports=function(e,t,n){a.inports||(a.inports={}),i.caseSensitive||(n=n.toLowerCase(),t=t.toLowerCase()),a.inports[n]={process:e,port:t}},a.registerOutports=function(e,t,n){a.outports||(a.outports={}),i.caseSensitive||(n=n.toLowerCase(),t=t.toLowerCase()),a.outports[n]={process:e,port:t}},a.registerEdges=function(e){Array.isArray(e)&&e.forEach(function(e,t){a.edges.push(e)})},a.processEdges=function(){var e,t;e=Bn(a.edges),t=[];for(var n=1;n<e.length;n+=1)("src"in e[n-1]||"data"in e[n-1])&&"tgt"in e[n]&&(e[n-1].tgt=e[n].tgt,t.push(e[n-1]),n++);return t},(o=c())!==s&&Jt===n.length)return o;throw o!==s&&Jt<n.length&&sn({type:"end",description:"end of input"}),ln(null,nn,tn<n.length?n.charAt(tn):null,tn<n.length?an(tn,tn+1):an(tn,tn))}}}()},{"../schema/graph.json":15,tv4:18}],13:[function(e,t,n){var o=e("./fbp"),r=e("./serialize");t.exports={SyntaxError:o.SyntaxError,parse:o.parse,serialize:r}},{"./fbp":12,"./serialize":14}],14:[function(e,t,n){var o=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};t.exports=function(e,t){var n,r,i,a,s,l,c,p,u,d,f,h,m,g,v,b,y,w,x,$,C,_,k;for(p in null==t&&(t={}),l="string"==typeof e?JSON.parse(e):e,u=[],f="",i=function(e){return null!=l.processes[e].metadata&&(e=l.processes[e].metadata.label),e.indexOf("/")>-1&&(e=e.split("/").pop()),e},r=function(e,t){return null!=t.process&&null!=l.processes[t.process].metadata?e=l.processes[t.process].metadata.label:null!=t.process&&(e=t.process),e.indexOf("/")>-1&&(e=e.split("/").pop()),e},l.properties&&(l.properties.environment&&l.properties.environment.type&&(f+="# @runtime "+l.properties.environment.type+"\n"),Object.keys(l.properties).forEach(function(e){if(e.match(/^[a-zA-Z0-9\-_]+$/)){var t=l.properties[e];"string"==typeof t&&t.match(/^[a-zA-Z0-9\-_\s\.]+$/)&&(f+="# @"+e+" "+t+"\n")}})),m=l.inports)h=r(p,s=m[p]),p=l.caseSensitive?p:p.toUpperCase(),s.port=l.caseSensitive?s.port:s.port.toUpperCase(),f+="INPORT="+h+"."+s.port+":"+p+"\n";for(p in g=l.outports)h=r(p,d=g[p]),p=l.caseSensitive?p:p.toUpperCase(),d.port=l.caseSensitive?d.port:d.port.toUpperCase(),f+="OUTPORT="+h+"."+d.port+":"+p+"\n";for(f+="\n",a=0,c=(v=l.connections).length;a<c;a++)null!=(n=v[a]).data?(_=l.caseSensitive?n.tgt.port:n.tgt.port.toUpperCase(),C=n.tgt.process,k=l.processes[C].component,$=i(C),o.call(u,k)<0&&($+="("+k+")",u.push(k)),f+='"'+n.data+'" -> '+_+" "+$+"\n"):(w=l.caseSensitive?n.src.port:n.src.port.toUpperCase(),y=n.src.process,x=l.processes[y].component,b=i(y),o.call(u,x)<0&&(b+="("+x+")",u.push(x)),_=l.caseSensitive?n.tgt.port:n.tgt.port.toUpperCase(),C=n.tgt.process,k=l.processes[C].component,$=i(C),o.call(u,k)<0&&($+="("+k+")",u.push(k)),f+=b+" "+w+" -> "+_+" "+$+"\n");return f}},{}],15:[function(e,t,n){t.exports={$schema:"http://json-schema.org/draft-04/schema",id:"graph.json",title:"FBP graph",description:"A graph of FBP processes and connections between them.\nThis is the primary way of specifying FBP programs.\n",name:"graph",type:"object",additionalProperties:!1,properties:{caseSensitive:{type:"boolean",description:"Whether the graph port identifiers should be treated as case-sensitive"},properties:{type:"object",description:"User-defined properties attached to the graph.",additionalProperties:!0,properties:{name:{type:"string",description:"Name of the graph"},environment:{type:"object",description:"Information about the execution environment for the graph",additionalProperties:!0,required:["type"],properties:{type:{type:"string",description:"Runtime type the graph is for",example:"noflo-nodejs"},content:{type:"string",description:"HTML fixture for browser-based graphs"}}},description:{type:"string",description:"Graph description"},icon:{type:"string",description:"Name of the icon that can be used for depicting the graph"}}},inports:{type:["object","undefined"],description:"Exported inports of the graph",additionalProperties:!0,patternProperties:{"[a-z0-9]+":{type:"object",properties:{process:{type:"string"},port:{type:"string"},metadata:{type:"object",additionalProperties:!0,required:[],properties:{x:{type:"integer",description:"X coordinate of a graph inport"},y:{type:"integer",description:"Y coordinate of a graph inport"}}}}}}},outports:{type:["object","undefined"],description:"Exported outports of the graph",additionalProperties:!0,patternProperties:{"[a-z0-9]+":{type:"object",properties:{process:{type:"string"},port:{type:"string"},metadata:{type:"object",required:[],additionalProperties:!0,properties:{x:{type:"integer",description:"X coordinate of a graph outport"},y:{type:"integer",description:"Y coordinate of a graph outport"}}}}}}},groups:{type:"array",description:"List of groups of processes",items:{type:"object",additionalProperties:!1,properties:{name:{type:"string"},nodes:{type:"array",items:{type:"string"}},metadata:{type:"object",additionalProperties:!0,required:[],properties:{description:{type:"string"}}}}}},processes:{type:"object",description:"The processes of this graph.\nEach process is an instance of a component.\n",additionalProperties:!1,patternProperties:{"[a-zA-Z0-9_]+":{type:"object",properties:{component:{type:"string"},metadata:{type:"object",additionalProperties:!0,required:[],properties:{x:{type:"integer",description:"X coordinate of a graph node"},y:{type:"integer",description:"Y coordinate of a graph node"}}}}}}},connections:{type:"array",description:"Connections of the graph.\nA connection either connects ports of two processes, or specifices an IIP as initial input packet to a port.\n",items:{type:"object",additionalProperties:!1,properties:{src:{type:"object",additionalProperties:!1,properties:{process:{type:"string"},port:{type:"string"},index:{type:"integer"}}},tgt:{type:"object",additionalProperties:!1,properties:{process:{type:"string"},port:{type:"string"},index:{type:"integer"}}},data:{},metadata:{type:"object",additionalProperties:!0,required:[],properties:{route:{type:"integer",description:"Route identifier of a graph edge"},schema:{type:"string",format:"uri",description:"JSON schema associated with a graph edge"},secure:{type:"boolean",description:"Whether edge data should be treated as secure"}}}}}}}}},{}],16:[function(e,t,n){n.read=function(e,t,n,o,r){var i,a,s=8*r-o-1,l=(1<<s)-1,c=l>>1,p=-7,u=n?r-1:0,d=n?-1:1,f=e[t+u];for(u+=d,i=f&(1<<-p)-1,f>>=-p,p+=s;p>0;i=256*i+e[t+u],u+=d,p-=8);for(a=i&(1<<-p)-1,i>>=-p,p+=o;p>0;a=256*a+e[t+u],u+=d,p-=8);if(0===i)i=1-c;else{if(i===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,o),i-=c}return(f?-1:1)*a*Math.pow(2,i-o)},n.write=function(e,t,n,o,r,i){var a,s,l,c=8*i-r-1,p=(1<<c)-1,u=p>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=o?0:i-1,h=o?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=p):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+u>=1?d/l:d*Math.pow(2,1-u))*l>=2&&(a++,l/=2),a+u>=p?(s=0,a=p):a+u>=1?(s=(t*l-1)*Math.pow(2,r),a+=u):(s=t*Math.pow(2,u-1)*Math.pow(2,r),a=0));r>=8;e[n+f]=255&s,f+=h,s/=256,r-=8);for(a=a<<r|s,c+=r;c>0;e[n+f]=255&a,f+=h,a/=256,c-=8);e[n+f-h]|=128*m}},{}],17:[function(e,t,n){var o,r,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function l(e){if(o===setTimeout)return setTimeout(e,0);if((o===a||!o)&&setTimeout)return o=setTimeout,setTimeout(e,0);try{return o(e,0)}catch(t){try{return o.call(null,e,0)}catch(t){return o.call(this,e,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:a}catch(e){o=a}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,p=[],u=!1,d=-1;function f(){u&&c&&(u=!1,c.length?p=c.concat(p):d=-1,p.length&&h())}function h(){if(!u){var e=l(f);u=!0;for(var t=p.length;t;){for(c=p,p=[];++d<t;)c&&c[d].run();d=-1,t=p.length}c=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new m(e,t)),1!==p.length||u||l(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],18:[function(e,t,n){var o,r;o=this,r=function(){var e,t,n,o;Object.keys||(Object.keys=(e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),o=(n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(r){if("object"!=typeof r&&"function"!=typeof r||null===r)throw new TypeError("Object.keys called on non-object");var i=[];for(var a in r)e.call(r,a)&&i.push(a);if(t)for(var s=0;s<o;s++)e.call(r,n[s])&&i.push(n[s]);return i})),Object.create||(Object.create=function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return e.prototype=t,new e}}()),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(null===this)throw new TypeError;var t=Object(this),n=t.length>>>0;if(0===n)return-1;var o=0;if(arguments.length>1&&((o=Number(arguments[1]))!=o?o=0:0!==o&&o!==1/0&&o!==-1/0&&(o=(o>0||-1)*Math.floor(Math.abs(o)))),o>=n)return-1;for(var r=o>=0?o:Math.max(n-Math.abs(o),0);r<n;r++)if(r in t&&t[r]===e)return r;return-1}),Object.isFrozen||(Object.isFrozen=function(e){for(var t="tv4_test_frozen_key";e.hasOwnProperty(t);)t+=Math.random();try{return e[t]=!0,delete e[t],!1}catch(e){return!0}});var r={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},i={"*":!0};function a(e){return encodeURI(e).replace(/%25[0-9][0-9]/g,function(e){return"%"+e.substring(3)})}function s(e){var t="";r[e.charAt(0)]&&(t=e.charAt(0),e=e.substring(1));var n="",o="",s=!0,l=!1,c=!1;"+"===t?s=!1:"."===t?(o=".",n="."):"/"===t?(o="/",n="/"):"#"===t?(o="#",s=!1):";"===t?(o=";",n=";",l=!0,c=!0):"?"===t?(o="?",n="&",l=!0):"&"===t&&(o="&",n="&",l=!0);for(var p=[],u=e.split(","),d=[],f={},h=0;h<u.length;h++){var m=u[h],g=null;if(-1!==m.indexOf(":")){var v=m.split(":");m=v[0],g=parseInt(v[1],10)}for(var b={};i[m.charAt(m.length-1)];)b[m.charAt(m.length-1)]=!0,m=m.substring(0,m.length-1);var y={truncate:g,name:m,suffices:b};d.push(y),f[m]=y,p.push(m)}var w=function(e){for(var t="",r=0,i=0;i<d.length;i++){var p=d[i],u=e(p.name);if(null==u||Array.isArray(u)&&0===u.length||"object"==typeof u&&0===Object.keys(u).length)r++;else if(t+=i===r?o:n||",",Array.isArray(u)){l&&(t+=p.name+"=");for(var f=0;f<u.length;f++)f>0&&(t+=p.suffices["*"]&&n||",",p.suffices["*"]&&l&&(t+=p.name+"=")),t+=s?encodeURIComponent(u[f]).replace(/!/g,"%21"):a(u[f])}else if("object"==typeof u){l&&!p.suffices["*"]&&(t+=p.name+"=");var h=!0;for(var m in u)h||(t+=p.suffices["*"]&&n||","),h=!1,t+=s?encodeURIComponent(m).replace(/!/g,"%21"):a(m),t+=p.suffices["*"]?"=":",",t+=s?encodeURIComponent(u[m]).replace(/!/g,"%21"):a(u[m])}else l&&(t+=p.name,c&&""===u||(t+="=")),null!=p.truncate&&(u=u.substring(0,p.truncate)),t+=s?encodeURIComponent(u).replace(/!/g,"%21"):a(u)}return t};return w.varNames=p,{prefix:o,substitution:w}}function l(e){if(!(this instanceof l))return new l(e);for(var t=e.split("{"),n=[t.shift()],o=[],r=[],i=[];t.length>0;){var a=t.shift(),c=a.split("}")[0],p=a.substring(c.length+1),u=s(c);r.push(u.substitution),o.push(u.prefix),n.push(p),i=i.concat(u.substitution.varNames)}this.fill=function(e){for(var t=n[0],o=0;o<r.length;o++){t+=(0,r[o])(e),t+=n[o+1]}return t},this.varNames=i,this.template=e}l.prototype={toString:function(){return this.template},fillFromObject:function(e){return this.fill(function(t){return e[t]})}};var c=function(e,t,n,o,r){if(this.missing=[],this.missingMap={},this.formatValidators=e?Object.create(e.formatValidators):{},this.schemas=e?Object.create(e.schemas):{},this.collectMultiple=t,this.errors=[],this.handleError=t?this.collectError:this.returnError,o&&(this.checkRecursive=!0,this.scanned=[],this.scannedFrozen=[],this.scannedFrozenSchemas=[],this.scannedFrozenValidationErrors=[],this.validatedSchemasKey="tv4_validation_id",this.validationErrorsKey="tv4_validation_errors_id"),r&&(this.trackUnknownProperties=!0,this.knownPropertyPaths={},this.unknownPropertyPaths={}),this.errorReporter=n||v("en"),"string"==typeof this.errorReporter)throw new Error("debug");if(this.definedKeywords={},e)for(var i in e.definedKeywords)this.definedKeywords[i]=e.definedKeywords[i].slice(0)};function p(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(Array.isArray(e)!==Array.isArray(t))return!1;if(Array.isArray(e)){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!p(e[n],t[n]))return!1}else{var o;for(o in e)if(void 0===t[o]&&void 0!==e[o])return!1;for(o in t)if(void 0===e[o]&&void 0!==t[o])return!1;for(o in e)if(!p(e[o],t[o]))return!1}return!0}return!1}c.prototype.defineKeyword=function(e,t){this.definedKeywords[e]=this.definedKeywords[e]||[],this.definedKeywords[e].push(t)},c.prototype.createError=function(e,t,n,o,r,i,a){var s=new $(e,t,n,o,r);return s.message=this.errorReporter(s,i,a),s},c.prototype.returnError=function(e){return e},c.prototype.collectError=function(e){return e&&this.errors.push(e),null},c.prototype.prefixErrors=function(e,t,n){for(var o=e;o<this.errors.length;o++)this.errors[o]=this.errors[o].prefixWith(t,n);return this},c.prototype.banUnknownProperties=function(e,t){for(var n in this.unknownPropertyPaths){var o=this.createError(b.UNKNOWN_PROPERTY,{path:n},n,"",null,e,t),r=this.handleError(o);if(r)return r}return null},c.prototype.addFormat=function(e,t){if("object"==typeof e){for(var n in e)this.addFormat(n,e[n]);return this}this.formatValidators[e]=t},c.prototype.resolveRefs=function(e,t){if(void 0!==e.$ref){if((t=t||{})[e.$ref])return this.createError(b.CIRCULAR_REFERENCE,{urls:Object.keys(t).join(", ")},"","",null,void 0,e);t[e.$ref]=!0,e=this.getSchema(e.$ref,t)}return e},c.prototype.getSchema=function(e,t){var n;if(void 0!==this.schemas[e])return n=this.schemas[e],this.resolveRefs(n,t);var o=e,r="";if(-1!==e.indexOf("#")&&(r=e.substring(e.indexOf("#")+1),o=e.substring(0,e.indexOf("#"))),"object"==typeof this.schemas[o]){n=this.schemas[o];var i=decodeURIComponent(r);if(""===i)return this.resolveRefs(n,t);if("/"!==i.charAt(0))return;for(var a=i.split("/").slice(1),s=0;s<a.length;s++){var l=a[s].replace(/~1/g,"/").replace(/~0/g,"~");if(void 0===n[l]){n=void 0;break}n=n[l]}if(void 0!==n)return this.resolveRefs(n,t)}void 0===this.missing[o]&&(this.missing.push(o),this.missing[o]=o,this.missingMap[o]=o)},c.prototype.searchSchemas=function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)this.searchSchemas(e[n],t);else if(e&&"object"==typeof e)for(var o in"string"==typeof e.id&&function(e,t){if(t.substring(0,e.length)===e){var n=t.substring(e.length);if(t.length>0&&"/"===t.charAt(e.length-1)||"#"===n.charAt(0)||"?"===n.charAt(0))return!0}return!1}(t,e.id)&&void 0===this.schemas[e.id]&&(this.schemas[e.id]=e),e)if("enum"!==o)if("object"==typeof e[o])this.searchSchemas(e[o],t);else if("$ref"===o){var r=m(e[o]);r&&void 0===this.schemas[r]&&void 0===this.missingMap[r]&&(this.missingMap[r]=r)}},c.prototype.addSchema=function(e,t){if("string"!=typeof e||void 0===t){if("object"!=typeof e||"string"!=typeof e.id)return;e=(t=e).id}e===m(e)+"#"&&(e=m(e)),this.schemas[e]=t,delete this.missingMap[e],g(t,e),this.searchSchemas(t,e)},c.prototype.getSchemaMap=function(){var e={};for(var t in this.schemas)e[t]=this.schemas[t];return e},c.prototype.getSchemaUris=function(e){var t=[];for(var n in this.schemas)e&&!e.test(n)||t.push(n);return t},c.prototype.getMissingUris=function(e){var t=[];for(var n in this.missingMap)e&&!e.test(n)||t.push(n);return t},c.prototype.dropSchemas=function(){this.schemas={},this.reset()},c.prototype.reset=function(){this.missing=[],this.missingMap={},this.errors=[]},c.prototype.validateAll=function(e,t,n,o,r){var i;if(!(t=this.resolveRefs(t)))return null;if(t instanceof $)return this.errors.push(t),t;var a,s=this.errors.length,l=null,c=null;if(this.checkRecursive&&e&&"object"==typeof e){if(i=!this.scanned.length,e[this.validatedSchemasKey]){var p=e[this.validatedSchemasKey].indexOf(t);if(-1!==p)return this.errors=this.errors.concat(e[this.validationErrorsKey][p]),null}if(Object.isFrozen(e)&&-1!==(a=this.scannedFrozen.indexOf(e))){var u=this.scannedFrozenSchemas[a].indexOf(t);if(-1!==u)return this.errors=this.errors.concat(this.scannedFrozenValidationErrors[a][u]),null}if(this.scanned.push(e),Object.isFrozen(e))-1===a&&(a=this.scannedFrozen.length,this.scannedFrozen.push(e),this.scannedFrozenSchemas.push([])),l=this.scannedFrozenSchemas[a].length,this.scannedFrozenSchemas[a][l]=t,this.scannedFrozenValidationErrors[a][l]=[];else{if(!e[this.validatedSchemasKey])try{Object.defineProperty(e,this.validatedSchemasKey,{value:[],configurable:!0}),Object.defineProperty(e,this.validationErrorsKey,{value:[],configurable:!0})}catch(t){e[this.validatedSchemasKey]=[],e[this.validationErrorsKey]=[]}c=e[this.validatedSchemasKey].length,e[this.validatedSchemasKey][c]=t,e[this.validationErrorsKey][c]=[]}}var d=this.errors.length,f=this.validateBasic(e,t,r)||this.validateNumeric(e,t,r)||this.validateString(e,t,r)||this.validateArray(e,t,r)||this.validateObject(e,t,r)||this.validateCombinations(e,t,r)||this.validateHypermedia(e,t,r)||this.validateFormat(e,t,r)||this.validateDefinedKeywords(e,t,r)||null;if(i){for(;this.scanned.length;){delete this.scanned.pop()[this.validatedSchemasKey]}this.scannedFrozen=[],this.scannedFrozenSchemas=[]}if(f||d!==this.errors.length)for(;n&&n.length||o&&o.length;){var h=n&&n.length?""+n.pop():null,m=o&&o.length?""+o.pop():null;f&&(f=f.prefixWith(h,m)),this.prefixErrors(d,h,m)}return null!==l?this.scannedFrozenValidationErrors[a][l]=this.errors.slice(s):null!==c&&(e[this.validationErrorsKey][c]=this.errors.slice(s)),this.handleError(f)},c.prototype.validateFormat=function(e,t){if("string"!=typeof t.format||!this.formatValidators[t.format])return null;var n=this.formatValidators[t.format].call(null,e,t);return"string"==typeof n||"number"==typeof n?this.createError(b.FORMAT_CUSTOM,{message:n},"","/format",null,e,t):n&&"object"==typeof n?this.createError(b.FORMAT_CUSTOM,{message:n.message||"?"},n.dataPath||"",n.schemaPath||"/format",null,e,t):null},c.prototype.validateDefinedKeywords=function(e,t,n){for(var o in this.definedKeywords)if(void 0!==t[o])for(var r=this.definedKeywords[o],i=0;i<r.length;i++){var a=(0,r[i])(e,t[o],t,n);if("string"==typeof a||"number"==typeof a)return this.createError(b.KEYWORD_CUSTOM,{key:o,message:a},"","",null,e,t).prefixWith(null,o);if(a&&"object"==typeof a){var s=a.code;if("string"==typeof s){if(!b[s])throw new Error("Undefined error code (use defineError): "+s);s=b[s]}else"number"!=typeof s&&(s=b.KEYWORD_CUSTOM);var l="object"==typeof a.message?a.message:{key:o,message:a.message||"?"},c=a.schemaPath||"/"+o.replace(/~/g,"~0").replace(/\//g,"~1");return this.createError(s,l,a.dataPath||null,c,null,e,t)}}return null},c.prototype.validateBasic=function(e,t,n){var o;return(o=this.validateType(e,t,n))?o.prefixWith(null,"type"):(o=this.validateEnum(e,t,n))?o.prefixWith(null,"type"):null},c.prototype.validateType=function(e,t){if(void 0===t.type)return null;var n=typeof e;null===e?n="null":Array.isArray(e)&&(n="array");var o=t.type;Array.isArray(o)||(o=[o]);for(var r=0;r<o.length;r++){var i=o[r];if(i===n||"integer"===i&&"number"===n&&e%1==0)return null}return this.createError(b.INVALID_TYPE,{type:n,expected:o.join("/")},"","",null,e,t)},c.prototype.validateEnum=function(e,t){if(void 0===t.enum)return null;for(var n=0;n<t.enum.length;n++){if(p(e,t.enum[n]))return null}return this.createError(b.ENUM_MISMATCH,{value:"undefined"!=typeof JSON?JSON.stringify(e):e},"","",null,e,t)},c.prototype.validateNumeric=function(e,t,n){return this.validateMultipleOf(e,t,n)||this.validateMinMax(e,t,n)||this.validateNaN(e,t,n)||null};var u=Math.pow(2,-51),d=1-u;function f(e){var t=String(e).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return t?{href:t[0]||"",protocol:t[1]||"",authority:t[2]||"",host:t[3]||"",hostname:t[4]||"",port:t[5]||"",pathname:t[6]||"",search:t[7]||"",hash:t[8]||""}:null}function h(e,t){return t=f(t||""),e=f(e||""),t&&e?(t.protocol||e.protocol)+(t.protocol||t.authority?t.authority:e.authority)+(n=t.protocol||t.authority||"/"===t.pathname.charAt(0)?t.pathname:t.pathname?(e.authority&&!e.pathname?"/":"")+e.pathname.slice(0,e.pathname.lastIndexOf("/")+1)+t.pathname:e.pathname,o=[],n.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(e){"/.."===e?o.pop():o.push(e)}),o.join("").replace(/^\//,"/"===n.charAt(0)?"/":""))+(t.protocol||t.authority||t.pathname?t.search:t.search||e.search)+t.hash:null;var n,o}function m(e){return e.split("#")[0]}function g(e,t){if(e&&"object"==typeof e)if(void 0===t?t=e.id:"string"==typeof e.id&&(t=h(t,e.id),e.id=t),Array.isArray(e))for(var n=0;n<e.length;n++)g(e[n],t);else for(var o in"string"==typeof e.$ref&&(e.$ref=h(t,e.$ref)),e)"enum"!==o&&g(e[o],t)}function v(e){var t=C[e=e||"en"];return function(e){var n=t[e.code]||x[e.code];if("string"!=typeof n)return"Unknown error code "+e.code+": "+JSON.stringify(e.messageParams);var o=e.params;return n.replace(/\{([^{}]*)\}/g,function(e,t){var n=o[t];return"string"==typeof n||"number"==typeof n?n:e})}}c.prototype.validateMultipleOf=function(e,t){var n=t.multipleOf||t.divisibleBy;if(void 0===n)return null;if("number"==typeof e){var o=e/n%1;if(o>=u&&o<d)return this.createError(b.NUMBER_MULTIPLE_OF,{value:e,multipleOf:n},"","",null,e,t)}return null},c.prototype.validateMinMax=function(e,t){if("number"!=typeof e)return null;if(void 0!==t.minimum){if(e<t.minimum)return this.createError(b.NUMBER_MINIMUM,{value:e,minimum:t.minimum},"","/minimum",null,e,t);if(t.exclusiveMinimum&&e===t.minimum)return this.createError(b.NUMBER_MINIMUM_EXCLUSIVE,{value:e,minimum:t.minimum},"","/exclusiveMinimum",null,e,t)}if(void 0!==t.maximum){if(e>t.maximum)return this.createError(b.NUMBER_MAXIMUM,{value:e,maximum:t.maximum},"","/maximum",null,e,t);if(t.exclusiveMaximum&&e===t.maximum)return this.createError(b.NUMBER_MAXIMUM_EXCLUSIVE,{value:e,maximum:t.maximum},"","/exclusiveMaximum",null,e,t)}return null},c.prototype.validateNaN=function(e,t){return"number"!=typeof e?null:!0===isNaN(e)||e===1/0||e===-1/0?this.createError(b.NUMBER_NOT_A_NUMBER,{value:e},"","/type",null,e,t):null},c.prototype.validateString=function(e,t,n){return this.validateStringLength(e,t,n)||this.validateStringPattern(e,t,n)||null},c.prototype.validateStringLength=function(e,t){return"string"!=typeof e?null:void 0!==t.minLength&&e.length<t.minLength?this.createError(b.STRING_LENGTH_SHORT,{length:e.length,minimum:t.minLength},"","/minLength",null,e,t):void 0!==t.maxLength&&e.length>t.maxLength?this.createError(b.STRING_LENGTH_LONG,{length:e.length,maximum:t.maxLength},"","/maxLength",null,e,t):null},c.prototype.validateStringPattern=function(e,t){if("string"!=typeof e||"string"!=typeof t.pattern&&!(t.pattern instanceof RegExp))return null;var n;if(t.pattern instanceof RegExp)n=t.pattern;else{var o,r="",i=t.pattern.match(/^\/(.+)\/([img]*)$/);i?(o=i[1],r=i[2]):o=t.pattern,n=new RegExp(o,r)}return n.test(e)?null:this.createError(b.STRING_PATTERN,{pattern:t.pattern},"","/pattern",null,e,t)},c.prototype.validateArray=function(e,t,n){return Array.isArray(e)&&(this.validateArrayLength(e,t,n)||this.validateArrayUniqueItems(e,t,n)||this.validateArrayItems(e,t,n))||null},c.prototype.validateArrayLength=function(e,t){var n;return void 0!==t.minItems&&e.length<t.minItems&&(n=this.createError(b.ARRAY_LENGTH_SHORT,{length:e.length,minimum:t.minItems},"","/minItems",null,e,t),this.handleError(n))?n:void 0!==t.maxItems&&e.length>t.maxItems&&(n=this.createError(b.ARRAY_LENGTH_LONG,{length:e.length,maximum:t.maxItems},"","/maxItems",null,e,t),this.handleError(n))?n:null},c.prototype.validateArrayUniqueItems=function(e,t){if(t.uniqueItems)for(var n=0;n<e.length;n++)for(var o=n+1;o<e.length;o++)if(p(e[n],e[o])){var r=this.createError(b.ARRAY_UNIQUE,{match1:n,match2:o},"","/uniqueItems",null,e,t);if(this.handleError(r))return r}return null},c.prototype.validateArrayItems=function(e,t,n){if(void 0===t.items)return null;var o,r;if(Array.isArray(t.items)){for(r=0;r<e.length;r++)if(r<t.items.length){if(o=this.validateAll(e[r],t.items[r],[r],["items",r],n+"/"+r))return o}else if(void 0!==t.additionalItems)if("boolean"==typeof t.additionalItems){if(!t.additionalItems&&(o=this.createError(b.ARRAY_ADDITIONAL_ITEMS,{},"/"+r,"/additionalItems",null,e,t),this.handleError(o)))return o}else if(o=this.validateAll(e[r],t.additionalItems,[r],["additionalItems"],n+"/"+r))return o}else for(r=0;r<e.length;r++)if(o=this.validateAll(e[r],t.items,[r],["items"],n+"/"+r))return o;return null},c.prototype.validateObject=function(e,t,n){return"object"!=typeof e||null===e||Array.isArray(e)?null:this.validateObjectMinMaxProperties(e,t,n)||this.validateObjectRequiredProperties(e,t,n)||this.validateObjectProperties(e,t,n)||this.validateObjectDependencies(e,t,n)||null},c.prototype.validateObjectMinMaxProperties=function(e,t){var n,o=Object.keys(e);return void 0!==t.minProperties&&o.length<t.minProperties&&(n=this.createError(b.OBJECT_PROPERTIES_MINIMUM,{propertyCount:o.length,minimum:t.minProperties},"","/minProperties",null,e,t),this.handleError(n))?n:void 0!==t.maxProperties&&o.length>t.maxProperties&&(n=this.createError(b.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:o.length,maximum:t.maxProperties},"","/maxProperties",null,e,t),this.handleError(n))?n:null},c.prototype.validateObjectRequiredProperties=function(e,t){if(void 0!==t.required)for(var n=0;n<t.required.length;n++){var o=t.required[n];if(void 0===e[o]){var r=this.createError(b.OBJECT_REQUIRED,{key:o},"","/required/"+n,null,e,t);if(this.handleError(r))return r}}return null},c.prototype.validateObjectProperties=function(e,t,n){var o;for(var r in e){var i=n+"/"+r.replace(/~/g,"~0").replace(/\//g,"~1"),a=!1;if(void 0!==t.properties&&void 0!==t.properties[r]&&(a=!0,o=this.validateAll(e[r],t.properties[r],[r],["properties",r],i)))return o;if(void 0!==t.patternProperties)for(var s in t.patternProperties){if(new RegExp(s).test(r)&&(a=!0,o=this.validateAll(e[r],t.patternProperties[s],[r],["patternProperties",s],i)))return o}if(a)this.trackUnknownProperties&&(this.knownPropertyPaths[i]=!0,delete this.unknownPropertyPaths[i]);else if(void 0!==t.additionalProperties){if(this.trackUnknownProperties&&(this.knownPropertyPaths[i]=!0,delete this.unknownPropertyPaths[i]),"boolean"==typeof t.additionalProperties){if(!t.additionalProperties&&(o=this.createError(b.OBJECT_ADDITIONAL_PROPERTIES,{key:r},"","/additionalProperties",null,e,t).prefixWith(r,null),this.handleError(o)))return o}else if(o=this.validateAll(e[r],t.additionalProperties,[r],["additionalProperties"],i))return o}else this.trackUnknownProperties&&!this.knownPropertyPaths[i]&&(this.unknownPropertyPaths[i]=!0)}return null},c.prototype.validateObjectDependencies=function(e,t,n){var o;if(void 0!==t.dependencies)for(var r in t.dependencies)if(void 0!==e[r]){var i=t.dependencies[r];if("string"==typeof i){if(void 0===e[i]&&(o=this.createError(b.OBJECT_DEPENDENCY_KEY,{key:r,missing:i},"","",null,e,t).prefixWith(null,r).prefixWith(null,"dependencies"),this.handleError(o)))return o}else if(Array.isArray(i))for(var a=0;a<i.length;a++){var s=i[a];if(void 0===e[s]&&(o=this.createError(b.OBJECT_DEPENDENCY_KEY,{key:r,missing:s},"","/"+a,null,e,t).prefixWith(null,r).prefixWith(null,"dependencies"),this.handleError(o)))return o}else if(o=this.validateAll(e,i,[],["dependencies",r],n))return o}return null},c.prototype.validateCombinations=function(e,t,n){return this.validateAllOf(e,t,n)||this.validateAnyOf(e,t,n)||this.validateOneOf(e,t,n)||this.validateNot(e,t,n)||null},c.prototype.validateAllOf=function(e,t,n){if(void 0===t.allOf)return null;for(var o,r=0;r<t.allOf.length;r++){var i=t.allOf[r];if(o=this.validateAll(e,i,[],["allOf",r],n))return o}return null},c.prototype.validateAnyOf=function(e,t,n){if(void 0===t.anyOf)return null;var o,r,i=[],a=this.errors.length;this.trackUnknownProperties&&(o=this.unknownPropertyPaths,r=this.knownPropertyPaths);for(var s=!0,l=0;l<t.anyOf.length;l++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var c=t.anyOf[l],p=this.errors.length,u=this.validateAll(e,c,[],["anyOf",l],n);if(null===u&&p===this.errors.length){if(this.errors=this.errors.slice(0,a),this.trackUnknownProperties){for(var d in this.knownPropertyPaths)r[d]=!0,delete o[d];for(var f in this.unknownPropertyPaths)r[f]||(o[f]=!0);s=!1;continue}return null}u&&i.push(u.prefixWith(null,""+l).prefixWith(null,"anyOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=o,this.knownPropertyPaths=r),s?(i=i.concat(this.errors.slice(a)),this.errors=this.errors.slice(0,a),this.createError(b.ANY_OF_MISSING,{},"","/anyOf",i,e,t)):void 0},c.prototype.validateOneOf=function(e,t,n){if(void 0===t.oneOf)return null;var o,r,i=null,a=[],s=this.errors.length;this.trackUnknownProperties&&(o=this.unknownPropertyPaths,r=this.knownPropertyPaths);for(var l=0;l<t.oneOf.length;l++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var c=t.oneOf[l],p=this.errors.length,u=this.validateAll(e,c,[],["oneOf",l],n);if(null===u&&p===this.errors.length){if(null!==i)return this.errors=this.errors.slice(0,s),this.createError(b.ONE_OF_MULTIPLE,{index1:i,index2:l},"","/oneOf",null,e,t);if(i=l,this.trackUnknownProperties){for(var d in this.knownPropertyPaths)r[d]=!0,delete o[d];for(var f in this.unknownPropertyPaths)r[f]||(o[f]=!0)}}else u&&a.push(u)}return this.trackUnknownProperties&&(this.unknownPropertyPaths=o,this.knownPropertyPaths=r),null===i?(a=a.concat(this.errors.slice(s)),this.errors=this.errors.slice(0,s),this.createError(b.ONE_OF_MISSING,{},"","/oneOf",a,e,t)):(this.errors=this.errors.slice(0,s),null)},c.prototype.validateNot=function(e,t,n){if(void 0===t.not)return null;var o,r,i=this.errors.length;this.trackUnknownProperties&&(o=this.unknownPropertyPaths,r=this.knownPropertyPaths,this.unknownPropertyPaths={},this.knownPropertyPaths={});var a=this.validateAll(e,t.not,null,null,n),s=this.errors.slice(i);return this.errors=this.errors.slice(0,i),this.trackUnknownProperties&&(this.unknownPropertyPaths=o,this.knownPropertyPaths=r),null===a&&0===s.length?this.createError(b.NOT_PASSED,{},"","/not",null,e,t):null},c.prototype.validateHypermedia=function(e,t,n){if(!t.links)return null;for(var o,r=0;r<t.links.length;r++){var i=t.links[r];if("describedby"===i.rel){for(var a=new l(i.href),s=!0,c=0;c<a.varNames.length;c++)if(!(a.varNames[c]in e)){s=!1;break}if(s){var p={$ref:a.fillFromObject(e)};if(o=this.validateAll(e,p,[],["links",r],n))return o}}}};var b={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,NUMBER_NOT_A_NUMBER:105,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,FORMAT_CUSTOM:500,KEYWORD_CUSTOM:501,CIRCULAR_REFERENCE:600,UNKNOWN_PROPERTY:1e3},y={};for(var w in b)y[b[w]]=w;var x={INVALID_TYPE:"Invalid type: {type} (expected {expected})",ENUM_MISMATCH:"No enum match for: {value}",ANY_OF_MISSING:'Data does not match any schemas from "anyOf"',ONE_OF_MISSING:'Data does not match any schemas from "oneOf"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from "oneOf": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from "not"',NUMBER_MULTIPLE_OF:"Value {value} is not a multiple of {multipleOf}",NUMBER_MINIMUM:"Value {value} is less than minimum {minimum}",NUMBER_MINIMUM_EXCLUSIVE:"Value {value} is equal to exclusive minimum {minimum}",NUMBER_MAXIMUM:"Value {value} is greater than maximum {maximum}",NUMBER_MAXIMUM_EXCLUSIVE:"Value {value} is equal to exclusive maximum {maximum}",NUMBER_NOT_A_NUMBER:"Value {value} is not a valid number",STRING_LENGTH_SHORT:"String is too short ({length} chars), minimum {minimum}",STRING_LENGTH_LONG:"String is too long ({length} chars), maximum {maximum}",STRING_PATTERN:"String does not match pattern: {pattern}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({propertyCount}), minimum {minimum}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({propertyCount}), maximum {maximum}",OBJECT_REQUIRED:"Missing required property: {key}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {missing} (due to key: {key})",ARRAY_LENGTH_SHORT:"Array is too short ({length}), minimum {minimum}",ARRAY_LENGTH_LONG:"Array is too long ({length}), maximum {maximum}",ARRAY_UNIQUE:"Array items are not unique (indices {match1} and {match2})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",FORMAT_CUSTOM:"Format validation failed ({message})",KEYWORD_CUSTOM:"Keyword failed: {key} ({message})",CIRCULAR_REFERENCE:"Circular $refs: {urls}",UNKNOWN_PROPERTY:"Unknown property (not in schema)"};function $(e,t,n,o,r){if(Error.call(this),void 0===e)throw new Error("No error code supplied: "+o);this.message="",this.params=t,this.code=e,this.dataPath=n||"",this.schemaPath=o||"",this.subErrors=r||null;var i=new Error(this.message);if(this.stack=i.stack||i.stacktrace,!this.stack)try{throw i}catch(i){this.stack=i.stack||i.stacktrace}}$.prototype=Object.create(Error.prototype),$.prototype.constructor=$,$.prototype.name="ValidationError",$.prototype.prefixWith=function(e,t){if(null!==e&&(e=e.replace(/~/g,"~0").replace(/\//g,"~1"),this.dataPath="/"+e+this.dataPath),null!==t&&(t=t.replace(/~/g,"~0").replace(/\//g,"~1"),this.schemaPath="/"+t+this.schemaPath),null!==this.subErrors)for(var n=0;n<this.subErrors.length;n++)this.subErrors[n].prefixWith(e,t);return this};var C={};var _=function e(t){var n,o,r=new c,i={setErrorReporter:function(e){return"string"==typeof e?this.language(e):(o=e,!0)},addFormat:function(){r.addFormat.apply(r,arguments)},language:function(e){return e?(C[e]||(e=e.split("-")[0]),!!C[e]&&(n=e,e)):n},addLanguage:function(e,t){var n;for(n in b)t[n]&&!t[b[n]]&&(t[b[n]]=t[n]);var o=e.split("-")[0];if(C[o])for(n in C[e]=Object.create(C[o]),t)void 0===C[o][n]&&(C[o][n]=t[n]),C[e][n]=t[n];else C[e]=t,C[o]=t;return this},freshApi:function(t){var n=e();return t&&n.language(t),n},validate:function(e,t,i,a){var s=v(n),l=new c(r,!1,o?function(e,t,n){return o(e,t,n)||s(e,t,n)}:s,i,a);"string"==typeof t&&(t={$ref:t}),l.addSchema("",t);var p=l.validateAll(e,t,null,null,"");return!p&&a&&(p=l.banUnknownProperties(e,t)),this.error=p,this.missing=l.missing,this.valid=null===p,this.valid},validateResult:function(){var e={toString:function(){return this.valid?"valid":this.error.message}};return this.validate.apply(e,arguments),e},validateMultiple:function(e,t,i,a){var s=v(n),l=new c(r,!0,o?function(e,t,n){return o(e,t,n)||s(e,t,n)}:s,i,a);"string"==typeof t&&(t={$ref:t}),l.addSchema("",t),l.validateAll(e,t,null,null,""),a&&l.banUnknownProperties(e,t);var p={toString:function(){return this.valid?"valid":this.error.message}};return p.errors=l.errors,p.missing=l.missing,p.valid=0===p.errors.length,p},addSchema:function(){return r.addSchema.apply(r,arguments)},getSchema:function(){return r.getSchema.apply(r,arguments)},getSchemaMap:function(){return r.getSchemaMap.apply(r,arguments)},getSchemaUris:function(){return r.getSchemaUris.apply(r,arguments)},getMissingUris:function(){return r.getMissingUris.apply(r,arguments)},dropSchemas:function(){r.dropSchemas.apply(r,arguments)},defineKeyword:function(){r.defineKeyword.apply(r,arguments)},defineError:function(e,t,n){if("string"!=typeof e||!/^[A-Z]+(_[A-Z]+)*$/.test(e))throw new Error("Code name must be a string in UPPER_CASE_WITH_UNDERSCORES");if("number"!=typeof t||t%1!=0||t<1e4)throw new Error("Code number must be an integer > 10000");if(void 0!==b[e])throw new Error("Error already defined: "+e+" as "+b[e]);if(void 0!==y[t])throw new Error("Error code already used: "+y[t]+" as "+t);for(var o in b[e]=t,y[t]=e,x[e]=x[t]=n,C){var r=C[o];r[e]&&(r[t]=r[t]||r[e])}},reset:function(){r.reset(),this.error=null,this.missing=[],this.valid=!0},missing:[],error:null,valid:!0,normSchema:g,resolveUrl:h,getDocumentUri:m,errorCodes:b};return i.language(t||"en"),i}();return _.addLanguage("en-gb",x),_.tv4=_,_},void 0!==t&&t.exports?t.exports=r():o.tv4=r()},{}],19:[function(e,t,n){var o=e("../the-graph-thumb/the-graph-thumb.js");function r(e,t,n){e.clearRect(0,0,n.width,n.height),e.fillStyle=n.outsideFill;var o=Math.round((n.viewrectangle[0]/n.scale-n.thumbrectangle[0])*n.thumbscale),r=Math.round((n.viewrectangle[1]/n.scale-n.thumbrectangle[1])*n.thumbscale),i=Math.round(n.viewrectangle[2]*n.thumbscale/n.scale),a=Math.round(n.viewrectangle[3]*n.thumbscale/n.scale),s=!1;return o<0&&r<0&&i>n.width-o&&a>n.height-r?{hide:s=!0}:(s=!1,o<0?(i+=o,o=0,t.style.borderLeftColor=n.viewBoxBorder2):(t.style.borderLeftColor=n.viewBoxBorder,e.fillRect(0,0,o,n.height)),r<0?(a+=r,r=0,t.style.borderTopColor=n.viewBoxBorder2):(t.style.borderTopColor=n.viewBoxBorder,e.fillRect(o,0,i,r)),i>n.width-o?(i=n.width-o,t.style.borderRightColor=n.viewBoxBorder2):(t.style.borderRightColor=n.viewBoxBorder,e.fillRect(o+i,0,n.width-(o+i),n.height)),a>n.height-r?(a=n.height-r,t.style.borderBottomColor=n.viewBoxBorder2):(t.style.borderBottomColor=n.viewBoxBorder,e.fillRect(o,r+a,i,n.height-(r+a))),t.style.left=o+"px",t.style.top=r+"px",t.style.width=i+"px",t.style.height=a+"px",{hide:s})}var i=React.createClass({propTypes:{},getDefaultProps:function(){return{width:200,height:150,hidden:!1,backgroundColor:"hsla(184, 8%, 75%, 0.9)",outsideFill:"hsla(0, 0%, 0%, 0.4)",nodeSize:60,nodeLineWidth:1,viewrectangle:[0,0,0,0],viewscale:1,viewBoxBorder:"hsla(190, 100%, 80%, 0.4)",viewBoxBorder2:"hsla( 10,  60%, 32%, 0.3)",viewBoxBorderStyle:"dotted",graph:null}},getInitialState:function(){return{thumbscale:1,currentPan:[0,0]}},render:function(){var e=this.props,t={position:"absolute",top:0,left:0},n={height:e.height,width:e.width,overflow:"hidden",cursor:"move",backgroundColor:e.backgroundColor},o={key:"thumb",ref:this._refThumbCanvas,width:e.width,height:e.height,style:t},r={key:"viewbox",ref:this._refViewboxCanvas,width:e.width,height:e.height,style:t},i={key:"viewboxdiv",ref:this._refViewboxElement,style:{position:"absolute",top:0,left:0,width:e.width,height:e.height,borderStyle:"dotted",borderWidth:1}},a=React.DOM;return a.div({key:"nav",style:n,ref:this._refTopElement},[a.div(i),a.canvas(r),a.canvas(o)])},componentDidUpdate:function(){this._updatePan(),this._renderElements()},componentDidMount:function(){this._updatePan(),this._renderElements(),this._setupEvents()},_refThumbCanvas:function(e){this._thumbContext=e.getContext("2d")},_refViewboxCanvas:function(e){this._viewboxContext=e.getContext("2d")},_refViewboxElement:function(e){this._viewboxElement=e},_refTopElement:function(e){this._topElement=e},_renderElements:function(){var e=function(e,t){var n={};for(var r in t)n[r]=t[r];return n.graph=null,n.lineWidth=t.nodeLineWidth,o.render(e,t.graph,n)}(this._thumbContext,this.props);!function(e,t,n,o){var i={};for(var a in o)i[a]=o[a];i.graph=null,i.scale=o.viewscale;var s=n.rectangle[2],l=n.rectangle[3];i.thumbscale=s>l?o.width/s:o.height/l,i.thumbrectangle=n.rectangle,r(e,t,i)}(this._viewboxContext,this._viewboxElement,e,this.props)},_updatePan:function(){this.state.currentPan=[-this.props.viewrectangle[0],-this.props.viewrectangle[1]]},_setupEvents:function(){this.hammer=new Hammer.Manager(this._topElement,{recognizers:[[Hammer.Tap],[Hammer.Pan,{direction:Hammer.DIRECTION_ALL}]]}),this.hammer.on("tap",function(e){this.props.onTap&&this.props.onTap(null,e)}.bind(this)),this.hammer.on("panmove",function(e){if(this.props.onPanTo){var t=this.state.currentPan[0],n=this.state.currentPan[1],o=this.state.thumbscale/this.props.viewscale;t-=e.deltaX/o,n-=e.deltaY/o;var r={x:Math.round(t),y:Math.round(n)};this.state.currentPan[0]=r.x,this.state.currentPan[1]=r.y,this.props.onPanTo(r,e)}}.bind(this))}});t.exports={render:r,calculateStyleFromTheme:function(e){var t={};return"dark"===e?(t.viewBoxBorder="hsla(190, 100%, 80%, 0.4)",t.viewBoxBorder2="hsla( 10,  60%, 32%, 0.3)",t.outsideFill="hsla(0, 0%, 0%, 0.4)",t.backgroundColor="hsla(0, 0%, 0%, 0.9)"):(t.viewBoxBorder="hsla(190, 100%, 20%, 0.8)",t.viewBoxBorder2="hsla( 10,  60%, 80%, 0.8)",t.outsideFill="hsla(0, 0%, 100%, 0.4)",t.backgroundColor="hsla(0, 0%, 100%, 0.9)"),t},Component:i}},{"../the-graph-thumb/the-graph-thumb.js":20}],20:[function(e,t,n){function o(e,t,n,o,r,i){try{e.strokeStyle=i.edgeColors[0],r&&(e.strokeStyle=i.edgeColors[r]);var a=Math.round(n.metadata.x*t)-.5,s=Math.round(n.metadata.y*t)-.5,l=Math.round(o.metadata.x*t)-.5,c=Math.round(o.metadata.y*t)-.5;e.beginPath(),e.moveTo(a,s),e.lineTo(l,c),e.stroke()}catch(e){}}t.exports={render:function(e,t,n){e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,n.width,n.height),e.lineWidth=n.lineWidth;var r=[],i=1/0,a=1/0,s=-1/0,l=-1/0,c={};if(t.nodes.forEach(function(e){!e.metadata||isNaN(e.metadata.x)||isNaN(e.metadata.y)||(r.push(e),c[e.id]=e,i=Math.min(i,e.metadata.x),a=Math.min(a,e.metadata.y),s=Math.max(s,e.metadata.x),l=Math.max(l,e.metadata.y))}.bind(this)),t.inports&&Object.keys(t.inports).forEach(function(e){var n=t.inports[e];!n.metadata||isNaN(n.metadata.x)||isNaN(n.metadata.y)||(r.push(n),i=Math.min(i,n.metadata.x),a=Math.min(a,n.metadata.y),s=Math.max(s,n.metadata.x),l=Math.max(l,n.metadata.y))}.bind(this)),t.outports&&Object.keys(t.outports).forEach(function(e){var n=t.outports[e];!n.metadata||isNaN(n.metadata.x)||isNaN(n.metadata.y)||(r.push(n),i=Math.min(i,n.metadata.x),a=Math.min(a,n.metadata.y),s=Math.max(s,n.metadata.x),l=Math.max(l,n.metadata.y))}.bind(this)),0===r.length)return{scale:1,rectangle:[0,0,0,0]};if(!(isFinite(i)&&isFinite(a)&&isFinite(s)&&isFinite(l)))throw new Error("the-graph-thumb: Invalid space spanned");i-=n.nodeSize,a-=n.nodeSize,s+=2*n.nodeSize,l+=2*n.nodeSize;var p=s-i,u=l-a,d=[];d[0]=i,d[1]=a,d[2]=p,d[3]=u;var f=p>u?n.width/p:n.height/u,h=f,m=Math.round(n.nodeSize*f)/2;return e.setTransform(1,0,0,1,0-i*f,0-a*f),t.inports&&Object.keys(t.inports).forEach(function(r){var i=t.inports[r];if(i.metadata&&!isNaN(i.metadata.x)&&!isNaN(i.metadata.y)){var a=c[i.process];if(!a)return;o(e,f,i,a,2,n)}}.bind(this)),t.outports&&Object.keys(t.outports).forEach(function(r){var i=t.outports[r];if(i.metadata&&!isNaN(i.metadata.x)&&!isNaN(i.metadata.y)){var a=c[i.process];if(!a)return;o(e,f,a,i,5,n)}}.bind(this)),t.edges.forEach(function(t){var r=c[t.from.node],i=c[t.to.node];r&&i&&o(e,f,r,i,t.metadata.route,n)}.bind(this)),r.forEach(function(t){var o=Math.round(t.metadata.x*f),r=Math.round(t.metadata.y*f);e.strokeStyle=n.strokeStyle,e.fillStyle=n.fillStyle,e.beginPath(),t.process&&!t.component?e.arc(o,r,m/2,0,2*Math.PI,!1):e.arc(o,r,m,0,2*Math.PI,!1),e.fill(),e.stroke(),e.beginPath();var i=Math.max(m-1.5,1);t.process&&!t.component?e.arc(o,r,i/2,0,2*Math.PI,!1):e.arc(o,r,i,0,2*Math.PI,!1),e.fill()}.bind(this)),{rectangle:d,scale:h}},styleFromTheme:function(e){var t={};return"dark"===e?(t.fill="hsl(184, 8%, 10%)",t.stroke="hsl(180, 11%, 70%)",t.edgeColors=["white","hsl(  0, 100%, 46%)","hsl( 35, 100%, 46%)","hsl( 60, 100%, 46%)","hsl(135, 100%, 46%)","hsl(160, 100%, 46%)","hsl(185, 100%, 46%)","hsl(210, 100%, 46%)","hsl(285, 100%, 46%)","hsl(310, 100%, 46%)","hsl(335, 100%, 46%)"]):(t.fill="hsl(184, 8%, 75%)",t.stroke="hsl(180, 11%, 20%)",t.edgeColors=["hsl(  0,   0%, 50%)","hsl(  0, 100%, 40%)","hsl( 29, 100%, 40%)","hsl( 47, 100%, 40%)","hsl(138, 100%, 40%)","hsl(160,  73%, 50%)","hsl(181, 100%, 40%)","hsl(216, 100%, 40%)","hsl(260, 100%, 40%)","hsl(348, 100%, 50%)","hsl(328, 100%, 40%)"]),t}}},{}],21:[function(e,t,n){let o=function(e,t){return t*Math.cos(2*Math.PI*e)},r=function(e,t){return t*Math.sin(2*Math.PI*e)},i=function(e,t,n){return["M",o(e,n),r(e,n),"A",n,n,0,0,0,o(t,n),r(t,n)].join(" ")},a={n4:i(7/8,5/8,36),s4:i(3/8,1/8,36),e4:i(1/8,-1/8,36),w4:i(5/8,3/8,36),inport:i(-.25,.25,4),outport:i(.25,-.25,4),inportBig:i(-.25,.25,6),outportBig:i(.25,-.25,6)};t.exports=a},{}],22:[function(e,t,n){n.nodeStyles={default:{bg:"rgba(255,255,255,1)",color:"#555"},primary:{bg:"rgba(69,112,253,1)",color:"#fff"},info:{bg:"rgba(214,69,250,1)",color:"#fff"},success:{bg:"rgba(253,91,70,1)",color:"#fff"},warning:{bg:"rgba(254,70,144,1)",color:"#fff"},danger:{bg:"rgba(79,86,104,1)",color:"#fff"},orange:{bg:"rgba(243,152,0,1)",color:"#fff"},green:{bg:"rgba(0,153,68,1)",color:"#fff"},blue:{bg:"rgba(0,70,134,1)",color:"#fff"},cyan:{bg:"rgba(19,181,177,1)",color:"#fff"},golden:{bg:"rgba(237,0,27,1)",color:"#fff"},warmgreen:{bg:"rgba(179,212,101,1)",color:"#fff"}},n.iconSvgD={code:"M10,3.5H9.1c0,0-0.1,0-0.1,0.1l-3.1,9c0,0,0,0,0,0c0,0.1,0,0.1,0.1,0.1h0.9c0,0,0.1,0,0.1-0.1l0,0l3-8.7l0.1-0.3c0,0,0,0,0,0C10.1,3.5,10.1,3.5,10,3.5L10,3.5zM14,8C13.9,8,13.9,8,14,8l-3-2.3c0,0-0.1,0-0.2,0c0,0,0,0,0,0.1v1.1c0,0,0,0.1,0,0.1l1.5,1.2l-1.5,1.2c0,0,0,0.1,0,0.1v1.1c0,0.1,0,0.1,0.1,0.1c0,0,0,0,0.1,0l2.9-2.3C14,8.2,14,8.1,14,8L14,8zM5,5.6L2.1,7.9c0,0,0,0,0,0C2,8.1,2,8.2,2.1,8.3L5,10.6c0,0,0,0,0.1,0c0.1,0,0.1,0,0.1-0.1V9.4c0,0,0-0.1,0-0.1L3.6,8.1l1.5-1.2c0,0,0-0.1,0-0.1V5.7c0,0,0,0,0-0.1C5.1,5.6,5.1,5.6,5,5.6L5,5.6z",alert:"M8,0C3.6,0,0,3.6,0,8s3.6,8,8,8s8-3.6,8-8S12.4,0,8,0 M8,13.7c-0.6,0-1.1-0.5-1.1-1.1c0-0.6,0.5-1.1,1.1-1.1c0.6,0,1.1,0.5,1.1,1.1C9.1,13.2,8.6,13.7,8,13.7 M9.5,5.1C9.5,5.1,9.5,5.1,9.5,5.1c0,0.1-1,4.6-1,4.6s0.1-0.3,0,0C8.5,10,8.3,10.2,8,10.2S7.5,9.9,7.5,9.6c-0.1-0.3-1-4.4-1-4.4c0-0.1-0.1-0.2-0.1-0.3c0-0.4,0.2-0.8,0.4-1.1S7.6,3.4,8,3.4c0.4,0,0.8,0.2,1.1,0.4s0.5,0.7,0.4,1.1C9.5,4.9,9.5,5,9.5,5.1",cube:"M16.2,27.1l11.5-6.3V9.3l-11.5,4.2V27.1z M15,11.5l12.6-4.6L15,2.3L2.4,6.9L15,11.5z M30,6.9v13.8c0,0.4-0.1,0.8-0.3,1.2 c-0.2,0.3-0.5,0.6-0.9,0.9l-12.7,6.9C15.8,29.9,15.4,30,15,30s-0.7-0.1-1.1-0.3L1.2,22.8c-0.4-0.2-0.7-0.5-0.9-0.9 C0.1,21.6,0,21.2,0,20.8V6.9C0,6.5,0.2,6,0.4,5.6C0.7,5.2,1.1,5,1.5,4.8l12.7-4.6C14.5,0.1,14.8,0,15,0s0.5,0,0.8,0.1l12.7,4.6 c0.4,0.1,0.8,0.4,1.1,0.9C29.9,6,30,6.5,30,6.9z",microchip:"M24.4,2.8v24.4c0,1.6-1.3,2.8-2.8,2.8H8.4c-1.6,0-2.8-1.3-2.8-2.8V2.8C5.6,1.3,6.9,0,8.4,0h13.1C23.1,0,24.4,1.3,24.4,2.8z\t M30,6.2v0.7c0,0.2-0.2,0.4-0.4,0.4h-1.1v0.4c0,0.2-0.2,0.4-0.4,0.4h-2.5V5.2h2.5c0.2,0,0.4,0.2,0.4,0.4v0.4h1.1\tC29.8,5.9,30,6,30,6.2z M30,11.8v0.7c0,0.2-0.2,0.4-0.4,0.4h-1.1v0.4c0,0.2-0.2,0.4-0.4,0.4h-2.5v-2.8h2.5c0.2,0,0.4,0.2,0.4,0.4\tv0.4h1.1C29.8,11.5,30,11.6,30,11.8z M30,17.5v0.7c0,0.2-0.2,0.4-0.4,0.4h-1.1v0.4c0,0.2-0.2,0.4-0.4,0.4h-2.5v-2.8h2.5\tc0.2,0,0.4,0.2,0.4,0.4v0.4h1.1C29.8,17.1,30,17.3,30,17.5z M30,23.1v0.7c0,0.2-0.2,0.4-0.4,0.4h-1.1v0.4c0,0.2-0.2,0.4-0.4,0.4\th-2.5V22h2.5c0.2,0,0.4,0.2,0.4,0.4v0.4h1.1C29.8,22.7,30,22.9,30,23.1z M1.8,22h2.5v2.8H1.8c-0.2,0-0.4-0.2-0.4-0.4v-0.4H0.4\tC0.2,24.1,0,24,0,23.8v-0.7c0-0.2,0.2-0.4,0.4-0.4h1.1v-0.4C1.4,22.2,1.6,22,1.8,22z M1.8,16.4h2.5v2.8H1.8c-0.2,0-0.4-0.2-0.4-0.4\tv-0.4H0.4c-0.2,0-0.4-0.2-0.4-0.4v-0.7c0-0.2,0.2-0.4,0.4-0.4h1.1v-0.4C1.4,16.6,1.6,16.4,1.8,16.4z M1.8,10.8h2.5v2.8H1.8\tc-0.2,0-0.4-0.2-0.4-0.4v-0.4H0.4c-0.2,0-0.4-0.2-0.4-0.4v-0.7c0-0.2,0.2-0.4,0.4-0.4h1.1v-0.4C1.4,10.9,1.6,10.8,1.8,10.8z\t M1.8,5.2h2.5V8H1.8C1.6,8,1.4,7.8,1.4,7.6V7.3H0.4C0.2,7.3,0,7.1,0,6.9V6.2C0,6,0.2,5.9,0.4,5.9h1.1V5.5C1.4,5.3,1.6,5.2,1.8,5.2z",flask:"M28.6,25.8c0.7,1.2,0.9,2.2,0.4,3c-0.4,0.8-1.4,1.2-2.7,1.2H3.8c-1.4,0-2.3-0.4-2.7-1.2c-0.4-0.8-0.3-1.8,0.4-3l9.8-15.5 V2.5H10c-0.3,0-0.6-0.1-0.9-0.4C8.9,1.9,8.8,1.6,8.8,1.2s0.1-0.6,0.4-0.9C9.4,0.1,9.7,0,10,0h10c0.3,0,0.6,0.1,0.9,0.4 c0.2,0.2,0.4,0.5,0.4,0.9s-0.1,0.6-0.4,0.9c-0.2,0.2-0.5,0.4-0.9,0.4h-1.3v7.8L28.6,25.8z M13.4,11.6L8,20H22l-5.3-8.4L16.3,11V2.5 h-2.5V11L13.4,11.6z",globe:"M20.3,9.2C19.5,3.8,17.4,0,15,0s-4.5,3.8-5.4,9.2H20.3z M9.2,15c0,1.3,0.1,2.6,0.2,3.9h11.2c0.1-1.2,0.2-2.5,0.2-3.9\ts-0.1-2.6-0.2-3.9H9.4C9.2,12.4,9.2,13.7,9.2,15z M28.8,9.2c-1.7-4.1-5.2-7.3-9.6-8.6c1.5,2,2.5,5.1,3,8.6H28.8z M10.7,0.6\tC6.4,1.9,2.9,5.1,1.1,9.2h6.5C8.2,5.8,9.2,2.7,10.7,0.6z M29.5,11.1h-6.9c0.1,1.3,0.2,2.6,0.2,3.9s-0.1,2.6-0.2,3.9h6.9\tc0.3-1.2,0.5-2.5,0.5-3.9S29.8,12.4,29.5,11.1L29.5,11.1z M7.2,15c0-1.3,0.1-2.6,0.2-3.9H0.5C0.2,12.4,0,13.7,0,15s0.2,2.6,0.5,3.9\th6.9C7.3,17.6,7.2,16.3,7.2,15z M9.6,20.8c0.9,5.4,2.9,9.2,5.4,9.2s4.5-3.8,5.4-9.2H9.6z M19.3,29.4c4.3-1.3,7.8-4.5,9.6-8.6h-6.5\tC21.8,24.2,20.7,27.3,19.3,29.4z M1.1,20.8c1.7,4.1,5.2,7.3,9.6,8.6c-1.5-2-2.5-5.1-3-8.6C7.7,20.8,1.1,20.8,1.1,20.8z","chart-area":"M29.3,22.5c0.4,0,0.7,0.3,0.7,0.7v2.3c0,0.4-0.3,0.7-0.7,0.7H0.7c-0.4,0-0.7-0.3-0.7-0.7V4.5c0-0.4,0.3-0.7,0.7-0.7H3 c0.4,0,0.7,0.3,0.7,0.7v18H29.3z M21.8,9.3l-5,3.3l-5-6.7c-0.3-0.4-0.9-0.4-1.2,0.1l-5.1,8.5v6.1h22.5l-5.3-11 C22.7,9.2,22.2,9.1,21.8,9.3z",strikethrough:"M30,14.5v2.7h-6c1.4,2.9,1.3,10.9-8.5,10.9C4.2,28.2,4.6,19.3,4.6,19.3l5.4,0.1c0,4.6,4.3,4.6,5.2,4.5 c0.9-0.1,4.1-0.1,4.4-3.2c0.1-1.5-1.4-2.6-3-3.4H0v-2.7H30 M25.1,8.9l-5.4,0c0,0,0.2-3.8-4.5-3.8c-4.7,0-4.3,3-4.3,3.4 c0.1,0.4,0.5,2.3,4.1,3.2H6.4c0,0-4.8-9.2,6.9-10.7C25.2-0.7,25.1,8.9,25.1,8.9z","shekel-sign":"M16.6,9.1v11.3c0,0.6,0.5,1.1,1.1,1.1h3.2c0.6,0,1.1-0.5,1.1-1.1V9.1c0-5-4.1-9.1-9.1-9.1H1.6C0.7,0,0,0.7,0,1.6v27.3 C0,29.5,0.5,30,1.1,30h3.2c0.6,0,1.1-0.5,1.1-1.1V5.4h7.5C14.9,5.4,16.6,7,16.6,9.1z M28.9,0h-3.2c-0.6,0-1.1,0.5-1.1,1.1v19.8 c0,2.1-1.7,3.8-3.8,3.8h-7.5v-15c0-0.6-0.5-1.1-1.1-1.1H9.1C8.5,8.6,8,9.1,8,9.6v18.8C8,29.3,8.8,30,9.6,30h11.2 c5,0,9.1-4.1,9.1-9.1V1.1C30,0.5,29.5,0,28.9,0z",random:"M29.6,21c0.5,0.5,0.5,1.4,0,2l-4.7,4.7c-0.9,0.9-2.4,0.3-2.4-1v-2.3h-3.4c-0.2,0-0.4-0.1-0.5-0.2l-4.1-4.4l3.1-3.3l3.1,3.3\th1.9v-2.3c0-1.3,1.5-1.9,2.4-1L29.6,21z M0.7,10.3h4.9l3.1,3.3l3.1-3.3L7.7,5.8C7.6,5.7,7.4,5.6,7.2,5.6H0.7C0.3,5.6,0,5.9,0,6.3\tv3.3C0,10,0.3,10.3,0.7,10.3z M22.5,10.3v2.3c0,1.3,1.5,1.9,2.4,1L29.6,9c0.5-0.5,0.5-1.4,0-2l-4.7-4.7c-0.9-0.9-2.4-0.3-2.4,1v2.3\th-3.4c-0.2,0-0.4,0.1-0.5,0.2L5.6,19.7H0.7C0.3,19.7,0,20,0,20.4v3.3c0,0.4,0.3,0.7,0.7,0.7h6.5c0.2,0,0.4-0.1,0.5-0.2l12.9-13.8\tH22.5z",signature:"M29.1,18.8h-5.4c-0.5,0-1.2-0.7-1.5-1.7c-0.9-2.5-2.8-4.1-5-4.1c-1.8,0-3.4,1.1-4.5,2.9l-1.3-9.6c-0.3-1.5-1.5-2.5-2.8-2.5 c-1.4,0-2.5,1-2.8,2.5L3.3,16.7C3,18,2.2,18.8,1.7,18.8H0.9c-0.5,0-0.9,0.4-0.9,0.9v1.9c0,0.5,0.4,0.9,0.9,0.9h0.7 c2.5,0,4.6-2,5.3-5l1.4-6l1.7,13c0.1,0.9,0.8,1.6,1.7,1.7c0.1,0,0.1,0,0.2,0c0.8,0,1.6-0.5,1.8-1.3l1.9-6.6c0.3-1,0.9-1.6,1.5-1.6 c0.6,0,1.1,0.6,1.5,1.7c0.9,2.5,2.8,4.1,5,4.1h5.4c0.5,0,0.9-0.4,0.9-0.9v-1.9C30,19.2,29.6,18.8,29.1,18.8L29.1,18.8z",adjust:"M15,25.6V4.4c-1.9,0-3.7,0.5-5.3,1.4S6.8,8,5.8,9.7S4.4,13.1,4.4,15c0,1.9,0.5,3.7,1.4,5.3s2.2,2.9,3.9,3.9 S13.1,25.6,15,25.6L15,25.6z M30,15c0,2.7-0.7,5.2-2,7.5s-3.2,4.1-5.5,5.5s-4.8,2-7.5,2s-5.2-0.7-7.5-2S3.4,24.8,2,22.5S0,17.7,0,15 c0-2.7,0.7-5.2,2-7.5S5.2,3.4,7.5,2s4.8-2,7.5-2s5.2,0.7,7.5,2s4.1,3.2,5.5,5.5S30,12.3,30,15z",atlas:"M20.5,12.2h-2.3c-0.1,1.6-0.4,3-0.8,4.1C19,15.5,20.2,14,20.5,12.2z M20.5,10.3C20.2,8.5,19,7,17.4,6.2\tc0.5,1.1,0.7,2.5,0.8,4.1H20.5z M15,5.7c-0.5,0.4-1.2,2-1.4,4.6h2.7C16.2,7.7,15.5,6.1,15,5.7z M12.6,6.2C11,7,9.8,8.5,9.5,10.3h2.3\tC11.8,8.7,12.1,7.3,12.6,6.2z M12.6,16.3c-0.4-1.1-0.7-2.5-0.8-4.1H9.5C9.8,14,11,15.5,12.6,16.3z M16.4,12.2h-2.7\tc0.2,2.6,0.9,4.2,1.4,4.6C15.5,16.4,16.2,14.8,16.4,12.2z M28.1,21V1.5c0-0.9-0.6-1.5-1.5-1.5H7.5C4.3,0,1.9,2.4,1.9,5.6v18.8\tc0,3.2,2.4,5.6,5.6,5.6h19.1c0.7,0,1.5-0.6,1.5-1.5v-0.9c0-0.4-0.2-0.8-0.6-1.1c-0.2-0.9-0.2-3.6,0-4.3C27.9,21.9,28.1,21.6,28.1,21\tL28.1,21z M15,3.8c4.1,0,7.5,3.4,7.5,7.5s-3.4,7.5-7.5,7.5s-7.5-3.4-7.5-7.5S10.9,3.8,15,3.8z M24.4,26.3H7.5\tc-1.1,0-1.9-0.8-1.9-1.9s0.9-1.9,1.9-1.9h16.9V26.3z",blanket:"M24.6,0H5.4C2.8,0,0.6,2.1,0.6,4.8V30h5.1v-5.1h1.8V30h3v-5.1h1.8V30h3v-5.1h1.8V30h5.1V4.8c-0.1-1.3,0.9-2.5,2.2-2.6 c1.3-0.1,2.5,0.9,2.6,2.2c0,0.1,0,0.2,0,0.3V21c0,0.3-0.3,0.6-0.6,0.6c-0.3,0-0.6-0.3-0.6-0.6v-7.8h-2.4V21c0.1,1.7,1.5,2.9,3.2,2.8 c1.5-0.1,2.7-1.3,2.8-2.8V4.8C29.4,2.1,27.2,0,24.6,0L24.6,0z",bong:"M19.6,30c1.4,0,2.6-0.7,3.3-1.9c0.9-1.6,1.5-3.6,1.5-5.6c0-2.1-0.6-4.1-1.6-5.8l2.5-2.5l0.5,0.5c0.4,0.4,1,0.4,1.3,0\tl0.7-0.7c0.4-0.4,0.4-1,0-1.3l-3.1-3.1c-0.4-0.4-1-0.4-1.3,0l-0.7,0.7c-0.4,0.4-0.4,1,0,1.3l0.5,0.5L21,14.5\tc-0.7-0.7-1.4-1.2-2.3-1.7v-9l0.9,0c0.5,0,0.9-0.4,0.9-0.9l0-1.9c0-0.5-0.4-0.9-0.9-0.9L6.6,0C6,0,5.6,0.4,5.6,1l0,1.9\tc0,0.5,0.4,0.9,0.9,0.9l0.9,0v9c-3.4,1.9-5.6,5.6-5.6,9.7c0,2,0.5,3.9,1.5,5.6C4,29.3,5.3,30,6.6,30H19.6z M8.9,15.2l1.4-0.8V3.7\tl5.6,0v10.6l1.4,0.8c1.5,0.8,2.6,2.1,3.3,3.5H5.6C6.3,17.3,7.5,16,8.9,15.2z",burn:"M15,0C8.4,5.9,3.8,12.9,3.8,17.6C3.8,24.9,8.4,30,15,30s11.3-5.1,11.3-12.4C26.3,12.9,21.6,5.9,15,0z M15,26.3 c-3.3,0-5.6-2.3-5.6-5.6c0-0.8,0.3-3.6,5.6-9.4c5.4,5.8,5.6,8.7,5.6,9.4C20.6,24,18.3,26.3,15,26.3z","chart-line":"M29.1,22.5H3.8V4.7c0-0.5-0.4-0.9-0.9-0.9H0.9C0.4,3.8,0,4.2,0,4.7v19.7c0,1,0.8,1.9,1.9,1.9h27.2c0.5,0,0.9-0.4,0.9-0.9 v-1.9C30,22.9,29.6,22.5,29.1,22.5z M27.2,5.6h-6.9c-1.3,0-1.9,1.5-1,2.4l1.9,1.9l-4.3,4.3l-4.3-4.3c-0.7-0.7-1.9-0.7-2.7,0l-4,4 c-0.4,0.4-0.4,1,0,1.3l1.3,1.3c0.4,0.4,1,0.4,1.3,0l2.7-2.7l4.3,4.3c0.7,0.7,1.9,0.7,2.7,0l5.6-5.6l1.9,1.9c0.9,0.9,2.4,0.3,2.4-1 V6.6C28.1,6,27.7,5.6,27.2,5.6z",clone:"M27.2,0C28.7,0,30,1.3,30,2.8v16.9c0,1.6-1.3,2.8-2.8,2.8H10.3c-1.6,0-2.8-1.3-2.8-2.8V2.8C7.5,1.3,8.8,0,10.3,0H27.2 M10.3,24.4c-2.6,0-4.7-2.1-4.7-4.7V7.5H2.8C1.3,7.5,0,8.8,0,10.3v16.9C0,28.7,1.3,30,2.8,30h16.9c1.6,0,2.8-1.3,2.8-2.8v-2.8H10.3z","cloud-upload-alt":"M20,15.5c0-0.1,0-0.3-0.1-0.4l-5.5-5.5c-0.1-0.1-0.2-0.1-0.4-0.1s-0.3,0-0.4,0.1l-5.5,5.5C8.1,15.3,8,15.4,8,15.5\tc0,0.1,0,0.3,0.1,0.4S8.4,16,8.5,16H12v5.5c0,0.1,0,0.3,0.1,0.4c0.1,0.1,0.2,0.1,0.4,0.1h3c0.1,0,0.3,0,0.4-0.1\tc0.1-0.1,0.1-0.2,0.1-0.4V16h3.5c0.1,0,0.3,0,0.4-0.1C20,15.8,20,15.6,20,15.5L20,15.5z M30,20c0,1.7-0.6,3.1-1.8,4.2\tC27.1,25.4,25.7,26,24,26H7c-1.9,0-3.6-0.7-4.9-2.1S0,20.9,0,19c0-1.4,0.4-2.6,1.1-3.8s1.7-2,2.9-2.6c0-0.3,0-0.5,0-0.7\tc0-2.2,0.8-4.1,2.3-5.7S9.8,4,12,4c1.6,0,3.1,0.5,4.5,1.4c1.3,0.9,2.3,2.1,2.9,3.6C20.1,8.3,21,8,22,8c1.1,0,2,0.4,2.8,1.2\tC25.6,10,26,10.9,26,12c0,0.8-0.2,1.5-0.6,2.2c1.4,0.3,2.5,1,3.3,2.1C29.6,17.4,30,18.6,30,20L30,20z","code-branch":"M25.7,8.6c0-2.4-1.9-4.3-4.3-4.3s-4.3,1.9-4.3,4.3c0,1.5,0.9,2.8,1.9,3.6c-0.6,1.9-2.1,3.6-4.5,4.1c-1.5,0-2.8,0.6-3.9,1.3\tV7.9c1.3-0.6,2.1-2.1,2.1-3.6c0-2.4-1.9-4.3-4.3-4.3S4.3,1.9,4.3,4.3c0,1.5,0.9,3,2.1,3.6v14.1c-1.3,0.6-2.1,2.1-2.1,3.6\tc0,2.4,1.9,4.3,4.3,4.3s4.3-1.9,4.3-4.3c0-1.1-0.4-2.1-1.3-3c0.9-1.3,2.1-2.1,3.9-2.4c4.1-0.7,7.3-3.8,7.9-7.9\tC24.9,11.6,25.7,10.3,25.7,8.6L25.7,8.6z M8.6,2.1c1.3,0,2.1,0.9,2.1,2.1S9.9,6.4,8.6,6.4S6.4,5.6,6.4,4.3S7.3,2.1,8.6,2.1z\t M8.6,27.9c-1.3,0-2.1-0.9-2.1-2.1c0-1.3,0.9-2.1,2.1-2.1s2.1,0.9,2.1,2.1C10.7,27,9.9,27.9,8.6,27.9z M21.4,10.7\tc-1.3,0-2.1-0.9-2.1-2.1s0.9-2.1,2.1-2.1c1.3,0,2.1,0.9,2.1,2.1S22.7,10.7,21.4,10.7z","code-commit":"M23.3,12.9C22.4,9.2,19,6.6,15,6.6s-7.3,2.7-8.3,6.3H0v4.2h6.7c1,3.7,4.3,6.4,8.3,6.4s7.4-2.7,8.3-6.4H30v-4.2H23.3 M15,19.2c-2.3,0-4.3-1.9-4.3-4.2c0-2.4,1.9-4.2,4.3-4.2s4.3,1.8,4.3,4.2C19.3,17.3,17.3,19.2,15,19.2",cog:"M26.9,17.2l2.7,1.6c0.3,0.2,0.5,0.5,0.3,0.9c-0.7,2.3-1.9,4.3-3.5,6c-0.2,0.3-0.6,0.3-0.9,0.1l-2.7-1.6\tc-1.1,1-2.4,1.7-3.8,2.2v3.1c0,0.4-0.2,0.7-0.6,0.7c-2.2,0.5-4.6,0.5-6.9,0c-0.3-0.1-0.6-0.4-0.6-0.7v-3.1c-1.4-0.5-2.7-1.2-3.8-2.2\tl-2.7,1.6c-0.3,0.2-0.7,0.1-0.9-0.1c-1.6-1.7-2.8-3.7-3.5-6c-0.1-0.3,0-0.7,0.3-0.9l2.7-1.6c-0.3-1.5-0.3-3,0-4.4l-2.7-1.6\tc-0.3-0.2-0.5-0.5-0.3-0.9c0.7-2.3,1.9-4.3,3.5-6C3.7,4.1,4.1,4,4.4,4.2l2.7,1.6c1.1-1,2.4-1.7,3.8-2.2V0.5c0-0.4,0.2-0.7,0.6-0.7\tc2.2-0.5,4.6-0.5,6.9,0C18.8-0.2,19,0.1,19,0.5v3.1c1.4,0.5,2.7,1.2,3.8,2.2l2.7-1.6c0.3-0.2,0.7-0.1,0.9,0.1c1.6,1.7,2.8,3.7,3.5,6\tc0.1,0.3,0,0.7-0.3,0.9l-2.7,1.6C27.2,14.2,27.2,15.8,26.9,17.2L26.9,17.2z M20.1,15c0-2.8-2.3-5.1-5.1-5.1S9.9,12.2,9.9,15\ts2.3,5.1,5.1,5.1S20.1,17.8,20.1,15z",coins:"M0,23.7v2.5C0,28.3,5,30,11.3,30s11.3-1.7,11.3-3.8v-2.5c-2.4,1.7-6.8,2.5-11.3,2.5S2.4,25.5,0,23.7z M18.8,7.5\tC25,7.5,30,5.8,30,3.8S25,0,18.8,0S7.5,1.7,7.5,3.8S12.5,7.5,18.8,7.5z M0,17.6v3c0,2.1,5,3.8,11.3,3.8s11.3-1.7,11.3-3.8v-3\tc-2.4,2-6.8,3-11.3,3S2.4,19.6,0,17.6z M24.4,18.2c3.4-0.7,5.6-1.9,5.6-3.2v-2.5c-1.4,1-3.4,1.6-5.6,2V18.2z M11.3,9.4\tC5,9.4,0,11.5,0,14.1s5,4.7,11.3,4.7s11.3-2.1,11.3-4.7S17.5,9.4,11.3,9.4z M24.1,12.7C27.6,12,30,10.8,30,9.4V6.9\tc-2.1,1.5-5.7,2.3-9.4,2.4C22.3,10.2,23.6,11.3,24.1,12.7z",compass:"M13.6,13.6c-0.8,0.8-0.8,2,0,2.7c0.8,0.8,2,0.8,2.7,0c0.8-0.8,0.8-2,0-2.7C15.6,12.9,14.4,12.9,13.6,13.6z M15,0 C6.7,0,0,6.7,0,15s6.7,15,15,15s15-6.7,15-15S23.3,0,15,0z M22.6,9l-4,8.7c-0.2,0.4-0.5,0.8-1,1l-8.7,4c-1,0.5-2-0.6-1.6-1.6l4-8.7 c0.2-0.4,0.5-0.8,1-1l8.7-4C22.1,6.9,23.1,7.9,22.6,9L22.6,9z","conveyor-belt-alt":"M26.6,19.6H3.4C1.5,19.6,0,21.1,0,23s1.5,3.4,3.4,3.4h23.3c1.9,0,3.4-1.5,3.4-3.4S28.5,19.6,26.6,19.6z M4.4,24.2\t\tc-0.7,0-1.3-0.6-1.3-1.3s0.6-1.3,1.3-1.3s1.3,0.6,1.3,1.3S5.1,24.2,4.4,24.2z M15,24.2c-0.7,0-1.3-0.6-1.3-1.3s0.6-1.3,1.3-1.3\t\ts1.3,0.6,1.3,1.3S15.7,24.2,15,24.2z M25.6,24.2c-0.7,0-1.3-0.6-1.3-1.3s0.6-1.3,1.3-1.3s1.3,0.6,1.3,1.3S26.3,24.2,25.6,24.2z M13.7,5.2H4.2c-0.5,0-1,0.4-1,1v9.5c0,0.6,0.5,1,1,1h9.5c0.6,0,1-0.5,1-1V6.2C14.7,5.6,14.2,5.2,13.7,5.2z M24.9,7.9h-6.8c-0.5,0-1,0.5-1,1v6.8c0,0.6,0.5,1,1,1h6.8c0.5,0,1-0.5,1-1V8.9C25.9,8.3,25.4,7.9,24.9,7.9z",database:"M28.1,4.3V7c0,2.4-5.9,4.3-13.1,4.3S1.9,9.3,1.9,7V4.3C1.9,1.9,7.8,0,15,0S28.1,1.9,28.1,4.3z M28.1,10.3v6 c0,2.4-5.9,4.3-13.1,4.3S1.9,18.7,1.9,16.3v-6c2.8,1.9,8,2.8,13.1,2.8S25.3,12.3,28.1,10.3z M28.1,19.7v6c0,2.4-5.9, 4.3-13.1,4.3 S1.9,28.1,1.9,25.7v-6c2.8,1.9,8,2.8,13.1,2.8S25.3,21.6,28.1,19.7z",exchange:"M18.5,27.8c-1.3,0-2.3-1-2.3-2.3c0-0.6,0.3-1.3,0.8-1.7l3.1-2.8H2.3c-1.3,0-2.3-1.1-2.2-2.4c0-1.2,1-2.2,2.2-2.2h23.8 c1.3,0,2.3,1,2.3,2.3c0,0.7-0.3,1.3-0.8,1.7l-7.5,6.8C19.7,27.5,19.1,27.8,18.5,27.8L18.5,27.8z M27.8,13.6H4.1 c-1.3,0-2.3-1-2.3-2.3c0-0.7,0.3-1.3,0.8-1.7l7.5-6.8C11,1.9,12.5,2,13.3,2.9c0.9,0.9,0.8,2.4-0.2,3.3l0,0L10.1,9h17.8 c1.3,0,2.3,1.1,2.3,2.4C30.1,12.6,29.1,13.6,27.8,13.6L27.8,13.6z",fire:"M16.4,1.4c0-1.4-1.8-1.9-2.6-0.8c-7.3,10.6,3.1,11.1,3.1,16.2c0,2.1-1.7,3.8-3.8,3.7c-2.1,0-3.7-1.7-3.7-3.8v-5 c0-1.3-1.6-1.9-2.4-1c-1.6,1.6-3.2,4.5-3.2,7.9C3.7,25,8.8,30,15,30s11.2-5,11.2-11.2C26.2,8.8,16.4,7.4,16.4,1.4L16.4,1.4z",fingerprint:"M15,14.4c-0.8,0-1.4,0.6-1.4,1.4c0.1,4.2-0.5,8.3-1.6,12.4c-0.2,0.6,0.1,1.8,1.4,1.8c0.6,0,1.2-0.4,1.4-1\tc0.8-2.8,1.8-7.3,1.7-13.2C16.4,15,15.8,14.4,15,14.4z M15,9.6c-3.6,0-6.1,2.8-6,5.9c0,2.8-0.2,5.6-0.8,8.4\tc-0.2,0.8,0.3,1.5,1.1,1.7c0.8,0.2,1.5-0.3,1.7-1.1c0.6-2.9,0.9-6,0.8-9c0-1.5,1.2-3.1,3.2-3.1c1.8,0,3.3,1.5,3.4,3.3\tc0,2.8-0.2,5.6-0.6,8.4c-0.1,0.8,0.4,1.5,1.2,1.6c1.2,0.2,1.6-0.9,1.6-1.2c0.5-2.9,0.7-5.9,0.7-8.9C21.1,12.4,18.3,9.7,15,9.6\tL15,9.6z M8.5,8.5C7.9,8,7,8.1,6.5,8.7c-1.5,1.8-2.3,4.2-2.3,6.6c0,2.2-0.1,4.4-0.5,6.6c-0.1,0.8,0.4,1.5,1.1,1.6\tc1.2,0.2,1.6-0.9,1.6-1.1C6.9,20,7.1,17.6,7,15.2c0-1.8,0.5-3.4,1.6-4.7C9.2,9.8,9.1,9,8.5,8.5z M14.9,4.8c-0.9,0-1.8,0.1-2.7,0.3\tc-0.8,0.2-1.2,0.9-1,1.7c0.2,0.8,0.9,1.2,1.7,1c0.6-0.2,1.3-0.2,2-0.2c4.4,0.1,8.1,3.6,8.1,7.9c0,2.2-0.1,4.5-0.3,6.7\tc-0.1,0.8,0.5,1.5,1.2,1.6c1,0.1,1.5-0.7,1.6-1.2c0.3-2.3,0.4-4.7,0.3-7C25.7,9.7,20.8,4.9,14.9,4.8L14.9,4.8z M29.7,11.9\tc-0.2-0.8-0.9-1.2-1.7-1.1c-0.8,0.2-1.2,0.9-1.1,1.7c0.3,1.3,0.3,2.2,0.3,3.6c0,0.8,0.6,1.4,1.4,1.4h0c0.8,0,1.4-0.6,1.4-1.4\tC30,14.9,30,13.6,29.7,11.9L29.7,11.9z M27.3,6.6C24.5,2.5,19.8,0.1,14.8,0C10.7,0,6.9,1.5,4.1,4.3C1.4,7-0.1,10.6,0,14.5l0,1.3\tc0,0.8,0.6,1.4,1.4,1.4c0,0,0,0,0,0c0.8,0,1.4-0.6,1.4-1.4l0-1.4c0-3.1,1.1-6,3.3-8.1c2.3-2.3,5.4-3.5,8.7-3.4\tc4.1,0.1,7.9,2.1,10.2,5.4c0.4,0.6,1.3,0.8,2,0.3C27.6,8.1,27.8,7.2,27.3,6.6L27.3,6.6z",gem:"M25.3,1.7L30,10h-5.3l-3.6-8.3H25.3z M18.6,1.7l3.6,8.3H7.8l3.6-8.3H18.6z M4.7,1.7h4.2L5.3,10H0L4.7,1.7z M0,11.7h5.2 l6.4,13.1c0.1,0.2-0.1,0.3-0.3,0.2L0,11.7z M7.7,11.7h14.6l-7.1,16.6c-0.1,0.1-0.2,0.1-0.3,0L7.7,11.7z M18.3,24.8l6.4-13.1H30 L18.6,24.9C18.5,25.1,18.3,24.9,18.3,24.8L18.3,24.8z",link:"M19.1,10.9c3.5,3.5,3.5,9.1,0,12.6c0,0,0,0,0,0l-3.9,3.9c-3.5,3.5-9.1,3.5-12.6,0c-3.5-3.5-3.5-9.1,0-12.6l2.2-2.2\tc0.6-0.6,1.6-0.2,1.6,0.6c0,1,0.2,2.1,0.6,3.1c0.1,0.3,0,0.7-0.2,1L6,18.1c-1.6,1.6-1.7,4.3-0.1,6c1.6,1.7,4.3,1.7,6,0l3.9-3.9\tc1.7-1.7,1.6-4.3,0-6c-0.2-0.2-0.4-0.4-0.6-0.5c-0.2-0.2-0.4-0.4-0.4-0.7c0-0.6,0.2-1.3,0.7-1.7l1.2-1.2c0.3-0.3,0.8-0.4,1.2-0.1\tC18.4,10.2,18.8,10.5,19.1,10.9L19.1,10.9z M27.4,2.6c-3.5-3.5-9.1-3.5-12.6,0l-3.9,3.9c0,0,0,0,0,0c-3.4,3.5-3.5,9.1,0,12.6\tc0.4,0.4,0.8,0.7,1.2,1c0.4,0.3,0.9,0.2,1.2-0.1l1.2-1.2c0.5-0.5,0.7-1.1,0.7-1.7c0-0.3-0.2-0.6-0.4-0.7c-0.2-0.1-0.4-0.3-0.6-0.5\tc-1.6-1.6-1.7-4.3,0-6l3.9-3.9c1.7-1.7,4.4-1.6,6,0c1.6,1.7,1.6,4.3-0.1,6l-0.8,0.8c-0.3,0.3-0.3,0.6-0.2,1c0.3,1,0.5,2.1,0.6,3.1\tc0,0.8,1,1.2,1.6,0.6l2.2-2.2C30.9,11.7,30.9,6.1,27.4,2.6L27.4,2.6z",retweet:"M29.6,16.6l-1.2-1.2c-0.3-0.3-0.9-0.3-1.2,0L25.7,17c-0.4,0.4-1,0.1-1-0.4V6.9c0-1.3-1-2.3-2.3-2.3H14\tc-0.5,0-0.9,0.4-0.9,0.9v1.7c0,0.5,0.4,0.9,0.9,0.9h6.3c0.5,0,0.9,0.4,0.9,0.9v7.6c0,0.5-0.6,0.7-1,0.4l-1.5-1.5\tc-0.3-0.3-0.9-0.3-1.2,0l-1.2,1.3c-0.3,0.3-0.3,0.9,0,1.2l6.1,6.1c0.3,0.3,0.9,0.3,1.2,0l6.1-6.1C29.9,17.5,29.9,17,29.6,16.6z\t M15.7,21.9H9.4c-0.5,0-0.9-0.4-0.9-0.9v-7.6c0-0.5,0.6-0.7,1-0.4l1.5,1.5c0.3,0.3,0.9,0.3,1.2,0l1.2-1.2c0.3-0.3,0.3-0.9,0-1.2\tL7.5,6C7.2,5.7,6.6,5.7,6.3,6l-6.2,6.1c-0.3,0.3-0.3,0.9,0,1.2l1.2,1.2c0.3,0.3,0.9,0.3,1.2,0L4.1,13c0.3-0.3,1-0.1,1,0.4v9.7\tc0,1.3,1.1,2.3,2.4,2.3h8.4c0.5,0,0.9-0.4,0.9-0.9v-1.7C16.6,22.3,16.2,21.9,15.7,21.9L15.7,21.9z",server:"M28.1,9.4H1.9C0.8,9.4,0,8.5,0,7.5V3.8c0-1,0.8-1.9,1.9-1.9h26.3c1,0,1.9,0.8,1.9,1.9v3.8C30,8.5,29.2,9.4,28.1,9.4z\t M25.3,4.2c-0.8,0-1.4,0.6-1.4,1.4S24.5,7,25.3,7s1.4-0.6,1.4-1.4S26.1,4.2,25.3,4.2z M21.6,4.2c-0.8,0-1.4,0.6-1.4,1.4\tS20.8,7,21.6,7S23,6.4,23,5.6S22.3,4.2,21.6,4.2z M28.1,18.8H1.9c-1,0-1.9-0.8-1.9-1.9v-3.8c0-1,0.8-1.9,1.9-1.9h26.3\tc1,0,1.9,0.8,1.9,1.9v3.8C30,17.9,29.2,18.8,28.1,18.8z M25.3,13.6c-0.8,0-1.4,0.6-1.4,1.4s0.6,1.4,1.4,1.4s1.4-0.6,1.4-1.4\tS26.1,13.6,25.3,13.6z M21.6,13.6c-0.8,0-1.4,0.6-1.4,1.4s0.6,1.4,1.4,1.4S23,15.8,23,15S22.3,13.6,21.6,13.6z M28.1,28.1H1.9\tc-1,0-1.9-0.8-1.9-1.9v-3.8c0-1,0.8-1.9,1.9-1.9h26.3c1,0,1.9,0.8,1.9,1.9v3.8C30,27.3,29.2,28.1,28.1,28.1z M25.3,23\tc-0.8,0-1.4,0.6-1.4,1.4s0.6,1.4,1.4,1.4s1.4-0.6,1.4-1.4S26.1,23,25.3,23z M21.6,23c-0.8,0-1.4,0.6-1.4,1.4s0.6,1.4,1.4,1.4\ts1.4-0.6,1.4-1.4S22.3,23,21.6,23z","shield-check":"M15.3,30h-0.5c-0.2,0-0.4,0-0.5-0.1c-1-0.2-1.9-0.5-2.8-1c-1.7-0.9-3.3-2-4.6-3.4c-1.3-1.3-2.4-2.7-3.2-4.4\tc-0.7-1.3-1.1-2.8-1.1-4.3c0-4.1,0-8.2,0-12.3V4.4c0,0,0,0,0,0c0,0,0.1,0,0.1,0c1.1,0,2.3-0.1,3.4-0.3c1.1-0.2,2.1-0.5,3.2-0.9\tc1.4-0.5,2.7-1.2,4-2C13.9,0.9,14.5,0.5,15,0h0c0,0,0.1,0.1,0.1,0.1c1,0.8,2.1,1.4,3.2,2c1.5,0.7,2.9,1.4,4.5,1.8\tc0.8,0.2,1.7,0.4,2.5,0.4c0.6,0,1.2,0.1,1.8,0.1c0.1,0,0.3,0,0.4,0v0.2c0,4.1,0,8.2,0,12.3c0,0.3,0,0.6,0,0.9\tc-0.1,1.1-0.4,2.1-0.9,3c-0.6,1.4-1.5,2.6-2.5,3.8c-1.7,1.9-3.7,3.5-6,4.6c-0.7,0.3-1.4,0.6-2.1,0.7C15.7,29.9,15.5,30,15.3,30\tL15.3,30z M12.7,20.8c0.2,0.2,0.6,0.3,0.9,0L22.4,10c0.1-0.1,0.1-0.2,0-0.2l-0.8-0.7c-0.1-0.1-0.2-0.1-0.2,0l-8.1,8.3\tc-0.2,0.2-0.5,0.2-0.8,0.1l-3.8-2.7c-0.1-0.1-0.2,0-0.2,0l-0.8,0.9c-0.1,0.1,0,0.2,0,0.2L12.7,20.8L12.7,20.8z",vial:"M29.9,10.6L19.4,0.1c-0.2-0.2-0.5-0.2-0.7,0l-2.1,2.1c-0.2,0.2-0.2,0.5,0,0.7l0.7,0.7L2.1,18.8c-2.4,2.4-2.8,6.4-0.6,9 C2.8,29.2,4.6,30,6.4,30c1.7,0,3.3-0.6,4.6-1.9l15.4-15.4l0.7,0.7c0.2,0.2,0.5,0.2,0.7,0l2.1-2.1C30.1,11.1,30.1,10.8,29.9,10.6z M19.9,15h-9.8l9.3-9.2l4.9,4.9L19.9,15z",vials:"M3.4,6h1.1v11.3c0,2.1,1.7,3.8,3.8,3.8s3.8-1.7,3.8-3.8V6h1.1c0.2,0,0.4-0.2,0.4-0.4V3.4c0-0.2-0.2-0.4-0.4-0.4H3.4 C3.2,3,3,3.2,3,3.4v2.3C3,5.8,3.2,6,3.4,6z M6.8,6h3v4.5h-3V6z M29.3,24H0.8C0.3,24,0,24.3,0,24.8v1.5C0,26.7,0.3,27,0.8, 27h28.5 c0.4,0,0.8-0.3,0.8-0.8v-1.5C30,24.3,29.7,24,29.3,24z M16.9,6H18v11.3c0,2.1,1.7,3.8,3.8,3.8s3.8-1.7,3.8-3.8V6h1.1 C26.8,6,27,5.8,27,5.6V3.4C27,3.2,26.8,3,26.6,3h-9.8c-0.2,0-0.4,0.2-0.4,0.4v2.3C16.5,5.8,16.7,6,16.9,6z M20.3,6h3v4.5h-3V6z"}},{}],23:[function(e,t,n){n.createGroup=function(e,t){let n=[e];return Array.isArray(t)&&(n=n.concat(t)),React.DOM.g.apply(React.DOM.g,n)},n.createRect=function(e){return React.DOM.rect(e)},n.createRectImg=function(e){let t=React.DOM.image({x:e.x,y:e.y,width:e.width,height:e.height,xlinkHref:e.href}),n=React.DOM.pattern({patternUnits:"userSpaceOnUse",width:"100%",height:"100%",id:e.id},t);return React.DOM.defs(null,n)},n.createText=function(e){return React.DOM.text(e)},n.createCircle=function(e){return React.DOM.circle(e)},n.createPath=function(e){return React.DOM.path(e)},n.createPolygon=function(e){return React.DOM.polygon(e)},n.createImg=function(e){return TheGraph.SVGImage(e)},n.createCanvas=function(e){return React.DOM.canvas(e)},n.createSvg=function(e,t){let n=[e];return Array.isArray(t)&&(n=n.concat(t)),React.DOM.svg.apply(React.DOM.svg,n)},n.createAppDefs=function(){return React.DOM.defs({dangerouslySetInnerHTML:{__html:'<linearGradient id="grad1" x1="0%" y1="100%" x2="0%" y2="0%"><stop offset="0%" style="stop-color:rgb(240,240,240);stop-opacity:1" /><stop offset="100%" style="stop-color:rgb(255,255,255);stop-opacity:1" /></linearGradient><filter id="blur_o"><feOffset result="offOut" in="SourceGraphic" dy="1" /><feColorMatrix result="matrixOut" in="offOut" type="matrix" values="0.86 0 0 0 0 0 0.86 0 0 0 0 0 0.86 0 0 0 0 0 1 0" /><feGaussianBlur result="blurOut" in="matrixOut" stdDeviation="3" /><feBlend in="SourceGraphic" in2="blurOut" mode="normal" /></filter><filter id="blur_o_sm"><feOffset result="offOut" in="SourceGraphic" dy="1" /><feColorMatrix result="matrixOut" in="offOut" type="matrix" values="0.86 0 0 0 0 0 0.86 0 0 0 0 0 0.86 0 0 0 0 0 1 0" /><feGaussianBlur result="blurOut" in="matrixOut" stdDeviation="2" /><feBlend in="SourceGraphic" in2="blurOut" mode="normal" /></filter><filter id="blur_c_sm"><feOffset result="offOut" in="SourceGraphic" dy="1" /><feGaussianBlur result="blurOut" in="offOut" stdDeviation="2" /><feBlend in="SourceGraphic" in2="blurOut" mode="normal" /></filter><filter id="blur_c"><feOffset result="offOut" in="SourceGraphic" dy="1" /><feGaussianBlur result="blurOut" in="offOut" stdDeviation="3" /><feBlend in="SourceGraphic" in2="blurOut" mode="normal" /></filter>'}})}},{}],24:[function(e,t,n){t.exports.register=function(e){e.TheGraph.FONT_ICON={"500px":"",check:"",checked:"","check-circle":"",close:"","close-circle":"","warning-circle":"",cog:"",cube:""}}},{}],25:[function(e,t,n){t.exports=function(e,t,n){if(Array.isArray(e)||Array.isArray(t)||"object"!=typeof e||"object"!=typeof t)return t;n=n||!1;for(let o in e)"function"==typeof e[o]||t[o]&&!n||(t[o]=e[o]);return t}},{}],26:[function(e,t,n){let o={componentWillUnmount:function(){this._ismounted=!1},showTooltip:function(e){if(!this.shouldShowTooltip())return;const t=_.get(e,"target.id","");let n=new CustomEvent("the-graph-tooltip",{detail:{nodeId:t,tooltip:this.props.label,x:e.offsetX,y:e.offsetY,isIn:this.props.isIn},bubbles:!0});ReactDOM.findDOMNode(this).dispatchEvent(n),this.setState({tooltipId:t})},hideTooltip:function(e){const t=_.get(e,"target.id","");if(t===this.state.tooltipId||this.state.tooltip&&this.shouldShowTooltip()){this.setState({tooltipId:null});let e=new CustomEvent("the-graph-tooltip-hide",{detail:{nodeId:t},bubbles:!0});this._ismounted&&ReactDOM.findDOMNode(this).dispatchEvent(e)}},componentDidMount:function(){if(this._ismounted=!0,navigator&&-1!==navigator.userAgent.indexOf("Firefox"))return;let e=this.getTooltipTrigger();e.addEventListener("tap",this.showTooltip),e.addEventListener("mouseenter",this.showTooltip),e.addEventListener("mouseleave",this.hideTooltip)}};t.exports={Tooltip:o}},{}],27:[function(e,t,n){let o=window.unwrap?window.unwrap:function(e){return e},r={27:function(e){e.refs.graph&&e.refs.graph.cancelPreviewEdge()}},i=[70,83,27];t.exports.register=function(e){let t=e.TheGraph;t.config.app={container:{className:"the-graph-app",name:"app"},canvas:{ref:"canvas",className:"app-canvas"},svg:{className:"app-svg",ref:"svg"},svgGroup:{className:"view"},graph:{ref:"graph"},tooltip:{ref:"tooltip"},modal:{className:"context"}},t.factories.app={createAppContainer:function(e,t){let n=[e];Array.isArray(t)&&(n=n.concat(t));return React.DOM.div.apply(React.DOM.div,n)},createAppCanvas:t.factories.createCanvas,createAppSvg:t.factories.createSvg,createAppSvgGroup:t.factories.createGroup,createAppGraph:function(e){return t.Graph(e)},createAppTooltip:function(e){return t.Tooltip(e)},createAppModalGroup:t.factories.createGroup,createAppModalBackground:function(e){return t.ModalBG(e)},createAppDefs:t.factories.createAppDefs};let n=[];window.React.Animate&&n.push(React.Animate),t.App=React.createClass({displayName:"TheGraphApp",mixins:n,getDefaultProps:function(){return{width:null,height:null,readonly:!1,nodeIcons:{},minZoom:.15,maxZoom:15,offsetX:0,offsetY:0,menus:null,showScriptEditIcon:!1,getMenuDef:null,onPanScale:null,onNodeSelection:null,onNodeRectImgDblclick:null,onEdgeSelection:null,onClickEdgeCode:null,onGroupSelection:null,onExpandIconClicked:null}},getInitialState:function(){return{x:this.props.x,y:this.props.y,scale:1,width:this.props.width,height:this.props.height,minZoom:this.props.minZoom,maxZoom:this.props.maxZoom,trackStartX:null,trackStartY:null,tooltip:"",tooltipX:0,tooltipY:0,tooltipVisible:!1,contextElement:null,contextType:null,offsetY:this.props.offsetY,offsetX:this.props.offsetX}},zoomFactor:0,zoomX:0,zoomY:0,onWheel:function(e){e.preventDefault(),this.zoomFactor||(this.zoomFactor=0),this.zoomFactor+=e.deltaY?e.deltaY:0-e.wheelDeltaY,this.zoomX=e.clientX-this.domNodeRect.x,this.zoomY=e.clientY-this.domNodeRect.y,requestAnimationFrame(this.scheduleWheelZoom)},scheduleWheelZoom:function(){if(isNaN(this.zoomFactor))return;let e=this.zoomFactor/-500;e=Math.min(.5,Math.max(-.5,e));let t=this.state.scale+this.state.scale*e;if(this.zoomFactor=0,t<this.state.minZoom?t=this.state.minZoom:t>this.state.maxZoom&&(t=this.state.maxZoom),t===this.state.scale)return;let n=t/this.state.scale,o=this.state.x,r=this.state.y,i=this.zoomX,a=this.zoomY,s=n*(o-i)+i,l=n*(r-a)+a;this.setState({scale:t,x:s,y:l,tooltipVisible:!1})},lastScale:1,lastX:0,lastY:0,pinching:!1,onTrackStart:function(e){let t=document.getElementById("editor");t.addEventListener("mousemove",this.onTrack),t.addEventListener("mouseup",this.onTrackEnd),this.moved=!1,this.setState({trackStartX:e.pageX,trackStartY:e.pageY})},onTrack:function(e){this.movedX=e.pageX-this.state.trackStartX,this.movedY=e.pageY-this.state.trackStartY,(Math.abs(this.movedX)>=5||Math.abs(this.movedY)>=5)&&(this.moved=!0,this.setState({x:this.state.x+this.movedX,y:this.state.y+this.movedY,trackStartX:e.pageX,trackStartY:e.pageY}))},onTrackEnd:function(e){let t=document.getElementById("editor");t.removeEventListener("mousemove",this.onTrack),t.removeEventListener("mouseup",this.onTrackEnd),this.setState({trackStartX:null,trackStartY:null}),this.props.onMoved(this.state.x,this.state.y)},onPanScale:function(){this.props.onPanScale&&this.props.onPanScale(this.state.x,this.state.y,this.state.scale)},defaultGetMenuDef:function(e){if(e.type&&this.props.menus&&this.props.menus[e.type]){let t=this.props.menus[e.type];return t.callback?t.callback(t,e):t}return null},showContext:function(e){this.setState({contextMenu:e,tooltipVisible:!1})},hideContext:function(e){this.setState({contextMenu:null})},changeTooltip:function(e){_.set(window,"__graph__.currentNodeId",_.get(e,"detail.nodeId",[]));let t=e.detail.tooltip;this.setState({tooltip:t,tooltipVisible:!0,tooltipX:e.detail.x+12,tooltipY:e.detail.isIn?e.detail.y-12:e.detail.y+12})},hideTooltip:function(e){_.set(window,"__graph__.currentNodeId",_.get(e,"detail.nodeId",[])),this.setState({tooltip:"",tooltipVisible:!1})},triggerFit:function(e){let n=t.findFit(this.props.graph,this.props.width,this.props.height);this.setState({x:n.x,y:n.y,scale:n.scale})},focusNode:function(e){let n=t.config.focusAnimationDuration,o=t.findNodeFit(e,this.state.width,this.state.height),r={x:-(this.state.x-this.state.width/2)/this.state.scale,y:-(this.state.y-this.state.height/2)/this.state.scale},i={x:e.metadata.x,y:e.metadata.y},a=t.findAreaFit(r,i,this.state.width,this.state.height),s=Math.abs(a.scale-this.state.scale),l=Math.abs(o.scale-a.scale),c=s+l;this.animate?this.animate({x:a.x,y:a.y,scale:a.scale},n*(s/c),"in-quint",function(){this.animate({x:o.x,y:o.y,scale:o.scale},n*(l/c),"out-quint")}.bind(this)):this.setState({x:o.x,y:o.y,scale:o.scale})},edgeStart:function(e){this.refs.graph.edgeStart(e),this.hideContext()},updateDomOffset:function(){const e=ReactDOM.findDOMNode(this.refs.svg);this.domNodeRect=e.getBoundingClientRect()},componentDidMount:function(){let e=ReactDOM.findDOMNode(this.refs.svg);e.addEventListener("click",this.unselectAll),e.addEventListener("mousedown",this.onTrackStart),void 0!==e.onwheel?e.addEventListener("wheel",this.onWheel):void 0!==e.onmousewheel&&e.addEventListener("mousewheel",this.onWheel),e.addEventListener("the-graph-tooltip",this.changeTooltip),e.addEventListener("the-graph-tooltip-hide",this.hideTooltip),e.addEventListener("the-graph-edge-start",this.edgeStart);let t=o(ReactDOM.findDOMNode(this.refs.canvas));this.bgContext=o(t.getContext("2d")),this.componentDidUpdate(),setTimeout(function(){this.renderGraph()}.bind(this),500)},onShowContext:function(e){e.preventDefault(),e.stopPropagation(),e.preventTap&&e.preventTap();let t=e.x||e.clientX||0,n=e.y||e.clientY||0;e.touches&&e.touches.length&&(t=e.touches[0].clientX,n=e.touches[0].clientY),this.showContext({element:this,type:"main",x:t,y:n,graph:this.props.graph,itemKey:"graph",item:this.props.graph})},keyDown:function(e){(e.metaKey||e.ctrlKey)&&(t.metaKeyPressed=!0);let n=e.keyCode,o=r[n];if(o){let e=this.props.readonly;(!e||e&&i[n])&&o(this)}},keyUp:function(e){t.metaKeyPressed&&(t.metaKeyPressed=!1)},unselectAll:function(e){this.moved||(this.props.onNodeSelection&&this.props.onNodeSelection(e),this.props.onNodeRectImgDblclick&&this.props.onNodeRectImgDblclick(e),this.props.onEdgeSelection&&this.props.onEdgeSelection(),this.props.onGroupSelection&&this.props.onGroupSelection())},renderGraph:function(){this.refs.graph.markDirty({allNodeDirty:!0})},componentDidUpdate:function(e,t){t&&t.x===this.state.x&&t.y===this.state.y&&t.scale===this.state.scale||this.onPanScale(),t&&t.width===this.state.width&&t.height===this.state.height||this.updateDomOffset()},renderCanvas:function(e){e.clearRect(0,0,this.state.width,this.state.height);let n=this.state.scale,o=t.config.nodeSize*n,r=(this.state.x,this.state.y,Math.floor(this.state.width/o)+1),i=Math.floor(this.state.height/o)+1;Math.floor(this.state.x/o),this.state.x,Math.floor(this.state.y/o),this.state.y;for(;i--;){let t=r;for(;t--;){let n=Math.round(t*o),r=Math.round(i*o);e.strokeStyle="#f0f0f0",e.beginPath(),e.moveTo(n+o,r),e.lineTo(n,r),e.lineTo(n,r+o),e.stroke()}}},getContext:function(e,n,o){return t.Menu({menu:e,options:n,triggerHideContext:o,label:"Hello",graph:this.props.graph,node:this,ports:[],process:[],processKey:null,x:n.x,y:n.y,nodeWidth:this.props.width,nodeHeight:this.props.height,deltaX:0,deltaY:0,highlightPort:!1})},render:function(){let e=this.state.scale,n="matrix("+e+",0,0,"+e+","+this.state.x+","+this.state.y+")",o=e>t.zbpBig?"big":e>t.zbpNormal?"normal":"small",r=null,i=this.props.getMenuDef||this.defaultGetMenuDef;if(this.state.contextMenu){let e=this.state.contextMenu,t=i(e);t&&Object.keys(t).length&&(r=e.element.getContext(t,e,this.hideContext))}let a=null;if(r){let e={width:this.state.width,height:this.state.height,triggerHideContext:this.hideContext,children:r};a=[t.factories.app.createAppModalBackground(e)],this.menuShown=!0}else this.menuShown=!1;let s={graph:this.props.graph,scale:this.state.scale,app:this,library:this.props.library,nodeIcons:this.props.nodeIcons,onNodeSelection:this.props.onNodeSelection,onNodeRectImgDblclick:this.props.onNodeRectImgDblclick,onEdgeSelection:this.props.onEdgeSelection,onClickEdgeCode:this.props.onClickEdgeCode,onGroupSelection:this.props.onGroupSelection,onExpandIconClicked:this.props.onExpandIconClicked,showContext:this.showContext,allowEdgeStart:!this.props.readonly,showScriptEditIcon:this.props.showScriptEditIcon};s=t.merge(t.config.app.graph,s);let l=t.factories.app.createAppGraph.call(this,s),c=t.merge(t.config.app.svgGroup,{transform:n}),p=t.factories.app.createAppSvgGroup.call(this,c,[l]),u={x:this.state.tooltipX,y:this.state.tooltipY,visible:this.state.tooltipVisible,label:this.state.tooltip};u=t.merge(t.config.app.tooltip,u);let d=t.factories.app.createAppTooltip.call(this,u),f=t.merge(t.config.app.modal,{children:a}),h=t.factories.app.createAppModalGroup.call(this,f);let m=[t.factories.app.createAppDefs.call(this),p,d,h],g=t.merge(t.config.app.svg,{width:this.state.width,height:this.state.height,version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"}),v=t.factories.app.createAppSvg.call(this,g,m),b=t.merge(t.config.app.canvas,{width:this.state.width,height:this.state.height}),y=[t.factories.app.createAppCanvas.call(this,b),v],w=t.merge(t.config.app.container,{style:{width:this.state.width,height:this.state.height}});return w.className+=" "+o,t.factories.app.createAppContainer.call(this,w,y)}})}},{}],28:[function(e,t,n){t.exports={applyToGraph:function(e,t,n){console.error("DEPRECATED: TheGraph.autolayout.applyAutolayout() will be removed in next version");let o,r,i=t.children.slice();for(o=0,r=i.length;o<r;o++){let t=i[o],r=e.getNode(t.id);if(t.children){let o,r=t.children;for(o in r){let i=r[o];i.id&&e.setNodeMetadata(i.id,{x:Math.round((t.x+i.x)/n.snap)*n.snap,y:Math.round((t.y+i.y)/n.snap)*n.snap})}}if(r)e.setNodeMetadata(t.id,{x:Math.round(t.x/n.snap)*n.snap,y:Math.round(t.y/n.snap)*n.snap});else{let o=t.id.split(":::"),r=o[0],i=o[1];"inport"===r&&e.inports[i]?e.setInportMetadata(i,{x:Math.round(t.x/n.snap)*n.snap,y:Math.round(t.y/n.snap)*n.snap}):"outport"===r&&e.outports[i]&&e.setOutportMetadata(i,{x:Math.round(t.x/n.snap)*n.snap,y:Math.round(t.y/n.snap)*n.snap})}}}}},{}],29:[function(e,t,n){const o=["#55dcfa","#5579fa","#f15f33","#ec3be3","#33f1b5","#1e81b0","#e28743","#eab676","#76b5c5","#873e23","#063970"];function r(e,t,n={}){e&&e instanceof Array&&t&&(this.animate=this.animate.bind(this),this.edges=e,this.runningAnimation=null,this.currentAnimation=null,this.animationTimer=0,this.animationEndTime=Number.MAX_VALUE,this.animationQueue=this.prepareAnimationData(e,t),this.ballColor=o[Math.floor(10*Math.random()%o.length)],this.onStart=n.onStart||null,this.onEnd=n.onEnd||null)}r.prototype.animate=function(){if(this.animationTimer>this.endTime)return cancelAnimationFrame(this.runningAnimation),void(this.onEnd&&this.onEnd());this.animationQueue.forEach(e=>{const{startTime:t=0,messages:n=[],started:o=!1}=e;this.animationTimer>=t&&!o&&n.forEach(t=>{const{edge:n={},duration:o=0}=t,r=`edge-${n.from.node}-${n.from.port}-${n.to.port}-${n.to.node}`,i=document.getElementById(r);if(i){const t=i.querySelectorAll(".edge-flow"),n=t[0];if(n){const r=n.cloneNode(),i=n.parentNode,a=n.getAttribute("d");if(a){const t=`<animateMotion path="${a}" begin="0s" dur="${o}s" repeatCount="1"></animateMotion>`;r.insertAdjacentHTML("beforeend",t),r.setAttribute("fill",this.ballColor),i.appendChild(r),r.classList.remove("hide"),r.querySelector("animateMotion").beginElement(),e.started=!0}t.length>100&&t[1].remove()}}})}),this.animationTimer+=60,this.runningAnimation=requestAnimationFrame(this.animate)},r.prototype.destroy=function(){},r.prototype.prepareAnimationData=function(e,t){const n=[],o={};let r=+Date.now();return this.endTime=0,Object.keys(t).forEach(i=>{t[i].messages.forEach(t=>{const i=t.source,a=t.target,s=i.timestamp,l=parseFloat(a.timestamp)-parseFloat(i.timestamp),c=e.find(e=>e.from.node===i.node_id&&e.from.port===i.port&&e.to.node===a.node_id&&e.to.port===a.port);c&&(r=Math.min(s,r),this.endTime=Math.max(this.endTime,s+l),o[s]?o[s].messages.push({edge:c,duration:l}):n.push({startTime:s,messages:[{edge:c,duration:l}]}))})}),n.forEach(function(e){e.startTime=e.startTime-r}),n.sort(function(e,t){return e.startTime<=t.startTime?-1:1}),n},r.prototype.reset=function(){this.runningAnimation&&cancelAnimationFrame(this.runningAnimation),this.animationTimer=0,this.runningAnimation=null,this.animationQueue=[]},r.prototype.setAnimationData=function(e){this.reset(),this.ballColor=o[Math.floor(10*Math.random()%o.length)],this.animationQueue=this.prepareAnimationData(this.edges,e)},t.exports=r},{}],30:[function(e,t,n){const o=e("./constants").iconSvgD.alert,r=e("./constants").iconSvgD.code;t.exports.register=function(e){let t=e.TheGraph;t.config.edge={curve:t.config.nodeSize,container:{className:"edge"},defaultColor:"#a6a6a6",backgroundPath:{className:"edge-bg"},foregroundPath:{ref:"route",className:"edge-fg stroke route"},flowPath:{className:"edge-flow hide",fill:"#55dcfa",cx:"0",cy:"0",r:"4"},autoPath:{ref:"route",className:"edge-auto stroke route"},touchPath:{className:"edge-touch",ref:"touch"},alertIcon:{className:"edge-alert",d:o,fill:"#FF6161",r:8},codeIcon:{className:"edge-code",d:r,fill:"#0084FF",r:8},portStart:{className:"edge-port edge-port-start",r:3,ref:"edgePortStart"},portEnd:{className:"edge-port edge-port-end",ref:"edgePortEnd"},port:{className:"edge-port",r:3}},t.factories.edge={createEdgeGroup:t.factories.createGroup,createEdgeBackgroundPath:t.factories.createPath,createEdgeForegroundPath:t.factories.createPath,createEdgeTouchPath:t.factories.createPath,createEdgePathArray:function(e,n,o,r,i){if(o-t.config.edge.codeIcon.r<e){let a=2*t.config.edge.codeIcon.r,s=a,l=.5;return _.isString(i)&&i.indexOf(",")>-1&&(i=i.split(",")),_.isArray(i)&&(a=i[0]||a,l=i[1]||l,s=i[2]||s,l=r>n?l:1-l),["M",e,n,"h",a,"v",(r-n)*l,"h",o-e-(a+s),"v",(r-n)*(1-l),"L",o-t.config.edge.port.r,r].join(" ")}return["M",e,n,"h",(o-e)*(i||.5),"v",r-n,"L",o-t.config.edge.port.r,r].join(" ")},createArrow:t.factories.createPolygon,createCircle:t.factories.createCircle,createIconSvg:t.factories.createPath},t.Edge=React.createFactory(React.createClass({displayName:"TheGraphEdge",componentDidMount:function(){const e=$(ReactDOM.findDOMNode(this));let t=this;t.handleMouseMove=t.handleMouseMove.bind(t),t.handleMouseUp=t.handleMouseUp.bind(t),this.props.isPreview||(e.on("mouseenter.edge",function(t){e.addClass("over")}),e.on("mouseleave.edge",function(t){e.removeClass("over")}),e.on("mousedown.edge",function(e){if(e.stopPropagation(),"path"!==e.target.tagName)return;const{sY:n,tY:o}=t.props;if(n!==o){const{turned:n}=t.state,o=e.target.getAttribute("class"),r=("edge-alert"===o||"edge-code"===o?e.target.parentNode.parentNode.querySelector(".edge-bg"):e.target).getBoundingClientRect();t.moveStart={x:e.clientX,y:e.clientY,domRect:r,turned:n}}}),this.$graph=$(document.querySelector(".the-graph-app")),this.$graph.on("mousemove",t.handleMouseMove),this.$graph.on("mouseup",t.handleMouseUp),e.on("click.edge",function(e){e.stopPropagation(),e.stopImmediatePropagation(),t.props.onEdgeSelection&&t.props.onEdgeSelection(t.props.edgeID,t.props.edge)}),e.on("click",".scripts",function(e){if(e.stopPropagation(),e.stopImmediatePropagation(),t.props.onClickEdgeCode){const n=e.currentTarget.getAttribute("data-direction");t.props.onClickEdgeCode(t.props.edge.from,t.props.edge.to,t.props.edge.metadata,n)}}),e.on("mousedown.edge.edgePorts",this.edgeStart)),this.props.showContext&&(e.on("contextmenu",this.showContext),e.on("press",this.showContext))},handleMouseMove:function(e){this.moveStart&&(Math.abs(e.clientY-this.moveStart.y)>10||Math.abs(e.clientX-this.moveStart.x)>10)&&this.handleResetEdge({x:e.clientX,y:e.clientY})},handleMouseUp:function(e){if(this.moveStart){const{from:e,to:t,metadata:n}=this.props.edge;let o=this.state.turned;_.isArray(o)&&(o=o.join(",")),this.props.onTurnedUpdated(e,t,Object.assign({},n,{turned:o})),this.moveStart=null}},componentWillUnmount:function(){this.$graph&&this.$graph.off("mousemove",this.handleMouseMove),this.$graph&&this.$graph.off("mouseup",this.handleMouseUp)},getInitialState:function(){let{turned:e,sX:t,tX:n,isPreview:o}=this.props;return o?e=null:n-t<5?e=_.isString(e)&&e.indexOf(",")>-1?e.split(",").map(e=>_.toNumber(e)):[10,.5,10]:_.isString(e)&&e.indexOf(",")>-1&&(e=.5),{turned:e}},componentWillReceiveProps:function(e){const{sX:n,tX:o}=this.props;if(!e.isPreview&&o-n<5&&e.tX-e.sX>=5)this.setState({turned:.5});else if(!e.isPreview&&o-n>=5&&e.tX-e.sX<5){const e=2*t.config.edge.codeIcon.r;this.setState({turned:[e,.5,e]})}},showContext:function(e){e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.preventTap&&e.preventTap();let t=e.x||e.clientX||0,n=e.y||e.clientY||0;e.touches&&e.touches.length&&(t=e.touches[0].clientX,n=e.touches[0].clientY),this.props.showContext({element:this,type:this.props.export?this.props.isIn?"graphInport":"graphOutport":"edge",x:t,y:n,graph:this.props.graph,itemKey:this.props.export?this.props.exportKey:null,item:this.props.export?this.props.export:this.props.edge})},getContext:function(e,n,o){return t.Menu({menu:e,options:n,triggerHideContext:o,label:this.props.label,iconColor:this.props.route})},shouldComponentUpdate:function(e,t){return e.sX!==this.props.sX||e.sY!==this.props.sY||e.tX!==this.props.tX||e.tY!==this.props.tY||e.color!==this.props.color||e.size!==this.props.size||e.hidden!==this.props.hidden||e.selected!==this.props.selected||e.animated!==this.props.animated||e.route!==this.props.route||e.inScript!==this.props.inScript||e.outScript!==this.props.outScript||e.error!==this.props.error||t.turned!==this.state.turned},handleResetEdge:function(e){const{sX:n,sY:o,tX:r,tY:i,app:a}=this.props;let{x:s,y:l,domRect:c,turned:p}=this.moveStart;if(Math.abs(e.x-s)>10||Math.abs(e.y-l)>10){const l=2*t.config.edge.codeIcon.r;if(r-5<n){const t=Math.abs(i-o)*a.state.scale;let n=p[0]||l,r=p[1]||.5,u=p[2]||l;const d=r>0?c.y:c.bottom-t;if(s>=c.x+c.width/2){const t=(e.x-s)/a.state.scale+n;n=t>l?t:l}else{const t=u-(e.x-s)/a.state.scale;u=t>l?t:l}p=[n,r=(e.y-d)/t,u]}else p=(e.x-c.x)/a.state.scale>c.width-l?(c.width-l)/c.width:e.x<c.x+l?l/c.width:Math.abs(e.x-c.x)/c.width;this.setState({turned:p})}},edgeStart:function(e){e.stopPropagation(),e.stopImmediatePropagation();const n=e.target.getAttribute("class"),o=n.indexOf("edge-port-start")>-1,r=n.indexOf("edge-port-end")>-1;if(o||r){const{graph:n,edge:r,edgeID:i}=this.props,a=o?r.to:r.from,s=n.getNode(a.node),l=s.metadata.def.ports.find(function(e){return e.display&&e.uuid==a.port}),{from:c,to:p,metadata:u}=r;u.turned=null;const d=o?-t.config.edge.port.r:t.config.edge.port.r,f=new CustomEvent("the-graph-edge-start",{detail:{node:s,port:{process:s.id,port:l.uuid,type:l.type,subType:l.subType,autoReceive:l.autoReceive},isIn:o,offsetX:e.offsetX+d,offsetY:e.offsetY,metadata:u,nodeType:s.metadata.def.type,updating:{from:c,to:p,edgeID:i},highlightVerified:!1},bubbles:!0});ReactDOM.findDOMNode(this).dispatchEvent(f)}return!1},render:function(){let{sX:e,sY:n,tX:o,tY:r,error:i,size:a}=this.props;e=e+t.config.edge.port.r+t.config.port.size,o=o-t.config.edge.port.r-t.config.port.size;const{turned:s}=this.state;let l,c=t.factories.edge.createEdgePathArray(e,n,o,r,s),p=t.merge(t.config.edge.touchPath,{strokeWidth:a+4,d:c}),u=t.factories.edge.createEdgeTouchPath(p),d={id:this.props.edgeID,className:"edge"+(this.props.selected?" selected":"")+(this.props.animated?" animated":"")+(this.props.hidden?" hidden":""),title:this.props.label};if(d=t.merge(t.config.edge.container,d),this.props.isAuto){let e=t.config.edge.autoPath.className+this.props.route,n=t.merge(t.config.edge.foregroundPath,{d:c,className:e,stroke:this.props.stroke||t.config.edge.defaultStroke});l=[t.factories.edge.createEdgeForegroundPath(n),u]}else{let p=t.merge(t.config.edge.backgroundPath,{strokeWidth:a+2,d:c}),d=t.factories.edge.createEdgeBackgroundPath(p),f=t.config.edge.foregroundPath.className+this.props.route,h=t.merge(t.config.edge.foregroundPath,{strokeWidth:a,d:c,className:f,stroke:this.props.color||t.config.edge.defaultColor});if(l=[d,t.factories.edge.createEdgeForegroundPath(h),t.factories.createCircle.call(this,t.merge(t.config.edge.flowPath,{d:c})),u],!this.props.isPreview||this.props.updating){const i=t.merge(t.config.edge.portStart,{cx:e,cy:n,fill:this.props.color||t.config.edge.defaultColor}),a=t.factories.edge.createCircle.call(this,i),s=t.merge(t.config.edge.portEnd,{points:`${o-t.config.edge.port.r},${r-t.config.edge.port.r} ${o-t.config.edge.port.r},${r+t.config.edge.port.r} ${o+t.config.edge.port.r},${r}`,fill:this.props.color||t.config.edge.defaultColor}),c=[a,t.factories.edge.createArrow.call(this,s)],p=t.factories.edge.createEdgeGroup.call(this,{className:"edge-ports"},c);l.push(p)}if(!this.props.isPreview){const a=this.props.inScript,c=this.props.outScript,p=t.config.edge.codeIcon.r,u=t.factories.createCircle.call(this,{className:"icon-bg",cx:p,cy:p,r:p,fill:"#fff"});let d=e+(o-e)/2,f=n+(r-n)/2;if(_.isArray(s)?f=n+(r-n)*(r>n?s[1]:1-s[1]):_.isNumber(s)&&(d=e+(o-e)*s),i){const e=t.factories.edge.createIconSvg.call(this,t.config.edge.alertIcon),n=t.factories.node.createNodeGroup.call(this,{className:"edge-icon edge-icon-alert",transform:"translate("+(d-p)+","+(f-p)+")"},[u,e]);l.push(n)}if(this.props.showScriptEditIcon){const i={className:`scripts edge-icon${c?" block":""}`,transform:"translate("+(e+p)+","+(n-p)+")","data-direction":"out"},s={className:`scripts edge-icon${a?" block":""}`,transform:"translate("+(o-3*p)+","+(r-p)+")","data-direction":"in"},d=[u,t.factories.edge.createIconSvg.call(this,t.config.edge.codeIcon)],f=t.factories.node.createNodeGroup.call(this,i,d),h=t.factories.node.createNodeGroup.call(this,s,d);l.push(f,h)}}}return t.factories.edge.createEdgeGroup(d,l)}}))}},{"./constants":22}],31:[function(e,t,n){let o=e("./constants").nodeStyles;t.exports.register=function(e){let t=e.TheGraph;t.config.graph={container:{},groupsGroup:{className:"groups"},edgesGroup:{className:"edges"},iipsGroup:{className:"iips"},nodesGroup:{className:"nodes"},inportsGroup:{className:"ex-inports"},outportsGroup:{className:"ex-outports"},node:{},iip:{},inportEdge:{},inportNode:{},outportEdge:{},outportNode:{},nodeGroup:{},edgePreview:{key:"edge-preview",label:""}},t.factories.graph={createGraphContainerGroup:t.factories.createGroup,createGraphGroupsGroup:t.factories.createGroup,createGraphEdgesGroup:t.factories.createGroup,createGraphIIPGroup:t.factories.createGroup,createGraphNodesGroup:t.factories.createGroup,createGraphInportsGroup:t.factories.createGroup,createGraphOutportsGroup:t.factories.createGroup,createGraphNode:function(e){return t.Node(e)},createGraphEdge:function(e){return t.Edge(e)},createGraphIIP:function(e){return t.IIP(e)},createGraphGroup:function(e){return t.Group(e)},createGraphEdgePreview:function(e){return t.Edge(e)}},t.Graph=React.createFactory(React.createClass({displayName:"TheGraphGraph",mixins:[],getDefaultProps:function(){return{library:{},graph:null,app:null,showScriptEditIcon:!1,offsetX:0,offsetY:0,nodeIcons:{}}},getInitialState:function(){return{displaySelectionGroup:!0,edgePreview:null,edgePreviewX:0,edgePreviewY:0,forceSelection:!1,selectedNodes:[],errorNodes:[],selectedEdges:[],animatedEdges:[],offsetX:this.props.offsetX,offsetY:this.props.offsetY}},componentDidMount:function(){this._ismounted=!0,this.subscribeGraph(null,this.props.graph),this.editor=document.getElementById("editor"),ReactDOM.findDOMNode(this).addEventListener("the-graph-node-remove",this.removeNode)},componentWillUnmount:function(){this._ismounted=!1},componentWillReceiveProps:function(e){this.subscribeGraph(this.props.graph,e.graph),this.markDirty({id:_.get(window,"__graph__.currentNodeId",[]),allNodeDirty:_.get(window,"__graph__.allNodeDirty",!1)}),_.set(window,"__graph__.currentNodeId",[]),_.set(window,"__graph__.allNodeDirty",!1)},subscribeGraph:function(e,t){e&&(e.removeListener("addEdge",this.resetPortRoute),e.removeListener("changeEdge",this.resetPortRoute),e.removeListener("removeEdge",this.resetPortRoute),e.removeListener("removeInitial",this.resetPortRoute),e.removeListener("changeNode",this.onChangeNode),e.removeListener("changeInport",this.onChangeInport),e.removeListener("changeOutport",this.onChangeOutport),e.removeListener("endTransaction",this.onEndTransaction)),t&&(t.on("addEdge",this.resetPortRoute),t.on("changeEdge",this.resetPortRoute),t.on("removeEdge",this.resetPortRoute),t.on("removeInitial",this.resetPortRoute),t.on("changeNode",this.onChangeNode),t.on("changeInport",this.onChangeInport),t.on("changeOutport",this.onChangeOutport),t.on("endTransaction",this.onEndTransaction))},onChangeNode:function(e,t){const n=[e.id].concat(this.getRelatedNodeIds(e.id));this.markDirty({id:[...n]},t)},onChangeInport:function(e,t,n,o){this.markDirty()},onChangeOutport:function(e,t,n,o){this.markDirty()},currentNodeId:[],onEndTransaction:function(e){delete this.currentNodeId,this.markDirty({allNodeDirty:!0})},edgePreview:null,edgeStart:function(e){const{port:t,highlightVerified:n}=e.detail;if(this.state.edgePreview){if(!n)return;this.currentNodeId.push(e.detail.node.id);let o=this.state.edgePreview;if(o.from&&o.from.process===t.process||o.to&&o.to.process===t.process)return;if(o.isIn===e.detail.isIn)return;const r=o.isIn?_.get(o,"updating.from"):_.get(o,"updating.to");return r&&r.node==t.process&&r.port==t.port?void this.cancelPreviewEdge():(e.detail.isIn?o.to=t:o.from=t,this.currentNodeId.push(e.detail.node.id),this.addEdge(o),this.addNodeRalation([...this.currentNodeId]),void this.cancelPreviewEdge())}if(e.detail.isIn&&!e.detail.updating)return;let o;this.currentNodeId=[e.detail.node.id],(o=e.detail.isIn?{to:t}:{from:t}).isIn=e.detail.isIn,o.updating=e.detail.updating,o.metadata=e.detail.metadata||{route:e.detail.route},o.type=e.detail.port.type,o.subType=e.detail.port.subType,o.nodeType=e.detail.nodeType,this.renderPreviewEdge(e),this.editor.addEventListener("mousemove",this.renderPreviewEdge),this.editor.addEventListener("mouseup",this.cancelPreviewEdge),this.setState({edgePreview:o})},cancelPreviewEdge:function(e){this.editor.removeEventListener("mousemove",this.renderPreviewEdge),this.editor.removeEventListener("mouseup",this.cancelPreviewEdge),this.state.edgePreview&&(_.set(window,"__graph__.currentNodeId",[]),_.set(window,"__graph__.allNodeDirty",!0),this.setState({edgePreview:null}),this.markDirty({allNodeDirty:!0}))},renderPreviewEdge:function(e){let t=e.offsetX||e.detail.offsetX||0,n=e.offsetY||e.detail.offsetY||0,o=this.props.app.state.scale;this.setState({edgePreviewX:(t-this.props.app.state.x)/o,edgePreviewY:(n-this.props.app.state.y)/o}),this.markDirty({allNodeDirty:!0})},__nodeRelated__:{},addNodeRalation:function(e=[]){_.isEmpty(e)||(this.__nodeRelated__[e[0]]=this.__nodeRelated__[e[0]]||[],this.__nodeRelated__[e[0]].push(e[1]),this.__nodeRelated__[e[1]]=this.__nodeRelated__[e[1]]||[],this.__nodeRelated__[e[1]].push(e[0]))},getRelatedNodeIds:function(e){return _.get(this.__nodeRelated__,`${e}`,[])},addEdge:function(e){if(this.props.graph.addEdge(e.from.process,e.from.port,e.to.process,e.to.port,e.metadata),e.updating){const{from:t,to:n}=e.updating;this.props.graph.removeEdge(t.node,t.port,n.node,n.port)}},setEdgeMetadata:function(e,t,n){this.props.graph.setEdgeMetadata(e.node,e.port,t.node,t.port,n)},moveGroup:function(e,n,o){let r=this.props.graph,i=e.length;for(let a=0;a<i;a++){let i=r.getNode(e[a]);if(i)if(void 0!==n)r.setNodeMetadata(i.id,{x:i.metadata.x+n,y:i.metadata.y+o});else{let e=parseFloat(t.config.nodeHeight)/20;r.setNodeMetadata(i.id,{x:Math.round(i.metadata.x/e)*e,y:Math.round(i.metadata.y/e)*e})}}this.markDirty({id:e})},getComponentInfo:function(e){let t={name:e.label,icon:"cube",inports:[],outports:[]};for(let n=0;n<e.def.ports.length;n++){let o=e.def.ports[n];o.display&&("in"===o.ioType?t.inports.push({name:o.uuid,description:o.description?o.description.zh_CN:o.uuid,type:o.type,subType:o.subType,autoReceive:o.autoReceive}):"out"===o.ioType&&t.outports.push({name:o.uuid,description:o.description?o.description.zh_CN:o.uuid,type:o.type,subType:o.subType}))}return t},portInfo:{},getPorts:function(e,t,n){let o=e.getNode(t),r=this.portInfo[t];if(!r){let e={},i={};if(n&&this.props.library){let t,n,r,a=this.getComponentInfo(o.metadata);if(!a)return{inports:e,outports:i};for(t=0,r=a.outports.length;t<r;t++)(n=a.outports[t]).name&&(i[n.name]={label:n.name,description:n.description,type:n.type,subType:n.subType,x:n.x||o.metadata.width,y:n.y||o.metadata.height/(r+1)*(t+1)});for(t=0,r=a.inports.length;t<r;t++)(n=a.inports[t]).name&&(e[n.name]={label:n.name,description:n.description,type:n.type,subType:n.subType,autoReceive:n.autoReceive,x:n.x||0,y:n.y||o.metadata.height/(r+1)*(t+1)})}r={inports:e,outports:i},this.portInfo[t]=r}return r},getNodeOutport:function(e,n,o,r,i){let a=this.getPorts(e,n,i);a.outports[o]||(a.outports[o]={label:o,x:t.config.nodeWidth/2,y:t.config.nodeHeight},this.dirty=!0);let s=a.outports[o];return void 0!==r&&(s.route=r),s},getNodeInport:function(e,n,o,r,i){let a=this.getPorts(e,n,i);a.inports[o]||(a.inports[o]={label:o,x:t.config.nodeWidth/2,y:0},this.dirty=!0);let s=a.inports[o];return void 0!==r&&(s.route=r),s},resetPortRoute:function(e){const t=[];if(e.from&&e.from.node){let n=this.portInfo[e.from.node];if(n){n.dirty=!0;let o=n.outports[e.from.port];o&&(o.route=null),t.push(e.from.node)}}if(e.to&&e.to.node){let n=this.portInfo[e.to.node];if(n){n.dirty=!0;let o=n.inports[e.to.port];o&&(o.route=null),t.push(e.to.node)}}this.currentNodeId=t,this.markDirty({id:t})},graphOutports:{},getGraphOutport:function(e){let n=this.graphOutports[e];return n||((n={inports:{},outports:{}}).inports[e]={label:e,type:"all",route:5,x:0,y:t.config.nodeHeight/2},this.graphOutports[e]=n),n},graphInports:{},getGraphInport:function(e){let n=this.graphInports[e];return n||((n={inports:{},outports:{}}).outports[e]={label:e,type:"all",route:2,x:t.config.nodeWidth,y:t.config.nodeHeight/2},this.graphInports[e]=n),n},getScripts:function(e,t,n,o){let r=e.properties.scripts;if(r){const e=[t,n,o];for(;null!=r&&e.length>0;)r=r[e.shift()];return r}return""},setSelectedNodes:function(e){this.setState({selectedNodes:e}),this.markDirty()},setErrorNodes:function(e){this.setState({errorNodes:e}),this.markDirty()},setSelectedEdges:function(e){this.setState({selectedEdges:e}),this.markDirty()},setAnimatedEdges:function(e){this.setState({animatedEdges:e}),this.markDirty()},updateIcon:function(e,t){console.error("DEPRECATED: updateIcon() will be removed in next version of the-graph. Pass nodeIcons through props instead"),this.props.nodeIcons[e]=t,this.markDirty()},dirty:!1,libraryDirty:!1,__currentNodeIds:[],__allNodeDirty:!0,markDirty:function(e){let t=_.get(e,"id",[]);this.__currentNodeIds=Array.isArray(t)?t:[t],this.__allNodeDirty=_.get(e,"allNodeDirty",!1),this.libraryDirty=!0,window.requestAnimationFrame(this.triggerRender)},triggerRender:function(e){this._ismounted&&(this.dirty=!0,this.forceUpdate())},shouldComponentUpdate:function(){return this.dirty},render:function(){this.dirty=!1;let e=this,n=this.props.graph,r=[],i=this.state.edgePreview;this.libraryDirty&&(this.libraryDirty=!1,this.portInfo={});let a=null;i&&i.type&&(a={type:i.type,subType:i.subType,isIn:!i.isIn,from:i.from,to:i.to,fromNodeType:i.nodeType,updating:i.updating});let s=n.nodes.map(function(i){let s=e.getComponentInfo(i.metadata);if(!s)throw new Error("Component "+i.component+" is not in library");let l=i.id;i.metadata||(i.metadata={}),void 0===i.metadata.x&&(i.metadata.x=0),void 0===i.metadata.y&&(i.metadata.y=0);const c=_.has(i.metadata,"size")?_.toNumber(i.metadata.size):1;if(i.metadata.width=t.config.nodeWidth*c,i.metadata.height=t.config.nodeHeight*c,t.config.autoSizeNode&&s){let e=Math.max(s.inports.length,s.outports.length);if(e>t.config.maxPortCount){let n=e-t.config.maxPortCount;i.metadata.height=t.config.nodeHeight+n*t.config.nodeHeightIncrement}}let p=i.metadata.icon||"cube",u="icon";!_.isEmpty(p)&&p.indexOf("studio")>-1&&(u="image");let d=!0===e.state.selectedNodes[l];d&&r.push(l);let f=i.metadata.nodeStyle?o[i.metadata.nodeStyle].bg:"rgba(255,255,255,1)",h={key:l,nodeID:l,x:i.metadata.x,y:i.metadata.y,dirty:e.__currentNodeIds.indexOf(l)>-1||e.__allNodeDirty,label:i.metadata.label,sublabel:i.metadata.sublabel||i.component,width:i.metadata.width,height:i.metadata.height,size:c,app:e.props.app,scale:e.props.scale,graphView:e,graph:n,node:i,icon:p,iconType:u,color:i.metadata.color||f,screenshot_index:i.metadata.screenshot_index,ports:e.getPorts(n,l,i.component),onNodeSelection:e.props.onNodeSelection,onNodeRectImgDblclick:e.props.onNodeRectImgDblclick,selected:d,error:!0===e.state.errorNodes[l],showContext:e.props.showContext,highlightPort:a,allowEdgeStart:e.props.allowEdgeStart,onExpandIconClicked:e.props.onExpandIconClicked};return h=t.merge(t.config.graph.node,h),t.factories.graph.createGraphNode.call(this,h)}),l=n.edges.map(function(o){let r=n.getNode(o.from.node),a=n.getNode(o.to.node);if(!r||!a)return;let s=e.getNodeOutport(n,o.from.node,o.from.port,0,r.component),l=e.getNodeInport(n,o.to.node,o.to.port,0,a.component);s.type!=l.type?o.metadata.error={type:"type",from:s.type,to:l.type}:s.subType!=l.subType&&"all"!=s.subType&&"all"!=l.subType?o.metadata.error={type:"subType",from:s.subType,to:l.subType}:delete o.metadata.error;let c=r.metadata.label+"() "+o.from.port.toUpperCase()+(o.from.hasOwnProperty("index")?"["+o.from.index+"]":"")+" -> "+o.to.port.toUpperCase()+(o.to.hasOwnProperty("index")?"["+o.to.index+"]":"")+" "+a.metadata.label+"()",p="edge-"+o.from.node+"-"+o.from.port+(o.from.hasOwnProperty("index")?"["+o.from.index+"]":"")+"-"+o.to.port+(o.to.hasOwnProperty("index")?"["+o.to.index+"]":"")+"-"+o.to.node,u={key:p,edgeID:p,graph:n,edge:o,app:e.props.app,sX:r.metadata.x+r.metadata.width,sY:r.metadata.y+s.y,tX:a.metadata.x,tY:a.metadata.y+l.y,turned:_.get(o,"metadata.turned"),label:c,route:0,error:o.metadata.error,isAuto:o.metadata.auto,color:_.get(o,"metadata.color"),size:_.get(o,"metadata.size")||1,inScript:!_.isEmpty(e.getScripts(n,o.to.node,o.to.port,"beforeEnter")),outScript:!_.isEmpty(e.getScripts(n,o.from.node,o.from.port,"afterLeave")),hidden:i&&i.updating&&p==i.updating.edgeID,onEdgeSelection:e.props.onEdgeSelection,onClickEdgeCode:e.props.onClickEdgeCode,selected:-1!==e.state.selectedEdges.indexOf(o),animated:-1!==e.state.animatedEdges.indexOf(o),showContext:e.props.showContext,showScriptEditIcon:e.props.showScriptEditIcon,onTurnedUpdated:e.setEdgeMetadata};return u=t.merge(t.config.graph.edge,u),t.factories.graph.createGraphEdge.call(this,u)}),c=n.initializers.map(function(o){let r=n.getNode(o.to.node);if(!r)return;let i=e.getNodeInport(n,o.to.node,o.to.port,0,r.component),a=r.metadata.x,s=r.metadata.y+i.y,l=o.from.data,c=typeof l,p={graph:n,label:!0===l||!1===l||"number"===c||"string"===c?l:c,x:a,y:s};return p=t.merge(t.config.graph.iip,p),t.factories.graph.createGraphIIP.call(this,p)}),p=Object.keys(n.inports).map(function(o){let r=n.inports[o],i=o,a=r.process,s=r.port;r.metadata||(r.metadata={x:0,y:0});let c=r.metadata;c.x||(c.x=0),c.y||(c.y=0),c.width||(c.width=t.config.nodeWidth),c.height||(c.height=t.config.nodeHeight);let p=e.portInfo[a];if(!p)return void console.warn("Node "+a+" not found for graph inport "+i);let u=p.inports[s];if(!u)return void console.warn("Port "+a+"."+s+" not found for graph inport "+i);let d=n.getNode(a);if(!d)return void console.warn("Node "+a+" not found for graph inport "+i);let f={key:"inport.node."+o,export:r,exportKey:o,x:c.x,y:c.y,width:c.width,height:c.height,label:i,app:e.props.app,graphView:e,graph:n,node:{},ports:e.getGraphInport(o),isIn:!0,icon:c.icon?c.icon:"sign-in",showContext:e.props.showContext};f=t.merge(t.config.graph.inportNode,f);let h={key:"inport.edge."+o,export:r,exportKey:o,graph:n,app:e.props.app,edge:{},route:0,isIn:!0,label:"export in "+i.toUpperCase()+" -> "+s.toUpperCase()+" "+d.metadata.label,sX:f.x+t.config.nodeWidth,sY:f.y+t.config.nodeHeight/2,tX:d.metadata.x+u.x,tY:d.metadata.y+u.y,showContext:e.props.showContext,allowEdgeStart:e.props.allowEdgeStart};return h=t.merge(t.config.graph.inportEdge,h),l.unshift(t.factories.graph.createGraphEdge.call(this,h)),t.factories.graph.createGraphNode.call(this,f)}),u=Object.keys(n.outports).map(function(o){let r=n.outports[o],i=o,a=r.process,s=r.port;r.metadata||(r.metadata={x:0,y:0});let c=r.metadata;c.x||(c.x=0),c.y||(c.y=0),c.width||(c.width=t.config.nodeWidth),c.height||(c.height=t.config.nodeHeight);let p=e.portInfo[a];if(!p)return void console.warn("Node "+a+" not found for graph outport "+i);let u=p.outports[s];if(!u)return void console.warn("Port "+a+"."+s+" not found for graph outport "+i);let d=n.getNode(a);if(!d)return void console.warn("Node "+a+" not found for graph outport "+i);let f={key:"outport.node."+o,export:r,exportKey:o,x:c.x,y:c.y,width:c.width,height:c.height,label:i,app:e.props.app,graphView:e,graph:n,node:{},ports:e.getGraphOutport(o),isIn:!1,icon:c.icon?c.icon:"sign-out",showContext:e.props.showContext};f=t.merge(t.config.graph.outportNode,f);let h={key:"outport.edge."+o,export:r,exportKey:o,graph:n,app:e.props.app,edge:{},route:c.route?c.route:4,isIn:!1,label:d.metadata.label+" "+s.toUpperCase()+" -> "+i.toUpperCase()+" export out",sX:d.metadata.x+u.x,sY:d.metadata.y+u.y,tX:f.x,tY:f.y+t.config.nodeHeight/2,showContext:e.props.showContext,allowEdgeStart:e.props.allowEdgeStart};return h=t.merge(t.config.graph.outportEdge,h),l.unshift(t.factories.graph.createGraphEdge.call(this,h)),t.factories.graph.createGraphNode.call(this,f)}),d=n.groups.map(function(o){if(o.nodes.length<1)return;let r=t.findMinMax(n,o.nodes);if(!r)return;let i={key:"group."+o.name,graph:n,item:o,app:e.props.app,minX:r.minX,minY:r.minY,maxX:r.maxX,maxY:r.maxY,scale:e.props.scale,label:o.metadata.name||"",nodes:o.nodes,groupId:o.name,triggerMoveGroup:e.moveGroup,showContext:e.props.showContext,onGroupSelection:e.props.onGroupSelection};return i=t.merge(t.config.graph.nodeGroup,i),t.factories.graph.createGraphGroup.call(this,i)});if(this.state.displaySelectionGroup&&r.length>=2){let o=t.findMinMax(n,r);if(o){let i={name:"selection",nodes:r,metadata:{color:1}},a={graph:n,app:e.props.app,item:i,minX:o.minX,minY:o.minY,maxX:o.maxX,maxY:o.maxY,scale:e.props.scale,color:i.metadata.color,triggerMoveGroup:e.moveGroup,showContext:e.props.showContext};a=t.merge(t.config.graph.selectionGroup,a);let s=t.factories.graph.createGraphGroup.call(this,a);d.push(s)}}if(i){let e;if(i.from){let t=n.getNode(i.from.process),o=this.getNodeOutport(n,i.from.process,i.from.port);e={sX:t.metadata.x+t.metadata.width,sY:t.metadata.y+o.y,tX:this.state.edgePreviewX,tY:this.state.edgePreviewY,route:i.metadata.route,updating:i.updating,isPreview:!0}}else{let t=n.getNode(i.to.process),o=this.getNodeInport(n,i.to.process,i.to.port);e={sX:this.state.edgePreviewX,sY:this.state.edgePreviewY,tX:t.metadata.x,tY:t.metadata.y+o.y,route:i.metadata.route,updating:i.updating,isPreview:!0}}e=t.merge(t.config.graph.edgePreview,e);let o=t.factories.graph.createGraphEdgePreview.call(this,e);l.push(o)}let f=t.merge(t.config.graph.groupsGroup,{children:d}),h=t.factories.graph.createGraphGroupsGroup.call(this,f),m=t.merge(t.config.graph.edgesGroup,{children:l}),g=t.factories.graph.createGraphEdgesGroup.call(this,m),v=t.merge(t.config.graph.iipsGroup,{children:c}),b=t.factories.graph.createGraphIIPGroup.call(this,v),y=t.merge(t.config.graph.nodesGroup,{children:s}),w=t.factories.graph.createGraphNodesGroup.call(this,y),x=t.merge(t.config.graph.inportsGroup,{children:p}),$=t.factories.graph.createGraphInportsGroup.call(this,x),C=t.merge(t.config.graph.outportsGroup,{children:u}),k=[h,g,b,w,$,t.factories.graph.createGraphGroupsGroup.call(this,C)],S=this.state.forceSelection||r.length>0?" selection":"",T=t.merge(t.config.graph.container,{className:"graph"+S});return t.factories.graph.createGraphContainerGroup.call(this,T,k)}}))}},{"./constants":22}],32:[function(e,t,n){t.exports.register=function(e){let t=e.TheGraph;t.config.group={container:{className:"group"},boxRect:{rx:t.config.nodeRadius,ry:t.config.nodeRadius},labelText:{className:"group-label"},descriptionText:{className:"group-description"}},t.factories.group={createGroupGroup:t.factories.createGroup,createGroupBoxRect:t.factories.createRect,createGroupLabelText:t.factories.createText,createGroupDescriptionText:t.factories.createText},t.Group=React.createFactory(React.createClass({displayName:"TheGraphGroup",getInitialState:function(){return{moving:!1,lastTrackX:null,lastTrackY:null}},componentDidMount:function(){let e=ReactDOM.findDOMNode(this);e.addEventListener("mousedown",this.onTrackStart),this.props.onGroupSelection&&e.addEventListener("click",this.onGroupSelection)},onGroupSelection:function(e){e.stopPropagation(),this.props.onGroupSelection(this.props.groupId)},onTrackStart:function(e){e.stopPropagation(),this.setState({moving:!0}),this.setState({lastTrackX:e.pageX,lastTrackY:e.pageY});let t=document.getElementById("editor");return t.addEventListener("mousemove",this.onTrack),t.addEventListener("mouseup",this.onTrackEnd),this.props.graph.startTransaction("movegroup"),!1},onTrack:function(e){e.stopPropagation();let t=e.pageX,n=e.pageY,o=t-this.state.lastTrackX,r=n-this.state.lastTrackY,i=Math.round(o/this.props.scale),a=Math.round(r/this.props.scale);this.setState({lastTrackX:t,lastTrackY:n}),this.props.triggerMoveGroup(this.props.item.nodes,i,a)},onTrackEnd:function(e){this.setState({moving:!1}),e.stopPropagation(),this.props.triggerMoveGroup(this.props.item.nodes);let t=document.getElementById("editor");t.removeEventListener("mousemove",this.onTrack),t.removeEventListener("mouseup",this.onTrackEnd),this.setState({lastTrackX:null,lastTrackY:null}),this.props.graph.endTransaction("movegroup")},render:function(){let e=this.props.minX-28,n=this.props.minY-28,o=this.props.color?this.props.color:0,r={x:e,y:n,width:this.props.maxX-e+14,height:this.props.maxY-n+14,className:"group-box color"+o};r=t.merge(t.config.group.boxRect,r);let i=t.factories.group.createGroupBoxRect.call(this,r),a={x:e+t.config.nodeRadius+3,y:n+14,children:this.props.label};a=t.merge(t.config.group.labelText,a);let s=[i,t.factories.group.createGroupLabelText.call(this,a)],l=t.merge(t.config.group.container,{id:this.props.groupId});return t.factories.group.createGroupGroup.call(this,l,s)}}))}},{}],33:[function(e,t,n){t.exports.register=function(e){let t=e.TheGraph;t.config.iip={container:{className:"iip"},path:{className:"iip-path"},text:{className:"iip-info",height:5,halign:"right"}},t.factories.iip={createIIPContainer:t.factories.createGroup,createIIPPath:t.factories.createPath,createIIPText:function(e){return t.TextBG(e)}};t.IIP=React.createFactory(React.createClass({displayName:"TheGraphIIP",shouldComponentUpdate:function(e,t){return e.x!==this.props.x||e.y!==this.props.y||e.label!==this.props.label},render:function(){let e=this.props.x,n=this.props.y,o=["M",e,n,"L",e-10,n].join(" "),r=this.props.label+"";r.length>12&&(r=r.slice(0,9)+"...");let i=t.merge(t.config.iip.path,{d:o}),a=t.factories.iip.createIIPPath.call(this,i),s=t.merge(t.config.iip.text,{x:e-10,y:n,text:r}),l=[a,t.factories.iip.createIIPText.call(this,s)],c=t.merge(t.config.iip.container,{title:this.props.label});return t.factories.iip.createIIPContainer.call(this,c,l)}}))}},{}],34:[function(e,t,n){function o(e){let t=[];return e.nodes.forEach(function(n){let o={name:n.component,icon:"cog",description:"",inports:[],outports:[]};Object.keys(e.inports).forEach(function(t){let r=e.inports[t];if(r.process===n.id){for(let e=0;e<o.inports.length;e++)if(o.inports[e].name===r.port)return;o.inports.push({name:r.port,type:"all"})}}),Object.keys(e.outports).forEach(function(t){let r=e.outports[t];if(r.process===n.id){for(let e=0;e<o.outports.length;e++)if(o.outports[e].name===r.port)return;o.outports.push({name:r.port,type:"all"})}}),e.initializers.forEach(function(e){if(e.to.node===n.id){for(let t=0;t<o.inports.length;t++)if(o.inports[t].name===e.to.port)return;o.inports.push({name:e.to.port,type:"all"})}}),e.edges.forEach(function(e){let t;if(e.from.node===n.id){for(t=0;t<o.outports.length;t++)if(o.outports[t].name===e.from.port)return;o.outports.push({name:e.from.port,type:"all"})}if(e.to.node===n.id){for(t=0;t<o.inports.length;t++)if(o.inports[t].name===e.to.port)return;o.inports.push({name:e.to.port,type:"all"})}}),t.push(o)}),t}t.exports={mergeComponentDefinition:function(e,t){if(e===t)return t;let n,o,r,i,a,s=e.inports,l=t.inports;if(s!==l)for(n=0,r=s.length;n<r;n++){let e=s[n];for(a=!1,o=0,i=l.length;o<i;o++){let t=l[o];e.name===t.name&&(a=!0)}a||l.push(e)}let c=e.outports,p=t.outports;if(c!==p)for(n=0,r=c.length;n<r;n++){let e=c[n];for(a=!1,o=0,i=p.length;o<i;o++){let t=p[o];e.name===t.name&&(a=!0)}a||p.push(e)}return"cog"!==t.icon?e.icon=t.icon:t.icon=e.icon,t.iconsvg=e.iconsvg,t},componentsFromGraph:o,libraryFromGraph:function(e){let t={};return o(e).forEach(function(e){t[e.name]=e}),t}}},{}],35:[function(e,t,n){let o=e("./constants").iconSvgD;t.exports.register=function(e){let t=e.TheGraph;const n=function(e,t){const n={light:!0,text:"#555"};if(!e)return n;let o=null,r=1;var i;if(0==e.indexOf("#")&&(o=(i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e))?[parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16)]:null),e.indexOf("rgb")>-1){const t=e.indexOf("(")+1,n=e.indexOf(")");(o=e.slice(t,n).split(",").map(e=>Number(e.trim()))).length>3&&(r=o.pop(3))}return(o.findIndex(e=>e<160)>-1||r<.4)&&(t||(n.text="#fff"),n.light=!1),n};t.config.node={snap:t.config.nodeSize,container:{},background:{className:"node-bg"},border:{className:"node-border drag",rx:t.config.nodeRadius,ry:t.config.nodeRadius},innerRect:{className:"node-rect drag",rx:t.config.nodeRadius,ry:t.config.nodeRadius,fill:"#f0f0f6"},icon:{ref:"icon",className:"icon node-icon drag the-graph-var-icon"},iconsvg:{className:"icon-svg node-icon drag"},runningIcon:{ref:"running-icon",className:"icon node-icon drag the-graph-spin"},successIcon:{ref:"success-icon",className:"icon node-icon drag the-graph-success-icon"},errorIcon:{ref:"error-icon",className:"icon node-icon drag the-graph-error-icon"},warnIcon:{ref:"warn-icon",className:"icon node-icon drag the-graph-warn-icon"},inports:{className:"inports"},outports:{className:"outports"},labelBackground:{className:"node-label-bg"},labelRect:{className:"text-bg-rect"},labelText:{className:"node-label"},sublabelBackground:{className:"node-sublabel-bg"},sublabelRect:{className:"text-bg-rect"},sublabelText:{className:"node-sublabel"}},t.factories.node={createNodeGroup:t.factories.createGroup,createNodeBackgroundRect:t.factories.createRect,createNodeBorderRect:t.factories.createRect,createNodeInnerRect:t.factories.createRect,createNodeInnerRectImg:t.factories.createRectImg,createNodeIconText:t.factories.createText,createNodeIconSVGGroup:t.factories.createGroup,createNodeIconSVG:t.factories.createPath,createNodeInportsGroup:t.factories.createGroup,createNodeOutportsGroup:t.factories.createGroup,createNodeLabelGroup:t.factories.createGroup,createNodeLabelRect:t.factories.createRect,createNodeLabelText:t.factories.createText,createNodeSublabelGroup:t.factories.createGroup,createNodeSublabelRect:t.factories.createRect,createNodeSublabelText:t.factories.createText,createNodePort:function(e){return t.Port(e)}},t.Node=React.createFactory(React.createClass({displayName:"TheGraphNode",gutter:{.5:6,1:8,2:12},labelHeight:{.5:6,1:30,2:45},getInitialState:function(){return{labelSize:12,lastTrackX:null,lastTrackY:null,lastNodeData:{},nodeColor:n(this.props.color,this.props.size<1)}},componentDidMount:function(){let e=ReactDOM.findDOMNode(this),t=e.querySelector(".node-rect");e.addEventListener("mousedown",this.onTrackStart),this.props.onNodeSelection&&e.addEventListener("click",this.onNodeSelection),t&&this.props.onNodeRectImgDblclick&&t.addEventListener("dblclick",this.onNodeRectImgDblclick),this.props.showContext&&(e.addEventListener("contextmenu",this.showContext),e.addEventListener("press",this.showContext)),"image"==this.props.iconType&&this.getIconImageUrl(this.props.icon),this.props.preview&&this.updatePreview(this.props.preview),this.isCheckingUrl=!1,this.screenShotKeyToCheck=[]},componentWillReceiveProps(e){if(e.screenshot_index!==this.state.lastNodeData.screenshot_index)if(this.state.lastNodeData.screenshot_index=e.screenshot_index,e.screenshot_index){let t="studio/"+window.appConfig.userId+"/logs/"+window.appConfig.appId+"/screenshots_thumbnail/"+this.props.nodeID+"/"+e.screenshot_index+".png";this.updateScreenShotUrl(t)}else this.screenshotSignedUrl=null;if("image"==e.iconType&&e.icon!=this.props.icon&&(this.iconUrl=null,this.getIconImageUrl(e.icon)),e.preview!==this.props.preview&&this.updatePreview(e.preview),e.scale!==this.props.scale){let t;this.state.labelSize!==(t=e.scale>=1.5?8:e.scale>=1?10:12)&&this.setState({labelSize:t})}if(e.color!==this.props.color){const t=n(e.color,this.props.size<1);this.setState({nodeColor:t})}},updatePreview:function(e){e?e.lastIndexOf("/")==e.length-1?window.appService.getContents(e).then(e=>{const t=_.find(e.catalog,e=>"png"==e.type||"jpg"==e.type||"jpeg"==e.type);t&&window.SuanpanAPI.appDataStoreService.head(t.id).then(()=>{window.SuanpanAPI.appDataStoreService.url(t.id).then(e=>{e.success&&this.setState({preview:e.data})})}).catch(()=>{})}):(e.indexOf(",")>0&&(e=e.split(",")[0]),window.SuanpanAPI.appDataStoreService.head(e).then(t=>{0==t.ContentType.indexOf("image")&&window.SuanpanAPI.appDataStoreService.url(e).then(e=>{e.success&&this.setState({preview:e.data})})}).catch(()=>{})):this.setState({preview:null})},updateScreenShotUrl:function(e){this.isCheckingUrl?this.screenShotKeyToCheck.push(e):window.SuanpanAPI.appDataStoreService.head(e).then(()=>{window.SuanpanAPI.appDataStoreService.url(e).then(e=>{_.isEmpty(this.screenShotKeyToCheck)?(this.isCheckingUrl=!1,e.success&&(this.screenshotSignedUrl=e.data,this.forceUpdate())):this.updateScreenShotUrl(this.screenShotKeyToCheck[this.screenShotKeyToCheck.length-1])})}).catch(()=>{})},getIconImageUrl:function(e){window.SuanpanAPI.appDataStoreService.url(e).then(e=>{e.success&&(this.iconUrl=e.data,this.forceUpdate())})},doCancel:function(e){e.stopPropagation(),e.stopImmediatePropagation()},onNodeSelection:function(e){e.stopPropagation(),e.stopImmediatePropagation();let n=t.metaKeyPressed||"touch"===e.pointerType;this.props.onNodeSelection(e,this.props.nodeID,this.props.node,n)},onNodeRectImgDblclick:function(e){e.stopPropagation(),e.stopImmediatePropagation(),this.screenshotSignedUrl&&this.props.onNodeRectImgDblclick(e,this.props.nodeID,this.screenshotSignedUrl)},onTrackStart:function(e){e.stopPropagation();let t=document.getElementById("editor");return t.addEventListener("mousemove",this.onTrack),t.addEventListener("mouseup",this.onTrackEnd),this.props.export?this.props.graph.startTransaction("moveexport"):this.props.graph.startTransaction("movenode"),this.lastTrackX=e.pageX,this.lastTrackY=e.pageY,!1},onTrack:function(e){e.stopPropagation();let t=e.pageX,n=e.pageY,o=t-this.lastTrackX,r=n-this.lastTrackY;this.lastTrackX=t,this.lastTrackY=n;let i=this.props.app.state.scale,a=Math.round(o/i),s=Math.round(r/i);if(this.props.export){let e={x:this.props.export.metadata.x+a,y:this.props.export.metadata.y+s};this.props.isIn?this.props.graph.setInportMetadata(this.props.exportKey,e):this.props.graph.setOutportMetadata(this.props.exportKey,e)}else this.props.graph.setNodeMetadata(this.props.nodeID,{x:this.props.node.metadata.x+a,y:this.props.node.metadata.y+s})},onTrackEnd:function(e){let n=document.getElementById("editor");n.removeEventListener("mousemove",this.onTrack),n.removeEventListener("mouseup",this.onTrackEnd);const{movementX:o,movementY:r}=e;if(0!==o&&0!==r){let e=!0,n=parseFloat(t.config.nodeHeight)/20;if(e){if(this.props.export){let e={x:Math.round(this.props.export.metadata.x/n)*n,y:Math.round(this.props.export.metadata.y/n)*n};this.props.isIn?this.props.graph.setInportMetadata(this.props.exportKey,e):this.props.graph.setOutportMetadata(this.props.exportKey,e)}else this.props.graph.setNodeMetadata(this.props.nodeID,{x:Math.round(this.props.node.metadata.x/n)*n,y:Math.round(this.props.node.metadata.y/n)*n})}}this.props.export?this.props.graph.endTransaction("moveexport"):this.props.graph.endTransaction("movenode")},showContext:function(e){e.preventDefault(),e.stopPropagation(),e.preventTap&&e.preventTap();let t=e.x||e.clientX||0,n=e.y||e.clientY||0;e.touches&&e.touches.length&&(t=e.touches[0].clientX,n=e.touches[0].clientY),this.props.showContext({element:this,type:this.props.export?this.props.isIn?"graphInport":"graphOutport":"node",x:t,y:n,graph:this.props.graph,itemKey:this.props.export?this.props.exportKey:this.props.nodeID,item:this.props.export?this.props.export:this.props.node})},getContext:function(e,n,o){if(this.props.export)return t.Menu({menu:e,options:n,triggerHideContext:o,label:this.props.exportKey});let r=n.x,i=n.y,a=this.props.app.state.scale,s=this.props.app.state.x,l=this.props.app.state.y,c=(this.props.x+this.props.width/2)*a+s-r,p=(this.props.y+this.props.height/2)*a+l-i,u=this.props.ports,d=this.props.nodeID,f=this.props.highlightPort;return this.props.graphView.state.edgePreview?this.props.graphView.state.edgePreview.isIn?t.NodeMenuPorts({ports:u.outports,triggerHideContext:o,isIn:!1,scale:a,processKey:d,deltaX:c,deltaY:p,translateX:r,translateY:i,nodeWidth:this.props.width,nodeHeight:this.props.height,highlightPort:f}):t.NodeMenuPorts({ports:u.inports,triggerHideContext:o,isIn:!0,scale:a,processKey:d,deltaX:c,deltaY:p,translateX:r,translateY:i,nodeWidth:this.props.width,nodeHeight:this.props.height,highlightPort:f}):t.NodeMenu({menu:e,options:n,triggerHideContext:o,label:this.props.label,graph:this.props.graph,graphView:this.props.graphView,node:this,icon:this.props.icon,ports:u,process:this.props.node,processKey:d,x:r,y:i,nodeWidth:this.props.width,nodeHeight:this.props.height,deltaX:c,deltaY:p,highlightPort:f})},shouldComponentUpdate:function(e,t){return e.dirty&&(e.x!==this.props.x||e.y!==this.props.y||e.icon!==this.props.icon||e.label!==this.props.label||e.sublabel!==this.props.sublabel||e.ports!==this.props.ports||e.selected!==this.props.selected||e.error!==this.props.error||e.highlightPort!==this.props.highlightPort||t.preview!==this.state.preview||!0===e.ports.dirty)||t.nodeColor.text!==this.state.nodeColor.text||t.nodeColor.light!==this.state.nodeColor.light||t.labelSize!==this.state.labelSize||e.scale>=2&&this.props.scale<2||e.scale<2&&this.props.scale>=2},renderIcon:function(){const{lastNodeData:e={},preview:n,labelSize:r}=this.state,{width:i,height:a,scale:s,size:l}=this.props;if("image"==this.props.iconType||n&&s>=2)e.iconContent=null,e.iconOptions=null;else if("icon"==this.props.iconType){let n=t.merge({},{d:o[this.props.icon],fill:"#7285a8"});const r=this.gutter[`${l}`],s=30;let c=(i-s*l)/2,p=r+(a-r-this.labelHeight[`${l}`]-s*l)/2,u=t.merge(t.config.node.iconsvg,{transform:"translate("+c+","+p+") scale("+l+")"});if(!e.iconContent||!_.isEqual(e.iconSVGOptions,n)||!_.isEqual(e.iconSvgGroupOptions,u)){let o=t.factories.node.createNodeIconSVG.call(this,n);e.iconContent=t.factories.node.createNodeIconSVGGroup.call(this,u,[o]),e.iconSVGOptions=n,e.iconSvgGroupOptions=u}}else if(!e.iconContent||!_.isEqual(e.iconOptions,iconOptions)){let n=t.FONT_ICON[this.props.icon];n||(n=t.FONT_ICON.cube);let o=t.merge(t.config.node.icon,{x:this.props.height/2,y:this.props.height/2,children:n});e.iconContent=t.factories.node.createNodeIconText.call(this,o),e.iconOptions=o}let c=t.merge(t.config.node.runningIcon,{children:t.FONT_ICON.cog});e.runningIconContent=t.factories.node.createNodeIconText.call(this,c);let p=t.merge(t.config.node.successIcon,{x:72,y:2*this.props.height/3-4,fontSize:"14px",children:t.FONT_ICON.checked});e.successIconContent=t.factories.node.createNodeIconText.call(this,p);let u=t.merge(t.config.node.errorIcon,{x:72,y:2*this.props.height/3-4,fontSize:"14px",children:t.FONT_ICON["close-circle"]});e.errorIconContent=t.factories.node.createNodeIconText.call(this,u);let d=t.merge(t.config.node.warnIcon,{x:72,y:2*this.props.height/3-4,fontSize:"14px",children:t.FONT_ICON["warning-circle"]});return e.warnIconContent=t.factories.node.createNodeIconText.call(this,d),e},renderLabel:function(){const{lastNodeData:e={},labelSize:n,nodeColor:o}=this.state;let{labelGroup:r}=e,{label:i,width:a,height:s,size:l}=this.props;if(e.label!==i||e.labelSize!==n||e.size!==l||e.width!==a||e.height!==s||e.labelColor!==o.text){const c=Math.floor((a-10)/n*2);let p=s-this.labelHeight[`${l}`];const u=l<2?n:Math.floor(1.4*n),d=l<1?s+this.gutter[`${l}`]/2+n:p+this.labelHeight[`${l}`]/2+n/3;l>=1&&function(e){let t=0;for(let n=0;n<e.length;n++){let o=e.charCodeAt(n);o>=1&&o<=126||65376<=o&&o<=65439?t++:t+=2}return t}(i)>c&&(i=function(e,t){let n=0,o=[],r="";for(let i=0;i<e.length&&!(o.length>1);i++){let a=e.charCodeAt(i);a>=1&&a<=126||65376<=a&&a<=65439?n++:n+=2,r+=e[i],1==o.length&&n>=10&&i<e.length-1?(o.push(r+"..."),r="",n=0):Math.floor(n/t)>=1&&(o.push(r),r="",n=0)}return""!=r&&o.push(r),o}(i,c-1).map(function(e,t){return React.createElement("tspan",{x:a/2,y:t?d+u/2:d-u/2},e)}));let f=t.merge(t.config.node.labelText,{x:a/2,y:d,children:i,fill:o.text,style:{"font-size":n+"px"}}),h=t.factories.node.createNodeLabelText.call(this,f);r=t.factories.node.createNodeLabelGroup.call(this,t.config.node.labelBackground,[h]),e.label=i,e.labelSize=n,e.size=l,e.labelColor=o.text,e.labelGroup=r}return{label:e.label,labelRect:e.labelRect,labelGroup:e.labelGroup,sublabelRect:e.sublabelRect,sublabelGroup:e.sublabelGroup}},renderRects:function(){const{lastNodeData:e={},preview:n,nodeColor:o}=this.state,{width:r,height:i,color:a,icon:s,scale:l,size:c}=this.props,p=this.gutter[`${c}`],u=r-2*p,d=i-p-this.labelHeight[`${c}`];if(!e.borderRect||e.width!==r||e.height!==i||e.color!==a){let n=o.light?"blur_o":"blur_c";c<1&&(n+="_sm");let s=t.merge(t.config.node.border,{width:r,height:i,stroke:o.light?"#e6e6e6":"",fill:a||"#fff",filter:"url(#"+n+")"});e.color=a,e.width=r,e.height=i,e.borderRect=t.factories.node.createNodeBorderRect.call(this,s)}let f=t.merge(t.config.node.innerRect,{x:p,y:p,width:u,height:d,fill:"url(#grad1)"});if(this.screenshotSignedUrl||n&&l>=2||e.icon!==s&&"image"==this.props.iconType&&this.iconUrl){let o="";this.screenshotSignedUrl?o=this.screenshotSignedUrl:n&&l>=2?(o=n,e.icon="preview"):"image"==this.props.iconType&&(o=this.iconUrl,e.icon=s);let r={x:p,y:p,width:u,height:d,id:"raduisImage_"+this.props.nodeID,href:o};e.innerImg=t.factories.node.createNodeInnerRectImg.call(this,r);const i=t.merge(t.config.node.innerRect,{className:"node-rect-img",width:u,height:d,stroke:"none",fill:"url(#raduisImage_"+this.props.nodeID+")"});e.innerImgRect=t.factories.node.createNodeInnerRect.call(this,i)}else"icon"==this.props.iconType&&(e.icon=s,e.innerImg=null,e.innerImgRect=null);return e.innerRect=t.factories.node.createNodeInnerRect.call(this,f),e},renderPorts:function(){const{lastNodeData:e={}}=this.state;let n,o,r=this.props.x,i=this.props.y,a=this.props.width,s=this.props.height,l=this.props.nodeID,c=this.props.app,p=this.props.graph,u=this.props.node,d=void 0!==this.props.export,f=this.props.showContext,h=this.props.highlightPort,m=this.props.ports.inports;o=(n=Object.keys(m)).length;let g=n.map(function(e){let n=m[e],o={app:c,graph:p,node:u,key:l+".in."+n.label,label:n.description,processKey:l,isIn:!0,isExport:d,nodeX:r,nodeY:i,nodeWidth:a,nodeHeight:s,x:n.x,y:n.y,port:{process:l,port:n.label,type:n.type,subType:n.subType,autoReceive:n.autoReceive},highlightPort:h,route:n.route,showContext:f,allowEdgeStart:this.props.allowEdgeStart};return p.edges.find(e=>e.metadata.error&&e.to.node==l&&e.to.port==n.label)&&(o.className="alert"),t.factories.node.createNodePort(o)}.bind(this)),v=t.merge(t.config.node.inports,{children:g});e.highlightPort=h,e.showContext=f,e.inports=m,e.inportsGroup=t.factories.node.createNodeInportsGroup.call(this,v);let b=this.props.ports.outports;o=(n=Object.keys(b)).length;let y=n.map(function(e){let n=b[e],o={app:c,graph:p,node:u,key:l+".out."+n.label,label:n.description,processKey:l,isIn:!1,isExport:d,nodeX:r,nodeY:i,nodeWidth:a,nodeHeight:s,x:n.x,y:n.y,port:{process:l,port:n.label,type:n.type,subType:n.subType},highlightPort:h,route:n.route,showContext:f,allowEdgeStart:this.props.allowEdgeStart};return t.factories.node.createNodePort(o)}.bind(this)),w=t.merge(t.config.node.outports,{children:y});return e.outports=b,e.outportsGroup=t.factories.node.createNodeOutportsGroup.call(this,w),e},render:function(){this.props.ports.dirty&&(this.props.ports.dirty=!1);let e=this.props.x,n=this.props.y,o=this.props.width,r=this.props.height;const{inportsGroup:i,outportsGroup:a}=this.renderPorts(),{iconContent:s,runningIconContent:l,successIconContent:c,errorIconContent:p,warnIconContent:u}=this.renderIcon(),{borderRect:d,innerImgRect:f,innerRect:h,innerImg:m}=this.renderRects(),{label:g,labelGroup:v}=this.renderLabel();let b=[d,h,f,m,l,c,p,u,i,a,v];this.screenshotSignedUrl||b.push(s),this.state.lastNodeData.width=o,this.state.lastNodeData.height=r;let y={id:this.props.nodeID,className:"node drag "+this.props.node.metadata.def.theme+" "+(this.props.selected?" selected":"")+(this.props.error?" error":""),name:this.props.nodeID,key:this.props.nodeID,title:g,transform:"translate("+e+","+n+")"};return y=t.merge(t.config.node.container,y),t.factories.node.createNodeGroup.call(this,y,b)}}))}},{"./constants":22}],36:[function(e,t,n){let o=e("./mixins").Tooltip;t.exports.register=function(e){let t=e.TheGraph,n=function(){return(new Date).getTime()};t.config.port={container:{className:"port arrow"},backgroundCircle:{className:"port-circle-bg"},arc:{className:"port-arc"},line:{ref:"route",className:"port-line"},innerCircle:{ref:"circleSmall"},highlightCircle:{ref:"circleHighlight"},text:{ref:"label",className:"port-label drag"},diamond:{className:"port-diamond",points:"-4,0 0,-4 4,0, 0,4",fill:"#fff",strokeWidth:1},size:4},t.factories.port={createPortGroup:t.factories.createGroup,createPortBackgroundCircle:t.factories.createCircle,createPortArc:t.factories.createPath,createPortInnerCircle:t.factories.createCircle,createPortHighlightCircle:t.factories.createCircle,createPortLabelText:t.factories.createText,createArrow:t.factories.createPolygon},t.Port=React.createFactory(React.createClass({displayName:"TheGraphPort",mixins:[o],defaultProps:{allowEdgeStart:!0},getInitialState:function(){return{highlightVerified:void 0,highlightVerifiedLastModified:void 0}},componentDidMount:function(){let e=ReactDOM.findDOMNode(this);e.addEventListener("mousedown",this.edgeStart),e.addEventListener("mouseup",this.edgeStart),this.props.showContext&&(e.addEventListener("contextmenu",this.showContext),e.addEventListener("press",this.showContext))},getTooltipTrigger:function(){return ReactDOM.findDOMNode(this)},shouldShowTooltip:function(){return this.props.app.state.scale<t.zbpBig||this.props.label.length>8},showContext:function(e){if(this.props.isExport)return;if(e&&e.target===ReactDOM.findDOMNode(this.refs.label))return;e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.preventTap&&e.preventTap();let t=e.x||e.clientX||0,n=e.y||e.clientY||0;e.touches&&e.touches.length&&(t=e.touches[0].clientX,n=e.touches[0].clientY),this.props.showContext({element:this,type:this.props.isIn?"nodeInport":"nodeOutport",x:t,y:n,graph:this.props.graph,itemKey:this.props.label,item:this.props.port})},getContext:function(e,n,o){return t.Menu({menu:e,options:n,label:this.props.label,triggerHideContext:o})},edgeStart:function(e){if(e.stopPropagation&&e.stopPropagation(),this.props.isExport)return;if(!this.props.allowEdgeStart)return;if(e&&e.target===ReactDOM.findDOMNode(this.refs.label))return;let t=new CustomEvent("the-graph-edge-start",{detail:{node:this.props.node,isIn:this.props.isIn,port:this.props.port,route:this.props.route,offsetX:e.offsetX,offsetY:e.offsetY,nodeType:this.props.node.metadata.def.type,highlightVerified:this.state.highlightVerified},bubbles:!0});return ReactDOM.findDOMNode(this).dispatchEvent(t),!1},render:function(){let e,o,r,{label:i,isIn:a,highlightPort:s,port:l,node:c,graph:p,x:u,y:d,className:f}=this.props;if(i&&i.length>7){e={fontSize:30/(4*i.length)*6+"px"}}if(s&&!l.autoReceive){if(void 0===this.state.highlightVerified||n()-this.state.highlightVerifiedLastModified>1e3){let e=!1,t=!1;s.from&&s.from.process!==c.id&&s.isIn===a&&(_.findIndex(p.edges,e=>e.from.node==s.from.process&&e.from.port==s.from.port&&e.to.node==l.process&&e.to.port==l.port)>-1&&(e=!0),(!e||_.get(s,"updating.to.node")==c.id&&_.get(s,"updating.to.port")==l.port)&&(t=!0)),!s.to||s.to.process===c.id||s.isIn||a||(!e||_.get(s,"updating.from.node")==c.id&&_.get(s,"updating.from.port")==l.port)&&(t=!0),this.setState({highlightVerified:t,highlightVerifiedLastModified:n()})}this.state.highlightVerified&&(r={className:"port-circle-highlight-gray",r:6},s.type!==l.type||s.subType&&l.subType&&s.subType!==l.subType&&"all"!==s.subType&&"all"!==l.subType||(r.className="port-circle-highlight"),r=t.merge(t.config.port.highlightCircle,r),o=t.factories.port.createPortHighlightCircle.call(this,r))}let h={x:a?5:-5,style:e,children:i};h=t.merge(t.config.port.text,h);let m=t.factories.port.createPortLabelText.call(this,h);const g=t.merge(t.config.port.diamond,{fill:a?"#fff":"#e6e6e6"});let v=[m,t.factories.edge.createArrow(g)];if(a&&l.autoReceive){let e=t.factories.edge.createEdgePathArray(-10,0,0,0),n=t.merge(t.config.port.line,{d:e}),o=t.factories.port.createPortArc(n);v.unshift(o)}o&&v.unshift(o);let b=t.merge(t.config.port.container,{title:i,transform:"translate("+u+","+d+")",id:l.process+"-"+l.port});return f&&(b.className+=` ${f}`),t.factories.port.createPortGroup.call(this,b,v)}}))}},{"./mixins":26}],37:[function(e,t,n){let o=e("./factories.js"),r=e("./merge.js"),i={container:{},rect:{className:"tooltip-bg",x:-4,y:-9,rx:3,ry:3,height:18},text:{className:"tooltip-label",ref:"label"}},a={createTooltipGroup:o.createGroup,createTooltipRect:o.createRect,createTooltipText:o.createText},s=React.createFactory(React.createClass({displayName:"TheGraphTooltip",render:function(){let e=6*function(e){let t=0;for(let n=0;n<e.length;n++)null!=e[n].match(/[^\x00-\xff]/gi)?t+=2:t+=1;return t}(this.props.label)+8,t=r(i.rect,{width:e}),n=a.createTooltipRect.call(this,t),o=r(i.text,{children:this.props.label}),s=[n,a.createTooltipText.call(this,o)],l={className:"tooltip"+(this.props.visible?"":" hidden"),transform:"translate("+this.props.x+","+this.props.y+")"};return l=r(i.container,l),a.createTooltipGroup.call(this,l,s)}}));t.exports={config:i,factories:a,Tooltip:s}},{"./factories.js":23,"./merge.js":25}],38:[function(e,t,n){t.exports.register=function(e){let t=e.TheGraph,n={nodeSize:12,nodeRadius:5,nodeSide:56,contextPortSize:36,zbpBig:1.2,zbpNormal:.4,zbpSmall:.01,config:{nodeSize:12,nodeWidth:90,nodeRadius:5,nodeHeight:90,autoSizeNode:!0,maxPortCount:6,nodeHeightIncrement:12,focusAnimationDuration:1500}};for(let e in n)t[e]=n[e];"undefined"!=typeof window&&(window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame),t.findMinMax=function(e,t){let n,o;if(void 0===t&&(t=e.nodes.map(function(e){return e.id}),n=e.inports,o=e.outports),t.length<1)return;let r,a,s=1/0,l=1/0,c=-1/0,p=-1/0,u=t.length;for(let n=0;n<u;n++){let o=t[n],r=e.getNode(o);if(!r||!r.metadata)continue;r.metadata.x<s&&(s=r.metadata.x),r.metadata.y<l&&(l=r.metadata.y);let i=r.metadata.x+r.metadata.width,a=r.metadata.y+r.metadata.height;i>c&&(c=i),a>p&&(p=a)}if(n)for(u=(r=Object.keys(n)).length,i=0;i<u;i++)(a=n[r[i]]).metadata&&(a.metadata.x<s&&(s=a.metadata.x),a.metadata.y<l&&(l=a.metadata.y),a.metadata.x>c&&(c=a.metadata.x),a.metadata.y>p&&(p=a.metadata.y));if(o)for(u=(r=Object.keys(o)).length,i=0;i<u;i++)(a=o[r[i]]).metadata&&(a.metadata.x<s&&(s=a.metadata.x),a.metadata.y<l&&(l=a.metadata.y),a.metadata.x>c&&(c=a.metadata.x),a.metadata.y>p&&(p=a.metadata.y));return isFinite(s)&&isFinite(l)&&isFinite(c)&&isFinite(p)?{minX:s,minY:l,maxX:c,maxY:p}:null},t.findFit=function(e,t,n){return{x:0,y:0,scale:1}},t.findAreaFit=function(e,n,o,r){let i={minX:e.x<n.x?e.x:n.x,minY:e.y<n.y?e.y:n.y,maxX:e.x>n.x?e.x:n.x,maxY:e.y>n.y?e.y:n.y};i.minX-=t.config.nodeSize,i.minY-=t.config.nodeSize,i.maxX+=2*t.config.nodeSize,i.maxY+=2*t.config.nodeSize;let a,s,l,c=i.maxX-i.minX,p=i.maxY-i.minY,u=o/c,d=r/p;return u<d?(a=u,s=0-i.minX*a,l=0-i.minY*a+(r-p*a)/2):(a=d,s=0-i.minX*a+(o-c*a)/2,l=0-i.minY*a),{x:s,y:l,scale:a}},t.findNodeFit=function(e,n,o){let r,i,a,s=e.metadata.x-t.config.nodeSize,l=e.metadata.y-t.config.nodeSize,c=e.metadata.x+2*t.config.nodeSize-s,p=e.metadata.y+2*t.config.nodeSize-l,u=n/c,d=o/p;return u<d?(i=0-s*(r=u),a=0-l*r+(o-p*r)/2):(i=0-s*(r=d)+(n-c*r)/2,a=0-l*r),{x:i,y:a,scale:r}},t.SVGImage=React.createFactory(React.createClass({displayName:"TheGraphSVGImage",render:function(){let e="<image ";return e=(e=(e=(e=(e=e+'xlink:href="'+this.props.src+'"')+'x="'+this.props.x+'"')+'y="'+this.props.y+'"')+'width="'+this.props.width+'"')+'height="'+this.props.height+'"',e+="/>",React.DOM.g({className:this.props.className,dangerouslySetInnerHTML:{__html:e}})}})),t.TextBG=React.createFactory(React.createClass({displayName:"TheGraphTextBG",render:function(){let e=this.props.text;e||(e="");let t=this.props.height,n=e.length*this.props.height*2/3,o=this.props.height/2,r="start",i=this.props.x,a=this.props.y-t/2;return"center"===this.props.halign&&(i-=n/2,r="middle"),"right"===this.props.halign&&(i-=n,r="end"),React.DOM.g({className:this.props.className?this.props.className:"text-bg"},React.DOM.rect({className:"text-bg-rect",x:i,y:a,rx:o,ry:o,height:1.1*t,width:n}),React.DOM.text({className:this.props.textClassName?this.props.textClassName:"text-bg-text",x:this.props.x,y:this.props.y,children:e}))}})),t.getOffset=function(e){let t=function(e){let n,o={top:0,left:0};return e?(o.top+=e.offsetTop||0,o.left+=e.offsetLeft||0,n=t(e.offsetParent),o.top+=n.top,o.left+=n.left,o):o};try{return t(e)}catch(e){return t()}}}},{}]},{},[1])(1)}),"suanpan"===window.appConfig.ossType&&(window.appConfig.signature=ALY.util.crypto.hmac(window.appConfig.oss.ossAccessSecret,window.appConfig.userId,"base64","sha1"),window.appConfig.signVersion="v1"),(app=angular.module("app",["angularBootstrapNavTree","ngAnimate","ngMaterial","ngMessages","ngSanitize","ui.select","ui.router","ui.bootstrap","ui.bootstrap.contextMenu","ui.codemirror","ui.colorpicker","toaster","as.sortable","app.tpls","angular-drag","ngCookies"])).constant("APPMENU",{predict:{name:"工业程序",icon:"icongongyechengxu",route:"app.predict",description:"数据 + 算法 + 硬件 + 可视化，全混合流计算技术",userConfig:"predictDirs",componentType:"service, dashboard",visible:!0},algo:{name:"AI开发",icon:"iconAIkaifa",route:"app.exp",description:"为机器学习和深度学习提供从数据处理、模型训练到服务部署的一站式服务",userConfig:"appDirs",componentType:"algo,model",visible:!0},processMining:{name:"流程挖掘",icon:"iconliuchengwajue",route:"app.predict",description:"通过从事件日志中提取出知识，从而去发现、监控和改进实际业务过程",userConfig:"pmDirs",componentType:"pm",visible:!1},edge:{name:"边缘计算",icon:"iconbianyuanjisuan",route:"predict",description:"基于容易编排，采用网络、计算、存储、应用核心能力为一体的开放平台",subMenu:[{id:"project",name:"项目"},{id:"hardware",name:"接入设备"}],userConfig:"edgeDirs",componentType:"edge",visible:!0},mechanism:{name:"机理开发",icon:"iconjilikaifa",route:"app.predict",description:"将专家经验沉淀为决策模型，接入实时数据，构建决策引擎",componentType:"mechanism",visible:!0},rpa:{name:"RPA开发",icon:"iconRPAkaifa",route:"app.exp",description:"将重复性劳动进行自动化出来，在业务流程上实现自动化智能升级",userConfig:"rpaDirs",componentType:"rpa",visible:!0}}),app.constant("COMPONENT_TYPES",[{name:"算法组件",type:"algo"},{name:"服务组件",type:"service"},{name:"前面板组件",type:"dashboard"},{name:"RPA组件",type:"rpa"},{name:"RTO组件",type:"rto"}]),app.constant("USER_CONFIG",{publicDirId:1,myDirId:2,appDirs:[{id:1,label:"分享给我的项目",folder:!0,children:[]},{id:2,label:"我的项目",folder:!0,children:[]}],componentDirs:[{id:1,label:"分享给我的组件",folder:!0,children:[]},{id:2,label:"我的组件",folder:!0,children:[]}]}),app.constant("nodeTabIcon",{overview:"icongailan",params:"iconshezhi-copy",fields:"iconziduan",tune:"iconzhihangtiaoyou",test:"iconziduan",debug:"iconziduan"}),app.constant("pageSizeOption",[{name:"12 条/页",value:12},{name:"24 条/页",value:24},{name:"48 条/页",value:48},{name:"72 条/页",value:72},{name:"96 条/页",value:96},{name:"120 条/页",value:120}]),app.config(["$controllerProvider","$compileProvider","$filterProvider","$provide","$urlRouterProvider","$uiRouterProvider","$locationProvider","$mdDateLocaleProvider",function(e,t,n,o,r,i,a,s){app.controller=e.register,app.directive=t.directive,app.filter=n.register,app.factory=o.factory,app.service=o.service,app.constant=o.constant,app.value=o.value,r.otherwise("/web"),i.plugin(window["@uirouter/dsr"].DSRPlugin),i.plugin(window["@uirouter/sticky-states"].StickyStatesPlugin),a.html5Mode({enabled:!0,requireBase:!0}),moment.locale("zh-cn",{relativeTime:{s:"%d 秒"}}),moment.relativeTimeThreshold("s",50),moment.relativeTimeThreshold("ss",51),s.months=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],s.shortMonths=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],s.days=["星期一","星期二","星期三","星期四","星期五","星期六","星期日"],s.shortDays=["日","一","二","三","四","五","六"],s.firstDayOfWeek=1,s.monthHeaderFormatter=function(e){return e.getFullYear()+"年 "+s.shortMonths[e.getMonth()]},s.formatDate=function(e){let t=moment(e);return t.isValid()?t.format("LL"):""},window.spInstance=window.sp&&window.sp({dashboardPlugins:!0})}]).run(["$rootScope","$state","$stateParams","applyFn","APPMENU","$window","nodeService","statisticsService","$location",function(e,t,n,o,r,i,a,s,l){e.pageLoading=!0,e.sidebarCollapsed=!0,e.$state=t,e.$stateParams=n,e.winHeight=jQuery(window).height(),e.winWidth=jQuery(window).width(),e.applyFn=o,e.global={},e.appConfig=window.appConfig,e.removedNodes=[],e.appMenu=r,e.appConfig._context,window.appConfig.env,e.landingCollapsed=!1;const c=_.split(l.path(),"/");function p(e,t,n){e.removeEventListener(t,n),e.addEventListener(t,n)}(c.indexOf("app")>0||c.indexOf("service")>0||c.indexOf("component")>0)&&(e.landingCollapsed=!0),e.log=function(){switch(arguments.length){case 0:return;case 1:arguments[0];break;case 2:arguments[0],arguments[1];break;case 3:arguments[0],arguments[1],arguments[2]}},e.copyNode=function(e,t){let o=n.type;i.localStorage.copiedNode=JSON.stringify({metadata:angular.copy(e),componentId:t,type:o})},e.pasteNode=function(){if(i.localStorage.copiedNode){let e=JSON.parse(i.localStorage.copiedNode);e.type===n.type&&a.pasteNode(e.metadata,e.componentId)}},p(window,"load",s.trackLoginEvent),p(window,"unload",s.trackLogoutEvent),p(window,"error",s.trackErrorEvent)}]),app.run(["appService","appDataStoreService","common","componentService","componentLogService","hardwareService","instantNodeLogService","loopService","ossService","userService","uiService","$timeout","$rootScope","$state","$stateParams","$transitions","eventService",function(e,t,n,o,r,i,a,s,l,c,p,u,d,f,h,m,g){const v={};m.onSuccess({},function(e){const t=e.to();v[t.name]&&v[t.name].forEach(function(e){e.callback.call(e.context,t,h,e.options)}),g.emit(g.EVENTS.sp.ng.transition.success,e)}),window.SuanpanAPI={common:{goto:function(e,t,n){if(u(function(){d.landingCollapsed=!n}),"customize"==e)f.go("app."+e,{componentId:t});else if(e){const n=_.get(appConfig.appMenu,`${e}.route`);f.go("app."+n,{type:e,id:t||"",refresh:h.refresh+1})}},registerState:function(e,t,n,o){v[e]||(v[e]=[]),v[e].push({callback:t,context:n,options:o})}},commonService:{uuid:n.uuid,getImportPath:n.getImportPath},appService:e,appDataStoreService:t,componentService:o,componentLogService:r,eventService:g,hardwareService:i,instantNodeLogService:a,loopService:s,ossService:l,uiService:p,userService:c}}]),app.factory("applyFn",["$rootScope",function(e){return function(t,n){t=angular.isFunction(t)?t:angular.noop,n=n&&n.$apply?n:e,t(),n.$$phase||n.$apply()}}]),app.directive("input",["$timeout",function(e){return{restrict:"E",require:"?ngModel",scope:{setFocus:"="},link:function(t,n,o,r){t.setFocus&&(n.bind("focus",function(){let t=this;e(function(){t.select()})}),e(function(){n[0].focus()})),void 0!==o.type&&"number"===o.type&&r&&(r.$formatters.push(function(e){return _.isNull(e)?null:Number(e)}),r.$parsers.push(function(e){return _.isNull(e)?null:Number(e)}))}}}]).directive("indeterminate",function(){return{restrict:"A",link:function(e,t,n){let o=e.$watch(n.indeterminate,function(e){t[0].indeterminate=e});e.$on("$destroy",function(){o()})}}}),app.constant("APP_STATUS",{AppRunning:"1",AppStopped:"2",AppSuccess:"3",AppFailed:"4",AppStarting:"5",AppStopping:"6",AppDead:"7",AppCron:"8",AppWaiting:"9",AppUnknown:"0"}),app.constant("PARAM_TYPES",{string:{label:"单行文本框"},password:{label:"密码输入框"},storage_path:{label:"文件"},multi_string:{label:"多行文本框"},float:{label:"标签"},checkbox:{label:"复选框"},table_select:{label:"表选择"},file_select:{label:"文件选择"},formula_editor:{label:"编辑公式"},key_value:{label:"输入键值对"},partition_select:{label:"分区选择"},select:{label:"单选下拉"},multiselect:{label:"多选下拉"},colselect:{label:"字段选择",placeholder:"输入或者选择字段"},upload_file:{label:"上传文件"}}),app.constant("layoutPaths",{images:{root:"./images/",logo:"./images/logo/",profile:"./images/profile/",type:"./images/types/"}}),app.run(["toaster",function(e){window.navigator.onLine||e.pop("error","网络异常，请查看网络后重新打开"),window.addEventListener("online",function(){e.pop("success","网络已连接")}),window.addEventListener("offline",function(){e.pop("error","网络异常，请查看网络后重新打开")})}]),app.factory("redirectInterceptor",[function(){return{response:function(e){return"string"==typeof e.data&&e.data.indexOf("<title>登录</title>")>0&&location.reload(),e}}}]),app.config(["$httpProvider",function(e){e.interceptors.push("redirectInterceptor")}]),function(){let e,t=[].indexOf||function(e){for(let t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};(e=angular.module("angularBootstrapNavTree",[])).directive("abnTree",["$timeout","nodeService","$state","toaster","$rootScope","componentService","$stateParams","common","$q",function(e,n,o,r,i,a,s,l,c){return{restrict:"E",templateUrl:"/tpl/blocks/nav_tree.html",replace:!0,scope:{treeData:"=",isCard:"=",contextType:"@",onSelect:"&",initialSelection:"@",expandedKeys:"=",treeControl:"="},link:function(c,p,u){let d,f,h,m,g,v,b,y,w,x,C;c.searched_rows=[];const k={};if(d=function(e){},null==u.iconExpand&&(u.iconExpand="icon-plus  glyphicon glyphicon-plus  fa fa-plus"),null==u.iconCollapse&&(u.iconCollapse="icon-minus glyphicon glyphicon-minus fa fa-minus"),null==u.iconLeaf&&(u.iconLeaf="icon-file  glyphicon glyphicon-file  fa fa-file"),null==u.expandLevel&&(u.expandLevel="3"),h=parseInt(u.expandLevel,10),!c.treeData)return;if(null==c.treeData.length){if(null==treeData.label)return void alert("treeData should be an array of root branches");c.treeData=[treeData]}g=function(e){let t,n,o,r,i,a;for(t=function(n,o){let r,i,a,s,l;if(e(n,o),null!=n.children){for(l=[],i=0,a=(s=n.children).length;i<a;i++)r=s[i],l.push(t(r,o+1));return l}},a=[],o=0,r=(i=c.treeData).length;o<r;o++)n=i[o],a.push(t(n,1));return T({children:c.treeData}),a},x=null,w=function(t){if(!t)return null!=x&&(x.selected=!1),void(x=null);if(t!==x){if(null!=x&&(x.selected=!1),t.selected=!0,x=t,f(t),null!=t.onSelect)return e(function(){return t.onSelect(t)});if(null!=c.onSelect)return e(function(){return c.onSelect({branch:t})})}};const S=function(e){let t=e.shift();t&&a["my_component"===t.type?"get":"getPublic"](t.id).then(n=>{const o=JSON.parse(n.componentInfo.data),r=o.icon?`iconfont icon${o.icon}`:"";t.icon=r,k[t.id]=r,S(e)})},T=function(e){if(!_.isEmpty(e)){const t=function(e){if(_.isEmpty(e)||_.isEmpty(e.children))return[];const t=[];return e.children.forEach(e=>{e.visible&&_.isEmpty(e.children)&&t.push(e),e.prefetch&&t.push(...e.children)}),t}(e).filter(e=>-1===Object.keys(k).indexOf(`${e.id}`));S(t)}};c.user_clicks_branch=function(e){if(e.folder){if(e.expanded=!e.expanded,c.expandedKeys){const t=_.findIndex(c.expandedKeys,e.id);e.expanded&&-1==t?(c.expandedKeys.push(e.id),T(e)):!e.expanded&&t>-1&&c.expandedKeys.splice(t,1)}if("components"==c.contextType)return}if(e!==x)return w(e)},v=function(e){let t;return t=void 0,e.parent_uid&&g(function(n){if(n.uid===e.parent_uid)return t=n}),t},m=function(e,t){let n;if(null!=(n=v(e)))return t(n),m(n,t)},f=function(e){return m(e,function(e){return e.expanded=!0})},c.tree_rows=[],c.isApp=o.includes("app.exp")||o.includes("app.predict"),y=function(){let e,n,o,r,i,a,s=[];for(g(function(e,t){if(!e.uid)return e.uid=""+Math.random()}),g(function(e){let t,n,o,r,i;if(angular.isArray(e.children)){for(i=[],n=0,o=(r=e.children).length;n<o;n++)t=r[n],i.push(t.parent_uid=e.uid);return i}}),c.tree_rows=[],g(function(e){let t,n;return e.children?e.children.length>0?(n=function(e){return"string"==typeof e?{label:e,children:[]}:e},e.children=function(){let o,r,i,a;for(a=[],o=0,r=(i=e.children).length;o<r;o++)t=i[o],a.push(n(t));return a}()):void 0:e.children=[]}),e=function(n,o,r){let i,a,l,p,d,f,h,m=("public_component"===o.type||"hufu_component"===o.type)&&!o.usable;if(null==o.expanded&&(o.expanded=!1),null==o.classes&&(o.classes=[]),o.folder||o.children&&0!==o.children.length?o.expanded?(l=u.iconCollapse,s.push(o.id)):l=u.iconExpand:(l=k[o.id]||o.icon||u.iconLeaf,t.call(o.classes,"leaf")<0&&o.classes.push("leaf")),o.selected&&(x=o),c.tree_rows.push({level:n,branch:o,id:o.id,label:o.label,classes:o.classes,tree_icon:l,folder:o.folder||!1,menuOptions:o.menu||null,disabled:m,selected:o.selected,visible:!1!==r&&(!o.folder||!1!==o.visible)}),null!=o.children){for(h=[],p=0,d=(f=o.children).length;p<d;p++)i=f[p],a=!1!==r&&o.expanded,h.push(e(n+1,i,a));return h}},a=[],o=0,r=(i=c.treeData).length;o<r;o++)n=i[o],a.push(e(1,n,n.visible));return a},c.$watch("treeData",y,!0),null!=u.initialSelection&&g(function(t){if(t.id==u.initialSelection)return e(function(){return w(t)})}),b=c.treeData.length,g(function(e,t){return e.level=t,e.expanded=e.level<h});const I="components"==c.contextType?angular.element("#app"):angular.element(".sp-app-dirs"),E=I.find("#simulator"),N=angular.element(".sp-app-aside"),O=I.find("#dragger");let D;return c.onmousedown=function(t,p){if(3==t.which||p.disabled)return;let u="components"==c.contextType&&N.offset().left+N.width(),d=(new Date).getTime(),f=p.type,h=p.folder,m=p.id,g=p.icon,v=p.componentId,b=p.componentType,y=p.label;if(p.branch&&(f=p.branch.type,y=p.branch.label,m=p.branch.id,v=p.branch.componentId,g=p.branch.icon,b=p.branch.componentType),"my_component"===f||"public_component"===f||"hufu_component"===f||"device_component"===f||h){if(!o.includes("app.customize")&&i.readOnly)return angular.element(".sp-app-actions .sp-alert").addClass("flash"),void e(function(){angular.element(".sp-app-actions .sp-alert").removeClass("flash")},3e3);var w=t.pageX,x=t.pageY,C=136+angular.element(".navi").height();I.on("mousemove.abn.drag",function(e){if(!p.disabled&&(!D&&(e.pageX-w>=8||Math.abs(e.pageY-x)>=8)&&(D=h?O:E),D&&D.is(":hidden")&&(D.find(".tree-node-label").text(y),D.show()),D&&(h?D.offset({top:e.pageY-15,left:e.pageX<u?e.pageX-80:u-80}):o.includes("app.customize")?D.offset({top:e.pageY-45,left:e.pageX<u?e.pageX-45:u-90}):D.offset({top:e.pageY-45,left:e.pageX-45}),o.includes("app.customize")||e.pageX<u))){var t=$(".navi").scrollTop();e.pageY<136&&e.pageX<u?$(".navi").scrollTop(t-10):e.pageY>C&&e.pageX<u&&$(".navi").scrollTop(t+10)}}),I.find(".abn-tree .droppable").on("mouseenter.abn.drag",function(e){var n=$(e.currentTarget),o=_.toNumber($(t.currentTarget).attr("the-id")),r=_.toNumber(n.attr("the-id"));D&&(!h||h&&o!==r)&&n.addClass("row-highlight")}).on("mouseleave.abn.drag",function(e){D&&$(e.currentTarget).removeClass("row-highlight")}).on("mouseup.abn.drag",function(e){if(D){var n=$(e.currentTarget);n.removeClass("row-highlight");var o=_.toNumber($(t.currentTarget).attr("the-id")),s=_.toNumber(n.attr("the-id"));if(o&&s)if(h&&s!=o&&s!==p.branch.parentId){const e=l.getDirMap(i.userConfig.componentDirs),t=e[e[m].parentId],n=e[s],o=_.remove(t.children,function(e){return e.id==m})[0];o.parentId=s,n.children.push(o),i.saveConfig().then(function(e){i.$broadcast("node.list.reload"),r.pop("success","移动文件夹成功")},function(e){r.pop("error","移动文件夹失败, 网络错误")})}else h||a.changeDir(o,s).then(function(e){i.$broadcast("node.list.reload"),r.pop("success","移动组件成功")},function(e){r.pop("error","移动组件失败: "+e.msg)});else r.pop("error","移动组件失败")}}),I.on("mouseup.abn.drag",function(e){if(e.stopPropagation(),I.off(".abn.drag"),I.find(".abn-tree .droppable").off(".abn.drag"),D&&(D.hide(),D=null),o.includes("app.customize")||e.pageX<u){if(o.includes("app.customize")&&!h){if(s.componentId==m)return;(new Date).getTime()-d<=500&&o.go("app.customize",{componentId:m})}}else e.pageX>u&&("public_component"===f?n.addPublicRemoteNode(v,e.pageX,e.pageY,f):"my_component"===f?"dashboard"===b?n.addRemoteDashboardNode(v,e.pageX,e.pageY,f):n.addRemoteNode(v,e.pageX,e.pageY,f):"hufu_component"!==f&&"device_component"!==f||n.addExternalNode(p.branch,e.pageX,e.pageY,f))})}},null!=c.treeControl&&angular.isObject(c.treeControl)?((C=c.treeControl).expand_all=function(){return g(function(e,t){return e.expanded=!0})},C.collapse_all=function(){return g(function(e,t){return e.expanded=!1})},C.get_first_branch=function(){if((b=c.treeData.length)>0)return c.treeData[0]},C.select_first_branch=function(){let e;return e=C.get_first_branch(),C.select_branch(e)},C.get_selected_branch=function(){return x},C.get_parent_branch=function(e){return v(e)},C.select_branch=function(e){return w(e),e},C.get_children=function(e){return e.children},C.select_parent_branch=function(e){let t;if(null==e&&(e=C.get_selected_branch()),null!=e&&null!=(t=C.get_parent_branch(e)))return C.select_branch(t),t},C.add_branch=function(e,t){return null!=e?(e.children.push(t),e.expanded=!0):c.treeData.push(t),t},C.add_root_branch=function(e){return C.add_branch(null,e),e},C.expand_branch=function(e){if(null==e&&(e=C.get_selected_branch()),null!=e)return e.expanded=!0,e},C.collapse_branch=function(e){if(null==e&&(e=x),null!=e)return e.expanded=!1,e},C.get_siblings=function(e){let t,n;if(null==e&&(e=x),null!=e)return n=(t=C.get_parent_branch(e))?t.children:c.treeData},C.get_next_sibling=function(e){let t,n;if(null==e&&(e=x),null!=e&&(n=C.get_siblings(e),b=n.length,(t=n.indexOf(e))<b))return n[t+1]},C.get_prev_sibling=function(e){let t,n;if(null==e&&(e=x),n=C.get_siblings(e),b=n.length,(t=n.indexOf(e))>0)return n[t-1]},C.select_next_sibling=function(e){let t;if(null==e&&(e=x),null!=e&&null!=(t=C.get_next_sibling(e)))return C.select_branch(t)},C.select_prev_sibling=function(e){let t;if(null==e&&(e=x),null!=e&&null!=(t=C.get_prev_sibling(e)))return C.select_branch(t)},C.get_first_child=function(e){let t;if(null==e&&(e=x),null!=e&&(null!=(t=e.children)?t.length:void 0)>0)return e.children[0]},C.get_closest_ancestor_next_sibling=function(e){let t,n;return null!=(t=C.get_next_sibling(e))?t:(n=C.get_parent_branch(e),C.get_closest_ancestor_next_sibling(n))},C.get_next_branch=function(e){let t;if(null==e&&(e=x),null!=e)return null!=(t=C.get_first_child(e))?t:t=C.get_closest_ancestor_next_sibling(e)},C.select_next_branch=function(e){let t;if(null==e&&(e=x),null!=e&&null!=(t=C.get_next_branch(e)))return C.select_branch(t),t},C.last_descendant=function(e){let t;return 0===(b=e.children.length)?e:(t=e.children[b-1],C.last_descendant(t))},C.get_prev_branch=function(e){let t,n;if(null==e&&(e=x),null!=e)return null!=(n=C.get_prev_sibling(e))?C.last_descendant(n):t=C.get_parent_branch(e)},C.select_prev_branch=function(e){let t;if(null==e&&(e=x),null!=e&&null!=(t=C.get_prev_branch(e)))return C.select_branch(t),t}):void 0}}}])}.call(this),angular.module("app").directive("logview",["$state","remoteService","$parse","logService","$stateParams","$rootScope",function(e,t,n,o,r,i){return{restrict:"EA",templateUrl:"/tpl/blocks/logview.html",scope:{logNodeId:"@"},link:function(t,r,i){let a=n(i.logId)(t.$parent),s=0,l=r.find(".logview-content"),c=!1,p=0,u=0,d=function(){c||(0===p||e.includes("app.exp.run")||e.includes("app.exp.history")||e.includes("app.predict.run"))&&o.getLog(a,s).then(function(e){if(!c){if(p++,"reload"===e)return 0,s=0,u=0,l.html(""),void setTimeout(function(){d()},1e3);if(e){"minio"===window.appConfig.ossType&&e.text&&(e.text=e.text.substr(u),u+=e.text.length);let t=!0;l.scrollTop()+l.height()+10<l.get(0).scrollHeight&&(t=!1),s=e.nextLogPosition;let n=e.text.split("\n"),o="",r=0;for(let e=0;e<n.length;e++)o+=n[e]+"\n",(++r>=5||e===n.length-1)&&(l.append("<div>"+o.substr(0,o.length-1)+"</div>"),o="",r=0,l.children().length>=200&&l.find(":first-child").remove());t&&l.animate({scrollTop:l.get(0).scrollHeight},500)}setTimeout(function(){d()},1e3)}})};d(),t.$on("$destroy",function(){c=!0})}}}]),angular.module("app").directive("numberOnly",[function(){return{require:"ngModel",link:function(e,t,n,o){o.$parsers.push(function(e){return e+""})}}}]).directive("onFinishRender",["$timeout",function(e){return{restrict:"A",link:function(t,n,o){!0===t.$last&&e(function(){t.$emit("ngRepeatFinished")})}}}]),angular.module("app").directive("labelEditor",["$timeout","$parse",function(e,t){return{restrict:"AE",templateUrl:"/tpl/blocks/label_editor.html",replace:!0,scope:{required:"=",title:"="},link:function(t,n,o){t.editing=!1,t.onClick=function(){t.editing=!0,e(function(){n.find("input")[0].focus()})},t.onKeyup=function(e){13==e.keyCode&&(t.editing=!1)}}}}]).directive("inputKeyValue",["$timeout","$parse",function(e,t){return{restrict:"AE",template:'<div class="sp-keyvalue"><button type="button" class="btn btn-xs btn-primary" ng-disabled="readOnly" ng-click="addKeyValue()"><i class="iconfont iconadd"></i></button><div><div class="input-group" ng-if="list" ng-repeat="item in list"><input type="text" class="form-control" ng-model="item.key" placeholder="键" ng-disabled="readOnly" ng-change="handleChange()" /><input type="text" class="form-control" ng-model="item.value" placeholder="值" ng-disabled="readOnly" ng-change="handleChange()" /><button type="button" class="btn-dashed danger input-group-addon" ng-disabled="readOnly" ng-click="removeKeyValue($index)"><i class="iconfont iconminus"></i></button></div></div></div>',replace:!0,scope:{data:"="},link:function(e,t,n){let o=_.isEmpty(e.data)?{"":""}:JSON.parse(e.data);e.list=_.keys(o).map(function(e){return{key:e,value:o[e]}}),e.removeKeyValue=function(t){e.list.splice(t,1)},e.addKeyValue=function(){e.list.push({key:"",value:""})},e.handleChange=function(){let t={};_.forEach(e.list,function(e){t[e.key]=e.value}),e.data=JSON.stringify(t)}}}}]).directive("startingHtml",[function(){return{template:"<div class='toaster-starting'>{{directiveData.title}}{{dynamicDirectiveData}}<span class='dotting'></span></div>"}}]).directive("whenScrolled",function(){return function(e,t,n){let o=t[0];t.bind("scroll",function(){o.scrollTop+o.offsetHeight>=o.scrollHeight&&e.$apply(n.whenScrolled)})}}).directive("proportion",function(){return{restrict:"E",replace:!0,template:'<div class="proportion-chart"><span ng-repeat="(key, val) in data" style="width: {{ val > 0 ? val * 100 : 0 }}%">{{w}}</span></div>',scope:{data:"="}}}).directive("selectLine",function(){return function(e,t){t.bind("focus",function(){this.select()})}}).directive("echartBar",function(){return{restrict:"E",replace:!0,template:'<div class="proportion-bar" id="proportion-bar"></div>',scope:!0,link:function(e,t,n){let o=document.getElementById("proportion-bar"),r=echarts.init(o),i=_.keys(e.barData),a=_.values(e.barData);r.setOption({xAxis:{type:"category",data:i},yAxis:{type:"value"},grid:{top:20,right:10,bottom:10,left:10,containLabel:!0},series:{type:"bar",barWidth:"40%",itemStyle:{color:"rgba(0,0,0,0)",borderColor:"#8800ff",borderWidth:"2px",barBorderRadius:[6,6,0,0]},data:a}})}}}).directive("abnTreeTooltip",["$timeout",function(e){return{restrict:"AE",template:'<div class="abn-tree-row-tooltip" ng-style="tooltipStyle">{{tooltipContent}}</div>',replace:!0,scope:{name:"=",disabled:"=",size:"@",onChange:"&"},link:function(t,n,o){let r;t.tooltipStyle={};angular.element(".navi").on("mouseenter",".abn-tree .leaf a",function(n){n.stopPropagation();const o=n.currentTarget.querySelector(".tree-label").innerText;if(function(e){for(var t,n=0,o=0;o<e.length;o++)(t=e.charCodeAt(o))<127?n++:n+=128<=t&&t<=2047?2:2048<=t&&t<=65535?3:4;return n}(o)>18){var i=n.clientX,a=n.clientY-50-40;t.tooltipContent=o,r||(r=e(function(){t.tooltipStyle.top=a,t.tooltipStyle.left=i,t.tooltipStyle.opacity=1},1e3))}}),angular.element(".navi").on("mouseleave",".abn-tree .leaf a",function(n){n.stopPropagation(),r&&(e.cancel(r),r=null,t.tooltipStyle.opacity=0,t.$apply())})}}}]).directive("spSwitch",["$timeout","$parse",function(e,t){return{restrict:"AE",templateUrl:"/tpl/blocks/sp_switch.html",replace:!0,scope:{disabled:"=",checked:"=",size:"@",onClick:"&",onChange:"&"},link:function(e,t,n){e.className=e.size?"sp-switch-"+e.size:"",t.on("click","input",function(t){e.checked=t.target.checked,e.onClick&&e.onClick()}),t.on("change","input",function(){e.onChange&&e.onChange()})}}}]).directive("spAlert",["$timeout",function(e){return{restrict:"AE",template:'<div class="sp-alert" ng-hide="!alertData || !alertData.message" ng-class="getClass()"><i class="iconfont iconjingshi"></i>{{alertData.message}}</div>',replace:!0,scope:{size:"@",alertData:"=",fadeOut:"=",delaySeconds:"="},link:function(t,n,o){t.$watch("alertData",function(n){n&&t.fadeOut&&e(function(){t.alertData.message=null},1e3*(t.delaySeconds||1))}),t.getClass=function(){let e=[];const n=_.get(t.alertData,"type");return n?e.push("sp-alert-"+n):e.push("sp-alert-info"),t.size&&e.push("sp-alert-"+t.size),e.join(" ")}}}}]).directive("spChecked",[function(){return{restrict:"AE",template:'<svg version="1.1" xmlns="http://www.w3.org/2000/svg"> <circle fill="none" stroke-linecap="round" ></circle> <polyline fill="none" stroke-linejoin="round" stroke-linecap="round" /></svg>',scope:{size:"=",r:"=",stroke:"=",strokeWidth:"=",loading:"="},link:function(e,t,n){let o=.8;const r=e.size/2,i=e.size/2;e.circum=2*e.r*Math.PI,e.dasharray=e.circum+" "+e.circum;const a=t.children("svg"),s=angular.element(a.find("circle")[0]),l=angular.element(a.find("polyline")[0]);a.attr("width",e.size),a.attr("height",e.size),s.attr("cx",r),s.attr("cy",i),s.attr("r",e.r),s.attr("stroke-width",e.strokeWidth),s.attr("stroke-dasharray",e.dasharray),s.attr("stroke-dashoffset",e.circum-o*e.circum),l.attr("stroke-width",e.strokeWidth);let c=1;const p=[[r-e.r/3,i-e.r/6],[r,i+e.r/4],[r+4*e.r/5,i-2*e.r/3]];l.attr("points",p.map(e=>e.join(",")).join(" "));const u=Math.sqrt(Math.pow(p[1][0]-p[0][0],2)+Math.pow(p[1][1]-p[0][1],2))+Math.sqrt(Math.pow(p[2][0]-p[1][0],2)+Math.pow(p[2][1]-p[1][1],2));let d;function f(){d=requestAnimationFrame(function(){s.attr("stroke-dashoffset",e.circum-o*e.circum),window.cancelAnimationFrame(d),d=null,o<.8?(o+=.02,f()):(o=0,function e(){d=requestAnimationFrame(function(){l.attr("stroke-dashoffset",u-c*u),window.cancelAnimationFrame(d),d=null,c<1?(c+=.05,e()):c=0})}())})}l.attr("stroke-dasharray",u+" "+u),l.attr("stroke-dashoffset",u-c*u),e.$watch("loading",function(t){t&&(o=0,c=0,s.attr("stroke-dashoffset",e.circum-o*e.circum),l.attr("stroke-dashoffset",u-c*u),f())})}}}]).directive("spIconpicker",["toaster","appDataStoreService","$stateParams","format","$timeout",function(e,t,n,o,r){return{restrict:"AE",template:'<div class="sp-iconpicker-wrapper"><div class="sp-iconpicker" uib-dropdown> <button type="button" ng-disabled="disabled" class="sp-iconpicker-toggle" uib-dropdown-toggle><i ng-if="!iconUrl" class="iconfont" ng-class="getIcon()"></i>{{log(iconUrl)}}<span ng-if="iconUrl" class="sp-iconpicker-image-wrapper"><img class="sp-iconpicker-image" ng-src="{{::iconUrl}}" /></span></button><ul class="dropdown-menu" uib-dropdown-menu><li class="dropdown-item" ng-repeat="item in builtIn"><a ng-click="onChange(item);"><i class="iconfont icon{{::item}}"></i></a></li><li class="dropdown-item" ng-repeat="item in iconImages"><a ng-if="item" ng-click="onChange(item.key);"><img class="sp-iconpicker-image" ng-src="{{::item.url}}" /></a></li></ul></div><span class="sp-iconpicker-custom" ng-class="{disabled: disabled}" ng-click="onClickCustom()"><input class="sp-iconpicker-input" type="file" multiple="multiple" ng-disabled="disabled" />自定义</span></div>',replace:!0,scope:{selectedIcon:"=",builtIn:"=",iconImages:"=",disabled:"=",onChange:"=",onUploadSuccess:"="},link:function(r,i,a){const s=i.find(".sp-iconpicker-input"),l=n.componentId?"studio/{{userId}}/component/{{componentId}}/icons/":"studio/{{userId}}/{{appId}}/icons/",c=o(l);r.getIcon=function(){return"icon"+r.selectedIcon},r.$watch("selectedIcon",function(e){r.iconUrl=null,_.isString(e)&&e.indexOf("studio/")>-1&&t.url(e).then(function(e){r.iconUrl=e.data})}),r.onClickCustom=function(){s[0].click()},s.on("change",function(n){const o=_.values(n.target.files),i=o.length;let a=0;const s=function(e){a<i?l(o[a]):(i==a&&e&&r.onChange(c+e),r.onUploadSuccess())},l=function(n){a++,-1==n.type.indexOf("image/")?(e.pop("error",n.name+"不是图片！"),a<i&&l(o[a])):n.size>81920?e.pop("error",n.name+" 上传失败，图片大于80K"):t.upload(c+n.name,n,function(e){},function(t){e.pop("error",n.name+" 上传失败"),s()},function(t){e.pop("success",n.name+" 上传成功"),s(n.name)})};l(o[a])})}}}]),angular.module("app").directive("traitsSection",[function(){return{replace:!0,templateUrl:"/tpl/custom/panels/setting.html",link:function(e,t,n,o){e.isShowSettingProperties=!0,e.isShowAdvSettingProperties=!1}}}]),angular.module("app").directive("stopKeyEvent",function(){return{restrict:"A",link:function(e,t,n){t.on("keydown",function(e){e.stopPropagation()}),t.on("keyup",function(e){e.stopPropagation()})}}}),angular.module("app").directive("spUploader",["appDataStoreService","format","$stateParams","common",function(e,t,n,o){return{restrict:"EA",templateUrl:"/tpl/blocks/spuploader.html",scope:{title:"=",controlInstUuid:"=",type:"=",out:"=",fileName:"=",nodeType:"=",separator:"=",btnDisabled:"=",fileUploading:"=",fileUploadFailed:"=",allFileUploadFinish:"=",fileUploadSuccess:"=",fileUploadPath:"=",readOnly:"=",singleFile:"=",uuidFile:"="},link:function(r,i,a){const s=_.cloneDeep({title:r.title,type:r.type,controlInstUuid:r.controlInstUuid,out:r.out,separator:r.separator,fileName:r.fileName});let l=null,c=null,p=0,u=10;const d={"{{userId}}":window.appConfig.userId,"{{appId}}":n.id,"{{nodeId}}":n.nodeId};function f(){r.files=[],r.title=s.title,r.type=s.type,r.controlInstUuid=s.controlInstUuid,r.out=s.out,r.separator=s.separator,r.fileName=s.fileName,p=0,c=t(r.fileUploadPath,d)}function h(e){if(l=_.values(e.target.files),r.total=l.length,r.total){for(r.$apply(function(){r.files=_.values(l).map(function(e){return{name:e.name,size:e.size,type:e.type}})}),p=0;p<Math.min(u,r.total);p++)g(l[p],p);p--}e.target.value=""}r.files=[],r.total=0,$(".btn-uploader").on("click",".input-upload",f),$(".btn-uploader").on("change",".input-upload",h);const m=function(){++p<r.total?g(l[p],p):r.allFileUploadFinish&&r.allFileUploadFinish(r.fileUploadPath,r.controlInstUuid)};let g=function(t,n){let i=t.name.lastIndexOf("."),a="";i>0&&(a=t.name.slice(i+1).toLowerCase());let s=t.name;if(_.isEmpty(t.webkitRelativePath)||(s=t.webkitRelativePath),function(e,t){switch(r.type){case"txt":case"csv":return e==r.type;case"excel":return e.indexOf("xls")>-1;case"images":case"image":return 0===t.indexOf("image/");default:return!0}}(a,t.type)){let l=s;"21"==r.nodeType&&("csv"==r.type||"txt"==r.type?l="data."+r.type:"excel"==r.type&&(l="data."+a)),r.uuidFile&&(l=a?l.slice(0,i)+"-"+o.uuid()+"."+a:l+"-"+o.uuid()),r.fileName&&(l=r.fileName);let p=c+l;e.upload(p,t,function(e){let t=Math.round(e.loaded/e.total*100)+"%";r.$apply(function(){r.files[n].msg=t})},function(e){r.$apply(function(){r.files[n].status="failed",r.files[n].msg="上传失败"}),r.fileUploadFailed&&r.fileUploadFailed(s),m()},function(e){r.$apply(function(){r.files[n].status="success",r.files[n].msg="上传成功"}),r.fileUploadSuccess&&r.fileUploadSuccess(p),m()}).then(function(e){},function(e){r.$apply(function(){r.files[n].status="error",r.files[n].msg=_.get(e,"msg")}),m()})}else r.$apply(function(){r.files[n].msg="类型不匹配",r.files[n].status="error"}),m()};r.$on("$destroy",function(){$(".btn-uploader").off("click",".input-upload",f),$(".btn-uploader").off("change",".input-upload",h)})}}}]),angular.module("app").directive("spResizeTrigger",[function(){return{restrict:"EA",template:'<span class="sp-resize-trigger" ng-class="className"></span>',replace:!0,scope:{className:"@",dragArrow:"@"},link:function(e,t,n){var o,r,i=n.dragArrow,a=!1,s=null,l=null,c=angular.element("#edit"),p=angular.element(t).parents(".sp-resizable");let u,d;var f,h,m,g,v,b,y;e.getClass=function(){return n.className},t.on("mousedown",function(e){return a=!0,"vertical"!=i?(s=e.screenX,o=c.width(),r=c.offset().left,f=angular.element(".sp-toggle"),u=angular.element(".sp-app-aside"),d=angular.element(".sp-app-right")):(s=e.screenY,g=angular.element(e.target),h=g.prev(),m=g.next(),v=h.height(),b=m.height()),!1}),c.on("mouseup",function(e){a=!1,"vertical"!=i?(s=e.screenX,f=null):s=e.screenY}),c.on("mousemove",function(e){var t;a&&(l=e.pageX,"left"==i?(t=o+r-l)>=250&&l>u.width()+u.offset().left+92&&(f.css({right:t+16+"px"}),p.width(t)):"right"==i?(t=l-r)>=250&&l<d.offset().left-92&&p.width(t):"vertical"==i&&(y=e.pageY-s,v+y>84&&b-y>40&&(h.height(v+y),m.height(b-y),g.css("top",v+y))))})}}}]),angular.module("app").directive("uiDraggableModal",["$document","$timeout",function(e,t){return{restrict:"EA",link:function(n,o,r){let i=0,a=0,s=!1,l=0,c=0,p=o.parent(),u=null;for(u=p;u&&!u.hasClass("modal");u=u.parent());function d(e){c=e.pageY-a,l=e.pageX-i,s&&u&&u.css({top:c+"px",left:l+"px"})}function f(){s=!1,e.unbind("mousemove",d),e.unbind("mouseup",f)}p=u.find(".modal-header"),t(function(){u&&(l=u.position().left,c=u.position().top)}),p.on("mousedown",function(t){t.preventDefault(),i=t.pageX-l,a=t.pageY-c,s=!0,e.on("mousemove",d),e.on("mouseup",f)})}}}]),(app=angular.module("app")).constant("app",{version:"0.6.0"}).constant("NODEICONS",["cube","microchip","flask","globe","chart-area","strikethrough","shekel-sign","random","signature","adjust","atlas","blanket","bong","burn","chart-line","clone","cloud-upload-alt","code-branch","code-commit","cog","coins","compass","conveyor-belt","database","exchange","fingerprint","fire","gem","link","retweet","server","shield-check","vial","vials"]).config(["$stateProvider",function(e){let t="app.exp";const n=_.find(appConfig.appMenu,function(e){return _.has(e,"route")&&e.visible});n&&(t="app."+n.route),e.state("app",{url:"/web",deepStateRedirect:{default:{state:t,params:{type:null,id:null}},params:!0},resolve:{userConfig:["userService","$q",function(e,t){const n=t.defer();return e.getConfig().then(function(e){n.resolve(e)}),n.promise}]},views:{"comps@app":{templateUrl:"/tpl/app/sp_app_comps.html",controller:"compsController"},"nodes@app":{templateUrl:"/tpl/app/sp_app_nodes.html",controller:"nodesController"},"":{templateUrl:"/tpl/sp_app.html",controller:["$scope","$state","$stateParams","$timeout","appDataStoreService","$rootScope","userService","$uibModal","$q","common","$transitions","userConfig","componentService","$mdBottomSheet","nodeService","enabledUser","scriptService","hardwareService","remoteService","toaster","loopService","NODEICONS","format",function(e,t,n,o,r,i,a,s,l,c,p,u,d,f,h,m,g,v,b,y,w,x,C){window.userConfig=i.userConfig=u,window.SuanpanAPI.common.logout=i.logout=function(){b.post("/logout").then(function(e){if(e.success){var t=encodeURIComponent(location.protocol+"//"+location.host);switch(window.appConfig.getUserIdMethod){case"xuelang":var n=window.appConfig.loginHost+"/login?callback="+t;location.href=n;break;case"xuelangUserCenterV2":n=window.appConfig.loginHost+"/logout?callback="+t;location.href=n;break;case"xuelangUserCenterV3":n=window.appConfig.loginHost+"/api/logout";location.href=n;break;default:location.href="/"}}else err.msg},function(e){e.msg})},window.reactInit(),i.pageLoading=!1,i.sidebarCollapsed=!0,i.tagModel={},i.fullScreenImage={isFullScreen:!1,onShowScreenImage:function(e,t){e.stopPropagation(),_.isEmpty(t)||(i.fullScreenImage.isFullScreen=!0,i.fullScreenImage.src=t,o(function(){angular.element(".fullScreen").css("z-index",2e3)}))},onFullScreenExit:function(e){e.stopPropagation(),i.fullScreenImage.isFullScreen=!1}},e.onChangeLang=function(){if("en"===e.langConfig.code){e.langConfig={code:"zh-CN",text:"English Edition"};let t=document.getElementById(":1.container");if(t){let n=t.contentDocument.getElementById(":1.restore");n&&(n.click(),$cookies.put("sp_langCode",e.langConfig.code),$cookies.put("sp_langText",e.langConfig.text))}}else{e.langConfig={code:"en",text:"切换至中文版"};let t=document.getElementById(":0.targetLanguage");if(t){let n=t.childNodes[0];n&&(n.value="en",n.dispatchEvent(new CustomEvent("change")),$cookies.put("sp_langCode",e.langConfig.code),$cookies.put("sp_langText",e.langConfig.text))}}},e.componentAble="0"==window.appConfig.disableComponent,e.resetTabInfo=function(e,t){let n=_.filter(_.values(e),function(e){return e.isRequired&&!e.hidden}),o=_.filter(_.keys(t),function(e){return t[e].required});if(_.isEmpty(o)&&!_.isEmpty(n)||!_.isEmpty(o)&&_.isEmpty(n)){let e=_.map(n,"controlInstUuid");for(let n in t){let o=t[n].controls;if(!_.isEmpty(o)){let r=_.findIndex(o,function(t){return _.indexOf(e,t.uuid)>-1});t[n].required=r>-1}}}},e._dropdown={open:!1,menu:[],fetching:!1,handleGetList:function(){let e=this;v.post("list",{hwtype:"board"}).then(function(t){t.success?(e.fetching=!1,e.menu=_.map(t.data,function(e){return{id:e.id,name:(e.name||e.id)+"("+e.ip+")",ip:e.ip,state:e.state}})):e.fetching=!1},function(t){e.fetching=!1})}};let k=function(e,t){let n=0,o=e.length,r=function(i){n++;let a=i.getAttribute("xlink:href"),s=i.getAttribute("width"),l=i.getAttribute("height"),c=new Image;c.setAttribute("crossOrigin","anonymous"),c.onload=function(){let a=function(e,t,n){let o=document.createElement("canvas");return o.width=t,o.height=n,o.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t,n),o.toDataURL("image/png")}(c,s,l);i.setAttribute("xlink:href",a),n<o?r(e[n]):t()},c.src=a+"&timeout="+(new Date).getTime()};o?r(e[n]):t()};let S;i.screenshots=function(e,n,o){$("#screenShot").remove();let a=$("#editor").html();$("#editor").append(a).children(".the-graph-app:last").attr("id","screenShot");let s=$("#screenShot .app-svg .view"),l="dark"==i.current_bg?"#464856":"#f1f1f1";s.parent().attr("style","background-color: "+l),s.find(".port-label").attr("display","none"),s.find(".inports .arrow-bg").add(".inports .port-circle-bg").add(".outports .port-circle-bg").attr({fill:"#b3b3b3"}),s.find(".inports .port-circle-small").add(".outports .port-circle-small").attr({fill:"#fff"}),s.find(".outports .fill").attr({fill:"#b0b0b0"}),s.find(".eventcatcher").attr({fill:"none"}),s.find(".group-box").attr({fill:"rgba(255, 239, 138, 0.2)",stroke:"rgba(228, 215, 59, 0.8)"}),s.find(".node-icon.icon").attr({fill:"none",display:"none"}),s.find(".edge-icon:not(.block)").attr({display:"none"}),s.find(".edge").each(function(e,t){$(t).children().attr("fill","none").end().find(".stroke").attr("stroke","#a6a6a6")}),s.siblings(".tooltip").find(".tooltip-bg").attr("fill","none");let c=s.find("image");k(c,function(e,n,o){let i="studio/"+window.appConfig.userId+"/"+t.params.id+(e?"/"+e:"/screen_shot.png"),a=document.getElementById("screenShot"),s=a.offsetWidth,l=a.offsetHeight,c=a.querySelector(".view"),p=c.getBBox(),u=p.width,d=p.height,f=p.x,h=p.y,m=c.getAttribute("transform"),g=m.indexOf("(")+1,v=m.indexOf(","),b=Number(m.slice(g,v));if(u>s||d>l){let e=b,t=b;u>s&&(e=s/u),d>l&&(t=l/d),b=e<t?e:t}let y="matrix("+b+",0,0,"+b+","+-f*b+","+-h*b+")";c.setAttribute("transform",y);const w=function(e){Math.round(e.loaded/e.total*100)},x=function(e){},$=function(e){o&&o()};let C=Math.ceil(u*b),_=Math.ceil(d*b),k=a.querySelector(".app-svg"),S=new XMLSerializer,T="data:image/svg+xml,"+encodeURIComponent(S.serializeToString(k)),I=new Image;I.src=T,I.crossOrigin="anonymous",I.width=C,I.height=_,I.onload=function(){let e=document.createElement("canvas");e.width=C,e.height=_,e.getContext("2d").drawImage(I,0,0),a.remove(),e.toBlob(function(e){r.upload(i,e,w,x,$)})},n&&n()}.bind(this,e,n,o))},e.enable=m,e.doCreateComponent=function(e,n){n.stopPropagation(),d.create("未命名组件",void 0,e).then(function(e){d.setPermission(e.id).then(function(n){t.go("app.customize",{componentId:e.id})},function(n){t.go("app.customize",{componentId:e.id})}),t.includes("app.customize")&&i.$broadcast("node.list.reload")})},i.saveConfig=function(){let t=l.defer(),n=c.getDirList(e.userConfig.appDirs);angular.forEach(n,function(e){angular.forEach(e,function(t,n){["id","label","folder","children"].indexOf(n)<0&&delete e[n]})});let o=c.getDirList(e.userConfig.componentDirs);angular.forEach(o,function(e){angular.forEach(e,function(t,n){["id","label","folder","children"].indexOf(n)<0&&delete e[n]})});let r=angular.copy(e.userConfig);return a.saveConfig(r).then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise},i.addFolder=function(e,t){S=s.open({backdrop:"static",animation:!0,templateUrl:"/tpl/custom/popup/addFolder.html",controller:["$scope","$rootScope","toaster","common",function(n,o,r,i){n.title="新增文件夹",n.name="新文件夹",n.ok=function(){if(n.loading)return;let a;if(n.loading=!0,"app"===t?a=i.getDirMap(n.userConfig.appDirs):"component"===t?a=i.getDirMap(n.userConfig.componentDirs):"predict"===t?a=i.getDirMap(n.userConfig.predictDirs):"rpa"===t&&(a=i.getDirMap(n.userConfig.rpaDirs)),!a)return n.loading=!1,void r.pop("error","新增文件夹失败");let s=3;for(let e in a)s<parseInt(e,10)&&(s=parseInt(e,10));let l=s+1,c=a[e];c.children||(c.children=[]),c.children.push({id:l,label:n.name,folder:!0,children:[]}),n.saveConfig().then(function(e){"app"===t?o.$broadcast("app.list.reload",{}):"component"===t?o.$broadcast("node.list.reload"):"predict"===t?o.$broadcast("predict.list.reload",{}):"rpa"===t&&o.$broadcast("rpa.list.reload",{}),S.close(),r.pop("success","新增文件夹成功")},function(e){r.pop("error","新增文件夹失败, 网络错误")}).finally(function(){n.loading=!1})},n.cancel=function(){S.close()},n.$on("modal.closing",function(e,t){S=void 0})}],size:"md",appendTo:""})},i.removeFolder=function(e,n,o,r,i){S=s.open({templateUrl:"/tpl/custom/popup/alert.html",controller:["$scope","$rootScope","common","componentService","toaster",function(a,s,l,c,p){a.alertTitle=i?"删除文件夹":"批量删除",a.alertIcon="iconfont iconjinggao text-danger";const u=l.getDirMap(a.userConfig[n+"Dirs"]),d=_.get(u[e],"parentId"),f=u[d],h=l.getDirMap(r),m=h[e];if(_.isEmpty(m))return void p.pop("error","该文件夹不存在");const g=_.filter(m.children,function(e){return!e.folder}),v=_.filter(m.children,function(e){return e.folder}),b=_.isEmpty(v)||-1==_.findIndex(v,function(e){return e.children.length});a.alertBody=i?b?"删除文件夹 ‘"+o+"’ 吗?":"文件夹 ‘"+o+"’ 中有非空目录，请先删除！":"文件夹 ‘"+o+"’ 中没有可删除的组件。",g.length&&(a.alertBody=i?"文件夹 ‘"+o+"’ 不为空，请先删除其中的组件！":"批量删除文件夹 ‘"+o+"’ 中的组件",a.moreLabel="全部组件：",a.more={hide:!1,toggle:!1},a.selected={all:!1},a.siblings=m&&_.filter(m.children,function(e){return!e.folder}),a.onChangeAll=function(){_.forEach(a.siblings,function(e){e.selected=a.selected.all})});const y=function(){angular.forEach(f.children,function(t,n){t.id===e&&f.children.splice(n,1)}),a.saveConfig().then(function(e){s.$broadcast("node.list.reload"),S&&S.close(),p.pop("success","文件夹 ‘"+o+"’ 已被删除")},function(e){p.pop("error","文件夹 ‘"+o+"’ 删除失败, 网络错误"),S&&S.close()}).finally(function(){a.loading=!1})};a.ok=function(){const e=a.siblings&&_.filter(a.siblings,{selected:!0});if(_.isEmpty(e))_.isEmpty(g)&&b&&i?y():b||S.close();else{if(a.loading)return;a.loading=!0,c.removeList(e).then(function(e){const n=_.filter(e,{removed:!1}),r=_.filter(e,{removed:!0}),l=_.findIndex(r,{id:t.params.componentId})>-1;if(l){let e=_.find(a.siblings,function(e){return!e.selected});e||(e=d&&h[d]&&_.find(h[d].children,function(e){return!e.folder})),t.go("app.customize",{componentId:e.id})}p.pop("success","组件 "+_.map(r,"label").join("、")+" 已被删除"),_.isEmpty(n)?b&&i?y():(i&&p.pop("warning","文件夹 ‘"+o+"’ 中有非空目录，请先删除！"),!l&&s.$broadcast("node.list.reload")):p.pop("error","组件 "+_.map(n,"label").join("、")+" 删除失败"),S.close()}).finally(function(){a.loading=!1})}},a.cancel=function(){S.close()},a.$on("modal.closing",function(e,t){S=void 0})}],size:"sm",appendTo:""})},i.renameFolder=function(e,t,n){S=s.open({backdrop:"static",animation:!0,templateUrl:"/tpl/custom/popup/rename.html",controller:["$scope","toaster",function(o,r){o.renameTitle="重命名文件夹",o.renameNameTitle="名称",o.renameName=n,o.ok=function(){if(o.renameLoading)return;let n;return o.renameLoading=!0,"app"===t?n=c.getDirMap(o.userConfig.appDirs):"component"===t?n=c.getDirMap(o.userConfig.componentDirs):"predict"===t?n=c.getDirMap(o.userConfig.predictDirs):"rpa"===t&&(n=c.getDirMap(o.userConfig.rpaDirs)),o.renameName?n&&n[e]?(n[e].label=o.renameName,void o.saveConfig().then(function(e){"app"===t?i.$broadcast("app.list.reload",{}):"component"===t?i.$broadcast("node.list.reload"):"predict"===t?i.$broadcast("predict.list.reload",{}):"rpa"===t&&i.$broadcast("rpa.list.reload",{}),S.close(),r.pop("success","重命名文件夹成功")},function(e){r.pop("error","重命名文件夹失败, 网络错误")}).finally(function(){o.renameLoading=!1})):(o.renameLoading=!1,void r.pop("error","重命名文件夹失败")):(o.renameLoading=!1,void r.pop("error","重命名文件夹失败: 名称不能为空"))},o.cancel=function(){S.close()},o.$on("modal.closing",function(e,t){S=void 0})}],size:"md",appendTo:""})},i.removeMultiNodes=function(e,t){S=s.open({animation:!0,templateUrl:"/tpl/custom/popup/alert.html",controller:["$scope","$state","nodeService","toaster",function(n,o,r,a){n.alertTitle="删除节点",n.alertIcon="iconfont iconjinggao text-danger";const s=_.map(e,"metadata.label");n.alertBody='确定删除节点 "'+s.join("；")+'" 吗?',n.ok=function(){n.loading||(n.loading=!0,n.alertBody="正在删除",_.forEach(e,function(e){r.removeNode(e.id),i.removedNodes.push(angular.copy(e))}),S.close(),o.go(t))},n.cancel=function(){S.close()},n.$on("modal.closing",function(){S=void 0})}],size:"sm",appendTo:""})},i.removeNode=function(e,t){const n=g.idNodeDeletable(e.id);S=s.open({animation:!0,templateUrl:"/tpl/custom/popup/alert.html",controller:["$scope","$state","nodeService","toaster",function(o,r,a,s){o.alertTitle="删除节点",o.alertIcon="iconfont iconjinggao text-danger",o.alertBody=n?'确定删除节点 "'+e.metadata.label+'" 吗?':'节点 "'+e.metadata.label+'" 的连线有自定义脚本，确定删除吗?',o.ok=function(){!n&&g.removeScriptByNode(e.id),a.removeNode(e.id),i.removedNodes.push(angular.copy(e)),t&&r.go(t),S.close()},o.cancel=function(){S.close()},o.$on("modal.closing",function(){S=void 0})}],size:"sm",appendTo:""})},i.removeGroup=function(e,t){S=s.open({animation:!0,templateUrl:"/tpl/custom/popup/alert.html",controller:["$scope","$state","nodeService","toaster",function(n,o,r,i){n.alertTitle="删除组合",n.alertIcon="iconfont iconjinggao text-danger",n.alertBody="确定删除组合 “"+e.metadata.name+"” 及其中的所有节点和连线吗？删除后不可恢复！",n.ok=function(){r.removeGroup(e.name),_.forEach(e.nodes,function(e){r.removeNode(e)}),t&&o.go(t),S.close()},n.cancel=function(){S.close()},n.$on("modal.closing",function(){S=void 0})}],size:"sm",appendTo:""})},i.removeEdge=function(e,n){g.isEdgeDeletable(e)?S=s.open({animation:!0,templateUrl:"/tpl/custom/popup/alert.html",controller:["$scope","$state","nodeService",function(t,o,r){t.alertTitle="删除连线",t.alertIcon="iconfont iconjinggao text-danger",t.alertBody="该连线包含自定义脚本，确定删除吗?",t.ok=function(){t.loading||(t.loading=!0,g.removeScriptByEdge(e),r.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port),n&&o.go(n))},t.cancel=function(){S.close()},t.$on("modal.closing",function(){S=void 0})}],size:"sm",appendTo:""}):(g.removeScriptByEdge(e),h.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port),n&&t.go(n))},i.handleResetContext=function(e,n,o){if(!o&&i.appConfig._context==appConfig.env||_.get(i.appConfig,"_board.id")==_.get(o,"id"))return;const r="app."+_.split(e,".")[1];if(o){if(e.indexOf("app.predict.run")>-1)return void y.pop("info","请先释放再切换到边缘端");i.appConfig._context="hardware"}else i.appConfig._context=appConfig.env;i.appConfig._board=o,t.go(r,{type:n.type,id:n.id,refresh:n.refresh+1})},i.showRunHistory=function(t){e.alert="",f.show({templateUrl:"/tpl/custom/popup/runHistory.html",controller:["$rootScope","$scope","appService","$mdBottomSheet",function(e,n,o,r){n.loading=!1,n.loaded=!1,n.data={data_:[],getItemAtIndex:function(e){return e>=this.data_.length?(this.fetchMoreItems_(e),null):this.data_[e]},getLength:function(){return 0===this.data_.length?0:n.loaded?this.data_.length:this.data_.length+5},fetchMoreItems_:function(e){n.loading||n.loaded||(n.loading=!0,o.listCron(t,40,this.data_.length).then(angular.bind(this,function(e){if(n.loading=!1,e&&e.list){if(0===e.list.length)return void(n.loaded=!0);for(let t=0;t<e.list.length;t++)e.list[t].cron_config=JSON.parse(e.list[t].cron_config);this.data_=this.data_.concat(e.list)}}),angular.bind(this,function(e){})))}},n.winH=$(window).height()-92,$(window).on("resize.showRunHistory",function(){n.winH=$(window).height()-92,e.$$phase||e.$apply()}),n.close=function(){r.hide()},n.$on("$destroy",function(){$(window).off("resize.showRunHistory")})}],clickOutsideToClose:!0,escapeToClose:!0}).then(function(e){}).catch(function(e){})},i.runSchedule=function(e,t){let n=h.getNode(t).metadata.label;S=s.open({backdrop:"static",animation:!0,templateUrl:"/tpl/custom/popup/schedule.html",controller:["$scope","$state","$rootScope","nodeService","appService","toaster","statisticsService",function(o,r,i,a,s,l,c){const p=function(e){switch(e){case"day":return{startHour:0,startMinute:0};case"week":case"month":return{startHour:0,startMinute:0,targetDays:""};case"minute":return{startHour:0,startMinute:0,endHour:23,endMinute:59,intervalMinute:5};case"hour":return{startHour:0,startMinute:0,endHour:23,endMinute:59,intervalHour:1}}};let u=function(){return moment().toISOString()};o.updateStartEffectTime=function(){moment(o.cronConfig.startEffectTime).unix(),moment().unix(),moment(o.cronConfig.startEffectTime).unix()<moment().unix()&&(o.cronConfig.startEffectTime=u()),o.minDate=new Date(u())},o.cronConfig=a.getCronConfig()||{period:"day",runType:"runStart",startEffectTime:u(),endEffectTime:moment().add(1,"year").toISOString(),config:p("day")},o.cronConfig.nodeId=t,o.updateStartEffectTime(),o.$watch("cronConfig.period",function(e,t){e!==t&&(o.cronConfig.config=p(e))}),o.a={},o.a.nodeLabel=n,o.a.monthDayList=[{name:"1号",value:1},{name:"2号",value:2},{name:"3号",value:3},{name:"4号",value:4},{name:"5号",value:5},{name:"6号",value:6},{name:"7号",value:7},{name:"8号",value:8},{name:"9号",value:9},{name:"10号",value:10},{name:"11号",value:11},{name:"12号",value:12},{name:"13号",value:13},{name:"14号",value:14},{name:"15号",value:15},{name:"16号",value:16},{name:"17号",value:17},{name:"18号",value:18},{name:"19号",value:19},{name:"20号",value:20},{name:"21号",value:21},{name:"22号",value:22},{name:"23号",value:23},{name:"24号",value:24},{name:"25号",value:25},{name:"26号",value:26},{name:"27号",value:27},{name:"28号",value:28},{name:"29号",value:29},{name:"30号",value:30},{name:"31号",value:31}],o.a.weekDayList=[{name:"星期一",value:1},{name:"星期二",value:2},{name:"星期三",value:3},{name:"星期四",value:4},{name:"星期五",value:5},{name:"星期六",value:6},{name:"星期日",value:7}],o.a.minuteList=[{name:"5分钟",value:5},{name:"10分钟",value:10},{name:"15分钟",value:15},{name:"20分钟",value:20},{name:"25分钟",value:25},{name:"30分钟",value:30},{name:"35分钟",value:35},{name:"40分钟",value:40},{name:"45分钟",value:45},{name:"50分钟",value:50},{name:"55分钟",value:55}],o.a.hourList=[{name:"1小时",value:1},{name:"2小时",value:2},{name:"3小时",value:3},{name:"4小时",value:4},{name:"5小时",value:5},{name:"6小时",value:6},{name:"7小时",value:7},{name:"8小时",value:8},{name:"9小时",value:9},{name:"10小时",value:10},{name:"11小时",value:11},{name:"12小时",value:12},{name:"13小时",value:13},{name:"14小时",value:14},{name:"15小时",value:15},{name:"16小时",value:16},{name:"17小时",value:17},{name:"18小时",value:18},{name:"19小时",value:19},{name:"20小时",value:20},{name:"21小时",value:21},{name:"22小时",value:22},{name:"23小时",value:23}],o.a.startHourList=[{name:"00",value:0},{name:"01",value:1},{name:"02",value:2},{name:"03",value:3},{name:"04",value:4},{name:"05",value:5},{name:"06",value:6},{name:"07",value:7},{name:"08",value:8},{name:"09",value:9},{name:"10",value:10},{name:"11",value:11},{name:"12",value:12},{name:"13",value:13},{name:"14",value:14},{name:"15",value:15},{name:"16",value:16},{name:"17",value:17},{name:"18",value:18},{name:"19",value:19},{name:"20",value:20},{name:"21",value:21},{name:"22",value:22},{name:"23",value:23}],o.a.startMinuteList=[{name:"00",value:0},{name:"01",value:1},{name:"02",value:2},{name:"03",value:3},{name:"04",value:4},{name:"05",value:5},{name:"06",value:6},{name:"07",value:7},{name:"08",value:8},{name:"09",value:9},{name:"10",value:10},{name:"11",value:11},{name:"12",value:12},{name:"13",value:13},{name:"14",value:14},{name:"15",value:15},{name:"16",value:16},{name:"17",value:17},{name:"18",value:18},{name:"19",value:19},{name:"20",value:20},{name:"21",value:21},{name:"22",value:22},{name:"23",value:23},{name:"24",value:24},{name:"25",value:25},{name:"26",value:26},{name:"27",value:27},{name:"28",value:28},{name:"29",value:29},{name:"30",value:30},{name:"31",value:31},{name:"32",value:32},{name:"33",value:33},{name:"34",value:34},{name:"35",value:35},{name:"36",value:36},{name:"37",value:37},{name:"38",value:38},{name:"39",value:39},{name:"40",value:40},{name:"41",value:41},{name:"42",value:42},{name:"43",value:43},{name:"44",value:44},{name:"45",value:45},{name:"46",value:46},{name:"47",value:47},{name:"48",value:48},{name:"49",value:49},{name:"50",value:50},{name:"51",value:51},{name:"52",value:52},{name:"53",value:53},{name:"54",value:54},{name:"55",value:55},{name:"56",value:56},{name:"57",value:57},{name:"58",value:58},{name:"59",value:59}],o.ok=function(){o.loading||(o.loading=!0,o.updateStartEffectTime(),o.cronConfig.startEffectTime=moment(o.cronConfig.startEffectTime).toISOString(),o.cronConfig.endEffectTime=moment(o.cronConfig.endEffectTime).toISOString(),o.cronConfig,a.setCronConfig(o.cronConfig),i.doSave().then(function(t){s.startCron(e,angular.copy(o.cronConfig)).then(function(e){S.close(),l.pop("success","定时任务提交成功"),r.go("app.exp.cron")},function(e){l.pop("error","定时任务提交失败, "+e.msg)})},function(e){l.pop("error","定时任务提交失败, 网络错误")}).finally(function(){o.loading=!1}))},o.cancel=function(){S.close()},o.$on("modal.closing",function(e,t){S=void 0})}],size:"md",appendTo:""})},i.exportComponent=function(e,t){const n=function(e){S=s.open({backdrop:"static",animation:!0,templateUrl:"/tpl/custom/popup/alert.html",controller:["$scope","appDataStoreService",function(n,o){n.alertTitle="导出组件",n.alertIcon="iconfont iconxunwen text-primary",n.alertBody='组件 "'+t+'"已导出至云端，是否需要下载到本地?',n.confirmTitle="下载",o.url(e).then(function(e){n.download=e.data}),n.cancel=function(){S.close()},n.$on("modal.closing",function(e,t){S=void 0})}],size:"sm",appendTo:""})};d.export(e).then(function(e){w.fetchJob({title:"正在导出",type:"export"},e.job.id,d.getJob,n)},function(e){y.pop("error","导出失败")})},i.importComponent=function(e,t,n){S=s.open({backdrop:"static",animation:!0,templateUrl:"/tpl/custom/popup/import.html",controller:["$scope","$rootScope","common","toaster","componentService",function(o,r,i,a,s){o.importTitle="导入组件",o.importNameLabel="组件名称",o.importPath=i.getImportPath(appConfig.userId),o.imported={name:t||"未命名组件",componentId:e||"",dataPath:""},o.onFileUpload=function(e){o.imported.dataPath=e};const l=function(t){s.switch(t.compId,t.importFolderName).then(function(t){t.success&&(a.pop("success","导入组件成功"),w.fetchJob({title:"切换数据",type:"switch"},t.job.id,s.getJob,function(){_.isEmpty(e)&&r.$broadcast("node.list.reload")}),S.close())})};o.ok=function(){o.imported.loading||(o.imported.loading=!0,s.import(o.imported.name,o.imported.componentId,n,o.imported.dataPath).then(function(e){w.fetchJob({title:"正在导入",type:"import"},e.job.id,s.getJob,l)},function(e){a.pop("error","导入组件失败")}).finally(function(){o.imported.loading=!1}))},o.cancel=function(){S.close()},o.$on("modal.closing",function(e,t){S=void 0})}],size:"md",appendTo:""})},i.createComponent=function(e,t){S=s.open({backdrop:"static",animation:!0,templateUrl:"/tpl/custom/popup/create.html",controller:["$scope","$state","$rootScope","toaster","componentService","USER_CONFIG","COMPONENT_TYPES",function(n,o,r,i,a,s,l){n.createTitle="创建组件",n.createNameTitle="组件名称",n.created={name:"未命名组件",dir:e||s.myDirId,type:t},n.componentTypes=l,"customize"==t&&(n.created.type=_.get(r.currentApp,"appType")||"algo"),"predict"==n.created.type&&(n.created.type="service"),n.ok=function(){n.createLoading||(n.createLoading=!0,a.create(n.created.name,n.created.dir,n.created.type).then(function(e){i.pop("success","组件 “"+n.created.name+"” 创建成功"),a.setPermission(e.id).then(function(t){o.go("app.customize",{componentId:e.id},{reload:!0})},function(t){o.go("app.customize",{componentId:e.id},{reload:!0})}),o.includes("app.customize")&&r.$broadcast("node.list.reload"),S.close()},function(e){i.pop("error","创建失败: "+e.msg)}).finally(function(){n.createLoading=!1}))},n.cancel=function(){S.close()},n.$on("modal.closing",function(e,t){S=void 0})}],size:"md",appendTo:""})},i.exportModel=function(e,t,n,o){S=s.open({backdrop:"static",animation:!0,templateUrl:"/tpl/custom/popup/export.html",controller:["$scope","$state","ossService","$rootScope","toaster","componentService","ccc",function(r,i,a,s,l,c,p){r.loading=!0,r.componentName="",r.componentNameDisabled=!1;let u="studio/"+window.appConfig.userId+"/"+e+"/"+t+"/"+n+"/metadata";a.getObject(window.appConfig.oss.bucket,u,null,!0).then(function(e){let t=JSON.parse(p.d(e));c.get(parseInt(t.exportComponentId)).then(function(e){if(r.loading=!1,e.success){let n=e.componentInfo;r.componentName=n.name,r.componentNameDisabled=!0,r.componentModelVersion=t.exportModelVersion}},function(e){r.loading=!1,r.componentName=o+"_导出模型_"+moment().format("L")})},function(e){r.loading=!1,r.componentName=o+"_导出模型_"+moment().format("L")}),r.ok=function(){if(r.loading)return;r.loading=!0;let o=!_.isNumber(r.componentModelVersion);c.exportModel(e,t,n,r.componentName,o).then(function(e){r.loading=!1,l.pop("success","模型导出成功"),S.close(),s.$broadcast("node.list.reload")},function(e){r.loading=!1,l.pop("error","模型导出失败: "+e.msg)})},r.cancel=function(){S.close()},r.$on("modal.closing",function(e,t){S=void 0})}],size:"md",appendTo:""})};let T=null;i.openAppScriptEditor=function(e){T&&(T.close(),T=null),T=s.open({templateUrl:"/tpl/custom/popup/appScriptEditor.html",controller:["$scope","$stateParams","nodeService","toaster","scriptService",function(t,n,o,r,i){const a=o.getGraph();t.editorOptions={lineWrapping:!0,lineNumbers:!1,theme:"material-darker",mode:"javascript"};let s=null;t.codeEditors={},t.$watch(function(){return i.getAppLogs(n.id)},function(e){t.scriptLog=e}),t.readOnly=e,t.handleSelectPort=function(e){const{id:n,nodeId:o,direction:r}=e,a=i.getScriptsByNode({node:o,port:n.split("-")[1]},r);s&&(t.currentNode=e,s.getDoc().setValue(a))},t.nodeTree=a.nodes.filter(({metadata:e})=>e.def.ports&&e.def.ports.length).map(({id:e,metadata:n})=>({id:e,label:n.label,expanded:!0,visible:!0,children:n.def.ports.map(({uuid:n,description:o,ioType:r})=>({id:`${e}-${n}`,label:`${n}(${_.get(o,"zh_CN","")})`,onSelect:t.handleSelectPort,nodeId:e,direction:r,visible:!0}))})),t.nodeTree.unshift({id:i.APP_GLOBAL_SCRIPT_NODEID,label:"全局",expanded:!0,visible:!0,children:[{id:`${i.APP_GLOBAL_SCRIPT_NODEID}-${i.APP_GLOBAL_SCRIPT_PORTID}`,label:"全局脚本",onSelect:t.handleSelectPort,nodeId:i.APP_GLOBAL_SCRIPT_NODEID,direction:i.APP_GLOBAL_SCRIPT_KEYWORD,visible:!0}]}),t.codemirrorLoaded=function(e){s=e,e.on("change",function(e){i.setScript(t.currentNode.nodeId,t.currentNode.id.split("-")[1],t.currentNode.direction,e.getValue())})},t.toggleScriptBlock=function(e){$(e.currentTarget).toggleClass("collasped")};const l=function(e){27===e.keyCode&&(t.scriptFullScreen=!1,$(document).off("keydown",l))};t.previewerOptions={lineWrapping:!0,lineNumbers:!1,theme:"material-darker",mode:"javascript",readOnly:!0},t.packedScript="",t.codePreviewerLoaded=function(e){t.codePreviewer=e},t.handleToggleFullscreen=function(){t.scriptFullScreen=!t.scriptFullScreen,t.scriptFullScreen?(r.pop("info","按 Esc 键退出全屏编辑"),$(document).on("keydown",l)):$(document).off("keydown",l)},t.handlePreviewScripts=function(e){e.stopPropagation(),t.showCodePreviewer=!t.showCodePreviewer,setTimeout(function(){t.codePreviewer&&(t.packedScript=i.packScripts(a),t.codePreviewer.getDoc().setValue(t.packedScript),t.codePreviewer.execCommand("selectAll"),t.codePreviewer.execCommand("indentAuto"),t.codePreviewer.setCursor(0))},500)},t.handleSaveScripts=function(e){e.stopPropagation(),i.saveAppScripts()},t.handleShowLog=function(e){e.stopPropagation(),t.showLog=!t.showLog},t.cancel=function(){T.close()},t.$on("modal.closing",function(e,t){T=void 0})}],size:"lg",appendTo:"",backdrop:!1,keyboard:!1})},i.openEdgeScriptEditor=function({from:e,to:t,metadata:n,direction:o},r){S&&S.close(),(S=s.open({templateUrl:"/tpl/custom/popup/edgeScriptEditor.html",controller:["$scope","toaster","scriptService","$uibModalInstance","$stateParams",function(r,i,a,s,l){let c=null;r.editorOptions={lineWrapping:!0,lineNumbers:!1,theme:"material-darker",mode:"javascript",autofocus:!r.readOnly};const p=o===a.DIRECTION.IN?t:e,u=h.getNode(p.node);r.editorTitle=`<${u.metadata.label}>-<${p.port}>-<${a.getKeyword(o)}>`,r.script=a.getOldEdgeScripts(n.script)||a.getScriptsByNode(p,o),r.scriptFullScreen=!1,r.funcNames=a.getSupportedFunctions(),o===a.DIRECTION.IN?r.funcNames=r.funcNames.filter(e=>"afterLeave"!==e):r.funcNames=r.funcNames.filter(e=>"beforeEnter"!==e),r.$watch(function(){return a.getLogsByEdge(l.id,{from:e,to:t})},function(e){r.scriptLog=e}),r.codemirrorLoaded=function(e){c=e;const t=e.getDoc();setTimeout(function(){t.setValue(r.script)},500)};let d=null;const f=function(e){27===e.keyCode&&(r.scriptFullScreen=!1,$(document).off("keydown",f),d&&(d.appendChild(document.querySelector("ui-draggable-modal")),d=null))};r.handleToggleFullscreen=function(){r.scriptFullScreen=!r.scriptFullScreen;const e=document.querySelector("ui-draggable-modal");r.scriptFullScreen?(i.pop("info","按 Esc 键退出全屏编辑"),$(document).on("keydown",f),e&&(d=e.parentNode,document.body.appendChild(e))):($(document).off("keydown",f),d&&(d.appendChild(e),d=null))},r.handleAddFunction=function(e,t){e.preventDefault(),e.stopPropagation(),r.dropdownOpen=!1,r.script+=a.getFunctionBlock(t)},r.handleSaveScripts=function(e){a.saveEdgeScripts(p,o,c.getValue())},r.cancel=function(){s.close(!0)},r.$on("modal.closing",function(e,t){if($(".full-screen").remove(),!t)return e.preventDefault(),!1;S=void 0})}],size:"md",appendTo:"",backdrop:!1,windowClass:"edge-script-editor-modal-window",keyboard:!1})).rendered.then(function(){setTimeout(function(){const e=$(".edge-script-editor-log-content");e&&e[0].lastChild&&e.scrollTop(e[0].lastChild.offsetTop)},500)})},i.removeComponent=function(e,n,o){S=s.open({animation:!0,templateUrl:"/tpl/custom/popup/alert.html",controller:["$scope","componentService",function(r,a){r.alertTitle="删除组件",r.alertIcon="iconfont iconjinggao text-danger",r.alertBody="删除组件 ‘"+e.label+"’ 吗？",r.moreLabel="删除同级目录的其他组件",r.selected={all:!1},r.siblings=_.filter(n,function(t){return t.id!=e.id&&!t.folder}),e.selected=!0,r.onChangeAll=function(){_.forEach(r.siblings,function(e){e.selected=r.selected.all})},r.ok=function(){if(!r.loading)if(r.loading=!0,_.isEmpty(n))a.del(e.id).then(function(t){y.pop("success","组件 "+e.label+" 已删除"),i.$broadcast("node.list.reload"),S.close()},function(t){y.pop("error","组件 "+e.label+" 删除失败")}).finally(function(){r.loading=!1});else{const n=_.filter(r.siblings,{selected:!0});n.unshift(e),a.removeList(n).then(function(n){const a=_.filter(n,{removed:!1}),s=_.filter(n,{removed:!0});if(y.pop("success","组件 "+_.map(s,"label").join("、")+" 已被删除"),_.isEmpty(a)||y.pop("error","组件 "+_.map(a,"label").join("、")+" 删除失败"),t.params.componentId==e.id){let e=_.filter(r.siblings,function(e){return!e.selected});_.isEmpty(e)||(o=e[0]),t.go("app.customize",{componentId:o.id},{reload:!0})}i.$broadcast("node.list.reload"),S.close()}).finally(function(){r.loading=!1})}},r.cancel=function(){e.selected=!1,S.close()},r.$on("modal.closing",function(e,t){S=void 0})}],size:"sm",appendTo:""})},i.shareComponent=function(e,t){S=s.open({backdrop:"static",animation:!0,templateUrl:"/tpl/custom/popup/share.html",controller:["$scope","toaster","componentService","$http",function(n,o,r,i){n.shareTitle="组件分享",n.shareNameTitle="组件名称",n.shareDescriptionTitle="组件描述",n.shareName=t,n.targetUser={id:"",username:""},n.userList=[],n.dropdownToggle=!1,n.activeType={name:"用户ID",value:"id"},n.userTypes=[{name:"用户ID",value:"id"},{name:"用户名",value:"username"}];const a=window.appConfig.loginHost+"/api/user/findByUsernameLike";let s,l;n.onClickUserListItem=function(e){n.targetUser=e,n.userList=[]},n.onClickType=function(e){n.dropdownToggle=!n.dropdownToggle,n.activeType=e},n.onChangeTargetUser=function(e){s=e.target.value.trim(),"username"==n.activeType.value?(l&&(clearTimeout(l),l=null),l=setTimeout(function(){i({method:"GET",url:a,params:{username:s}}).then(function(e){200===e.status&&(n.userList=_.get(e,"data.data"))},function(e){o.pop("warning",_.get(e,"data.message")+" 请选择“用户ID”输入"),n.activeType={name:"用户ID",value:"id"},n.targetUser={id:"",username:""}})},400)):n.targetUser.id=s},n.ok=function(){n.shareLoading||(n.shareLoading=!0,r.share(e,n.shareName,n.targetUser.id).then(function(e){S.close(),o.pop("success","分享成功")},function(e){o.pop("error","分享失败: "+e.msg)}).finally(function(){n.shareLoading=!1}))},n.cancel=function(){S.close()},n.$on("modal.closing",function(e,t){S=void 0})}],size:"md",appendTo:""})},i.node2component=function(e,t,n){S=s.open({animation:!0,templateUrl:"/tpl/custom/popup/node2component.html",controller:["$scope","$state","$stateParams","toaster","componentService",function(o,r,i,a,s){o.title="从节点创建组件",o.nameTitle="组件名称",o.name=t,o.ok=function(){if(o.loading)return;o.loading=!0;let t=i.type;"predict"===t&&(t="service"),s.create(o.name,void 0,t,n,e).then(function(e){S.close(),a.pop("success","创建成功"),s.setPermission(e.id).then(function(t){r.go("app.customize",{componentId:e.id},{reload:!0})},function(t){r.go("app.customize",{componentId:e.id},{reload:!0})})},function(e){a.pop("error","创建失败: "+e.msg)}).finally(function(){o.loading=!1})},o.cancel=function(){S.close()},o.$on("modal.closing",function(e,t){S=void 0})}],size:"md",appendTo:""})},i.duplicateComponent=function(e){S=s.open({animation:!0,templateUrl:"/tpl/custom/popup/duplicate.html",controller:["$scope","$rootScope","toaster","componentService","appDataStoreService","statisticsService",function(t,n,o,r,i,a){t.duplicateTitle="复制组件",t.duplicateNameTitle="组件名称",t.duplicateName=e.label,t.ok=function(){if(t.duplicateLoading)return;t.duplicateLoading=!0;let a=["studio",window.appConfig.userId,"component",e.id].join("/");i.sync(a,"upload").then(function(n){return r.duplicate(e.id,t.duplicateName)}).then(function(e){let t=["studio",window.appConfig.userId,"component",e.id].join("/");return i.sync(t,"download")}).then(function(e){S.close(),o.pop("success","复制成功"),n.$broadcast("node.list.reload")},function(e){o.pop("error","复制失败: "+e.msg)}).finally(function(){t.duplicateLoading=!1})},t.cancel=function(){S.close()},t.$on("modal.closing",function(e,t){S=void 0})}],size:"md",appendTo:""})},i.duplicateAppFromTemplate=function(e,t,n){S=s.open({animation:!0,templateUrl:"/tpl/custom/popup/duplateAppFromTemplate.html",controller:["$scope","$rootScope","toaster","appService","statisticsService",function(o,i,a,s,l){o.duplicateTitle="从模板创建项目",o.duplicateNameTitle="项目名称",o.duplicateName=t,o.duplicateDescriptionTitle="项目描述",o.duplicateDescription=n,o.ok=function(){o.duplicateLoading||(o.duplicateLoading=!0,s.duplicatePublic(e,o.duplicateName,o.duplicateDescription,"algo").then(function(e){let t=["studio",window.appConfig.userId,e.id].join("/");return r.sync(t,"download")}).then(function(e){S.close(),a.pop("success","创建成功"),i.$broadcast("app.list.reload",{})}).catch(function(e){a.pop("error","创建失败: "+e.msg)}).finally(function(){o.duplicateLoading=!1}))},o.cancel=function(){S.close()},o.$on("modal.closing",function(e,t){S=void 0})}],size:"md",appendTo:""})},i.changeParentDir=function(e){S=s.open({backdrop:"static",animation:!0,templateUrl:"/tpl/custom/popup/edit_dirs.html",controller:["$scope","$rootScope","componentService","common","toaster",function(t,n,o,r,i){t.modalTitle=(e.folder?"移动文件夹 ":"移动组件 ")+e.label+" 至";let a=e.folder?e.id:e.dir||2;t.my_treedata=n.userConfig.componentDirs;const s=r.getDirMap(t.userConfig.componentDirs),l=s[a];t.parentId=e.folder?l.parentId:e.dir||2,t.targetDir=null,t.onSelect=function(e){t.targetDir=e},t.ok=function(){if(e.folder){const o=_.remove(s[l.parentId].children,function(t){return t.id==e.id})[0];o.parentId=t.targetDir.id,s[t.targetDir.id].children.push(o),n.saveConfig().then(function(e){n.$broadcast("node.list.reload"),i.pop("success","移动文件夹成功")},function(e){i.pop("error","移动文件夹失败, 网络错误")}).finally(function(){S.close()})}else o.changeDir(e.id,t.targetDir.id).then(function(e){n.$broadcast("node.list.reload"),i.pop("success","移动组件成功")},function(e){i.pop("error","移动组件失败: "+e.msg)}).finally(function(){S.close()})},t.cancel=function(){S.close()},t.$on("modal.closing",function(e,t){S=void 0})}]})},i.showChart=function(e,t,n){S=s.open({animation:!0,templateUrl:"/tpl/custom/popup/chart.html",controller:["$scope","appDataStoreService",function(o,r){o.popupTitle="分析报告",o.popupLoading=!1;let i=["studio",window.appConfig.userId,e,t,n,"visual","part-00000"].join("/");r.url(i).then(function(e){e.success&&(o.chartUrl="/visual_iframe?data="+encodeURIComponent(e.data))}),o.cancel=function(){S.close()},o.$on("modal.closing",function(e,t){S=void 0}),o.$on("$destroy",function(){})}],size:"lg",appendTo:""})},i.showColumn=function(e,t,n){S=s.open({animation:!0,templateUrl:"/tpl/custom/popup/column.html",controller:["$scope","tableService","nodeService",function(o,r,i){o.popupTitle="字段选择",o.popupHasFooter=!0,o.popupLoading=!0;let a,s,l=function(e){o.popupLoading=!1,o.popupNotice=e},c=i.getNode(t);for(let e in c.metadata.def.params){let t=c.metadata.def.params[e];if(t.controlInstUuid===n){a=t;break}}_.isEmpty(a.value)||(s=_.map(a.value.split(","),function(e){return e})),r.getUpstreamTableName(e,t,n).then(function(e){let t=e.propertyName,n=e.value;t&&n?r.getTableMeta(n,t).then(function(e){o.popupLoading=!1;let n=e,r=0;if(n){if("tableName"==t&&(n=e.data.tableColumns,!_.isEmpty(s)))for(let e=0;e<n.length;e++){let t=_.indexOf(s,n[e].name)>-1;t&&r++,n[e].selected=t}if("dataName"==t&&(n=_.map(n,function(e){let t=_.indexOf(s,e)>-1;return t&&r++,{name:e,selected:t}})),o.tableColumnArr=n,o.totalSelectedNum=r,o.tableColumnObj={},o.tableColumnNumObj={},"dataName"==t&&(o.tableColumnObj.string=o.tableColumnArr,o.tableColumnNumObj.string=r),"tableName"==t)for(let e=0;e<n.length;e++){let t=n[e],r=t.type.toLowerCase();o.tableColumnObj[r]||(o.tableColumnObj[r]=[],o.tableColumnNumObj[r]=0),o.tableColumnObj[r].push(t),t.selected&&(o.tableColumnNumObj[r]+=1)}o.toggleColType=function(e,t){let n=o.tableColumnObj[t];if(e){for(let e=0;e<n.length;e++)n[e].selected=!1;o.tableColumnNumObj[t]=0,o.totalSelectedNum-=n.length}else{for(let e=0;e<n.length;e++)n[e].selected=!0;o.tableColumnNumObj[t]=n.length,o.totalSelectedNum+=n.length}},o.toggleSelectAll=function(e){if(e){for(let e in o.tableColumnObj)_.forEach(o.tableColumnObj[e],function(e){e.selected=!1}),o.tableColumnNumObj[e]=0;o.totalSelectedNum=0}else{for(let e in o.tableColumnObj)_.forEach(o.tableColumnObj[e],function(e){e.selected=!0}),o.tableColumnNumObj[e]=o.tableColumnObj[e].length;o.totalSelectedNum=n.length}},o.popupConfirm=function(){let e=[];for(let t=0;t<n.length;t++)n[t].selected&&e.push(n[t].name);a.value=e.join(","),o.ok()}}else l("未获取到数据")},function(e){console.error(e),l("未获取到数据")}):l("未获取到数据")},function(e){_.isString(e)?l(e):l("未获取到数据")}),o.ok=function(){S.close()},o.cancel=function(){S.close()},o.$on("modal.closing",function(e,t){S=void 0}),o.$on("$destroy",function(){})}],size:"lg",appendTo:""})},i.showTable=function(e,t,n){S=s.open({animation:!0,templateUrl:"/tpl/custom/popup/table.html",controller:["$scope","tableService",function(o,r){o.popupTitle="数据探查",o.popupLoading=!0,o.popupHasFooter=!0,o.isTable=!0,o.tableColumnWidth=68,o.widthUp=function(){o.tableColumnWidth>=200||(o.tableColumnWidth+=5)},o.widthDown=function(){o.tableColumnWidth<=68||(o.tableColumnWidth-=5)},o.tableDownload=function(){let r="";o.tableSchema.forEach(function(e){r+=e.name+","}),r+="\n";for(let e=0;e<o.tableData.length;e++){for(let t in o.tableData[e])if(t>0){let n=o.tableData[e][t].toString(),i=_.replace(n,/\"/g,'""');r+=(i='"'+i+'"')+"\t,"}r+="\n"}let i="data:text/csv;charset=utf-8,"+encodeURIComponent(r),a=document.createElement("a");a.href=i,a.download=e+"-"+t+"-"+n+".csv",document.body.appendChild(a),a.click(),document.body.removeChild(a)},r.getNodeTableName(e,t,n).then(function(e){r.getTableMeta(e.value,e.propertyName).then(function(e){o.popupLoading=!1,o.tableData=e.data.table_data.data,o.tableSchema=e.data.table_data.schema.map(function(e){return{name:e,exp_w:0}}),o.exp_w=0;for(let e=0;e<o.tableData.length;e++)o.tableData[e].unshift(e);o.order=function(e,t){o.sortIndex=e,o.sortType=t,"asc"===t?o.tableData.sort(function(t,n){return parseFloat(t[e])-parseFloat(n[e])}):o.tableData.sort(function(t,n){return parseFloat(n[e])-parseFloat(t[e])})};let t=!1,n={};o.changeWidthStart=function(e,r){t=!0,n.index=r,n.start=e.pageX-o.tableSchema[n.index].exp_w},o.changeWidth=function(e){if(t){let t=e.pageX-n.start;t>=0&&(o.tableSchema[n.index].exp_w=t,o.exp_w=o.tableSchema.map(function(e){return e.exp_w}).reduce(function(e,t,n,o){return e+t}))}},o.changeWidthEnd=function(e){t=!1,n={}}},function(e){o.popupLoading=!1,o.popupNotice="未获取到数据"})},function(e){o.popupLoading=!1,o.popupNotice="未获取到数据表"}),o.cancel=function(){S.close()},o.$on("modal.closing",function(e,t){S=void 0}),o.$on("$destroy",function(){})}],size:"lg",appendTo:""})},i.showRapidminer=function(e,t,n){S=s.open({animation:!0,templateUrl:"/tpl/custom/popup/rapidminer.html",controller:["$scope","$q",function(o,i){let a;o.popupTitle="数据质量分析",o.popupLoading=!0,o.popupHasFooter=!0,o.isTable=!0,o.tableColumnWidth=150;let l="studio/"+window.appConfig.userId+"/"+e+"/"+t+"/"+n+"/data/data.json",c="studio/"+window.appConfig.userId+"/"+e+"/"+t+"/"+n+"/data/data.csv";i.all([r.get(c),r.get(l)]).then(function(e){o.popupLoading=!1,o.exp_w=0;let t=_.compact(e[0].split("\n")),n=t.length,r=e[1];try{r=JSON.parse(e[1])}catch(e){}o.csv_title=n?t[0].split(",").map(function(e){let t=e.trim(),n=r.columnDetail[t];if(n){let e=n.valueCounts;delete n.valueCounts;let o=r.numericSummary[t];return{name:t,detail:n,menuOption:[{text:"详情",click:function(r){!function(e,t,n,o){a=s.open({animation:!0,templateUrl:"/tpl/custom/popup/rapidminer_detail.html",controller:["$scope",function(r){r.popupTitle=e,r.popupLoading=!1,r.popupHasFooter=!0,r.columnDetail=t,r.barData=n,r.numericSummary=o,r.cancel=function(){a.close()},r.$on("modal.closing",function(e,t){a=void 0}),r.$on("$destroy",function(){})}],size:"md",appendTo:""})}(t,n,e,o)}}]}}return{name:t,detail:n}}):[],o.csv_data=n?t.slice(1).map(function(e){return e.split(",")}):[],o.csv_len=o.csv_title.length},function(e){o.popupLoading=!1,o.popupNotice="未获取到数据表"}),o.cancel=function(){S.close()},o.$on("modal.closing",function(e,t){S=void 0}),o.$on("$destroy",function(){})}],size:"lg",appendTo:""})},i.showFormulaEidtor=function(e){S=s.open({backdrop:"static",animation:!0,templateUrl:"/tpl/custom/popup/formulaEditor.html",controller:["$scope","$stateParams","nodeService",function(t,n,o){t.popupTitle="编辑公式",t.inputAttr="输出1",t.popupHasFooter=!0,t.popupLoading=!1;let r=o.getNode(n.nodeId);const i=function(e){let t=_.cloneDeep(e);switch(t.typeLabel=t.type,t.labelClass="",e.type.toUpperCase()){case"STRING":t.typeLabel="文本",t.labelClass="string-label";break;case"ARRAY":t.typeLabel="数组",t.labelClass="array-label";break;case"NUMBER":t.typeLabel="数字",t.labelClass="number-label";break;case"DATE":t.typeLabel="时间戳",t.labelClass="time-label";break;case"JSON":t.typeLabel="JSON",t.labelClass="json-label"}return t};let a=_.get(r,"metadata.def.ports"),s=[];a.forEach(e=>{if("in"===e.ioType){let t=_.get(e,"description.zh_CN","");const n={id:e.uuid,name:t,type:e.subType||""},o=i(n);s.push(o)}}),t.currFieldList=s,t.editorOptions={placeholder:"请在此输入公式...",matchBrackets:!0,autoCloseBrackets:!0,indentUnit:0,smartIndent:!1,lineWrapping:!0,autofocus:!0};let l=function(e){const t=_.get(r,"metadata.def.params"),n=Object.keys(t);let o="";return n.forEach(n=>{t[n].controlInstUuid&&t[n].controlInstUuid===e&&(o=t[n])}),o}(e);l&&(l=i(l)),t.initFormular=l,t.codemirrorLoaded=function(e){t._editor=e;let n=e.getDoc();setTimeout(()=>{const e=t.initFormular.value;e&&""!==e&&n.replaceRange(e,{line:0,char:0},void 0,"setInitValue")},0);e.setOption("hintOptions",{hint:function(){const t=e,n=e.constructor,o=t.getCursor(),r=t.getLine(o.line),i=o.ch,a=i,s=["AND","IF","OR"],l=r.split("");let c=i;for(let e=i-1;e>=0&&/\w/.test(l[e]);e-=1)c=e;let p="";c<i&&(p=r.slice(c,i));const u=[];""!==p&&function(e,t){e.forEach(e=>{t&&0===e.lastIndexOf(t.toUpperCase(),0)&&u.push(e)})}(s,p);const d=p.split("").length;return{list:u,from:n.Pos(o.line,a-d),to:n.Pos(o.line,i)}},completeSingle:!1});e.on("change",function(t,o){if(t.closeHint(),o.origin)if("setInitValue"===o.origin){e.focus(),o.text.forEach((e,n)=>{s.forEach(o=>{(function(e,t){let n=[],o=e.indexOf(t);for(;o>-1;)n.push(o),o=e.indexOf(t,o+1);return n})(e,o.id).forEach(e=>{const r={line:n,ch:e},i=o.id.length,a={line:n,ch:e+i},s=document.createElement("span");s.innerHTML=o.name,s.className="cm-field-name",t.markText(r,a,{selectRight:!0,atomic:!0,replacedWith:s})})})})}else if(/custom_add-field-/.test(o.origin)){const e=o.origin.replace("custom_add-field-",""),n={line:o.from.line,ch:o.from.ch},r=o.text[0].split("").length,i={line:o.from.line,ch:o.from.ch+r},a=document.createElement("span");a.innerHTML=e,a.className="cm-field-name",t.markText(n,i,{selectRight:!0,atomic:!0,replacedWith:a})}else if("complete"===o.origin){let e=n.getCursor();n.replaceRange("()",e,void 0,"custom_add-formular");const t={line:e.line,ch:e.ch+1};n.setCursor(t)}else/custom_add-formular/.test(o.origin)||t.showHint()}),e.constructor.defineSimpleMode("simplemode",{start:[{regex:/"(?:[^\\]|\\.)*?(?:"|$)/,token:"string"},{regex:/IF|AND|OR/,token:"keyword"},{regex:/true|false|null|undefined/,token:"atom"},{regex:/0x[a-f\d]+|[-+]?(?:\.\d+|\d+\.?\d*)(?:e[-+]?\d+)?/i,token:"number"},{regex:/\/(?:[^\\]|\\.)*?\//,token:"variable-3"},{regex:/[-+\/*=<>!]+/,token:"operator"},{regex:/[\{\[\(]/,indent:!0},{regex:/[\}\]\)]/,dedent:!0},{regex:/[a-zA-Z$][\w$]*/,token:"variable"}]}),e.setOption("mode","simplemode")},t.operatorList=[{name:"函数分隔符",label:"."},{name:"参数引号",label:'""'},{name:"加",label:"+"},{name:"减",label:"-"},{name:"乘",label:"*"},{name:"除",label:"/"},{name:"大于",label:">"},{name:"小于",label:"<"},{name:"等于",label:"=="},{name:"不等于",label:"!="},{name:"大于等于",label:">="},{name:"小于等于",label:"<="}],t.handleClickAddOperator=function(e){if(t._editor){let n=t._editor.getDoc(),o=n.getCursor();n.replaceRange(e.label,o,void 0,"custom_add-operator");let r=e.label.split("").length;"参数引号"===e.name&&(r=1);const i={line:o.line,ch:o.ch+r};t._editor.focus(),n.setCursor(i)}},t.formularList=[{label:"常用函数",expand:!0,children:[{label:"IF",format:"IF(A,B,C)",description:"表示如果满足条件A，那么返回B，否则返回C"},{label:"SWITCH",format:"SWITCH(逻辑表达式1, A, 逻辑表达式2, B, ..., OTHERS, N)",description:"表示如果满足逻辑表达式1，那么返回A；如果满足逻辑表达式2, 那么返回B；...同上；否则返回N。"},{label:"ARRAY",format:"ARRAY(A,B,C)",description:"返回[A,B,C]"},{label:"DICT",format:"DICT(A)",description:"返回[A,B,C]"},{label:"JSON",format:"JSON(A,B,C)",description:""},{label:"DF",format:"DF(A,B,C)",description:""},{label:"JSON2DF",format:"JSON2DF(A)",description:""},{label:"DF2ECHARTS",format:"DF2ECHARTS(A)",description:""},{label:"CHAIN",format:"CHAIN(A,B,C)",description:""},{label:"ZIP",format:"ZIP(A,B,C)",description:""}]},{label:"逻辑函数",expand:!0,children:[{label:"AND",format:"AND(逻辑表达式1,逻辑表达式2,...)",description:"如果所有参数都为真，AND函数返回布尔值true，否则返回布尔值 false"},{label:"OR",format:"OR(逻辑表达式1,逻辑表达式2,...)",description:"如果任意参数为真，OR 函数返回布尔值true；如果所有参数为假，返回布尔值false。"}]},{label:"数学函数",expand:!0,children:[{label:"MAX",format:"MAX(变量1,变量2,...)",description:"如果所有参数都为数字，MAX 函数返回最大值。"},{label:"MIN",format:"MIN(变量1,变量2,...)",description:"如果任意参数为数字，MIN 函数返回最小值。"},{label:"SUM",format:"SUM(变量1,变量2,...)",description:"SUM 函数返回所有值的和。"},{label:"LEN",format:"LEN(变量)",description:"LEN 函数返回变量的长度。"}]}],t.handleClickTreeLabel=function(e){t.formularList[e].expand=!t.formularList[e].expand},t.selecFormular={format:"",description:""},t.handleTreeSelect=function(e){if(t._editor){let n=t._editor.getDoc(),o=n.getCursor(),r=`${e.label}()`,i={line:o.line,ch:o.ch+e.label.split("").length+1};n.replaceRange(r,o,void 0,"custom_add-formular"),t._editor.focus(),n.setCursor(i)}},t.handleTreeHover=function(e){t.selecFormular=e},t.handleClickAddField=function(e){if(t._editor){let n=t._editor.getDoc(),o=n.getCursor();n.replaceRange(e.id,o,void 0,`custom_add-field-${e.name}`);const r={line:o.line,ch:o.ch+e.id.split("").length};t._editor.focus(),n.setCursor(r)}},t.ok=function(){let n=t._editor.getValue();!function(e,t){const n=_.cloneDeep(r.metadata.def.params);Object.keys(n).forEach(o=>{n[o].controlInstUuid&&n[o].controlInstUuid===e&&(r.metadata.def.params[o].value=t)})}(e,n),S.close()},t.cancel=function(){S.close()},t.$on("modal.closing",function(e,t){S=void 0}),t.$on("$destroy",function(){})}],size:"lg",appendTo:""})},i.showFiles=function(e,t,n){S=s.open({animation:!0,templateUrl:"/tpl/custom/popup/files.html",controller:["$scope","$rootScope","$stateParams","downloadFile","appService","appDataStoreService","common","format",function(o,r,i,a,l,c,p,u){let d,f;o.popupTitle=t?"选择文件":"查看文件",o.popupLoading=!0,o.popupHasFooter=!0,o.NextMarker=void 0,o.maxKeys=20,o.checkAll=!1,o.filesRemovable=!1,o.removing=!1,o.fileSelect=!_.isEmpty(t);const m={},g={"{{userId}}":r.appConfig.userId,"{{appId}}":i.id,"{{nodeId}}":i.nodeId},v=function(e){return new Promise(function(t,n){if(f=e,!_.isEmpty(m[f]))return o.filesRemovable=!1,o.data.data_=_.forEach(m[f].prefixes.concat(m[f].catalog),function(e){e.checked=!1}),o.data.total=o.data.data_.length,o.popupLoading=!1,o.loaded=!0,void t(null);l.getContents(e).then(function(e){if(o.popupLoading=!1,o.data.data_=[],o.data.total=0,_.isEmpty(e.catalog)&&_.isEmpty(e.prefixes))o.popupNotice="暂无数据";else{let t=e.prefixes.concat(e.catalog);o.data.total=t.length}o.loaded=!1,t(e)},function(e){o.popupLoading=!1,o.popupNotice="未获取到数据表"})})};let b,w,x;if(t){const e=h.getNode(i.nodeId);_.forEach(e.metadata.def.params,function(e){_.get(e,"controlInstUuid")===t&&(b=e),_.has(e,"fileType")&&(w=e)}),x=b.value&&_.map(b.value.split(","),function(e){return u(e,g)})}if(d=e||(w?_.get(w,"value"):p.getUploadNodeDataPath(n||"out1")),f=u(d,g),_.isEmpty(f))o.popupLoading=!1,o.popupNotice="未获取到数据";else{let e=f;o.loading=!1,o.loaded=!1,o.data={data_:[],total:0,getItemAtIndex:function(e){return e>this.data_.length&&e<=this.total?(this.fetchMoreItems_(e),null):this.data_[e]},getLength:function(){return 0===this.data_.length?0:this.total},fetchMoreItems_:function(e){o.loading||o.loaded||(o.loading=!0,o.loaded||l.getContents(f,o.NextMarker,o.maxKeys,o.checkAll).then(function(e){o.loading=!1,o.scrollLoading=!0,e.NextMarker||(o.loaded=!0),_.isEmpty(x)||_.forEach(e.catalog,function(e){e.checked=x.indexOf(e.id)>-1});let t=e.prefixes.concat(e.catalog);_.isEmpty(m[f])&&(m[f]={prefixes:[],catalog:[]});let n=m[f];m[f]={prefixes:n.prefixes.concat(e.prefixes),catalog:n.catalog.concat(e.catalog)},o.data.data_=o.data.data_.concat(t),o.NextMarker=e.NextMarker},function(e){o.loading=!1,o.scrollLoading=!0}))}},v(f).then(function(t){o.filesBreadcrumbs[0].id=e,o.filesBreadcrumbs[0].prefixes=_.get(t,"prefixes.length",0),o.filesBreadcrumbs[0].catalog=_.get(t,"catalog.length",0)})}o.filesBreadcrumbs=[{id:0,label:"全部文件夹"}],o.getFileIcon=function(e){switch(e){case"png":case"gif":case"jpg":case"jpeg":case"bmp":return"icon-file-image";case"folder":return"icon-folder";case"txt":return"icon-file-text";case"json":return"icon-code";case"pdf":return"icon-file-pdf";case"xls":case"xlsx":return"icon-file-excel";default:return"icon-file"}};o.onFileItem=function(e){let t=function(e){let t;return o.data.data_.forEach(function(n){e===n.id&&(t=n)}),t}(e);if(t.isFolder)o.checkAll=!1,o.filesRemovable=!1,o.active=null,o.fileChecked=!1,_.isEmpty(m[e])?v(e).then(function(e){o.filesBreadcrumbs.push({id:t.id,label:t.label,prefixes:e.prefixes.length,catalog:e.catalog.length})}):(o.data.data_=_.forEach(m[e].prefixes.concat(m[e].catalog),function(e){e.checked=!1}),o.data.total=o.data.data_.length,o.filesBreadcrumbs.push({id:t.id,label:t.label,prefixes:m[e].prefixes.length,catalog:m[e].catalog.length}));else{o.isFetching=!0,o.active=e,o.fileChecked=!0,o.fileActive={alt:t.label},c.url(e).then(function(e){e.success&&(o.fileActive.src=e.data)});let n=["png","gif","jpg","jpeg","bmp"];c.head(e).then(function(r){0==r.ContentType.indexOf("image")||n.indexOf(t.type)>-1?(o.fileActive.type="image",o.isFetching=!1):0==r.ContentType.indexOf("text")||"application/json"==r.ContentType||"json"==t.type||"csv"==t.type?(o.fileActive.type=t.type,0==r.ContentLength?(o.isFetching=!1,o.fileActive.info="该文件为空"):!r.ContentLength||_.toNumber(r.ContentLength)<=5242880?c.get(e).then(function(e){if(o.isFetching=!1,"application/json"==r.ContentType||"json"==o.fileActive.type){let t=e;try{t=JSON.parse(e)}catch(e){console.error(e)}o.fileActive.body=JSON.stringify(t,null,2)}else if("csv"==t.type){let t=",";-1==e.indexOf(",")&&(t=" ");const n=_.map(_.slice(_.compact(e.split(/\r\n|\n/)),0,101),function(e){return _.split(e,t)});o.fileActive.body=n}else o.fileActive.body=e},function(e){o.isFetching=!1}):(o.isFetching=!1,o.fileActive.info="文件超过5M不支持预览")):(o.isFetching=!1,o.fileActive.info="暂不支持该文件查看")},function(e){})}},o.onFileCheckAll=function(e){o.checkAll=e.target.checked,o.filesRemovable=o.checkAll,_.forEach(o.data.data_,function(e){e.checked=o.checkAll})},o.onFileChecked=function(e,t){e.stopPropagation();let n=_.find(o.data.data_,{id:t});n.checked=!n.checked,o.filesRemovable=_.findIndex(o.data.data_,{checked:!0})>-1};let $=!1;o.onCancelRemoveHandler=function(){$=!0};let C=function(e,t){let n=_.slice(o.filesBreadcrumbs,-1)[0],r=e.length,i=0,a=function(s){let l=s.id,p=s.isFolder;c.remove(l).then(function(s){if(i++,_.remove(o.data.data_,{id:l}),o.data.total-=1,m[l]&&delete m[l],p?(n.prefixes-=1,_.has(m[n.id],"prefixes")&&_.remove(m[n.id].prefixes,{id:l})):(n.catalog-=1,_.has(m[n.id],"catalog")&&_.remove(m[n.id].catalog,{id:l})),$)return o.removing=!1,void(o.filesRemovable=!0);if(i<r)a(e[i]);else{let e=t?null:_.filter(o.data.data_,"checked");if(o.checkAll&&!_.isEmpty(e))C(e);else if(t||(o.checkAll=!1,o.removing=!1),!o.data.total&&o.filesBreadcrumbs.length>1){let e=o.filesBreadcrumbs.slice(-2),t=e[1].id,n=e[0].id;"local"==window.appConfig.appDataStoreType&&c.remove(t.slice(0,-1)),o.filesBreadcrumbs[o.filesBreadcrumbs.length-2].prefixes-=1,delete m[t],_.remove(m[n].prefixes,{id:t}),o.onFilesBreadcrumbsBack()}}})};a(e[i])};o.onRemoveFiles=function(e,t,n){e.stopPropagation(),s.open({animation:!0,templateUrl:"/tpl/custom/popup/alert.html",controller:["$scope","$uibModalInstance",function(e,o){let r=t&&n?'是否删除文件 "'+n+'"？':"是否删除已选中的文件或文件夹？";e.alertTitle="删除",e.alertBody=r,e.ok=function(){o.close(!0)},e.cancel=function(){o.dismiss("cancel")}}],size:"sm"}).result.then(function(e){let n=null;t?n=_.filter(o.data.data_,{id:t}):(o.filesRemovable=!1,o.removing=!0,$=!1,n=_.filter(o.data.data_,"checked")),C(n,t)},function(e){})};let k=function(e){s.open({animation:!0,templateUrl:"/tpl/custom/popup/alert.html",controller:["$scope","$uibModalInstance",function(t,n){t.alertTitle="提示",t.alertBody="共有"+e.length+"个文件将被下载，选中的文件夹不会被下载！",t.ok=function(){n.close(!0)},t.cancel=function(){n.dismiss("cancel")}}],size:"sm"}).result.then(function(t){o.downloading=!0;let n=_.last(o.filesBreadcrumbs,-1).label;a.downloadZip(e,n.slice(0,n.lastIndexOf("/"))).then(function(e){if(o.downloading=!1,!e.completed){let t=_.map(e.failedFile,function(e){return e.label}).join("、");y.pop("error","文件 "+t+" 下载失败")}})},function(e){})};o.onFilesDownload=function(e,t,n){if(e.stopPropagation(),t&&n)a.download(t,n);else{let e;if(o.data.data_.length<o.data.total){let t=_.slice(o.filesBreadcrumbs,-1)[0].id;l.getContents(t).then(function(t){e=t.catalog,k(e)})}else e=_.filter(o.data.data_,function(e){return!e.isFolder&&e.checked}),k(e)}},o.onFilesBreadcrumbs=function(e){o.checkAll=!1,o.active=null,o.fileChecked=!1,null!=e&&v(e).then(function(t){let n;o.filesBreadcrumbs.forEach(function(t,o){t.id==e&&(n=o)}),o.filesBreadcrumbs=o.filesBreadcrumbs.slice(0,n+1)})},o.onFilesBreadcrumbsBack=function(){o.checkAll=!1,o.active=null,o.fileChecked=!1,o.filesBreadcrumbs.pop();let e=o.filesBreadcrumbs.slice(-1)[0].id;v(e)},o.onClickImage=function(e){r.fullScreenImage.onShowScreenImage(e,o.fileActive.src)};o.onFileNext=function(e,t){if(!(e===(o.data.data_[0].id&&"38"===t)||e===o.data.data_[o.data.data_.length-1].id&&"40"===t||"40"!=t&&"38"!=t)){let n=function(e,t){let n;for(let r=0;r<o.data.data_.length;r++)o.data.data_[r].id==e&&(38==t&&(n=o.data.data_[r-1].id),40==t&&(n=o.data.data_[r+1].id));return n}(e,t);o.onFileItem(n)}},o.ok=function(){let e=_.filter(o.data.data_,function(e){return!e.isFolder&&e.checked});e=_.map(e,function(e){return e.id}).join(","),b.value=e,h.changeNode(i.nodeId),S.close()},o.cancel=function(){S.close()},o.$on("modal.closing",function(e,t){S=void 0}),o.$on("$destroy",function(){})}],size:"lg",appendTo:""})},i.onAsideToggle=function(e){let t;if("predict"===i.currentApp.type&&i.currentApp.dashboard){if(t=angular.element(".front-panel"),"right"==e){const e=angular.element(".sp-toggle");e.hasClass("right-hidden")?e.removeClass("right-hidden"):e.addClass("right-hidden")}o(function(){i.$broadcast("canvasresizer.update")},300)}else t=angular.element("#edit");t.hasClass(e+"-hidden")?t.removeClass(e+"-hidden"):t.addClass(e+"-hidden"),h.resetCanvas()},e.togglePredictDashboard=function(t){e.currentApp.screenshot.loading||(t?i.$broadcast("predict.predict",t):i.$broadcast("predict.dashboard",t))},window.addEventListener("keyup",function(t){if("Digit1"===t.code&&t.altKey&&"predict"===i.currentApp.type)e.togglePredictDashboard(!i.currentApp.dashboard);else if(("Digit2"===t.code||"Digit3"===t.code)&&t.altKey){var n="";"Digit2"===t.code&&(n="left"),"Digit3"===t.code&&(n="right"),n&&i.onAsideToggle(n)}e.$apply()});const I={lastSaved:"上次修改是在",saved:"最近保存 ",success:"保存成功"},E=function(e,t){const n=moment();let o;switch(e){case"lastSaved":return o=moment(t).diff(n,"days")<-30?moment(t).format("YYYY年MM月DD日"):moment(t).diff(n,"hours")+n.hours()<0?moment(t).format("MM月DD日"):moment(t).fromNow(),I[e]+o+"进行的";case"saved":return o=moment(t).format("HH:mm"),I[e]+o;default:return I[e]}};let N;i.$on("app-saved",function(e,t){i.saveStatus=t,t&&(i.saveStatus.msg=E(t.status,t.timestamp),N&&(o.cancel(N),N=null),"success"==t.status&&(N=o(function(){i.saveStatus.status="saved",i.saveStatus.msg=E(t.status,t.timestamp)},2e3)))}),i.iconList={icons:x,images:null},i.getImages=function(){const t=n.componentId?"studio/{{userId}}/component/{{componentId}}/icons/":"studio/{{userId}}/{{appId}}/icons/",o=C(t);appService.getContents(o).then(function(t){const n=[],o=t.catalog.length;let i=0;const a=function(s){r.url(s.id).then(function(e){n.push({key:s.id,url:e.data})}).finally(function(){++i<o?a(t.catalog[i]):e.iconList.images=n})};o&&a(t.catalog[i])})},i.getImages(),p.onStart({},function(e){S&&(S.close(),S=void 0),f.hide()}),t.defaultErrorHandler(function(e,t,n){}),e.$on("$destroy",function(){i.fullScreenImage=void 0,N&&(o.cancel(N),N=void 0)})}]}}})}]).run(["$rootScope","toaster","app","$transitions",function(e,t,n,o){n.toaster=t,window.onbeforeunload=function(){},o.onSuccess({},function(t){e.previousState=t.from().name,e.currentState=t.to().name})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.customize",{url:"/component/:componentId",params:{refresh:0},resolve:{compInfo:["componentService","$stateParams","pageLoading","$q","$state","toaster",function(e,t,n,o,r,i){let a=o.defer();return t.componentId?e.getPermission(t.componentId).then(function(o){!o||"read"!==o.result||r.transition.to().$$state().includes["app.customize.read"]?!o||"write"!==o.result||r.transition.to().$$state().includes["app.customize.edit"]?e.get(t.componentId).then(function(e){a.resolve(e.componentInfo),n.show()},function(e){i.pop("warning","获取组件信息失败: "+e.msg),r.go("app.customize",{componentId:"",refresh:t.refresh+1})}):r.go("app.customize.edit",{componentId:t.componentId,refresh:t.refresh+1}):r.go("app.customize.read",{componentId:t.componentId,refresh:t.refresh+1})},function(e){i.pop("error","获取组件信息失败: "+e.msg),r.go("app.customize",{componentId:"",refresh:t.refresh+1})}):e.list(null,1).then(function(n){n.list&&n.list.length>0?r.go("app.customize",{componentId:n.list[0].id,refresh:t.refresh+1}):e.create("未命名组件",void 0).then(function(e){r.go("app.customize",{componentId:e.id,refresh:t.refresh+1})},function(e){i.pop("error","获取组件信息失败: "+e.msg)})},function(e){i.pop("error","获取组件信息失败: "+e.msg)}),a.promise}]},deepStateRedirect:{default:"app.customize.read",params:!0},views:{"edit@app":{templateUrl:"/tpl/exp.html",controller:["$scope","$state","$stateParams","pageLoading","nodeService","compInfo","$rootScope","$timeout","common",function(e,t,n,o,r,i,a,s,l){a.getImages();let c=$("#editor");r.init(c,null,function(){a.pageLoading=!1,o.hide()}),i.data||console.error("no data"),"string"==typeof i.data&&(i.data=JSON.parse(i.data)),a.$broadcast("toggle.customize",{id:i.id,dir:i.dir}),a.nodeId=r.addCustomNode(i.name,i.data),a.compInfo=angular.copy(i),delete a.compInfo.data,a.node=r.getNode(a.nodeId),a.controlList=[],a.paramsModel=r.getParamsModel(i.data.def.params);const p=a.$on("ngRepeatFinished",function(){const e=document.getElementById(i.id.toString());if(!e)return;const t=angular.element(e).offset().top,n=angular.element(".navi");(t<n.offset().top||t>n.height()+n.offset().top)&&n.scrollTop(e.offsetTop-n.height()/2)});a.change=function(t){e.controlList=[];let n={},o=function(){for(let t in e.paramsModel.port){let o=e.paramsModel.port[t];for(let e in o)n[o[e]]?(o.error_duplicate||(o.error_duplicate={}),o.error_duplicate[e]=!0):(o.error_duplicate&&o.error_duplicate[e]&&delete o.error_duplicate[e],o.error_duplicate&&l.isEmpty(o.error_duplicate)&&delete o.error_duplicate),n[o[e]]={type:"port",id:t,sub:e}}},r=function(){for(let t in e.paramsModel.control)e.paramsModel.control[t].value&&(e.controlList.push(e.paramsModel.control[t].value),n[e.paramsModel.control[t].value]?e.paramsModel.control[t].error_duplicate=!0:delete e.paramsModel.control[t].error_duplicate,n[e.paramsModel.control[t].value]={type:"control",id:t})};"control"===t&&(o(),r()),"port"===t&&(r(),o())},s(function(){e.change("control")}),r.setExpandIconClickedHandler(function(e,o){t.go("app.composite",{componentId:n.componentId})}),e.$on("$destroy",function(){a.nodeId=void 0,a.node=void 0,a.paramsModel=void 0,a.controlList=void 0,a.change=void 0,a.compInfo=void 0,r.setExpandIconClickedHandler(null),p()})}]},"page-panel@app.customize":{template:"<div ui-view='panel'></div>",controller:["$state","$stateParams","$scope","$rootScope","multiselect","common","nodeService","componentService","toaster",function(e,t,n,o,r,i,a,s,l){n.componentId=n.node.component,n.nodeTabInfo=n.node.metadata.ui.tabs}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.customize.edit",{url:"/edit",deepStateRedirect:{default:"app.customize.edit.setting",params:!0},views:{"header@app":{templateUrl:"/tpl/blocks/header_edit.html",controller:["$state","$stateParams","$scope","$rootScope","nodeService","remoteService","appService","toaster","$uibModal","$q","componentService",function(e,t,n,o,r,i,a,s,l,c,p){let u,d=n.save=function(){u&&(clearTimeout(u),u=void 0),u=setTimeout(function(){let o=r.getCustomizeNodeMetadata(n.nodeId,n.paramsModel);p.save(t.componentId,o).then(function(){},function(t){t&&"未授权"===t.msg&&e.reload(),s.pop("error","保存组件失败: "+t.msg)})},500)};n.$watch("node",function(){d()},!0),n.$watch("paramsModel",function(){d()},!0),r.setGraphChangeHandler(function(){d()}),n.$on("$destroy",function(){r.setGraphChangeHandler(null),u&&(clearTimeout(u),u=void 0)})}]},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.customize.edit.middle.html",controller:["$scope","$rootScope","$state",function(e,t,n){e.onFinish=function(){if(_.isEmpty(t.currentApp)){const n=_.find(Object.keys(e.appConfig.appMenu),function(n){return _.has(e.appConfig.appMenu[n],"componentType")&&_.get(e.appConfig.appMenu[n],"componentType").indexOf(t.compInfo.type)>-1});n&&window.SPLanding.onExpandList("/"+n)}else n.go("app."+t.currentApp.type,{type:t.currentApp.appType,id:t.currentApp.id})}}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.customize.edit.setting",{deepStateRedirect:{default:"app.customize.edit.setting.overview",params:!0},data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"},{type:"params",url:".params"},{type:"fields",url:".fields"},{type:"tune",url:".tune"}]},views:{"panel@app.customize":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.customize.edit.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_node_customize.html",controller:"editComponentController"}}}).state("app.customize.edit.setting.fields",{params:{controlId:""},data:{type:"fields"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"},"edit-second":{templateUrl:"/tpl/custom/edit_control.html",controller:"editControlController"}}}).state("app.customize.edit.setting.params",{params:{controlId:""},data:{type:"params"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"},"edit-second":{templateUrl:"/tpl/custom/edit_control.html",controller:"editControlController"}}}).state("app.customize.edit.setting.tune",{params:{controlId:""},data:{type:"tune"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"},"edit-second":{templateUrl:"/tpl/custom/edit_control.html",controller:"editControlController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.customize.read",{deepStateRedirect:{default:"app.customize.read.setting",params:!0},views:{"header@app":{templateUrl:"/tpl/blocks/header_edit.html",controller:["$state","$stateParams","$scope","$rootScope","nodeService","remoteService","appService","toaster","$uibModal","$q",function(e,t,n,o,r,i,a,s,l,c){o.readOnly=!0,n.$on("$destroy",function(){o.readOnly=void 0})}]},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.customize.read.middle.html",controller:["$scope","$rootScope","componentService","toaster","$stateParams","$state",function(e,t,n,o,r,i){e.requireEdit=function(){n.setPermission(r.componentId).then(function(e){i.reload("app.customize")},function(e){o.pop("error","请求失败: "+e.msg)})},t.stateAlert={type:"info",message:"当前状态仅支持查看，请在“编辑”状态下进行编辑"},e.onFinish=function(){if(_.isEmpty(t.currentApp)){const n=_.find(Object.keys(e.appConfig.appMenu),function(n){return _.has(e.appConfig.appMenu[n],"componentType")&&_.get(e.appConfig.appMenu[n],"componentType").indexOf(t.compInfo.type)>-1});n&&window.SPLanding.onExpandList("/"+n)}else i.go("app."+t.currentApp.type,{type:t.currentApp.appType,id:t.currentApp.id})},e.$on("$destroy",function(){t.stateAlert=null})}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.customize.read.setting",{deepStateRedirect:{default:"app.customize.read.setting.overview",params:!0},data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"},{type:"params",url:".params"},{type:"fields",url:".fields"},{type:"tune",url:".tune"}]},views:{"panel@app.customize":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.customize.read.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_node_customize.html",controller:"editComponentController"}}}).state("app.customize.read.setting.fields",{params:{controlId:""},data:{type:"fields"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"},"edit-second":{templateUrl:"/tpl/custom/edit_control.html",controller:"editControlController"}}}).state("app.customize.read.setting.params",{params:{controlId:""},data:{type:"params"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"},"edit-second":{templateUrl:"/tpl/custom/edit_control.html",controller:"editControlController"}}}).state("app.customize.read.setting.tune",{params:{controlId:""},data:{type:"tune"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"},"edit-second":{templateUrl:"/tpl/custom/edit_control.html",controller:"editControlController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.composite",{url:"/composite/:componentId",params:{refresh:0},resolve:{compInfo:["componentService","$stateParams","pageLoading","$q","$state","toaster",function(e,t,n,o,r,i){let a=o.defer();return t.componentId?e.getPermission(t.componentId).then(function(o){!o||"read"!==o.result||r.transition.to().$$state().includes["app.composite.read"]?!o||"write"!==o.result||r.transition.to().$$state().includes["app.composite.edit"]?e.get(t.componentId).then(function(e){a.resolve(e.componentInfo),n.show()},function(e){i.pop("warning","获取组件信息失败: "+e.msg),r.go("app.composite",{componentId:"",refresh:t.refresh+1})}):r.go("app.composite.edit",{componentId:t.componentId,refresh:t.refresh+1}):r.go("app.composite.read",{componentId:t.componentId,refresh:t.refresh+1})},function(e){i.pop("error","获取组件信息失败: "+e.msg)}):e.list(null,1).then(function(n){n.list&&n.list.length>0?r.go("app.composite",{componentId:n.list[0].id,refresh:t.refresh+1}):e.create("未命名组件",void 0).then(function(e){r.go("app.composite",{componentId:e.id,refresh:t.refresh+1})},function(e){i.pop("error","获取组件信息失败: "+e.msg)})},function(e){i.pop("error","获取组件信息失败: "+e.msg)}),a.promise}]},deepStateRedirect:{default:"app.composite.read",params:!0},views:{"edit@app":{templateUrl:"/tpl/exp.html",controller:["$scope","$state","$stateParams","pageLoading","nodeService","compInfo","$rootScope","$timeout","common",function(e,t,n,o,r,i,a,s,l){i.data||console.error("no data"),"string"==typeof i.data&&(i.data=JSON.parse(i.data));let c=$("#editor");r.init(c,i.data.def.composite,function(){o.hide(),a.$broadcast("editor.ready")}),a.compInfo=angular.copy(i),delete a.compInfo.data,a.compMetadata=angular.copy(i.data),delete a.compMetadata.def.composite,a.$$phase||a.$digest(),e.$on("$destroy",function(){a.compInfo=void 0,a.compMetadata=void 0})}]},"page-panel@app.composite":{template:"<div ui-view='panel'></div>",controller:["$state","$stateParams","$scope","$rootScope","multiselect","common","nodeService","componentService","toaster",function(e,t,n,o,r,i,a,s,l){}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.composite.edit",{url:"/edit",deepStateRedirect:{default:"app.composite.edit.setting",params:!0},views:{"header@app":{templateUrl:"/tpl/blocks/header_edit.html",controller:["$state","$stateParams","$scope","$rootScope","nodeService","remoteService","componentService","toaster","$uibModal","$q",function(e,t,n,o,r,i,a,s,l,c){let p,u=o.save=function(){let n=c.defer();return p&&(clearTimeout(p),p=void 0),p=setTimeout(function(){p=void 0;let n=angular.copy(o.compMetadata);n.def.composite=r.getGraphJson(),a.save(t.componentId,n).then(function(e,t){},function(t){t&&"未授权"===t.msg&&e.reload(),s.pop("error","保存组件失败: "+t.msg)})},500),n.promise};n.$watch("compMetadata",function(){u()},!0),r.setGraphChangeHandler(function(){u()}),r.setNodeSelectionHandler(function(t,n,o,r){n?e.go("app.composite.edit.node",{nodeId:n}):e.go("app.composite.edit")}),r.setEdgeSelectionHandler(function(t,n){t?e.go("app.composite.edit.edge",{edgeId:t}):e.go("app.composite.edit.setting")}),n.$on("$destroy",function(){r.setNodeSelectionHandler(null),r.setEdgeSelectionHandler(null),r.setGraphChangeHandler(null),o.save=void 0,p&&(clearTimeout(p),p=void 0)})}]},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.customize.edit.middle.html",controller:["$scope","$rootScope",function(e,t){}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.composite.edit.node",{url:"/:nodeId",params:{},deepStateRedirect:{default:"app.composite.edit.node.setting",params:!0},views:{"page-panel@app.composite":{template:"<div ui-view='panel'></div>",controller:["$state","$stateParams","$scope","$rootScope","multiselect","common","nodeService","logService",function(e,t,n,o,r,i,a,s){let l=$("#editor #"+t.nodeId);l&&0!==l.length?(n.nodeId=t.nodeId,n.node=a.getNode(n.nodeId),n.nodeTabInfo=n.node.metadata.ui?n.node.metadata.ui.tabs:{},n.componentId=n.node.component,n.logId=s.getLogId(window.appConfig.userId,t.id,t.nodeId),n.$watch("node",function(e,t){e!==t&&n.save()},!0),$(document).on("keydown.node.edit",function(e){let t=$(e.target);if(!t.is("input")&&!t.is("textarea"))switch(e.keyCode){case 46:case 8:e.stopPropagation(),o.removeNode(n.node,"app.composite.edit");break;case 67:(e.ctrlKey||e.metaKey)&&(e.stopPropagation(),o.copiedNode=angular.copy(n.node.metadata),o.copiedComp=angular.copy(n.node.component));break;case 86:(e.ctrlKey||e.metaKey)&&(e.stopPropagation(),o.copiedNode&&a.pasteNode(o.copiedNode,n.node.component))}}),l.addClass("selected"),n.$on("$destroy",function(){l.removeClass("selected"),$(document).off("keydown.node.edit")})):e.go("app.composite.edit")}]},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.customize.edit.middle.html",controller:["$scope","$rootScope",function(e,t){}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.composite.edit.node.setting",{deepStateRedirect:{default:"app.composite.edit.node.setting.overview",params:!0},sticky:!0,data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"},{type:"params",url:".params"},{type:"fields",url:".fields"},{type:"tune",url:".tune"}]},views:{"panel@app.composite.edit.node":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.composite.edit.node.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_node_edit.html",controller:"expNodeSettingOverviewController"}}}).state("app.composite.edit.node.setting.fields",{data:{type:"fields"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.composite.edit.node.setting.params",{data:{type:"params"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.composite.edit.node.setting.tune",{data:{type:"tune"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.composite.edit.setting",{deepStateRedirect:{default:"app.composite.edit.setting.overview",params:!0},data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"}]},views:{"panel@app.composite":{templateUrl:"/tpl/custom/panels/index.html",controller:"compositeSettingController"}}}).state("app.composite.edit.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_node_customize.html",controller:"editComponentController"}}}).state("app.composite.edit.setting.fields",{params:{controlId:""},data:{type:"fields"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"},"edit-second":{templateUrl:"/tpl/custom/edit_control.html",controller:"editControlController"}}}).state("app.composite.edit.setting.params",{params:{controlId:""},data:{type:"params"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"},"edit-second":{templateUrl:"/tpl/custom/edit_control.html",controller:"editControlController"}}}).state("app.composite.edit.setting.tune",{params:{controlId:""},data:{type:"tune"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"},"edit-second":{templateUrl:"/tpl/custom/edit_control.html",controller:"editControlController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.composite.read",{deepStateRedirect:{default:"app.composite.read.setting",params:!0},views:{"header@app":{templateUrl:"/tpl/blocks/header_edit.html",controller:"readController"},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.exp.read.middle.html",controller:["$scope","$rootScope","toaster","appService","$stateParams","$state","$window",function(e,t,n,o,r,i,a){e.requireEdit=function(){o.setPermission(r.id).then(function(e){i.reload("app.composite")},function(e){n.pop("error","请求失败: "+e.msg)})},t.stateAlert={type:"info",message:"当前状态仅支持查看，请在“编辑”状态下进行编辑"},e.$on("$destroy",function(){t.stateAlert=null})}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.composite.read.setting",{deepStateRedirect:{default:"app.composite.read.setting.overview",params:!0},data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"}]},views:{"panel@app.composite":{templateUrl:"/tpl/custom/panels/index.html",controller:"compositeSettingController"}}}).state("app.composite.read.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_node_customize.html",controller:"editComponentController"}}}).state("app.composite.read.setting.fields",{params:{controlId:""},data:{type:"fields"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"},"edit-second":{templateUrl:"/tpl/custom/edit_control.html",controller:"editControlController"}}}).state("app.composite.read.setting.params",{params:{controlId:""},data:{type:"params"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"},"edit-second":{templateUrl:"/tpl/custom/edit_control.html",controller:"editControlController"}}}).state("app.composite.read.setting.tune",{params:{controlId:""},data:{type:"tune"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"},"edit-second":{templateUrl:"/tpl/custom/edit_control.html",controller:"editControlController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp",{url:"/app/:type/:id",params:{refresh:0},resolve:{appInfo:["appService","$stateParams","rpaService","$q","$state","toaster","pageLoading",function(e,t,n,o,r,i,a){const s=o.defer(),l=t.type||"algo",c=function(n){e.get(n).then(function(e){s.resolve(e.appInfo)},function(e){i.pop("error","获取项目信息失败: "+e.msg),r.go("app.exp",{type:l,id:"",refresh:t.refresh+1})})},p=function(e){t.nodeId?r.go(e+".node",{type:l,id:t.id,nodeId:t.nodeId,refresh:t.refresh+1}):r.go(e,{type:l,id:t.id,refresh:t.refresh+1})};if(a.show(),t.id)if(r.transition.to().$$state().includes["app.exp.history"])c(t.id);else{let o=e;"rpa"===l&&(o=n),o.getNetworkStatus(t.id).then(function(n){if(n&&n.map){if("1"===n.map.status||"5"===n.map.status||"6"===n.map.status||"9"===n.map.status)return r.transition.to().$$state().includes["app.exp.run"]?void c(t.id):void p("app.exp.run");if("8"===n.map.status)return r.transition.to().$$state().includes["app.exp.cron"]?void c(t.id):void p("app.exp.cron")}e.getPermission(t.id).then(function(n){if(!n||"write"!==n.result||r.transition.to().$$state().includes["app.exp.edit"]){if(n&&"read"===n.result){if(r.transition.to().$$state().includes["app.exp.edit"])return void e.setPermission(t.id).then(function(e){c(t.id)},function(e){p("app.exp.read")});if(!r.transition.to().$$state().includes["app.exp.read"])return void p("app.exp.read")}c(t.id)}else p("app.exp.edit")},function(e){i.pop("error","获取项目信息失败: "+e.msg),r.go("app.exp",{type:l,id:"",refresh:t.refresh+1})})},function(e){i.pop("error","获取项目信息失败: "+e.msg),r.go("app.exp",{type:l,id:"",refresh:t.refresh+1})})}else{const n=function(){e.create("未命名项目",null,l).then(function(e){r.go("app.exp",{type:l,id:e.id,refresh:t.refresh+1})},function(e){i.pop("error","获取项目信息失败: "+e.msg)})};e.list(30,l).then(function(o){if(o&&o.list&&o.list.length>0){let i=0;const a=function(s){i++,e.head(s.id).then(function(e){r.go("app.exp",{type:l,id:s.id,refresh:t.refresh+1})},function(e){i<o.list.length?a(o.list[i]):n()})};a(o.list[i])}else n()},function(e){i.pop("error","获取项目信息失败: "+e.msg)})}return s.promise}]},deepStateRedirect:{default:"app.exp.edit",params:!0},views:{"edit@app":{templateUrl:"/tpl/exp.html",controller:["$scope","$state","$stateParams","appInfo","pageLoading","nodeService","$rootScope","logService","toaster",function(e,t,n,o,r,i,a,s,l){window.appConfig.appId=n.id;const c=_.get(a.appConfig,"appMenu");if(a.currentApp={type:_.split(t.$current.name,".")[1],appType:n.type,id:n.id,icon:c[n.type].icon,name:c[n.type].name},a.$broadcast("toggle.app",n.type),!_.isEmpty(o.data)){const e=_.get(JSON.parse(o.data),"timestamp"),t=e?{status:"lastSaved",timestamp:e}:null;a.$broadcast("app-saved",t)}a.getImages();const p=$("#editor");i.init(p,o.data,function(){r.hide(),a.$broadcast("editor.ready")}),a.appInfo=angular.copy(o),a.appLogId=s.getAppLogId(window.appConfig.userId,n.id),delete a.appInfo.data,a.$$phase||a.$digest(),a.runStartStop=function(){a.stateAlert=null;const e=i.onValidated();if(e&&"error"===e.status)return void(a.stateAlert={type:"danger",fadeOut:!0,message:e.message});let o=l.pop({type:"info",body:"starting-html",bodyOutputType:"directive",directiveData:{title:"正在保存"},timeout:0});a.doSave().finally(function(){l.clear(o),o=null,t.go("app.exp.prepare",{type:n.type,runType:"runStartStop"})})},e.$on("$destroy",function(){a.appInfo=void 0,a.appLogId=void 0,window.appConfig.appId=void 0,a.runStartStop=void 0})}]},"page-panel@app.exp":{template:"<div ui-view='panel'></div>"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.edit",{deepStateRedirect:{default:"app.exp.edit.setting",params:!0},views:{"header@app":{templateUrl:"/tpl/blocks/header_edit.html",controller:["$state","$stateParams","$scope","$rootScope","nodeService","rpaService","appService","toaster","$q",function(e,t,n,o,r,i,a,s,l){let c,p=$("#editor");n.$on("editor.ready",function(){p=$("#editor")});let u=t.type||"algo",d=a;"rpa"===u&&(d=i);let f,h=0,m=function(){p&&p.length?(r.showAllScreenshots(),d.getNetworkStatus(t.id).then(function(e){if(!e||!e.map)return;let t=e.map;for(let e in t){if(!e.startsWith("node.status."))continue;let n=e.replace("node.status.",""),o=t[e],r=$("#"+n);switch(o){case"4":r.find(".the-graph-spin").hide(),r.find(".the-graph-success-icon").hide(),r.find(".the-graph-error-icon").show();break;case"3":r.find(".the-graph-spin").hide(),r.find(".the-graph-success-icon").show(),r.find(".the-graph-error-icon").hide();break;case"1":break;default:r.find(".the-graph-spin").hide(),r.find(".the-graph-success-icon").hide(),r.find(".the-graph-error-icon").hide()}}e.msg&&e.msg[h]&&(s.pop("info",e.msg[h]),h+=1)})):c=window.setTimeout(m,1e3)};m(),o.doSave=function(n){let i=l.defer(),c=r.getGraphJson();const p=(new Date).getTime();return c.timestamp=p,a.save(t.id,c).then(function(){n?s.pop("success","保存成功"):o.$broadcast("app-saved",{status:"success",timestamp:p}),i.resolve()},function(n){s.pop("error","保存项目失败: "+n.msg),"NetworkingError"!==_.get(n,"err.code")&&e.go("app.exp.read",{type:u,id:t.id,refresh:t.refresh+1}),i.reject(n)}),i.promise};let g,v=o.save=function(){f||(f=setTimeout(function(){o.doSave(),clearTimeout(f),f=void 0},1e3))};r.setGraphChangeHandler(function(){v();const e=r.getGraph();_.isEmpty(e.properties.preview)?g||(g=window.setTimeout(function(){o.screenshots("screen_shot.png"),window.clearTimeout(g),g=void 0},1e4)):g&&(window.clearTimeout(g),g=void 0)}),r.setEdgeSelectionHandler(function(t,n){t?e.go("app.exp.edit.edge",{edgeId:t}):e.go("app.exp.edit.setting")}),r.setGroupSelectionHandler(function(t){t&&e.go("app.exp.edit.group",{groupId:t})}),r.setNodeSelectionHandler(function(t,n,r,i){if(t.ctrlKey||t.metaKey)if(n)if(e.includes("app.exp.edit.multi")){let t=e.params.nodes.indexOf(n);-1===t?(e.params.nodes.push(n),o.$broadcast("multi.nodes.add",{nodeId:n})):1===e.params.nodes.length?e.go("app.exp.edit"):(e.params.nodes.splice(t,1),o.$broadcast("multi.nodes.remove",{nodeId:n}))}else e.includes("app.exp.edit.node")?e.params.nodeId!==n?e.go("app.exp.edit.multi",{nodes:[e.params.nodeId,n]}):e.go("app.exp.edit.node",{nodeId:n}):n?e.go("app.exp.edit.node",{nodeId:n}):e.go("app.exp.edit");else e.go("app.exp.edit");else n?e.go("app.exp.edit.node",{nodeId:n}):e.go("app.exp.edit")}),r.setNodeRectImgDblclickHandler.call(this,function(e,n,r){if("dblclick"==e.type&&n&&r){let e="studio/"+window.appConfig.userId+"/logs/"+t.id+"/screenshots/"+n+"/";o.showFiles(e)}}),$(document).on("keydown.edit",function(e){let t=$(e.target);if(!(t.is("input")||t.is("textarea")||t.is(".form-control")))switch(e.keyCode){case 86:(e.ctrlKey||e.metaKey)&&(e.stopPropagation(),o.copiedNode&&r.pasteNode(o.copiedNode,o.copiedComp));break;case 90:if((e.ctrlKey||e.metaKey)&&(e.stopPropagation(),o.removedNodes.length)){let e=o.removedNodes.pop(),t=e.metadata,n=r.getNodeOriginalPosision(t.x,t.y);switch(t.type){case"public_component":r.addPublicRemoteNode(e.component,n.x,n.y,t.type);break;case"my_component":r.addRemoteNode(e.component,n.x,n.y,t.type);break;case"hufu_component":r.addHufuNode(e.component,t.label,t.icon,n.x,n.y,t.type)}}}}),n.$on("$destroy",function(){window.clearTimeout(c),window.clearTimeout(g),r.setNodeSelectionHandler(null),r.setGroupSelectionHandler(null),r.setEdgeSelectionHandler(null),r.setGraphChangeHandler(null),r.setNodeRectImgDblclickHandler(null),$(document).off("keydown.edit"),o.removedNodes=[],o.save=void 0,o.doSave=void 0,f&&(clearTimeout(f),f=void 0)})}]},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.exp.edit.middle.html"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.edit.setting",{deepStateRedirect:{default:"app.exp.edit.setting.overview",params:!0},data:{info:{type:"setting"},tabs:[{name:{zh_CN:"项目属性"},type:"overview",url:".overview"}]},views:{"panel@app.exp":{templateUrl:"/tpl/custom/panels/index.html",controller:"expSettingController"}}}).state("app.exp.edit.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview.html",controller:"expSettingOverviewController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.edit.node",{url:"/:nodeId",params:{},deepStateRedirect:{default:"app.exp.edit.node.setting",params:!0},views:{"page-panel@app.exp":{template:"<div ui-view='panel'></div>",controller:["$state","$stateParams","$scope","$rootScope","nodeService","logService","appService","toaster",function(e,t,n,o,r,i,a,s){let l=null;if(_.isEmpty(t.nodeId)||(l=$("#editor #"+t.nodeId)),!l||0===l.length)return void e.go("app.exp.edit");n.nodeId=t.nodeId,n.node=r.getNode(n.nodeId),n.nodeTabInfo=n.node.metadata.ui?n.node.metadata.ui.tabs:{},n.componentId=n.node.component,n.logId=i.getLogId(window.appConfig.userId,t.id,t.nodeId),o.nodeCompType=n.node.metadata.def.type,o.$broadcast("toggle.node",n.node),n.resetTabInfo(n.node.metadata.def.params,n.nodeTabInfo),998===o.nodeCompType&&(n.appList=[],a.list(9999,"algo").then(function(e){e&&e.list&&(n.appList=_.filter(e.list,function(e){return e.id!=t.id}))},function(e){s.pop("error","获取项目列表失败: "+e.msg)})),n.updateCompositeAppId=function(e){n.node.metadata.def.compositeParams=[],n.node.metadata.def.ports=[],n.node.metadata.def.compositeApp=_.find(n.appList,{id:e}),a.get(e).then(function(e){n.node.metadata.def.ports=[],n.node.metadata.def.composite=JSON.parse(e.appInfo.data),r.collectCompositePorts(n.node.metadata.def.composite,n.node.metadata.def.ports),r.changeNode(t.nodeId),n.save()},function(e){s.pop("error","获取项目信息失败: "+e.msg)})},n.node,n.$watch("node",function(e,t){e!==t&&n.save()},!0),$(document).on("keydown.node.edit",function(e){let t=$(e.target);if(!t.is("input")&&!t.is("textarea"))switch(e.keyCode){case 46:case 8:e.stopPropagation(),o.removeNode(n.node,"app.exp.edit");break;case 67:(e.ctrlKey||e.metaKey)&&(e.stopPropagation(),o.copiedNode=angular.copy(n.node.metadata),n.node.metadata.def.compositeAppId&&(delete o.copiedNode.initCoord,delete o.copiedNode.def.composite,delete o.copiedNode.def.compositeAppId,delete o.copiedNode.def.compositeParams),o.copiedComp=angular.copy(n.node.component));break;case 37:n.node.metadata.x-=1,r.changeNode(n.nodeId);break;case 38:n.node.metadata.y-=1,r.changeNode(n.nodeId);break;case 39:n.node.metadata.x+=1,r.changeNode(n.nodeId);break;case 40:n.node.metadata.y+=1,r.changeNode(n.nodeId)}}),l.addClass("selected");let c=r.hightEdges(t.nodeId);n.$on("$destroy",function(){o.nodeCompType=void 0,l.removeClass("selected"),$(c).removeClass("active"),$(document).off("keydown.node.edit"),o.$broadcast("toggle.node",null)})}]},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.exp.edit.node.middle.html",controller:["$scope","$stateParams","$rootScope","appService","nodeService","$state","toaster",function(e,t,n,o,r,i,a){e.a={},e.doRun=function(e,t){const o="runStartStop"==e&&t,s=r.onValidated(o);if(s&&"error"===s.status)return void a.pop("warning",s.message);let l=a.pop({type:"info",body:"starting-html",bodyOutputType:"directive",directiveData:{title:"正在保存"},timeout:0});n.doSave().finally(function(){a.clear(l),l=null,i.go("app.exp.prepare.node",{nodeId:t,runType:e,targetNodeId:t})})},e.doExpand=function(){const e=r.getNode(t.nodeId);if("composite"!==e.component){const n=_.get(e,"metadata.def.compositeAppId");if(!n)return void a.pop("warning","该组件缺少运行的项目");o.get(n).then(function(n){e.metadata.def.composite=JSON.parse(n.appInfo.data),r.collectCompositePorts(e.metadata.def.composite,e.metadata.def.ports),r.changeNode(t.nodeId)},function(e){a.pop("error","获取项目信息失败: "+e.msg)}).finally(function(){r.expandGroup(e),requestAnimationFrame(function(){i.go("app.exp.edit.group",{groupId:t.nodeId})})})}else r.expandGroup(e),i.go("app.exp.edit.group",{groupId:t.nodeId})}}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.edit.node.setting",{deepStateRedirect:{default:"app.exp.edit.node.setting.overview",params:!0},sticky:!0,data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"},{type:"params",url:".params"},{type:"fields",url:".fields"},{type:"tune",url:".tune"}]},views:{"panel@app.exp.edit.node":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.exp.edit.node.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_node_edit.html",controller:"expNodeSettingOverviewController"}}}).state("app.exp.edit.node.setting.fields",{data:{type:"fields"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.exp.edit.node.setting.params",{data:{type:"params"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.exp.edit.node.setting.tune",{data:{type:"tune"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.edit.multi",{url:"/nodes",params:{nodes:null},deepStateRedirect:{default:"app.exp.edit.multi.setting",params:!0},views:{"page-panel@app.exp":{template:"<div ui-view='panel'></div>",controller:["$state","$stateParams","$scope","$rootScope","multiselect","common","nodeService",function(e,t,n,o,r,i,a){if(!t.nodes||!t.nodes.length)return void e.go("app.exp.edit");n.getMultiNodes=function(){return _.map(t.nodes,function(e){return a.getNode(e)})};$(document).on("keydown.node.edit",function(e){let t=$(e.target);var r;if(!t.is("input")&&!t.is("textarea"))switch(e.keyCode){case 46:case 8:e.stopPropagation();const t=n.getMultiNodes();o.removeMultiNodes(t,"app.exp.edit");break;case 67:(e.ctrlKey||e.metaKey)&&e.stopPropagation();break;case 37:case 38:case 39:case 40:r=e.keyCode,_.forEach(n.nodes,function(e){switch(r){case 37:e.metadata.x-=10,a.changeNode(e.id);break;case 38:e.metadata.y-=10,a.changeNode(e.id);break;case 39:e.metadata.x+=10,a.changeNode(e.id);break;case 40:e.metadata.y+=10,a.changeNode(e.id)}})}});for(let e=0;e<t.nodes.length;e++){$("#editor #"+t.nodes[e]).addClass("selected")}n.$on("multi.nodes.add",function(e,t){$("#editor #"+t.nodeId).addClass("selected")}),n.$on("multi.nodes.remove",function(e,t){$("#editor #"+t.nodeId).removeClass("selected")}),n.$on("$destroy",function(){for(let e=0;e<t.nodes.length;e++){$("#editor #"+t.nodes[e]).removeClass("selected")}$(document).off("keydown.node.edit")})}]},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.exp.edit.multi.middle.html",controller:["$scope","$rootScope","$stateParams","appService","nodeService","$state","common",function(e,t,n,o,r,i,a){e.a={},e.a.doGroup=function(){let e=a.uuid();r.addGroup(e,n.nodes,{name:"未命名组合",component:"composite",data:{}}),i.go("app.exp.edit.group",{groupId:e})};let s=function(){if(n.nodes){for(let o=0;o<n.nodes.length;o++){if(r.whichGroup(n.nodes[o]).length)return e.a.canotGroup=!0,void(t.$$phase||t.$apply())}e.a.canotGroup=!1,t.$$phase||t.$apply()}};s(),e.$on("multi.nodes.add",function(e,t){s()}),e.$on("multi.nodes.remove",function(e,t){s()}),e.$on("$destroy",function(){})}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.edit.multi.setting",{deepStateRedirect:{default:"app.exp.edit.multi.setting.overview",params:!0},sticky:!0,data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"}]},views:{"panel@app.exp.edit.multi":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.exp.edit.multi.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_multi_edit.html",controller:"expMultiSettingOverviewController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.edit.edge",{params:{edgeId:null},deepStateRedirect:{default:"app.exp.edit.edge.setting",params:!0},views:{"page-panel@app.exp":{template:"<div ui-view='panel'></div>",controller:["$state","$stateParams","$scope","nodeService",function(e,t,n,o){let r=$("#"+t.edgeId);if(!r||0===r.length)return void e.go("app.exp.edit");r.addClass("selected"),r.parent().append(r);let i=t.edgeId.split("-");n.edge=o.getEdge(i[1],i[2],i[4],i[3]),_.get(n.edge,"metadata.color")||_.set(n.edge,"metadata.color","#a6a6a6"),$(document).on("keydown.edge.edit",function(t){let o=$(t.target);if(!o.is("input")&&!o.is("textarea"))switch(t.keyCode){case 46:case 8:t.stopPropagation(),n.removeEdge(n.edge,_.get(e,"current.name").split(".edge")[0])}}),n.$on("$destroy",function(){r.removeClass("selected"),$(document).off("keydown.edge.edit")})}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.edit.edge.setting",{deepStateRedirect:{default:"app.exp.edit.edge.setting.overview",params:!0},data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"}]},views:{"panel@app.exp.edit.edge":{templateUrl:"/tpl/custom/panels/index.html",controller:["$state","$stateParams","$scope","$timeout","$rootScope","common","nodeService",function(e,t,n,o,r,i,a){n.tabs=angular.copy(e.current.data.tabs),n.currentTab={},n.$on("$destroy",function(){})}]}}}).state("app.exp.edit.edge.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_edge.html",controller:["$state","$scope",function(e,t){t.currentTab.type=e.current.data.type,t.currentTab.title=_.get(_.find(t.tabs,{type:t.currentTab.type}),"name.zh_CN")}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.edit.group",{url:"/group/:groupId",params:{nodes:null},deepStateRedirect:{default:"app.exp.edit.group.setting",params:!0},views:{"page-panel@app.exp":{template:"<div ui-view='panel'></div>",controller:["$state","$stateParams","$scope","$rootScope","nodeService",function(e,t,n,o,r){o.group=r.getGroup(t.groupId);let i=$("#editor #"+t.groupId);n.nodeTabInfo={params:{controls:[],tabName:{en_US:"Parameters Setting",zh:"参数设置",zh_CN:"参数设置"}}},o.nodeCompType="group",i.addClass("selection");let a=r.getGroupConnections(r.getGraph().toJSON(),n.group);r.collectGroupInport(a.inConnections,[]),r.collectGroupOutport(a.outConnections,[]),$(document).on("keydown.group.edit",function(e){let t=$(e.target);if(!t.is("input")&&!t.is("textarea"))switch(e.keyCode){case 46:case 8:e.stopPropagation(),o.removeGroup(o.group,"app.exp")}}),n.$on("$destroy",function(){o.nodeCompType=void 0,o.group=void 0,i.removeClass("selection"),$(document).off("keydown.group.edit")})}]},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.exp.edit.group.middle.html",controller:["$scope","$rootScope","$stateParams","appService","nodeService","$state","common",function(e,t,n,o,r,i,a){e.unGroup=function(){r.removeGroup(n.groupId),i.go("app.exp")};let s=function(){e.a={},r.getChildGroup(n.groupId).length&&(e.a.canotFold=!0)};r.getGraph()?s():e.$on("editor.ready",function(){s()}),e.doFold=function(){r.foldGroup(n.groupId),requestAnimationFrame(function(){i.go("app.exp.edit.node",{nodeId:n.groupId})})}}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.edit.group.setting",{deepStateRedirect:{default:"app.exp.edit.group.setting.overview",params:!0},sticky:!0,data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"},{type:"params",url:".params"}]},views:{"panel@app.exp.edit.group":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.exp.edit.group.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_group.html",controller:"expGroupSettingOverviewController"}}}).state("app.exp.edit.group.setting.params",{data:{type:"params"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.cron",{deepStateRedirect:{default:"app.exp.cron.setting",params:!0},views:{"header@app":{templateUrl:"/tpl/blocks/header_edit.html",controller:"readController"},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.exp.run.middle.html",controller:["$scope","$rootScope","toaster","appService","$stateParams","nodeService","$state",function(e,t,n,o,r,i,a){e.stop=function(){o.stopCron(r.id,i.getCronConfig()).then(function(e){n.pop("success","停止定时运行成功"),a.reload()},function(e){n.pop("error","停止定时运行失败: "+e.msg)})}}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.cron.node",{url:"/:nodeId",params:{nodeId:null},deepStateRedirect:{default:"app.exp.cron.node.setting",params:!0},views:{"page-panel@app.exp":{template:"<div ui-view='panel'></div>",controller:"readNodeController"}}}).state("app.exp.cron.setting",{deepStateRedirect:{default:"app.exp.cron.setting.overview",params:!0},data:{info:{type:"setting"},tabs:[{name:{zh_CN:"项目属性"},type:"overview",url:".overview"}]},views:{"panel@app.exp":{templateUrl:"/tpl/custom/panels/index.html",controller:"expSettingController"}}}).state("app.exp.cron.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview.html",controller:"expSettingOverviewController"}}}).state("app.exp.cron.node.setting",{deepStateRedirect:{default:"app.exp.cron.node.setting.overview",params:!0},sticky:!0,data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"},{type:"params",url:".params"},{type:"fields",url:".fields"},{type:"tune",url:".tune"}]},views:{"panel@app.exp.cron.node":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.exp.cron.node.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_node_edit.html",controller:"expNodeSettingOverviewController"}}}).state("app.exp.cron.node.setting.fields",{data:{type:"fields"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.exp.cron.node.setting.params",{data:{type:"params"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.exp.cron.node.setting.tune",{data:{type:"tune"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.history",{url:"/history",deepStateRedirect:{default:"app.exp.history.setting",params:!0},views:{"header@app":{templateUrl:"/tpl/blocks/header_edit.html",controller:"readController"},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.exp.history.middle.html",controller:["$scope","$rootScope","$state",function(e,t,n){e.backToApp=function(e){let t=e.split("_");n.go("app.exp.edit",{id:t[0]},{reload:!0})}}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.history.node",{url:"/:nodeId",params:{nodeId:null},deepStateRedirect:{default:"app.exp.history.node.setting",params:!0},views:{"page-panel@app.exp":{template:"<div ui-view='panel'></div>",controller:"readNodeController"}}}).state("app.exp.history.setting",{deepStateRedirect:{default:"app.exp.history.setting.overview",params:!0},data:{info:{type:"setting"},tabs:[{name:{zh_CN:"项目属性"},type:"overview",url:".overview"}]},views:{"panel@app.exp":{templateUrl:"/tpl/custom/panels/index.html",controller:"expSettingController"}}}).state("app.exp.history.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview.html",controller:"expSettingOverviewController"}}}).state("app.exp.history.node.setting",{deepStateRedirect:{default:"app.exp.history.node.setting.overview",params:!0},sticky:!0,data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"},{type:"params",url:".params"},{type:"fields",url:".fields"},{type:"tune",url:".tune"}]},views:{"panel@app.exp.history.node":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.exp.history.node.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_node_edit.html",controller:"expNodeSettingOverviewController"}}}).state("app.exp.history.node.setting.fields",{data:{type:"fields"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.exp.history.node.setting.params",{data:{type:"params"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.exp.history.node.setting.tune",{data:{type:"tune"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.run",{deepStateRedirect:{default:"app.exp.run.setting",params:!0},views:{"header@app":{templateUrl:"/tpl/blocks/header_edit.html",controller:"readController"},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.exp.run.middle.html",controller:["$scope","$rootScope","toaster","appService","$stateParams","rpaService",function(e,t,n,o,r,i){let a="algo"===r.type?o:i;e.stop=function(){a.stop(r.id).then(function(e){},function(e){n.pop("error","停止运行失败: "+e.msg)})},t.stateAlert={type:"danger",message:"项目运行期间请勿编辑"},e.$on("$destroy",function(){t.stateAlert=null})}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.run.node",{url:"/:nodeId",params:{nodeId:null},deepStateRedirect:{default:"app.exp.run.node.setting",params:!0},views:{"page-panel@app.exp":{template:"<div ui-view='panel'></div>",controller:"readNodeController"}}}).state("app.exp.run.group",{url:"/:groupId",params:{groupId:null},deepStateRedirect:{default:"app.exp.run.group.setting",params:!0},views:{"page-panel@app.exp":{template:"<div ui-view='panel'></div>",controller:"readGroupController"}}}).state("app.exp.run.setting",{deepStateRedirect:{default:"app.exp.run.setting.overview",params:!0},data:{info:{type:"setting"},tabs:[{name:{zh_CN:"项目属性"},type:"overview",url:".overview"}]},views:{"panel@app.exp":{templateUrl:"/tpl/custom/panels/index.html",controller:"expSettingController"}}}).state("app.exp.run.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview.html",controller:"expSettingOverviewController"}}}).state("app.exp.run.node.setting",{deepStateRedirect:{default:"app.exp.run.node.setting.overview",params:!0},sticky:!0,data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"},{type:"params",url:".params"},{type:"fields",url:".fields"},{type:"tune",url:".tune"}]},views:{"panel@app.exp.run.node":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.exp.run.group.setting",{deepStateRedirect:{default:"app.exp.run.group.setting.overview",params:!0},sticky:!0,data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"}]},views:{"panel@app.exp.run.group":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.exp.run.node.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_node_edit.html",controller:"expNodeSettingOverviewController"}}}).state("app.exp.run.group.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_group.html",controller:"expGroupSettingOverviewController"}}}).state("app.exp.run.node.setting.fields",{data:{type:"fields"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.exp.run.node.setting.params",{data:{type:"params"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.exp.run.node.setting.tune",{data:{type:"tune"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.prepare",{params:{runType:"",targetNodeId:""},deepStateRedirect:{default:"app.exp.prepare.setting",params:!0},views:{"header@app":{templateUrl:"/tpl/blocks/header_edit.html",controller:"readController"},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.exp.run.middle.html",controller:"prepareController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.prepare.node",{url:"/:nodeId",params:{nodeId:null},deepStateRedirect:{default:"app.exp.prepare.node.setting",params:!0},views:{"page-panel@app.exp":{template:"<div ui-view='panel'></div>",controller:"readNodeController"}}}).state("app.exp.prepare.setting",{deepStateRedirect:{default:"app.exp.prepare.setting.overview",params:!0},data:{info:{type:"setting"},tabs:[{name:{zh_CN:"项目属性"},type:"overview",url:".overview"}]},views:{"panel@app.exp":{templateUrl:"/tpl/custom/panels/index.html",controller:"expSettingController"}}}).state("app.exp.prepare.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview.html",controller:"expSettingOverviewController"}}}).state("app.exp.prepare.node.setting",{deepStateRedirect:{default:"app.exp.prepare.node.setting.overview",params:!0},sticky:!0,data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"},{type:"params",url:".params"},{type:"fields",url:".fields"},{type:"tune",url:".tune"}]},views:{"panel@app.exp.prepare.node":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.exp.prepare.node.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_node_edit.html",controller:"expNodeSettingOverviewController"}}}).state("app.exp.prepare.node.setting.fields",{data:{type:"fields"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.exp.prepare.node.setting.params",{data:{type:"params"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.exp.prepare.node.setting.tune",{data:{type:"tune"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.read",{deepStateRedirect:{default:"app.exp.read.setting",params:!0},views:{"header@app":{templateUrl:"/tpl/blocks/header_edit.html",controller:"readController"},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.exp.read.middle.html",controller:["$scope","$rootScope","toaster","appService","$stateParams","$state","$window",function(e,t,n,o,r,i,a){e.requireEdit=function(){o.setPermission(r.id).then(function(e){i.reload("app.exp")},function(e){n.pop("error","请求失败: "+e.msg)})},t.stateAlert={type:"info",message:"当前状态仅支持查看，请在“编辑”状态下进行编辑"},e.$on("$destroy",function(){t.stateAlert=null})}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.exp.read.node",{url:"/:nodeId",params:{nodeId:null},deepStateRedirect:{default:"app.exp.read.node.setting",params:!0},views:{"page-panel@app.exp":{template:"<div ui-view='panel'></div>",controller:"readNodeController"}}}).state("app.exp.read.group",{url:"/group/:groupId",params:{groupId:null},deepStateRedirect:{default:"app.exp.read.group.setting",params:!0},views:{"page-panel@app.exp":{template:"<div ui-view='panel'></div>",controller:"readGroupController"}}}).state("app.exp.read.setting",{deepStateRedirect:{default:"app.exp.read.setting.overview",params:!0},data:{info:{type:"setting"},tabs:[{name:{zh_CN:"项目属性"},type:"overview",url:".overview"}]},views:{"panel@app.exp":{templateUrl:"/tpl/custom/panels/index.html",controller:"expSettingController"}}}).state("app.exp.read.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview.html",controller:"expSettingOverviewController"}}}).state("app.exp.read.node.setting",{deepStateRedirect:{default:"app.exp.read.node.setting.overview",params:!0},sticky:!0,data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"},{type:"params",url:".params"},{type:"fields",url:".fields"},{type:"tune",url:".tune"}]},views:{"panel@app.exp.read.node":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.exp.read.group.setting",{deepStateRedirect:{default:"app.exp.read.group.setting.overview",params:!0},sticky:!0,data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"}]},views:{"panel@app.exp.read.group":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.exp.read.node.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_node_edit.html",controller:"expNodeSettingOverviewController"}}}).state("app.exp.read.group.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_group.html",controller:"expGroupSettingOverviewController"}}}).state("app.exp.read.node.setting.fields",{data:{type:"fields"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.exp.read.node.setting.params",{data:{type:"params"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.exp.read.node.setting.tune",{data:{type:"tune"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}})}]),angular.module("app").constant("frontPanelI18n",{zh_CN:{styleManager:{properties:{width:"宽度",height:"高度",left:"X",top:"Y",background:"背景","background-color":"背景颜色",border:"边框","font-size":"字号","font-weight":"加粗",color:"字体颜色","text-align":"对齐方式"}}}}).config(["$stateProvider",function(e){e.state("app.predict",{url:"/service/:type/:id",params:{refresh:0},resolve:{appInfo:["appService","$stateParams","hardwareService","$q","$state","toaster","$rootScope","predictService","pageLoading","APP_STATUS",function(e,t,n,o,r,i,a,s,l,c){const p=o.defer(),u=t.type||"predict",d=function(n){e.get(n).then(function(e){p.resolve(e.appInfo)},function(e){i.pop("error","获取服务信息失败: "+e.msg),r.go("app.predict",{type:u,id:"",refresh:t.refresh+1})})},f=function(e){t.nodeId?r.go(e+".node",{type:u,id:t.id,nodeId:t.nodeId,refresh:t.refresh+1}):r.go(e,{type:u,id:t.id,refresh:t.refresh+1})},h=function(n){if(n&&n.map&&(n.map.status===c.AppRunning||n.map.status===c.AppStarting||n.map.status===c.AppStopping||n.map.status===c.AppWaiting))return r.transition.to().$$state().includes["app.predict.run"]?void d(t.id):void f("app.predict.run",t.id,t.nodeId);e.getPermission(t.id).then(function(n){if(n&&"write"===n.result){if(!r.transition.to().$$state().includes["app.predict.edit"])return void f("app.predict.edit")}else if(n&&"read"===n.result){if(r.transition.to().$$state().includes["app.predict.edit"])return void e.setPermission(t.id).then(function(e){d(t.id)},function(e){f("app.predict.read")});if(!r.transition.to().$$state().includes["app.predict.read"])return void f("app.predict.read")}d(t.id)},function(e){i.pop("error","获取服务信息失败: "+e.msg),r.go("app.predict",{type:u,id:"",refresh:t.refresh+1})})};if(l.show(),t.id)a.appConfig._board?n.post("status",{id:t.id,boardId:a.appConfig._board.id}).then(function(e){h(e)},function(e){i.pop("error","获取服务信息失败: "+e.msg),a.appConfig._board=null,r.go("app.predict",{type:u,id:"",refresh:t.refresh+1})}):s.getNetworkStatus(t.id).then(function(e){h(e)},function(e){i.pop("error","获取服务信息失败: "+e.msg),r.go("app.predict",{type:u,id:"",refresh:t.refresh+1})});else{const n=function(){e.create("未命名项目",null,u).then(function(e){r.go("app.predict",{type:u,id:e.id,refresh:t.refresh+1})},function(e){i.pop("error","获取项目信息失败: "+e.msg)})};e.list(30,u).then(function(o){if(o&&o.list&&o.list.length>0){let i=0;const a=function(s){i++,e.head(s.id).then(function(e){r.go("app.predict",{type:u,id:s.id,refresh:t.refresh+1})},function(e){i<o.list.length?a(o.list[i]):n()})};a(o.list[i])}else n()},function(e){i.pop("error","获取项目信息失败: "+e.msg)})}return p.promise}]},deepStateRedirect:{default:"app.predict.edit",params:!0},views:{"edit@app":{templateUrl:"/tpl/exp.html",controller:["$scope","APPMENU","$state","$stateParams","appInfo","pageLoading","nodeService","$rootScope","logService","appDataStoreService","dashboardAssetService","appService","$timeout",function(e,t,n,o,r,i,a,s,l,c,p,u,d){_.get(s.currentApp,"id")!==o.id&&"predict"===o.type&&s.appConfig._board&&(s.appConfig._context=appConfig.env,s.appConfig._board=null);const f=_.get(s.appConfig,"appMenu")||t;if(window.appConfig.appId=o.id,s.currentApp={type:_.split(n.$current.name,".")[1],appType:o.type,id:o.id,icon:f[o.type].icon,name:f[o.type].name,screenshot:{loading:!1}},s.getImages(),s.$broadcast("toggle.app",o.type),!_.isEmpty(r.data)){const e=_.get(JSON.parse(r.data),"timestamp"),t=e?{status:"lastSaved",timestamp:e}:null;s.$broadcast("app-saved",t)}function h(e){let t="screen_shot.png";const n=a.getGraph();"graph"!=e||"preview"!=_.get(n.properties,"preview")&&"dashboard"!=_.get(n.properties,"preview")?"dashboard"==e&&"preview"==_.get(n.properties,"preview")&&(t="screen_shot_dashboard.png"):t="screen_shot_graph.png";const r="studio/"+window.appConfig.userId+"/"+o.id+"/"+t;s.currentApp.screenshot.loading=!0,u.getImgUrl(r).then(function(t){s.currentApp.screenshot[e]=t}).finally(function(){s.currentApp.screenshot.loading=!1})}e.selectedNodeId=o.nodeId;let m=$("#editor"),g=null;a.init(m,r.data,function(){i.hide(),s.$broadcast("editor.ready")}),s.appInfo=angular.copy(r);const v=s.appConfig._board?s.appConfig._board.id:null;let b;if(s.appLogId=l.getAppLogId(window.appConfig.userId,o.id,null,v),delete s.appInfo.data,s.$$phase||s.$digest(),window.spFPanelWrapper){const t=window.spFPanelWrapper.grapesjs;let o=Object.keys(t.plugins.getAll()).reverse();t.plugins.add("plugin-asset-oss",(t,n)=>{const o=t.AssetManager,r=function(e){const t=(e.dataTransfer?e.dataTransfer.files:e.target.files)[0],n=this,r={key:"loading",src:"./images/loading.gif",name:`${t.name}(上传中...)`};t&&(this.onUploadStart(),o.add(r),p.uploadImage(t).then(e=>{o.remove(r.src),e&&e.src?n.onUploadResponse({data:e}):n.onUploadError("上传失败")},e=>{o.remove(r.src),n.onUploadError(e)}))};e.imageList=[];const i=function(){p.listImages().then(function(t){e.imageList=e.imageList.concat(t),o.getAll().reset(e.imageList),o.render()},function(e){})},a=function(e){const t=e.attributes;t.key&&"loading"===t.key||p.deleteImage(e.attributes).then(function(){},function(e){console.warn("remote asset remove failed",e)})};!function(){const n=o.getConfig();let s=_.assign(n,{uploadFile:r,stylePrefix:"am-"});o.init(s),o.AssetsView().template=function(t){const n=t.pfx,r=(t.ppfx,$(`\n                      <div class="${n}assets-cont">\n                        <div class="imagelist-search-group" style="display: table;">\n                          <div class="imagelist-search-group-addon" style="display: table-row; padding-left: 5px; padding-right: 5px;">\n                            <div style="display: table-cell; width: 220px; padding-right: 10px;">\n                              <input type="text" placeholder="按资源名称搜索" class="imagelist-search-input" style="width: 100%; height: 28px; border:none; outline: none; background-color: rgba(0,0,0,0.2); padding-left: 5px;"/>\n                            </div>\n                            <div style="display: table-cell; width: 60px; padding-left: 5px; padding-right: 5px;">\n                              <button class="gjs-btn-prim gjs-btn--full imagelist-search-clear">清空</button>\n                            </div>\n                            <div style="display: table-cell; width: 60px; padding-left: 5px; padding-right: 5px;">\n                              <button class="gjs-btn-prim gjs-btn--full imagelist-search-confirm">搜索</button>\n                            </div>\n                          </div>\n                        </div>\n                        <div class="${n}assets" data-el="assets"></div>\n                        <div style="clear:both"></div>\n                      </div>\n                    `)),a=r.find(`.${n}assets`)[0];let s="";return r.find(`.${n}assets`).on("scroll",function(e){a.scrollHeight===a.clientHeight+a.scrollTop&&(s||i())}),r.find(".imagelist-search-clear").on("click",function(){r.find(".imagelist-search-input").val(""),p.reset(),s="",e.imageList=[],i()}),r.find(".imagelist-search-confirm").on("click",function(){s=r.find(".imagelist-search-input").val(),p.search(s).then(function(t){e.imageList=t,o.getAll().reset(e.imageList),o.render()},function(e){})}),r[0]},t.on("asset:remove",a),i()}()}),o.push("plugin-asset-oss"),-1==o.indexOf("grapesjs-custom-code")&&o.push("grapesjs-custom-code");const r=function(){(g=window.spFPanelWrapper.init({container:"#gjs",colorPicker:{appendTo:"body"},plugins:window.spFPanelWrapper.plugins.concat(o),layerManager:{appendTo:"#layers"},blockManager:{appendTo:"#blocks"},styleManager:{appendTo:"#styles",clearProperties:1},storageManager:{type:"sp-storage",autosave:1,autoload:0},traitManager:{appendTo:"#traits"},canvas:{styles:["/common_static/css/fontawesome.5.1.0.css","/common_static/fontFamily/index.css",window.appConfig.suanpanSdkAllCSSPath],scripts:[window.appConfig.suanpanSdkAllPath]},panels:{defaults:[{id:"layers",el:"#layers-container",resizable:{tc:0,cr:1,bc:0,keyWidth:"flex-basis"}},{id:"styles",el:"#style-container",resizable:{tc:0,cr:0,cl:1,bc:0,keyWidth:"flex-basis"}}]}})).Panels.removeButton("options","sw-visibility"),g.Panels.removeButton("views","open-tm"),g.stopCommand("sw-visibility"),g.Panels.addButton("options",{id:"canvas-clear",className:"iconfont icontrash",command:function(e){s.readOnly?g.Modal.open({title:"提示",content:"请在编辑状态下进行操作！"}):confirm("清空画布后，画布中的所有前面板组件将全部被清除。")&&e.runCommand("core:canvas-clear")},attributes:{title:"清空画布","data-tooltip-pos":"bottom"}}),g.on("block:drag:start",function(e){s.readOnly&&g.Modal.open({title:"提示",content:"请在编辑状态下进行操作！"})}),g.StorageManager.add("sp-storage",{load(e,t,n){t(a.getDashboardConfig())},store(t,n,o){if(a.setDashboardConfig(t),e.save){if(t["gjs-components"]){let e=JSON.parse(t["gjs-components"]),n={};a.getGraph().nodes.forEach(function(e){22===e.metadata.def.type&&(n[e.metadata.def.dashboardId]=e.id)});let o=function(e){e.forEach(function(e){if(e.attributes){let t=e.attributes.id;if(e.attributes.sp){let o=e.attributes.sp;if(!n[t]){const e=o.metadata;e.def.dashboardId=t,a.addDashboardNode(e)}delete n[t]}else n[t]&&(a.removeNode(n[t],!0),delete n[t])}e.components&&e.components.length&&o(e.components)})};o(e),Object.keys(n).forEach(function(e){let t=n[e];a.removeNode(t)})}e.save&&e.save()}n()}});a.setGraphAddNodeHandler(function(e,t){!function(e,t,n){if(e){let o=t.BlockManager.get(e).attributes.content;!_.isString(o)&&o.content&&(o=o.content);const r=t.addComponents(o);n&&r[0].set(n)}}(e,g,t)}),a.setGraphDeleteNodeHandler(function(e){!function(e,t){let n=t.DomComponents.componentsById[e];n=_.isArray(n)?n:[n],t.select(null),n.forEach(e=>{if(e&&e.get("removable")){if(e){const t=e.collection;e.trigger("component:destroy"),t&&t.remove(e)}}else console.warn("The element is not removable",e)})}(e,g)}),a.setEdgeIconClickHandler(function(t,n,o,r="in"){e.openEdgeScriptEditor({from:t,to:n,metadata:o,direction:r})}),e.$on("toggle.node",function(t,n){n&&(e.selectedNodeId=n.id)}),g.on("component:selected",function(t){const n=t.ccid,o=a.getDashboardNode(n);e.selectedNodeId=o?o.id:null}),g.load(),e.onDashboardSelectedComponent=function(e){if(!_.isEmpty(e)){const t=a.getNode(e),n=_.get(t,"metadata.def.dashboardId");if(n){const e=g.getComponents();e.length&&e.models.forEach(function(e){e.ccid===n?g.selectAdd(e):g.selectRemove(e)})}}},h("dashboard")};s.appConfig.pluginLoaded?r():(s.currentApp.screenshot.loading=!0,async_load(s.appConfig.dashboardPluginPath,function(){s.appConfig.pluginLoaded=!0,r()})),e.$on("predict.dashboard",function(t,o){s.currentApp.dashboard=o,g.getSelectedAll().forEach(function(e){g.selectRemove(e)}),h("dashboard"),e.selectedNodeId&&(n.includes("app.predict.edit")?n.go("app.predict.edit.node",{nodeId:e.selectedNodeId}):n.includes("app.predict.run")?n.go("app.predict.run.node",{nodeId:e.selectedNodeId}):n.includes("app.predict.read")&&n.go("app.predict.read.node",{nodeId:e.selectedNodeId}))}),s.$on("canvasresizer.update",function(){const e=_.find(g.getModel().get("modules"),{name:"CanvasResizer"});e&&(e.rendered?e.setCanvasTransform():b=d(function(){e&&e.render(),d.cancel(b),b=void 0},300))}),e.$on("predict.predict",function(t,o){h("graph"),s.currentApp.dashboard=o,s.$broadcast("canvasresizer.update"),e.selectedNodeId&&(e.onDashboardSelectedComponent(e.selectedNodeId),e.selectedNodeId=null,n.includes("app.predict.edit.node")?n.go("app.predict.edit.setting"):n.includes("app.predict.run.node")?n.go("app.predict.run.setting"):n.includes("app.predict.read.node")&&n.go("app.predict.read.setting"))})}e.$on("$destroy",function(){window.appConfig.appId=void 0,s.appInfo=void 0,s.appLogId=void 0,b&&(d.cancel(b),b=void 0),g&&g.destroy()})}]},"page-panel@app.predict":{template:"<div ui-view='panel'></div>",controller:["$state","$stateParams","$scope","$rootScope","toaster","hardwareService",function(e,t,n,o,r,i){let a=o.appConfig._board,s=null,l=null;if("predict"===t.type&&a){let n=function(n,i){i||(r.clear(s),s=null,l&&(clearTimeout(l),l=null),o.handleResetContext(e.current.name,t,null))},c=function(){l&&(clearTimeout(l),l=null),i.post("get",{hwtype:"board",boardId:a.id}).then(function(e){e.success&&("online"!==_.get(e,"data.state")?_.isEmpty(s)&&(s=r.pop({type:"error",title:"板子已掉线",body:"点击回到 "+o.appConfig.env+"。",showCloseButton:!1,tapToDismiss:!0,timeout:0,clickHandler:n})):s&&(r.pop("success","板子已连线！"),r.clear(s),s=null)),l=setTimeout(c,3e3)},function(e){l=setTimeout(c,3e3)})};c()}n.$on("$destroy",function(){a=void 0,l&&(clearTimeout(l),l=void 0)})}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.predict.edit",{deepStateRedirect:{default:"app.predict.edit.setting",params:!0},resolve:{},views:{"header@app":{templateUrl:"/tpl/blocks/header_edit.html",controller:["$state","$stateParams","$scope","$rootScope","nodeService","appService","$q","toaster","appDataStoreService","eventService",function(e,t,n,o,r,i,a,s,l,c){let p,u=$("#editor");n.$on("editor.ready",function(){u=$("#editor")}),o.doSave=function(n){let l=a.defer(),c=r.getGraphJson();const p=(new Date).getTime();return c.timestamp=p,i.save(t.id,c).then(function(){n?s.pop("success","保存成功"):o.$broadcast("app-saved",{status:"success",timestamp:p}),l.resolve()},function(n){s.pop("error","保存项目失败: "+n.msg),"NetworkingError"!==_.get(n,"err.code")&&e.go("app.predict.read",{type:t.type||"predict",id:t.id,refresh:t.refresh+1}),l.reject(n)}),l.promise};let d;const f=o.save=function(){d||(d=setTimeout(function(){o.doSave(),clearTimeout(d),d=void 0},1e3)),p||(p=window.setTimeout(function(){let e="studio/"+window.appConfig.userId+"/"+t.id+"/",n="screen_shot.png";const i=r.getGraph();o.currentApp.dashboard?("preview"==_.get(i.properties,"preview")?n="screen_shot_dashboard.png":i.properties.preview="dashboard",window.spFPanelWrapper.getScreenshot({allowTaint:!1,useCORS:!0,scale:.5}).then(function(t){if("toBlob"in t)try{t.toBlob(function(t){t&&l.upload(e+n,t,function(e){},function(e){},function(){})})}catch(e){}})):("preview"==_.get(i.properties,"preview")||"dashboard"==_.get(i.properties,"preview")?n="screen_shot_graph.png":i.properties.preview="graph",o.screenshots(n)),window.clearTimeout(p),p=null},1e4))};r.setGraphChangeHandler(function(){f()}),r.setNodeSelectionHandler(function(t,n,i,a){if(t.ctrlKey||t.metaKey)if(n)if(e.includes("app.predict.edit.multi")){const t=e.params.nodes.indexOf(n);-1===t?(e.params.nodes.push(n),o.$broadcast("multi.nodes.add",{nodeId:n})):1===e.params.nodes.length?e.go("app.predict.edit"):(e.params.nodes.splice(t,1),o.$broadcast("multi.nodes.remove",{nodeId:n}))}else e.includes("app.predict.edit.node")?e.params.nodeId!==n?e.go("app.predict.edit.multi",{nodes:[e.params.nodeId,n]}):e.go("app.predict.edit.node",{nodeId:n}):n?e.go("app.predict.edit.node",{nodeId:n}):e.go("app.predict.edit");else e.go("app.predict.edit");else n?(c.emit("sp:node:select",[n,r.getNode(n)]),e.go("app.predict.edit.node",{nodeId:n})):e.go("app.predict.edit")}),r.setEdgeSelectionHandler(function(t,n){t?e.go("app.predict.edit.edge",{edgeId:t}):e.go("app.predict.edit.setting")}),r.setGroupSelectionHandler(function(t){t&&e.go("app.predict.edit.group",{groupId:t})}),$(document).on("keydown.edit",function(e){let t=$(e.target);if(!(t.is("input")||t.is("textarea")||t.is(".form-control")))switch(e.keyCode){case 86:(e.ctrlKey||e.metaKey)&&(e.stopPropagation(),o.copiedNode&&r.pasteNode(o.copiedNode,o.copiedComp));break;case 90:if((e.ctrlKey||e.metaKey)&&(e.stopPropagation(),o.removedNodes.length)){let e=o.removedNodes.pop(),t=e.metadata,n=r.getNodeOriginalPosision(t.x,t.y);switch(t.type){case"public_component":r.addPublicRemoteNode(e.component,n.x,n.y,t.type);break;case"my_component":r.addRemoteNode(e.component,n.x,n.y,t.type);break;case"hufu_component":r.addHufuNode(e.component,t.label,t.icon,n.x,n.y,t.type)}}}}),n.$on("$destroy",function(){window.clearTimeout(d),window.clearTimeout(p),r.setNodeSelectionHandler(null),r.setEdgeSelectionHandler(null),r.setGraphChangeHandler(null),o.removedNodes=[],o.save=void 0,o.doSave=void 0,$(document).off("keydown.edit")})}]},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.predict.edit.middle.html",controller:["$scope","$state","$stateParams","toaster","appService","nodeService","$rootScope",function(e,t,n,o,r,i,a){e.deploy=function(){a.stateAlert=null;const e=i.onValidated();if(e&&"error"===e.status)return void(a.stateAlert={type:"danger",fadeOut:!0,message:e.message});let n=o.pop({type:"info",body:"starting-html",bodyOutputType:"directive",directiveData:{title:"正在保存"},timeout:0});a.doSave().finally(function(){o.clear(n),n=null,t.params.nodeId?t.go("app.predict.prepare.node",{nodeId:t.params.nodeId}):t.go("app.predict.prepare")})},e.doExpand=function(){const e=i.getNode(t.params.nodeId),a=_.get(e,"metadata.def.compositeAppId");a?r.get(a).then(function(t){e.metadata.def.composite=JSON.parse(t.appInfo.data),i.collectCompositePorts(e.metadata.def.composite,e.metadata.def.ports),i.changeNode(n.nodeId)},function(e){o.pop("error","获取项目信息失败: "+e.msg)}).finally(function(){i.expandGroup(e),requestAnimationFrame(function(){t.go("app.predict.edit.group",{groupId:t.params.nodeId})})}):o.pop("warning","该组件缺少运行的项目")}}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.predict.edit.setting",{deepStateRedirect:{default:"app.predict.edit.setting.overview",params:!0},data:{info:{type:"setting"},tabs:[{name:{zh_CN:"项目属性"},type:"overview",url:".overview"}]},views:{"panel@app.predict":{templateUrl:"/tpl/custom/panels/index.html",controller:"expSettingController"}}}).state("app.predict.edit.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview.html",controller:"expSettingOverviewController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.predict.edit.node",{url:"/:nodeId",params:{nodeId:null},deepStateRedirect:{default:"app.predict.edit.node.setting",params:!0},views:{"page-panel@app.predict":{template:"<div ui-view='panel'></div>",controller:["$state","$stateParams","$scope","$rootScope","nodeService","logService",function(e,t,n,o,r,i){let a=$("#editor .nodes #"+t.nodeId);if(!a||0===a.length)return void e.go("app.predict.edit");n.nodeId=t.nodeId,n.node=r.getNode(n.nodeId),o.$broadcast("toggle.node",n.node),n.nodeTabInfo=n.node.metadata.ui.tabs,n.componentId=n.node.component,o.nodeCompType=n.node.metadata.def.type;let s=o.appConfig._board?o.appConfig._board.id:null;n.logId=i.getLogId(window.appConfig.userId,t.id,t.nodeId,s),n.resetTabInfo(n.node.metadata.def.params,n.nodeTabInfo),998===o.nodeCompType&&(n.appList=[],appService.list(9999,"predict").then(function(e){e&&e.list&&(n.appList=_.filter(e.list,function(e){return e.id!=t.id}))},function(e){toaster.pop("error","获取项目列表失败: "+e.msg)})),n.updateCompositeAppId=function(e){n.node.metadata.def.compositeParams=[],n.node.metadata.def.ports=[],n.node.metadata.def.compositeApp=_.find(n.appList,{id:e}),appService.get(e).then(function(e){n.node.metadata.def.ports=[],n.node.metadata.def.composite=JSON.parse(e.appInfo.data),r.collectCompositePorts(n.node.metadata.def.composite,n.node.metadata.def.ports),r.changeNode(t.nodeId),n.save()},function(e){toaster.pop("error","获取项目信息失败: "+e.msg)})},n.$watch("node",function(e,t){e!==t&&n.save()},!0),n.node,$(document).on("keydown.node.edit",function(e){let t=$(e.target);if(!t.is("input")&&!t.is("textarea"))switch(e.keyCode){case 46:case 8:e.stopPropagation(),o.removeNode(n.node,"app.predict.edit");break;case 67:(e.ctrlKey||e.metaKey)&&(e.stopPropagation(),"dashboard"==n.node.component?o.copiedNode=null:(o.copiedNode=angular.copy(n.node.metadata),o.copiedComp=angular.copy(n.node.component),_.has(o.copiedNode,"apiName")&&delete o.copiedNode.apiName));break;case 37:n.node.metadata.x-=1,r.changeNode(n.nodeId);break;case 38:n.node.metadata.y-=1,r.changeNode(n.nodeId);break;case 39:n.node.metadata.x+=1,r.changeNode(n.nodeId);break;case 40:n.node.metadata.y+=1,r.changeNode(n.nodeId)}}),a.addClass("selected");let l=r.hightEdges(t.nodeId);n.$on("$destroy",function(){a.removeClass("selected"),$(document).off("keydown.node.edit"),$(l).removeClass("active"),o.nodeCompType=void 0,o.$broadcast("toggle.node",null)})}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.predict.edit.node.setting",{deepStateRedirect:{default:"app.predict.edit.node.setting.overview",params:!0},sticky:!0,data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"},{type:"params",url:".params"},{type:"fields",url:".fields"},{type:"tune",url:".tune"}]},views:{"panel@app.predict.edit.node":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.predict.edit.node.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_node_edit.html",controller:"expNodeSettingOverviewController"}}}).state("app.predict.edit.node.setting.fields",{data:{type:"fields"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.predict.edit.node.setting.params",{data:{type:"params"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.predict.edit.node.setting.tune",{data:{type:"tune"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.predict.edit.multi",{url:"/nodes",params:{nodes:null},deepStateRedirect:{default:"app.predict.edit.multi.setting",params:!0},views:{"page-panel@app.predict":{template:"<div ui-view='panel'></div>",controller:["$state","$stateParams","$scope","$rootScope","nodeService",function(e,t,n,o,r){if(!t.nodes||!t.nodes.length)return void e.go("app.predict.edit");n.getMultiNodes=function(){return _.map(t.nodes,function(e){return r.getNode(e)})};$(document).on("keydown.node.edit",function(e){var t,i=$(e.target);if(!i.is("input")&&!i.is("textarea"))switch(e.keyCode){case 46:case 8:e.stopPropagation();const i=n.getMultiNodes();o.removeMultiNodes(i,"app.predict.edit");break;case 67:(e.ctrlKey||e.metaKey)&&e.stopPropagation();break;case 37:case 38:case 39:case 40:t=e.keyCode,_.forEach(n.nodes,function(e){switch(t){case 37:e.metadata.x-=10,r.changeNode(e.id);break;case 38:e.metadata.y-=10,r.changeNode(e.id);break;case 39:e.metadata.x+=10,r.changeNode(e.id);break;case 40:e.metadata.y+=10,r.changeNode(e.id)}})}});for(var i=0;i<t.nodes.length;i++){$("#editor #"+t.nodes[i]).addClass("selected")}n.$on("multi.nodes.add",function(e,t){$("#editor #"+t.nodeId).addClass("selected")}),n.$on("multi.nodes.remove",function(e,t){$("#editor #"+t.nodeId).removeClass("selected")}),n.$on("$destroy",function(){for(var e=0;e<t.nodes.length;e++){$("#editor #"+t.nodes[e]).removeClass("selected")}$(document).off("keydown.node.edit")})}]},"footer-middle@app":{template:""}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.predict.edit.multi.setting",{deepStateRedirect:{default:"app.predict.edit.multi.setting.overview",params:!0},sticky:!0,data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"}]},views:{"panel@app.predict.edit.multi":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.predict.edit.multi.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_multi_edit.html",controller:"expMultiSettingOverviewController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.predict.edit.edge",{params:{edgeId:null},deepStateRedirect:{default:"app.predict.edit.edge.setting",params:!0},views:{"page-panel@app.predict":{template:"<div ui-view='panel'></div>",controller:["$state","$stateParams","$scope","nodeService",function(e,t,n,o){let r=$("#"+t.edgeId);if(!r||0===r.length)return void e.go("app.predict.edit");r.addClass("selected"),r.parent().append(r);let i=t.edgeId.split("-");n.edge=o.getEdge(i[1],i[2],i[4],i[3]),_.get(n.edge,"metadata.color")||_.set(n.edge,"metadata.color","#a6a6a6"),_.get(n.edge,"metadata.size")||_.set(n.edge,"metadata.size",1);const{from:a,to:s,metadata:l}=n.edge;n.$watch("edge.metadata.color",function(e){o.setEdgeMetadata(a.node,a.port,s.node,s.port,l)}),n.onChangeSize=function(){o.setEdgeMetadata(a.node,a.port,s.node,s.port,l)},n.fromPort=o.getPort(i[1],i[2]),n.toPort=o.getPort(i[4],i[3]),n.subTypeMismatch=n.fromPort.subType!=n.toPort.subType,$(document).on("keydown.edge.edit",function(t){let o=$(t.target);if(!o.is("input")&&!o.is("textarea"))switch(t.keyCode){case 46:case 8:t.stopPropagation(),n.removeEdge(n.edge,_.get(e,"current.name").split(".edge")[0])}}),n.$on("$destroy",function(){r.removeClass("selected"),$(document).off("keydown.edge.edit")})}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.predict.edit.edge.setting",{deepStateRedirect:{default:"app.predict.edit.edge.setting.overview",params:!0},data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"}]},views:{"panel@app.predict.edit.edge":{templateUrl:"/tpl/custom/panels/index.html",controller:["$state","$scope",function(e,t){t.tabs=angular.copy(e.current.data.tabs),t.currentTab={},t.$on("$destroy",function(){})}]}}}).state("app.predict.edit.edge.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_edge.html",controller:["$state","$scope",function(e,t){t.currentTab.type=e.current.data.type,t.currentTab.title=_.get(_.find(t.tabs,{type:t.currentTab.type}),"name.zh_CN")}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.predict.prepare",{deepStateRedirect:{default:"app.predict.prepare.setting",params:!0},views:{"header@app":{templateUrl:"/tpl/blocks/header_edit.html",controller:"readController"},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.predict.edit.middle.html",controller:"prepareController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.predict.prepare.node",{url:"/:nodeId",params:{nodeId:null},deepStateRedirect:{default:"app.predict.prepare.node.setting",params:!0},views:{"page-panel@app.predict":{template:"<div ui-view='panel'></div>",controller:"readNodeController"}}}).state("app.predict.prepare.setting",{deepStateRedirect:{default:"app.predict.prepare.setting.overview",params:!0},data:{info:{type:"setting"},tabs:[{name:{zh_CN:"项目属性"},type:"overview",url:".overview"}]},views:{"panel@app.predict":{templateUrl:"/tpl/custom/panels/index.html",controller:"expSettingController"}}}).state("app.predict.prepare.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview.html",controller:"expSettingOverviewController"}}}).state("app.predict.prepare.node.setting",{deepStateRedirect:{default:"app.predict.prepare.node.setting.overview",params:!0},sticky:!0,data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"},{type:"params",url:".params"},{type:"fields",url:".fields"},{type:"tune",url:".tune"},{name:{zh_CN:"测试"},type:"test",url:".test"}]},views:{"panel@app.predict.prepare.node":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.predict.prepare.node.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_node_edit.html",controller:"expNodeSettingOverviewController"}}}).state("app.predict.prepare.node.setting.fields",{data:{type:"fields"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.predict.prepare.node.setting.params",{data:{type:"params"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.predict.prepare.node.setting.tune",{data:{type:"tune"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.predict.prepare.node.setting.test",{url:"/test",data:{type:"test"},views:{tab:{templateUrl:"/tpl/custom/tabs/tab_test.html",controller:"predictNodeSettingTestController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.predict.edit.group",{url:"/group/:groupId",params:{nodes:null},deepStateRedirect:{default:"app.predict.edit.group.setting",params:!0},views:{"page-panel@app.predict":{template:"<div ui-view='panel'></div>",controller:["$state","$stateParams","$scope","$rootScope","multiselect","common","nodeService",function(e,t,n,o,r,i,a){o.group=a.getGroup(t.groupId),o.group;let s=$("#editor #"+t.groupId);n.nodeTabInfo={params:{controls:[],tabName:{en_US:"Parameters Setting",zh:"参数设置",zh_CN:"参数设置"}}},o.nodeCompType="group",s.addClass("selection");let l=a.getGroupConnections(a.getGraph().toJSON(),n.group);a.collectGroupInport(l.inConnections,[]),a.collectGroupOutport(l.outConnections,[]),$(document).on("keydown.group.edit",function(e){let t=$(e.target);if(!t.is("input")&&!t.is("textarea"))switch(e.keyCode){case 46:case 8:e.stopPropagation(),o.removeGroup(o.group,"app.predict")}}),n.$on("$destroy",function(){o.nodeCompType=void 0,s.removeClass("selection"),$(document).off("keydown.group.edit")})}]},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.predict.edit.group.middle.html",controller:["$scope","$rootScope","$stateParams","appService","nodeService","$state","common",function(e,t,n,o,r,i,a){let s=function(){e.a={},r.getChildGroup(n.groupId).length&&(e.a.canotFold=!0)};r.getGraph()?s():e.$on("editor.ready",function(){s()}),e.doFold=function(){r.foldGroup(n.groupId),requestAnimationFrame(function(){i.go("app.predict.edit.node",{nodeId:n.groupId})})}}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.predict.edit.group.setting",{deepStateRedirect:{default:"app.predict.edit.group.setting.overview",params:!0},sticky:!0,data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"},{type:"params",url:".params"}]},views:{"panel@app.predict.edit.group":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.predict.edit.group.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_group.html",controller:"expGroupSettingOverviewController"}}}).state("app.predict.edit.group.setting.params",{data:{type:"params"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.predict.read",{deepStateRedirect:{default:"app.predict.read.setting",params:!0},views:{"header@app":{templateUrl:"/tpl/blocks/header_edit.html",controller:"readController"},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.predict.read.middle.html",controller:["$scope","$rootScope","toaster","appService","$stateParams","$state","$window","enabledUser",function(e,t,n,o,r,i,a){e.requireEdit=function(){o.setPermission(r.id).then(function(e){r.nodeId?i.go("app.predict.edit.node",{nodeId:r.nodeId}):i.go("app.predict.edit")},function(e){n.pop("error","请求失败: "+e.msg)})},t.stateAlert={type:"info",message:"当前状态仅支持查看，请在“编辑”状态下进行编辑"},e.$on("$destroy",function(){t.stateAlert=null})}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.predict.read.node",{url:"/:nodeId",params:{nodeId:null},deepStateRedirect:{default:"app.predict.read.node.setting",params:!0},views:{"page-panel@app.predict":{template:"<div ui-view='panel'></div>",controller:"readNodeController"}}}).state("app.predict.read.setting",{deepStateRedirect:{default:"app.predict.read.setting.overview",params:!0},data:{info:{type:"setting"},tabs:[{name:{zh_CN:"项目属性"},type:"overview",url:".overview"}]},views:{"panel@app.predict":{templateUrl:"/tpl/custom/panels/index.html",controller:"expSettingController"}}}).state("app.predict.read.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview.html",controller:"expSettingOverviewController"}}}).state("app.predict.read.node.setting",{deepStateRedirect:{default:"app.predict.read.node.setting.overview",params:!0},sticky:!0,data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"},{type:"params",url:".params"},{type:"fields",url:".fields"},{type:"tune",url:".tune"}]},views:{"panel@app.predict.read.node":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.predict.read.node.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_node_edit.html",controller:"expNodeSettingOverviewController"}}}).state("app.predict.read.node.setting.fields",{data:{type:"fields"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.predict.read.node.setting.params",{data:{type:"params"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.predict.read.node.setting.tune",{data:{type:"tune"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.predict.run",{deepStateRedirect:{default:"app.predict.run.setting",params:!0},views:{"header@app":{templateUrl:"/tpl/blocks/header_edit.html",controller:"readController"},"footer-middle@app":{templateUrl:"/tpl/custom/footer/app.predict.run.middle.html",controller:["$scope","$rootScope","toaster","$stateParams","$timeout","predictService","nodeService","APP_STATUS","instantNodeLogService",function(e,t,n,o,r,i,a,s,l){const c=o.id;let p=null;const u=function(){t.sockets&&t.sockets[c]&&(t.sockets[c].disconnect(),t.sockets[c]=null),l.disconnect()},d=function(){i.getNetworkStatus(c).then(e=>{e&&e.map&&(e.map.status===s.AppRunning?p=l.connect():setTimeout(d,1e3))})};let f=function(){let e=n.pop({type:"info",title:"正在删除临时文件",timeout:0});hardwareService.post("storage.remove",{boardId:t.appConfig._board.id,appId:c,keys:["tmp"]}).then(function(t){n.clear(e),e=void 0,n.pop("success","删除完成")})};t.release=function(){return t.appConfig._board?hardwareService.post("app/release",{boardId:t.appConfig._board.id,appId:c}).then(function(e){r(f,8e3)}):(u(),i.release(c))},t.showFlowAnimation=!1,t.toggleDataFlowAnimation=function(){t.showFlowAnimation=!t.showFlowAnimation,l.toggle(t.showFlowAnimation)},d(),e.$on("$destroy",function(){u(),delete t.release,delete t.toggleDataFlowAnimation,delete t.showFlowAnimation})}]}}})}]),angular.module("app").config(["$stateProvider",function(e){e.state("app.predict.run.node",{url:"/:nodeId",params:{nodeId:null},deepStateRedirect:{default:"app.predict.run.node.setting",params:!0},views:{"page-panel@app.predict":{template:"<div ui-view='panel'></div>",controller:"readNodeController"}}}).state("app.predict.run.setting",{deepStateRedirect:{default:"app.predict.run.setting.overview",params:!0},data:{info:{type:"setting"},tabs:[{name:{zh_CN:"项目属性"},type:"overview",url:".overview"}]},views:{"panel@app.predict":{templateUrl:"/tpl/custom/panels/index.html",controller:"expSettingController"}}}).state("app.predict.run.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview.html",controller:"expSettingOverviewController"}}}).state("app.predict.run.node.setting",{deepStateRedirect:{default:"app.predict.run.node.setting.overview",params:!0},sticky:!0,data:{info:{type:"setting"},tabs:[{name:{zh_CN:"概览"},type:"overview",url:".overview"},{type:"params",url:".params"},{type:"fields",url:".fields"},{type:"tune",url:".tune"},{name:{zh_CN:"调试日志"},type:"debug",url:".debug",icon:"iconziduan"},{name:{zh_CN:"测试"},type:"test",url:".test"}]},views:{"panel@app.predict.run.node":{templateUrl:"/tpl/custom/panels/index.html",controller:"nodeSettingController"}}}).state("app.predict.run.node.setting.overview",{data:{type:"overview"},views:{tab:{templateUrl:"/tpl/custom/tabs/overview_node_edit.html",controller:"expNodeSettingOverviewController"}}}).state("app.predict.run.node.setting.fields",{data:{type:"fields"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.predict.run.node.setting.params",{data:{type:"params"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.predict.run.node.setting.tune",{data:{type:"tune"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.predict.run.node.setting.debug",{data:{type:"debug"},views:{tab:{templateUrl:"/tpl/custom/tabs/controlList.html",controller:"controlListController"}}}).state("app.predict.run.node.setting.test",{url:"/test",data:{type:"test"},views:{tab:{templateUrl:"/tpl/custom/tabs/tab_test.html",controller:"predictNodeSettingTestController"}}})}]),(app=angular.module("app")).filter("moment",function(){return function(e,t){return moment(e).isValid()?moment(e).format(t):"-"}}),app.filter("duration",function(){return function(e,t){return t?moment.duration(moment(t).valueOf()-moment(e).valueOf(),"milliseconds").format("h小时mm分钟ss秒"):"-"}}),app.filter("portState",function(){return function(e,t){return e.filter(function(e){return"all"===e.state||e.state===t})}}),app.filter("runStatusColor",function(){return function(e){switch(e){case"running":return"#1976d2";case"success":return"#388e3c";case"failed":case"stopped":return"#d32f2f";case"outdated":return"#512da8";case"userResourceLimit":case"systemResourceLimit":return"#d32f2f";default:return"#000"}}}),app.filter("runStatus",function(){return function(e){switch(e){case"running":return"运行中";case"success":return"成功";case"failed":return"失败";case"stopped":return"停止";case"outdated":return"已过期";case"userResourceLimit":return"用户资源不足";case"systemResourceLimit":return"系统资源不足";default:return"-"}}}),app.filter("runType",function(){return function(e){switch(e){case"runStart":return"从此处开始运行";case"runStop":return"运行到此处";case"runStartStop":return"运行该节点";default:return e}}}),app.filter("limitLength",function(){return function(e,t){return e&&"string"==typeof e?(t=t||12,e.length>t?e.substr(0,t)+"...":e):e}}),app.filter("sortByNum",function(){return function(e){return e.sort(function(e,t){return e.index>t.index})}}),app.filter("sortByZindex",function(){return function(e){return e.sort(function(e,t){return parseInt(e.css.zIndex)>parseInt(t.css.zIndex)})}}),app.filter("parseRotate",function(){return function(e){if(!(e=parseInt(e)))return 0;if(e<0){let t=function(e){return(e+=360)<0?t(e):e};e=t(e)}return Math.round(e%360)}}),app.filter("xss",function(){return function(e){if(!(e=parseInt(e)))return 0;if(e<0){let t=function(e){return(e+=360)<0?t(e):e};e=t(e)}return Math.round(e%360)}}),app.filter("page",function(){return function(e,t,n){if(!e||!t)return;let o=(t-1)*n,r=o+n;return e.slice(o,r)}}),app.filter("tag",function(){return function(e,t){return e&&t?"all"==t?e:e.filter(function(e){return e.tags&&-1!=e.tags.indexOf(t)}):e}}),app.filter("size",function(){return function(e,t){if(!e)return;if(0===(e=parseInt(e)))return"0 B";let n=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,n)).toPrecision(3)+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}}),app.filter("cut",function(){return function(e,t,n,o){if(!e)return"";if(!(n=parseInt(n,10)))return e;if(e.length<=n)return e;let r=0,i=0;for(;i<e.length&&!(r>n);i++){let t=e.charCodeAt(i);t>=1&&t<=126||65376<=t&&t<=65439?r++:r+=2}if(e=e.substr(0,i-1),t){let t=e.lastIndexOf(" ");-1!==t&&("."!==e.charAt(t-1)&&","!==e.charAt(t-1)||(t-=1),e=e.substr(0,t))}return e+(o||" …")}}),app.filter("trustAsResourceUrl",["$sce",function(e){return function(t){return e.trustAsResourceUrl(t)}}]),app.filter("profilePicture",["layoutPaths",function(e){return function(t,n,o){return n=n||"profile",o=o||"png",e.images[n]+t+"."+o}}]),angular.module("app").constant("SUBTYPES",[{name:"所有类型",value:"all"},{name:"数字",value:"number"},{name:"布尔值",value:"bool"},{name:"字符串",value:"string"},{name:"JSON",value:"json"},{name:"文件",value:"file"},{name:"文件夹",value:"folder"},{name:"Npy文件",value:"npy"},{name:"模型",value:"model"},{name:"图片",value:"image"},{name:"Csv文件",value:"csv"},{name:"数据库表",value:"table"},{name:"h5文件",value:"hdf5"},{name:"Parquet文件",value:"parquet"},{name:"Sqlite数据文件",value:"sqlite"}]).controller("controlListController",["$scope","$stateParams","$state","toaster","nodeService","$parse","$rootScope","common","$timeout","$q","tableService","PARAM_TYPES",function(e,t,n,o,r,i,a,s,l,c,p,u){e.currentTab.type=n.current.data.type,e.tabInfo=e.nodeTabInfo[n.current.data.type],e.currentTab.title=_.get(e.nodeTabInfo[e.currentTab.type],"tabName.zh_CN"),e.nodeId=t.nodeId,e.tabInfo||n.go("app.predict.edit.node.setting",{nodeId:t.nodeId});let d=n.current.data.type;if(n.current.name.indexOf("customize")>-1&&("fields"==d||"params"==d||"tune"==d)&&(a.secondEditor=!0),e.controlListScope={},e.model={},e.globalVarModel={},n.includes("app.customize"))for(let t=0;t<e.tabInfo.controls.length;t++){let n=e.tabInfo.controls[t];e.model[n.uuid]=a.paramsModel.control[n.uuid]}else if("group"===a.nodeCompType||[998,999].includes(a.nodeCompType)){let t;$(".edit_tools").on("mouseenter.toggle.groupControl",".btn-collapse .dropdown-menu > li",function(){$(this).children(".btn-collapse-list").slideDown().end().siblings().children(".btn-collapse-list").slideUp()}).on("mouseleave.toggle.groupControl",".btn-collapse .dropdown-menu > li",function(){$(this).children(".btn-collapse-list").slideUp()}),"group"===a.nodeCompType?(e.group.metadata.params||(e.group.metadata.params=[]),t=e.group.metadata.params):998!==a.nodeCompType&&999!==a.nodeCompType||(e.node.metadata.def.compositeParams||(e.node.metadata.def.compositeParams=[]),t=e.node.metadata.def.compositeParams);const n=function(n,o){const r={id:o,label:n.metadata.label,controls:[]};e.groupNodes.push(r),Object.keys(n.metadata.ui.tabs).forEach(function(e){n.metadata.ui.tabs[e].controls.forEach(function(e){r.controls.push(e)})});for(let r=0;r<t.length;r++){let i=t[r];if(i.nodeId===o){for(let t in n.metadata.def.params){let o=n.metadata.def.params[t];if(o.controlInstUuid===i.controlId){e.model[i.controlId]={meta:o};break}}break}}},o=function(){if(e.groupNodes=[],"group"===a.nodeCompType)e.tabInfo.controls=r.genGroupTabInfo(t),e.group.nodes.forEach(function(e){const t=r.getNode(e);n(t,e)});else if(998===a.nodeCompType||999===a.nodeCompType){if(!e.node.metadata.def.composite)return;if(998===a.nodeCompType&&e.node.metadata.def.composite.properties.globalVars){let t={id:"global",label:"全局变量",controls:[]};e.node.metadata.def.composite.properties.globalVars.forEach(function(n){e.globalVarModel[n.id]=n,t.controls.push(n)}),e.groupNodes.push(t)}e.tabInfo.controls=r.genCompositeTabInfo(t,e.node.metadata.def.composite.processes,e.node.metadata.def.composite.properties.globalVars),Object.keys(e.node.metadata.def.composite.processes).forEach(function(t){const o=e.node.metadata.def.composite.processes[t];n(o,t)})}};e.addGroupGlobalVar=function(n){for(let e=0;e<t.length;e++){if(t[e].id===n.id)return}t.push({type:"global",id:n.id}),o(),e.save()},e.removeGroupGlobalVar=function(n){for(let e=0;e<t.length;e++){if(t[e].id===n){t.splice(e,1);break}}o(),e.save()},e.addGroupControl=function(n,r){for(let e=0;e<t.length;e++){let o=t[e];if(o.nodeId===n&&o.controlId===r)return}t.push({nodeId:n,controlId:r}),o(),e.save()},e.removeGroupControl=function(n){for(let e=0;e<t.length;e++){if(t[e].controlId===n){t.splice(e,1);break}}o(),e.save()},o()}else for(let t=0;t<e.tabInfo.controls.length;t++){let n=e.tabInfo.controls[t],o=!1;for(let t in e.node.metadata.def.params){let r=e.node.metadata.def.params[t];if(r.controlInstUuid===n.uuid){e.model[n.uuid]={meta:r},o=!0;break}}o||n.uuid}e.checkExists=function(t){if(n.includes("app.customize"))return!0;try{if(t.relations&&t.relations.hide&&t.relations.hide.enabled){let t=t.relations.hide,n=e.node.metadata.def.params[t.key].value;switch(t.operator){case"==":return n===t.value;case"!=":return n!==t.value;case">":return n>t.value;case"<":return n<t.value;case">=":return n>=t.value;case"<=":return n<=t.value}}}catch(e){}return!0},e.removeControl=function(o){for(let t=0;t<e.tabInfo.controls.length;t++)e.tabInfo.controls[t].uuid===o&&e.tabInfo.controls.splice(t,1);delete a.paramsModel.control[o],delete e.model[o],t.controlId===o&&n.go("app.customize.setting",{controlId:null})},e.arrayToString=function(e){return e&&e.length?e.join(","):""},e.addControl=function(t){if("upload_file"==t&&_.findIndex(_.values(e.tabInfo.controls),{type:"upload_file"})>-1)return o.pop("warning","每个组件中只能有一个文件上传参数"),null;let r=s.uuid(),i={uuid:r,type:t,label:{zh_CN:u[t]&&u[t].label||"标签"},placeholder:{zh_CN:u[t]&&u[t].placeholder||"占位提示文本"},tooltip:{zh_CN:u[t]&&u[t].tooltip||""},relations:{}};"select"!=t&&"multiselect"!=t||(i.options=[]),e.tabInfo.controls.push(i);const l={};"upload_file"==t&&(l.outPortUuid="out1",l.fileType="files"),a.paramsModel.control[r]={meta:l},n.go(".",{controlId:r})},e.a={},e.a.openMenu=!1,$(document).on("click.toggle.controlList.menu",function(t){e.a.openMenu=!1,a.$$phase||a.$apply()}),e.appId=t.id,e.nodeId=t.nodeId,e.fileUploadPath=function(e){return s.getUploadDataPath(e)},e.onAllFileUploadFinish=function(t,n){const o=_.find(e.node.metadata.def.params,{controlInstUuid:n}),r=_.find(e.node.metadata.def.params,{propertyName:"dataName",defOutPortUuid:o.outPortUuid});o.value=t,r.value=t},e.onCheckedFileChange=function(){r.changeNode(e.nodeId)},e.$on("$destroy",function(){$(document).off("click.toggle.controlList.menu"),$(".edit_tools").off("mouseenter.toggle.groupControl").off("mouseleave.toggle.groupControl")})}]).controller("editControlController",["$scope","$stateParams","$state","xssList","nodeService","$rootScope",function(e,t,n,o,r,i){if(e.tabInfo=e.nodeTabInfo[n.current.data.type],e.outportPropertyList=["tableName","partitionName","modelName","visualName","dataName"],e.inportList=_.filter(_.keys(e.paramsModel.port),function(e){return 0==e.indexOf("in")}),e.outportList=_.filter(_.keys(e.paramsModel.port),function(e){return 0==e.indexOf("out")}),t.controlId){for(let n=0;n<e.tabInfo.controls.length;n++){let o=e.tabInfo.controls[n];o.uuid===t.controlId&&(e.control=o)}let n=e.paramsModel.control[t.controlId];n&&"colselect"==e.control.type?_.hasIn(n,"inport")||_.isEmpty(e.inportList)||(n.inport=e.inportList[0]):!n||"table_select"!=e.control.type&&"partition_select"!=e.control.type&&"upload_file"!=e.control.type&&"file_select"!=e.control.type||(_.hasIn(n,"outport")||_.isEmpty(e.outportList)||(n.outport=e.outportList[0]),_.hasIn(n,"meta.defOutPortUuid")||_.isEmpty(e.outportList)||"upload_file"!=e.control.type&&"file_select"!=e.control.type||(n.meta.outPortUuid=e.outportList[0]))}else e.tabInfo.controls.length>0&&n.go(".",{controlId:e.tabInfo.controls[0].uuid});e.addOption=function(e){e.options.push({name:{zh_CN:""},value:""})},e.removeOption=function(e,t){e.options.splice(t,1)},e.a={},e.a.chooseControl=!1,e.a.chooseOperator=!1,$(document).on("click.toggle.choose",function(t){e.a.chooseControl=!1,e.a.chooseOperator=!1,i.$$phase||i.$apply()}),e.$on("$destroy",function(){$(document).off("click.toggle.choose")})}]).controller("editComponentController",["$scope","$stateParams","$state","SUBTYPES","nodeService","$sce","$rootScope","common","ossService","componentService","toaster",function(e,t,n,o,r,i,a,s,l,c,p){if(e.currentTab.type=n.current.data.type,e.currentTab.title=_.get(_.find(e.tabs,{type:e.currentTab.type}),"name.zh_CN"),_.forEach(e.node.metadata.def.actionList,function(e){_.isEmpty(e.url)&&(e.port||e.absolute)&&(e.url="{{protocol}}//"+(appConfig.proxyHost?"{{proxyHost}}":"{{host}}")+"/"+(e.absolute?"proxy":"proxr")+"/{{userId}}/{{appId}}/{{nodeId}}/"+e.port+"/")}),e.componentInfo=e.node.metadata,_.has(e.componentInfo,"icon")||(e.componentInfo.icon="cube"),_.has(e.componentInfo,"def.description.zh_CN")){const t=s.handleLinkInDesc(e.componentInfo.def.description.zh_CN);e.componentDescription=i.trustAsHtml(t)}else e.componentDescription=i.trustAsHtml("");let u;_.has(e.node,"metadata")&&!_.has(e.node,"metadata.color")&&(e.node.metadata.color=s.getInitedNodeColor(_.get(e.node.metadata,"nodeStyle"))),e.$watch("node.metadata.color",function(t){r.changeNode(e.nodeId)}),_.forEach(e.componentInfo.def.ports,function(e){_.isEmpty(e.subType)&&(e.subType="all"),_.isEmpty(e.type)&&(e.type="data")}),e.dataTypes=[{type:"",title:"无",state:"all"},{type:"table",title:"数据表",state:"all"},{type:"model",title:"模型",state:"all"},{type:"visual",title:"可视化数据",state:"out"},{type:"data",title:"非结构化数据",state:"all"},{type:"system",title:"系统事件",state:"in"}],e.subTypes=o,e.changeNodeName=function(n){_.isEmpty(n)?p.pop("warning","组件名称不能为空"):(e.node.metadata.label=n,r.changeNode(e.nodeId),c.changeName(t.componentId,n).then(function(e){a.$broadcast("node.list.reload")},function(e){p.pop("error","修改组件名称失败: "+e.msg)}))},e.stringToArray=function(e){return e?JSON.parse(e):[]},e.nodeTagsValid={validated:!0,tags:[]},e.tags=e.stringToArray(e.compInfo.tags),e.changeNodeTags=function(n){n||(n=[]);let o={},r=[];e.nodeTagsValid.validated=!0,e.nodeTagsValid.tags=[],n.forEach(function(t){let n=(t+"").trim();if(_.isEmpty(n)||!/^[a-z][A-Za-z0-9\:\.\_\-]+$/.test(n))return e.nodeTagsValid.validated=!1,void e.nodeTagsValid.tags.push(t);o[n]=1});for(let e in o)r.push(e);e.compInfo.tags=JSON.stringify(r),_.isEqual(e.tags,r)||(e.tags=r),a.$broadcast("node.tags.changed",{nodeId:t.componentId,tags:e.compInfo.tags}),u&&(clearTimeout(u),u=void 0),u=setTimeout(function(){u=void 0,c.changeTags(t.componentId,e.compInfo.tags).then(function(){},function(e){p.pop("error","更新组件标签失败: "+e.msg)})},500)},a.secondEditor=!1,e.changeNodeIcon=function(t){e.node.metadata.icon=t,r.changeNode(e.nodeId)},e.changePortSubType=function(t,n){let o=e.compInfo.tags,r=[],i=[],a={};o&&(r=JSON.parse(o)),r.forEach(function(e){0!==e.indexOf("in:")&&0!==e.indexOf("out:")&&i.push(e)}),e.componentInfo.def.ports.forEach(function(e){_.isEmpty(e.type)||_.isEmpty(e.subType)?delete e.autoReceive:e.display&&(a[e.ioType+":"+e.type+"."+e.subType]=1)});for(let e in a)i.push(e);e.changeNodeTags(i)},e.changeVisibility=function(t){n.includes("app.customize")&&(a.change(t),e.changePortSubType())},e.addPort=function(t){let n=0,o="in"==t?"输入数据":"输出数据";e.componentInfo.def.ports.forEach(function(e){e.ioType===t&&n++});let r=t+(n+1);e.componentInfo.def.ports.push({uuid:r,description:{en_US:"input data",zh_CN:o},display:!0,ioType:t,type:"data",subType:"all"}),e.paramsModel.port[r]={data:t+"putData"+(n+1)},a.change("port")},e.deletePort=function(t){let n=t.ioType;if(1==_.filter(e.componentInfo.def.ports,{ioType:n}).length)return;let o=s.getIndexFromPortUuid(t.uuid);e.componentInfo.def.ports.forEach(function(t,r){if(t.ioType===n){s.getIndexFromPortUuid(t.uuid)===o&&e.componentInfo.def.ports.splice(r,1)}}),e.componentInfo.def.ports.forEach(function(e,t){if(e.ioType===n){let t=s.getIndexFromPortUuid(e.uuid);t>o&&(e.uuid=n+(t-1))}})},e.changePortType=function(e,t,n,o,r,i){switch("system"===i.type&&(i.display=!1,i.subType=void 0,i.autoReceive=void 0),e){case"":case"system":n[o]={};break;case"table":n[o]={table:t+"Table"+(r+1),partition:t+"Partition"+(r+1)};break;case"model":n[o]={model:t+"Model"+(r+1)};break;case"visual":n[o]={visual:t+"Visual"+(r+1)};break;case"data":n[o]={data:t+"Data"+(r+1)}}},e.port_errors={},e.changeTargetPort=function(t,n,o){e.port_errors[t+"_"+o]=void 0;const i=r.getPort(n.targetNode,n.targetPort);i?(n.type=i.type,n.description=angular.copy(i.description),e.compMetadata.def.params={},r.genParamsFromPorts(e.compMetadata.def.ports,e.compMetadata.def.params)):e.port_errors[t+"_"+o]="节点或端口未找到"},e.componentTypeList=[{name:{zh_CN:"算法组件"},value:"algo"},{name:{zh_CN:"服务组件"},value:"service"},{name:{zh_CN:"模型组件"},value:"model"},{name:{zh_CN:"RPA组件"},value:"rpa"},{name:{zh_CN:"前面板组件"},value:"dashboard"},{name:{zh_CN:"RTO组件"},value:"rto"}];const d=function(t){"algo"===t?e.typeList=[{name:{zh_CN:"Spark Java"},value:7},{name:{zh_CN:"Spark Python"},value:2},{name:{zh_CN:"ODPS Python"},value:3},{name:{zh_CN:"ODPS MR"},value:4},{name:{zh_CN:"Python"},value:5},{name:{zh_CN:"Java"},value:6},{name:{zh_CN:"Runtime"},value:12},{name:{zh_CN:"SupRuntime"},value:13},{name:{zh_CN:"Data File"},value:21},{name:{zh_CN:"Composite"},value:999},{name:{zh_CN:"Composite App"},value:998},{name:{zh_CN:"Spark Java (deprecated)"},value:1}]:"service"===t?e.typeList=[{name:{zh_CN:"Runtime"},value:12},{name:{zh_CN:"SupRuntime"},value:13},{name:{zh_CN:"DashboardPage"},value:23},{name:{zh_CN:"Send File"},value:31},{name:{zh_CN:"Web Input"},value:10002},{name:{zh_CN:"Web Output"},value:10003},{name:{zh_CN:"Hardware"},value:50},{name:{zh_CN:"Hardware Network"},value:51},{name:{zh_CN:"Composite App"},value:998}]:"model"===t?e.typeList=[{name:{zh_CN:"model"},value:10001}]:"dashboard"===t?e.typeList=[{name:{zh_CN:"dashboard"},value:22}]:"rpa"===t?e.typeList=[{name:{zh_CN:"通用"},value:501},{name:{zh_CN:"Office Excel"},value:502},{name:{zh_CN:"浏览器"},value:503},{name:{zh_CN:"流程控制"},value:504},{name:{zh_CN:"系统"},value:505},{name:{zh_CN:"文件处理"},value:506}]:"rto"===t&&(e.typeList=[{name:{zh_CN:"RTO"},value:601}]);let n=!1;for(let t=0;t<e.typeList.length;t++)e.typeList[t].value==e.componentInfo.def.type&&(n=!0);n||(e.componentInfo.def.type=e.typeList[0].value)};e.$watch("compInfo.type",function(e,t){e!==t&&d(e)}),e.changeCodeType=function(){r.changeNode(e.nodeId)},d(e.compInfo.type),e.$watch("componentInfo.def.ports",function(t,n){r.changeNode(e.nodeId)},!0),e.uploadCode=function(){let n,o=e.codeFile;e.codeFile=void 0,e.b.uploadingStatus="正在上传",n=1===e.b.uploadMode?s.getUploadPath(window.appConfig.userId,t.componentId,e.componentInfo.def.type):e.componentInfo.def.codePath||s.getUploadPath(window.appConfig.userId,t.componentId,e.componentInfo.def.type),l.upload(n,o,function(t){e.b.uploadingStatus="正在上传 "+Math.round(t.loaded/t.total*100)+"%",a.$$phase||e.$digest()},function(t){e.b.uploadingStatus="上传失败",e.target.value="",a.$$phase||e.$digest()},function(t){e.componentInfo.def.codePath=n,e.b.uploadingStatus="已上传",e.target.value="",a.$$phase||a.$apply()}).then(function(){},function(){e.b.uploadingStatus="上传失败",a.$$phase||e.$digest()})},$("#upload_code").on("change",function(t){e.codeFile=t.target.files[0],e.target=t.target,a.$$phase||e.$digest()});const f=s.getUploadPyLibPath(window.appConfig.userId,t.componentId);$("#upload_py_lib").on("change",function(t){let n=t.target.files[0];e.uploadingPyLibStatus="正在上传";l.upload(f,n,function(t){e.uploadingPyLibStatus="正在上传 "+Math.round(t.loaded/t.total*100)+"%",a.$$phase||e.$digest()},function(t){e.uploadingPyLibStatus="上传失败",a.$$phase||e.$digest()},function(t){e.componentInfo.def.pyLibPath=f,e.uploadingPyLibStatus="已上传",a.$$phase||a.$apply()}).then(function(){},function(){e.uploadingPyLibStatus="上传失败",a.$$phase||e.$digest()})})}]).controller("publishController",["$scope","$stateParams","$state","$uibModal",function(e,t,n,o){e.$on("$destroy",function(){})}]).controller("nodeSettingController",["$state","$stateParams","$scope","nodeTabIcon",function(e,t,n,o){n.tabs=[];for(let t=0;t<e.current.data.tabs.length;t++){let r=angular.copy(e.current.data.tabs[t]);if(r.icon=_.get(o,r.type),n.nodeTabInfo&&n.nodeTabInfo[r.type])if(e.includes("app.customize")||"group"===n.nodeCompType||998===n.nodeCompType||999===n.nodeCompType)r.name=n.nodeTabInfo[r.type].tabName,n.tabs.push(r);else{const e=_.map(n.nodeTabInfo[r.type].controls,"uuid"),t=!_.isEmpty(e)&&_.filter(n.node.metadata.def.params,function(t){return _.indexOf(e,t.controlInstUuid)>-1&&!t.hidden});n.nodeTabInfo[r.type].controls&&!_.isEmpty(t)&&(r.name=n.nodeTabInfo[r.type].tabName,n.nodeTabInfo[r.type].required&&(r.required=!0),n.tabs.push(r))}"test"===r.type&&10002===n.nodeCompType&&e.includes("app.predict.run")&&n.tabs.push(r),"overview"!==r.type&&"debug"!==r.type||n.tabs.push(r)}n.currentTab={},n.$on("$destroy",function(){})}]).controller("compositeSettingController",["$state","$stateParams","$scope","$timeout","$rootScope","common","nodeService",function(e,t,n,o,r,i,a){n.tabs=[];for(let t=0;t<e.current.data.tabs.length;t++){let o=angular.copy(e.current.data.tabs[t]);"overview"===o.type&&n.tabs.push(o)}n.currentTab={},n.node={metadata:n.compMetadata},n.$on("$destroy",function(){})}]).controller("expSettingController",["$state","$scope","$rootScope","common","nodeTabIcon",function(e,t,n,o,r){t.tabs=_.map(e.current.data.tabs,function(e){return Object.assign({},e,{icon:_.get(r,e.type)})}),t.currentTab={},n.secondEditor=!1}]).controller("expSettingOverviewController",["$scope","$stateParams","$state","xssList","appService","$rootScope","$uibModal","toaster","nodeService","predictService","$sce","common",function(e,t,n,o,r,i,a,s,l,c,p,u){if(e.currentTab.type=n.current.data.type,e.currentTab.title=_.get(_.find(e.tabs,{type:e.currentTab.type}),"name.zh_CN"),e.appInfo.description){const t=u.handleLinkInDesc(e.appInfo.description);e.appDescription=p.trustAsHtml(t)}else e.appDescription=p.trustAsHtml("");const d=l.getGraph();let f;n.includes("app.predict")&&(d.properties.predictConfig||(d.properties.predictConfig={isolationMode:"v2"}),d.properties.predictConfig.isolationMode||(d.properties.predictConfig.isolationMode="v1"),e.predictConfig=d.properties.predictConfig),d.properties.globalVars||(d.properties.globalVars=[{id:u.uuid()},{id:u.uuid()},{id:u.uuid()}]),e.globalVars=d.properties.globalVars,e.onUpdateName=function(e){_.isEmpty(e)?s.pop("warning","项目名称不能为空"):r.changeName(t.id,e).then(function(){window.SPLanding.updateAppName(t.type,t.id,e)},function(e){s.pop("error","修改名称失败: "+e.msg)})},e.changeDescription=function(){f&&(clearTimeout(f),f=void 0),f=setTimeout(function(){f=void 0,r.changeDescription(t.id,e.appInfo.description).then(function(){},function(e){s.pop("error","修改描述失败: "+e.msg)})},500)},e.onAppImageUploaded=function(){d.properties.preview="preview",i.doSave().then(function(){},function(e){s.pop("error","设置图片失败")})},e.deployTargetList=[{name:"在线部署",value:"web"},{name:"边缘部署",value:"edge"}];const h="hardware"==i.appConfig._context?"http://"+i.appConfig._board.ip:location.origin;e.dashboard_url=h+"/dashboard/"+window.appConfig.userId+"/"+t.id,e.$on("$destroy",function(){})}]).controller("expGroupSettingOverviewController",["$state","$stateParams","$scope","nodeService",function(e,t,n,o){n.currentTab.type=e.current.data.type,n.currentTab.title=_.get(_.find(n.tabs,{type:n.currentTab.type}),"name.zh_CN"),n.$watch("group.metadata.name",function(e,n){o.changeGraph(t.groupId)})}]).controller("expNodeSettingOverviewController",["$state","$stateParams","$scope","common","nodeService","SUBTYPES","$sce","$rootScope","format","$uibModal","ossService","eventService",function(e,t,n,o,r,i,a,s,l,c,p,u){n.currentTab.type=e.current.data.type,n.currentTab.title=_.get(_.find(n.tabs,{type:n.currentTab.type}),"name.zh_CN"),n.changeNodeIcon=function(e){n.node.metadata.icon=e,r.changeNode(n.nodeId)},n.onSizeChange=function(){r.changeNode(n.nodeId)},!_.has(n.node,"metadata.icon")&&_.set(n.node,"metadata.icon","cube");const d=r.getGraph();if(n.showNodeInfo="false"!=localStorage.detailCollapsed,n.onClickDetailToggle=function(){n.showNodeInfo=!n.showNodeInfo,localStorage.detailCollapsed=n.showNodeInfo},n.node&&n.node.metadata&&n.node.metadata.def.description){const e=o.handleLinkInDesc(n.node.metadata.def.description.zh_CN);n.nodeDescription=a.trustAsHtml(e)}else n.nodeDescription=a.trustAsHtml("");if(_.has(n.node,"metadata")&&!_.has(n.node,"metadata.color")&&(n.node.metadata.color=o.getInitedNodeColor(_.get(n.node.metadata,"nodeStyle"))),998===s.nodeCompType&&(n.appList=[],appService.list(9999,t.type).then(function(e){e&&e.list&&(n.appList=_.filter(e.list,function(e){return e.id!=t.id}))},function(e){toaster.pop("error","获取项目列表失败: "+e.msg)})),_.forEach(_.get(n.node,"metadata.def.ports"),function(e){_.isEmpty(e.subType)&&(e.subType="all"),_.isEmpty(e.type)&&(e.type="data")}),n.webInputOrigin="hardware"==s.appConfig._context?location.protocol+"//"+s.appConfig._board.ip:location.protocol+"//"+n.appConfig.predictHost,n.subTypes=i,n.outputTypeArr=r.getNodeOutputTypeArr(t.nodeId),n.node&&21===n.node.metadata.def.type){n.localDataSeparator=[{name:{zh_CN:"英文逗号"},value:","},{name:{zh_CN:"空格"},value:" "}];const e=function(){let e=_.find(n.outputTypeArr,function(e){return"dataName"==e.propertyName});if(e){if(e.subType){const t=_.split(e.subType,".")[1];return"image"==t||"images"==t?"images":t}return"files"}};n.localData={meta:{type:e(),separator:",",file:""},files:[]},n.appId=t.id,n.nodeId=t.nodeId,n.fileUploadPath=o.getUploadNodeDataPath("out1"),n.onAllFileUploadFinish=function(e){n.node.metadata.def.params.outputData1.value=e}}n.$watch("node.metadata.label",function(e,t){r.changeNode(n.nodeId)}),n.$watch("node.metadata.color",function(e,t){r.changeNode(n.nodeId)}),n.goResult=function(t,n){switch(t){case"visualName":e.go("app.exp.edit.node.popup.chart",{portId:n})}},n.dataTypes=[{type:"",title:"无",state:"all"},{type:"table",title:"数据表",state:"all"},{type:"model",title:"模型",state:"all"},{type:"visual",title:"可视化数据",state:"out"},{type:"data",title:"非结构化数据",state:"all"},{type:"system",title:"系统事件",state:"in"}],n.addNotebookPort=function(e,t){let o=0,r="in"==e?"输入数据":"输出数据";n.node.metadata.def.ports.forEach(function(t){t.ioType===e&&o++}),n.node.metadata.def.ports.push({uuid:e+(o+1),description:{en_US:"input data",zh_CN:r},display:!0,ioType:e,type:"data",subType:"all"}),n.changeNotebookPortType(t)};const f=function(e,t){const i="def"+_.capitalize(e.ioType)+"PortUuid";let a=o.getIndexFromPortUuid(e.uuid);const s=n.node.metadata.def.params;n.node.metadata.def.ports.forEach(function(t,r){t.ioType===e.ioType&&(o.getIndexFromPortUuid(t.uuid)===a&&(n.node.metadata.def.ports.splice(r,1),_.forEach(_.keys(s),function(e){s[e].propertyName&&s[e][i]==t.uuid&&delete s[e]})))}),n.node.metadata.def.ports.forEach(function(n,l){if(n.ioType===e.ioType){let l=o.getIndexFromPortUuid(n.uuid);if(l>a){const o=e.ioType+(l-1);_.forEach(_.keys(s),function(e){s[e].propertyName&&s[e][i]==n.uuid&&(s[e][i]=o)}),n.uuid=o,r.updateEdges(e.ioType,t,l,n.uuid)}}}),n.changeNotebookPortType(t)},h=function(e,t){let n=c.open({animation:!0,templateUrl:"/tpl/custom/popup/alert.html",controller:["$scope","nodeService",function(o,r){o.alertTitle=t.title,o.alertIcon="iconfont iconjinggao text-danger",o.alertBody=t.body,o.ok=function(){_.forEach(e,function(e){r.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port)}),t.onOk(),n.close()},o.cancel=function(){"onCancel"in t&&t.onCancel(),n.close()},o.$on("modal.closing",function(){n=void 0})}],size:"sm",appendTo:""})},m=function(e,t){let n;if("out"===e.ioType){const o=r.getDownstreamNodeByPort(t,e.uuid);n=_.map(o,function(n){return r.getEdge(t,e.uuid,n.node,n.port)})}else if("in"===e.ioType){const o=r.getUpstreamNodeByPort(t,e.uuid);_.isEmpty(o)||(n=[r.getEdge(o.node,o.port,t,e.uuid)])}return n};n.deleteNotebookPort=function(e,t){const n=m(e,t);_.isEmpty(n)?f(e,t):h(n,{title:"删除端口",body:"端口"+e.uuid+"上有 "+n.length+" 条连线，确定全部删除吗?",onOk:function(){f(e,t)}})},n.changeNotebookPortType=function(e){const t=function(e){return e.replace("in","").replace("out","")},o=n.node.metadata.def.params,i=n.node.metadata.def.ports,a=[];for(let e in o)_.has(o[e],"propertyName")&&a.push({key:e,propertyName:_.get(o[e],"propertyName"),portUuid:o[e].defInPortUuid||o[e].defOutPortUuid});i.forEach(function(n){if("system"===n.type){const t=m(n,e);_.isEmpty(t)||_.forEach(t,function(e){r.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port)})}if("system"===n.type)return n.display=!1,n.subType=void 0,void(n.autoReceive=void 0);if(_.isEmpty(n.type)||_.isEmpty(n.subType))return void delete n.autoReceive;if(_.isEmpty(n.type))return;let i="def"+_.capitalize(n.ioType)+"PortUuid";const s=_.findIndex(a,{portUuid:n.uuid});if(-1==s){let e={type:"string",propertyName:n.type+"Name"};if(e[i]=n.uuid,o[n.ioType+"put"+_.capitalize(n.type)+t(n.uuid)]=e,"table"===n.type){let r=_.clone(e);r.propertyName="partitionName",o[n.ioType+"putPartition"+t(n.uuid)]=r}}else{if("tableName"==a[s].propertyName&&"table"!=n.type){const e=_.findIndex(a,{portUuid:n.uuid,propertyName:"partitionName"});e>-1&&delete o[a[e].key]}if("tableName"!=a[s].propertyName&&"table"==n.type){const e=n.ioType+"putPartition"+t(n.uuid);o[e]={type:"string",propertyName:"partitionName"},o[e][i]=n.uuid}o[a[s].key].propertyName=n.type+"Name"}}),r.changeNode(e),r.analyzeGraph(),setTimeout(function(){r.hightEdges(e)},100)};const g=function(e,t){"in"==e.ioType&&e.display&&(e.autoReceive=!1),n.changeNotebookPortType(t)};n.onClickPortDisplay=function(e,t){const n=m(e,t);_.isEmpty(n)||e.display?g(e,t):h(n,{title:"端口隐藏",body:"端口"+e.uuid+"上有 "+n.length+" 条连线，隐藏端口将会删除连线。确定要隐藏吗?",onOk:function(){g(e,t)},onCancel:function(){e.display=!e.display}})},n.changeApiName=function(){if(n.node.metadata.apiName)if(/^[a-zA-Z0-9]{1}[a-zA-Z0-9\-\_]*[a-zA-Z0-9]$/.test(n.node.metadata.apiName))if(n.node.metadata.apiName.length>40)n.apiNameError="长度不能大于40";else{for(let e=0;e<d.nodes.length;e++){let t=d.nodes[e];if(t.id!==n.node.id&&t.metadata.apiName===n.node.metadata.apiName)return void(n.apiNameError="项目中 api 名称冲突")}n.apiNameError="",n.save&&n.save()}else n.apiNameError="只能为字符、数字、连字符和下划线, 长度大于1";else n.apiNameError="不能为空"},n.getProxyUrl=function(e,t,n,o){const r=o?o.ip:"",i=_.isEmpty(appConfig.proxyHost)?location.host:appConfig.proxyHost,a=_.isEmpty(r)?i:r,s=o?"http:":location.protocol;if(!_.isEmpty(e.url)){const o={"{{protocol}}":s,"{{proxyHost}}":a,"{{host}}":a,"{{userId}}":appConfig.userId,"{{appId}}":t,"{{nodeId}}":n};return l(e.url,o)}return e.url="{{protocol}}//"+(appConfig.proxyHost?"{{proxyHost}}":"{{host}}")+"/"+(e.absolute?"proxy":"proxr")+"/{{userId}}/{{appId}}/{{nodeId}}/"+e.port+"/",location.protocol+"//"+(appConfig.proxyHost||location.host)+"/"+(e.absolute?"proxy":"proxr")+"/"+appConfig.userId+"/"+t+"/"+n+"/"+e.port+"/"},n.openLink=function(t,o,r,i,a){if(t.preventDefault(),!e.includes("app.predict.run")&&!e.includes("app.exp.run")){const t=e.includes("app.predict")?"请先部署项目！":"请先运行该节点！";return void(n.actionAlert={type:"danger",message:t})}const s=n.getProxyUrl(o,r,i.id,a),l=s.split("//")[0];if(601===i.metadata.def.type)u.emit("rto:setting:params",[{...o,url:s},r,i,a]);else{if(o.isModal&&l===location.protocol){let e=c.open({animation:!0,windowClass:"iframe-modal",template:'<div class="sp-modal-iframe"><div class="sp-modal-header"><div class="sp-modal-title">{{title}}</div><div class="sp-modal-actions"><i class="iconfont" ng-class="fullscreen ? \'icon-fullscreen-exit\' : \'icon-fullscreen\'" title="{{fullscreen ? \'还原\' : \'最大化\'}}" ng-click="maximize(!fullscreen)"></i><i class="iconfont icon-close" title="关闭" ng-click="cancel()"></i></div></div><iframe style="width: 100%; height: calc(100% - 30px); border: none; outline: none;" src="'+s+'"></iframe></div>',size:"lg",controller:["$scope",function(t){t.fullscreen=!1,t.title=i.metadata.label,t.maximize=function(e){const n=$(".iframe-modal");t.fullscreen=e,e?n.addClass("iframe-modal-fullscreen"):n.removeClass("iframe-modal-fullscreen")},t.cancel=function(){e.close()},t.$on("modal.closing",function(t,n){e=void 0})}]});return}window.open(s)}}}]).controller("tableSelectController",["$state","$stateParams","$scope","$timeout","$rootScope","common","tableService","$q",function(e,t,n,o,r,i,a,s){let l;n.onTableSelect=function(e){e&&(n.refreshingMeta=!0,a.getTableMeta(e).then(function(e){n.controlListScope.selectedTableDef=e.data,n.controlListScope.selectedTableDef}).finally(function(){n.refreshingMeta=!1}))},n.listTable=function(e){n.controlListScope.selectedTableDef=void 0,!e||e.length<2||(l&&o.cancel(l),l=o(function(){n.refreshing=!0,a.listTable(e).then(function(e){n.tableList=e.data}).finally(function(){n.refreshing=!1,l=void 0})},500))},$(document).on("click.close.tableSelction.menu",function(e){n.openTableList=!1,r.$$phase||r.$apply()}),n.$on("$destroy",function(){$(document).off("click.close.tableSelction.menu")})}]).controller("partitionSelectController",["$scope","$rootScope",function(e,t){$(document).on("click.close.partitionSelction.menu",function(n){e.openPartitionList=!1,t.$$phase||t.$apply()}),e.$on("$destroy",function(){$(document).off("click.close.partitionSelction.menu")})}]).controller("expMultiSettingOverviewController",["$state","$stateParams","$scope",function(e,t,n){n.currentTab.type=e.current.data.type,n.currentTab.title=_.get(_.find(n.tabs,{type:n.currentTab.type}),"name.zh_CN")}]),angular.module("app").constant("compTabs",[{id:"shared",name:"分享的组件",dir:1,icon:"iconfenxiang1",service:"list",componentType:"my_component",editable:!0,enable:!0},{id:"public",name:"内置组件",icon:"iconneizhizujian",service:"public",componentType:"public_component",enable:!0},{id:"my",name:"我的组件",dir:2,icon:"iconzujian",service:"list",componentType:"my_component",editable:!0,enable:!0},{id:"hufu",name:"数据",icon:"iconyunshujuku",enable:appConfig.services.hufu,path:"/proxy/hufu-web/datatag/suanpan/module/group",algoComponentId:1876,predictComponentId:1874},{id:"device",name:"设备",icon:"iconshebei",enable:appConfig.services.device,path:"/changqing/device/listDevicePonitMxg",params:{pageNumber:1,pageSize:30},algoComponentId:null,predictComponentId:11330},{id:"recommend",name:"推荐",icon:"iconshoucang",enable:!0}]).controller("compsController",["$state","$stateParams","$scope","$rootScope","USER_CONFIG","componentService","toaster","compTabs","$q","enabledUser","APPMENU","common",function(e,t,n,o,r,i,a,s,l,c,p,u){const d=_.get(o.appConfig,"appMenu")||p,f="card"==localStorage.navTreeStyle;n.tabs=s,n.current={tab:_.find(s,{id:e.includes("app.customize")?"my":"public"}),type:t.type,node:null,isCard:f,expandedDir:[]},e.includes("app.customize")&&(n.current.component={id:t.componentId},n.current.type="customize"),n.onToggleStyle=function(e){localStorage.navTreeStyle=e&&"card",n.current.isCard=e},n.search={keyword:""},n.treeControls={};let h=o.tagModel,m={};h.list=[];let g=_.get(d[_.get(n.current,"type")],"componentType");const v={};_.keys(d,function(e){v[e]=null});const b={list:_.clone(v),public:_.clone(v)};let y=null;const w={shared:_.get(r,"publicDirId"),my:_.get(r,"myDirId"),sharedAllDir:[]},x={shared:_.find(n.userConfig.componentDirs,{id:w.shared}).children,my:_.find(n.userConfig.componentDirs,{id:w.my}).children,public:null},$=function(){const e=u.getDirList(x.shared,w.shared);w.sharedAllDir=_.map(e,"id"),w.sharedAllDir.unshift(w.shared)};$();const C={list:function(){n.loading=!0,i.list(g).then(function(e){if(e.success){b.list[n.current.type]=e.list,y=_.cloneDeep(e.list);var t=O(x[n.current.tab.id]),o=_.get(n.current,"tab.id"),r=D(o);t=_.concat(t,r),n.search.keyword&&(n.search.emptyResult=-1==_.findIndex(t,{visible:!0})),n.my_treedata=t,n.loading=!1}},function(e){a.pop("error","加载组件列表失败: "+e.msg),n.my_treedata=[]})},public:function(){n.loading=!0,i.listPublic(g).then(function(e){if(e.success){b.public[n.current.type]=e.list,y=_.cloneDeep(e.list),x.public=e.dirs;var t=O(e.dirs);n.search.keyword&&(n.search.emptyResult=-1==_.findIndex(t,{visible:!0})),n.my_treedata=t,n.loading=!1}},function(e){a.pop("error","加载组件列表失败: "+e.msg),n.my_treedata=[]})}},k={pageNumber:1,list:[]},S=3,T={algo:"iconfont iconcube",service:"iconfont iconcube",model:"iconfont icongem",dashboard:"iconfont iconchart-area"};let I="predict"===n.current.type?"service":n.current.type;function E(e,t){let n=[];return e%S==0&&n.push("mg-l-xs"),e<S&&n.push("first-row"),e===t-1&&(n.push("last"),n.push("mg-r-"+(S-1-e%S))),n}function N(e,t){const o=e.length,r=_.map(e,function(e,r){const i=E(r,o),a={id:e.id,label:e.name,componentId:e.id,tags:e.tags,icon:T[e.type],type:t||_.get(n.current,"tab.componentType"),componentType:e.type,dir:e.dir,classes:i,visible:!0,selected:"customize"==n.current.type&&n.current.component.id==e.id,usable:!0};let s;if(!_.isEmpty(e.tags)){try{s=JSON.parse(e.tags)}catch(e){}_.forEach(s,function(e){const t=0===e.indexOf("in:"),n=0===e.indexOf("out:");if(t||n){const n=t?3:4;var o=e.substr(n).split(".");if(!_.isEmpty(o)){const e=o.slice(1).join(".");_.isEmpty(e)||(m[e]=1)}}else m[e]=1})}return n.current.tab.editable&&B(a,"component",I),a});return h.list=_.keys(m),r}function O(e){return _.map(e,function(e){let t=_.indexOf(n.current.expandedDir,e.id)>-1,o=!0,r=[];_.isEmpty(e.children)||(r=O(e.children));const i=_.remove(y,function(t){return n.search.keyword?t.dir==e.id&&(_.toLower(t.name).indexOf(_.toLower(n.search.keyword))>-1||t.id==n.search.keyword):t.dir==e.id}),a=N(i);!_.isEmpty(r)&&-1!=_.findIndex(r,{visible:!0})||!_.isEmpty(i)||"customize"===n.current.type&&_.isEmpty(n.search.keyword)||(o=!1),r=_.concat(r,a),(!_.isEmpty(n.search.keyword)&&!_.isEmpty(i)||_.findIndex(r,{expanded:!0})>-1||_.findIndex(r,{selected:!0})>-1)&&(t=!0);const s=_.assign({},e,{children:r,classes:["droppable"],expanded:t,visible:o});return n.current.tab.editable&&B(s,"component",I),s})}function D(e){return N(_.remove(y,function(t){return"shared"===e?n.search.keyword?t.dir==w[e]&&(t.name.indexOf(n.search.keyword)>-1||t.id==n.search.keyword):t.dir==w[e]:"my"===e?n.search.keyword?(t.dir==w[e]||-1==_.indexOf(w.sharedAllDir,t.dir))&&(t.name.indexOf(n.search.keyword)>-1||t.id==n.search.keyword):t.dir==w[e]||-1==_.indexOf(w.sharedAllDir,t.dir):void 0}))}function P(e,t,o){return _.filter(b[o][n.current.type],function(n){let o;try{o=JSON.parse(n.tags)}catch(e){}const r=_.filter(o,function(e){return 0===e.indexOf(t+":")});if(_.isEmpty(r))return!1;const i=t.length+1;return _.findIndex(r,function(t){const n=t.slice(i).split("."),o=n[0],r=n.slice(1).join(".");return _.findIndex(e,function({type:e,subType:t}){return e==o&&(t==r||"all"==t||"all"==r)})>-1})>-1})}const A=12;let M=A;const U={inport:[],outport:[]},R=function(e){return{id:e+"-show-more",label:"加载更多",icon:"iconfont iconxiala",classes:["show-more"],usable:!0,showMore:!0,visible:!0}};function L(e){const t=_.findIndex(n.my_treedata,{id:e}),o=U[e].slice(0,M);if(U[e].length>M){const t=R(e);o.push(t)}n.my_treedata[t].children=o,n.loading=!1}function z(){M=A,n.my_treedata=[{id:"inport",label:"输入推荐",folder:!0,expanded:!0,visible:!0,children:[],prefetch:!0},{id:"outport",label:"输出推荐",folder:!0,expanded:!0,visible:!0,children:[],prefetch:!0}];const e=_.filter(_.get(n.current,"node.metadata.def.ports"),{display:!0});if(U.inport=[],U.outport=[],!_.isEmpty(e)){const t=function(e){return{type:e.type,subType:e.subType}},o=_.map(_.filter(e,{ioType:"in"}),t),r=_.map(_.filter(e,{ioType:"out"}),t);if(!_.isEmpty(o)){const e=N(P(o,"out","public"),"public_component"),t=N(P(o,"out","list"),"my_component");let r=_.concat(e,t);n.search.keyword&&(r=_.filter(r,function(e){return _.toLower(e.label).indexOf(_.toLower(n.search.keyword))>-1||e.id==n.search.keyword}),n.search.emptyResult=0==r.length),U.inport=r}if(!_.isEmpty(r)){const e=N(P(r,"in","public"),"public_component"),t=N(P(r,"in","list"),"my_component");let o=_.concat(e,t);n.search.keyword&&(o=_.filter(o,function(e){return _.toLower(e.label).indexOf(_.toLower(n.search.keyword))>-1||e.id==n.search.keyword}),n.search.emptyResult=0==o.length),U.outport=o}L("inport"),L("outport")}n.loading=!1}function F(){n.loading=!0;const e=n.current.type,t=!_.isEmpty(b.list[e]),o=!_.isEmpty(b.public[e]);if(t||o){const n=[];t&&n.push(i.list(g)),o&&n.push(i.listPublic(g)),l.all(n).then(function(n){n.length>1?(b.list[e]=n[0].list,b.public[e]=n[1].list,x.public=n[1].dirs):t?b.list[e]=n[0].list:o&&(b.public[e]=n[0].list,x.public=n[0].dirs),z()},function(e){a.pop("error","加载组件列表失败: "+e.msg)})}else z()}function j(e,t){const o=_.get(n.appConfig,"services."+e+".url"),r=_.get(n.appConfig,"services."+e+".path")||_.get(n.current.tab,"path"),s=_.clone(_.get(n.current.tab,"params"));"device"===e&&s&&(s.pageNumber=k.pageNumber,n.search.keyword&&(s.pageNumber=1,isNaN(Number(n.search.keyword))?s.deviceName=n.search.keyword:s.deviceId=n.search.keyword)),o&&r&&i.getExternal(o+r,s).then(function(o){let r=function(e,t){const o=_.get(n.current.tab,n.current.type+"ComponentId");let r,i,a=_.get(window.appConfig.services,t+"."+n.current.type+"ComponentId");a=a||o;const s=function(e){return r=0,i=_.filter(e,function(e){return!e.folder}).length,_.map(e,function(e){if(e.folder){let o=e.children,r=!0;return n.search.keyword&&(o=_.filter(o,function(e){return _.toLower(e.label).indexOf(_.toLower(n.search.keyword))>-1||e.id==n.search.keyword})),_.isEmpty(o)?r=!1:o=s(e.children),_.assign({},e,{id:t+"-"+e.id,expanded:!0,visible:r,children:o})}{const n=E(r,i);return r++,_.assign({},e,{icon:"iconfont iconcube",componentId:a||t+"-"+e.id,type:t+"_component",label:"device"==t?e.deviceName:e.label,classes:n,usable:!0,visible:!0})}})};let l=s(e);return"device"!=t&&n.search.keyword&&(l=_.filter(l,function(e){return e.folder||_.toLower(e.label).indexOf(_.toLower(n.search.keyword))>-1||e.id==n.search.keyword})),l}("device"===e?o.data.result:o.data,e);n.search.keyword&&(k.searchKey=n.search.keyword,n.search.emptyResult=0==_.filter(r,{visible:!0}).length),"device"===e&&(k.pageNumber=o.data.pageNumber+1,k.list=t?_.concat(k.list,r):r,(r=_.clone(k.list)).length>=s.pageSize&&r.push(R("device"))),n.my_treedata=r,n.loading=!1},function(e){a.pop("error","加载数据失败: "+e.msg),n.my_treedata=[],n.loading=!1})}n.onAbnTreeRowSelected=function(e){if(e.showMore){n.loading=!0;const t=e.id.split("-")[0];if("device"===t)j(_.get(n.current,"tab.id"),!0);else M+=A,L(t)}};var B=function(r,s,l){r.folder?1===r.id?r.menu=[]:2===r.id&&n.componentAble?r.menu=[{text:"新建文件夹",enabled:c,click:function(e){n.addFolder(e.row.id,s)}}]:(r.menu=[{text:"重命名",enabled:c,click:function(e){n.renameFolder(e.row.id,s,e.row.label)}},{text:"customize"==n.current.type?"删除":"批量删除",enabled:c,click:function(e){n.removeFolder(e.row.id,s,e.row.label,n.my_treedata,"customize"==n.current.type)}}],n.componentAble&&("customize"==n.current.type&&(r.menu.push(null),r.menu.push({text:"新建文件夹",enabled:c,click:function(e){n.addFolder(e.row.id,s)}}),r.menu.push({text:"移动",enabled:c,click:function(e){n.changeParentDir(e.row.branch)}})),r.menu.push(null),r.menu.push({text:"新建组件",enabled:c,click:function(e){n.createComponent(e.row.id,l)}}),r.menu.push({text:"导入组件",enabled:c,click:function(e){n.importComponent(null,null,e.row.id)}}))):(r.menu=[{text:"复制",enabled:c,click:function(e){n.duplicateComponent(e.row.branch)}},{text:"删除",enabled:c,click:function(t){let o=null,r=null;if("customize"===n.current.type&&(o=n.treeControls.get_siblings(t.row.branch),e.params.componentId==t.row.id)){var i=_.filter(o,{folder:!0}),a=!_.isEmpty(i)&&_.filter(n.treeControls.get_children(i[0]),function(e){return!e.folder});r=_.isEmpty(a)?n.treeControls.get_first_branch():a[0]}n.removeComponent(t.row.branch,o,r)}},{text:"分享",enabled:c,click:function(e){n.shareComponent(e.row.id,e.row.label)}}],r.menu.push(null),r.menu.push({text:"导出",enabled:c,click:function(e){n.exportComponent(e.row.id,e.row.label)}}),r.menu.push({text:"导入",enabled:c,click:function(e){n.importComponent(e.row.id,e.row.label)}}),n.componentAble&&r.menu.unshift({text:"编辑",enabled:c,click:function(n){o.currentProjectId=t.id,i.setPermission(n.row.id).then(function(t){e.go("app.customize",{componentId:n.row.id})},function(e){a.pop("error","请求失败: "+e.msg)})}}),"customize"==n.current.type&&(r.menu.push(null),r.menu.push({text:"移动",enabled:c,click:function(e){n.changeParentDir(e.row.branch)}})))};function G(e){n.loading=!0;const t=_.get(n.current,"tab.service");var o=_.get(n.current,"tab.id");if("recommend"==o)F();else if("hufu"==o||"device"==o)j(o);else if(y=_.cloneDeep(_.get(b[t],n.current.type)),(e||_.isEmpty(y))&&t)C[t]();else if(t){var r=O(x[o]);if("list"===t){var i=D(o);r=_.concat(r,i)}n.search.keyword&&(n.search.emptyResult=-1==_.findIndex(r,{visible:!0})),n.my_treedata=r,n.loading=!1}}n.my_treedata=[],n.handleChangeTab=function(e){n.current.tab=e,G()},n.handleSearchKeyup=function(e){13!=e.keyCode&&"click"!=e.type||(n.search.emptyResult=!1,G())},n.$watch("current.type",function(e,t){I="predict"===e?"service":e,g=_.get(d[e],"componentType"),G(!0)}),n.$on("toggle.app",function(e,t){t!==n.current.type&&("customize"!=n.current.type&&"customize"!=t&&(n.current.expandedDir=[]),n.current.type=t)}),n.$on("toggle.node",function(e,t){n.current.node=t,"recommend"==_.get(n.current,"tab.id")&&F()}),n.$on("toggle.customize",function(e,t){"customize"!=n.current.type&&(n.current.type="customize",n.current.tab=_.find(s,{id:"my"})),n.current.component=t}),n.$on("node.list.reload",function(e,t){x.shared=_.find(n.userConfig.componentDirs,{id:w.shared}).children,x.my=_.find(n.userConfig.componentDirs,{id:w.my}).children,$(),G(!0)}),n.$on("$destroy",function(){})}]),angular.module("app").controller("nodesController",["$state","$rootScope","$scope","nodeService",function(e,t,n,o){n.searchKey="",n.$on("editor.ready",function(){const e=o.getGraph();n.nodes=_.get(e,"nodes")}),n.$on("toggle.node",function(e,t){_.forEach(n.nodes,function(e){e.active=e.id==_.get(t,"id")})}),n.handleClick=function(t){const n=_.slice(_.get(e,"current.name").split("."),0,3).join(".");e.go(n+".node",{nodeId:t.id}),function(e){var t,n,r=o.getPosition(),i=document.querySelector(".app-svg"),a=i.clientWidth,s=i.clientHeight,l=r.x,c=r.y,p=r.scale,u=e.metadata.x,d=e.metadata.y,f=e.metadata.width,h=e.metadata.height;n=c+d*p<0||c+d*p>s-h?s/2-d-h/2:c,l===(t=l+u*p<0||l+u*p>a-f?a/2-u-f/2:l)&&c===n||o.setPosition(t,n)}(t)},n.menuOptions=[{text:"复制",click:function(e,n,o,r,i){const a=e.node;"dashboard"===a.component?t.copiedNode=null:(t.copiedNode=angular.copy(a.metadata),t.copiedComp=angular.copy(a.component),_.has(t.copiedNode,"apiName")&&delete t.copiedNode.apiName)}},{text:"删除",click:function(e,n,o,r,i){t.removeNode(e.node,"app.predict.edit")}},{text:"属性",click:function(t,n,o,r,i){e.go("app.predict.edit.node.setting.params",{nodeId:t.node.id})}}]}]);let __popupController=["$uibModal","$stateParams","$rootScope","$state",function(e,t,n,o){if(!n.currentState)return void o.go("app.exp",{type:t.type,id:t.id,nodeId:t.nodeId});let r=e.open({animation:!0,templateUrl:"/tpl/custom/popup/popup.html",controller:["$scope","$state","$stateParams","ossService","$rootScope",function(e,t,n,o,i){e.ok=function(){r.close(!0)},e.cancel=function(){r.close(!1)},e.$on("modal.closing",function(e,n){setTimeout(function(){t.go(i.previousState)},300)})}],size:"lg",appendTo:""})}];angular.module("app").controller("popupChartController",["$scope","$rootScope","$stateParams","appDataStoreService",function(e,t,n,o){t.popupTitle="分析报告",t.popupLoading=!1;let r=["studio",window.appConfig.userId,n.id,n.nodeId,n.portId,"visual","part-00000"].join("/");o.url(r).then(function(t){t.success&&(e.chartUrl="/visual_iframe?data="+encodeURIComponent(t.data))}),e.$on("$destroy",function(){t.popupTitle=void 0,t.popupLoading=void 0})}]).controller("popupTableController",["$scope","$rootScope","$stateParams","tableService",function(e,t,n,o){t.popupTitle="数据探查",t.popupLoading=!0,t.popupHasFooter=!0,t.isTable=!0,t.tableColumnWidth=68,t.widthUp=function(){t.tableColumnWidth>=200||(t.tableColumnWidth+=5)},t.widthDown=function(){t.tableColumnWidth<=68||(t.tableColumnWidth-=5)},o.getNodeTableName(n.id,n.nodeId,n.portId).then(function(n){let r=n.tableName,i=n.propertyName;o.getTableMeta(r,i).then(function(n){t.popupLoading=!1,e.tableData=n.data.table_data.data,e.tableSchema=n.data.table_data.schema;for(let t=0;t<e.tableData.length;t++)e.tableData[t].unshift(t);e.order=function(t,n){e.sortIndex=t,e.sortType=n,"asc"===n?e.tableData.sort(function(e,n){return parseFloat(e[t])-parseFloat(n[t])}):e.tableData.sort(function(e,n){return parseFloat(n[t])-parseFloat(e[t])})}},function(e){t.popupLoading=!1,t.popupNotice="未获取到数据"})},function(e){t.popupLoading=!1,t.popupNotice="未获取到数据表"}),e.$on("$destroy",function(){t.popupTitle=void 0,t.popupLoading=void 0,t.popupHasFooter=void 0,t.popupNotice=void 0,t.popupHasFooter=void 0,t.isTable=void 0,t.tableColumnWidth=void 0,t.widthUp=void 0,t.widthDown=void 0})}]).controller("popupColumnController",["$scope","$rootScope","tableService","$stateParams","nodeService",function(e,t,n,o,r){t.popupTitle="字段选择",t.popupHasFooter=!0,t.popupLoading=!0;let i,a=function(e){t.popupLoading=!1,t.popupNotice=e},s=r.getNode(o.nodeId);for(let e in s.metadata.def.params){let t=s.metadata.def.params[e];t.controlInstUuid===o.targetControlId&&(i=t)}n.getUpstreamTableName(o.id,o.nodeId,o.targetControlId).then(function(o){let r=o.tableName,s=o.propertyName;r?n.getTableMeta(r,s).then(function(n){t.popupLoading=!1;let o=n.data.tableColumns;if(o){if(i.value&&i.value.length){let e=i.value.trim().split(","),t={};for(let n=0;n<e.length;n++){t[e[n].trim()]=!0}for(let e=0;e<o.length;e++)t[o[e].name]&&(o[e].selected=!0)}e.tableColumnArr=o,e.totalSelectedNum=0,e.tableColumnObj={};for(let t=0;t<o.length;t++){let n=o[t],r=n.type.toLowerCase();e.tableColumnObj[r]||(e.tableColumnObj[r]=[]),e.tableColumnObj[r].push(n)}e.$watch("tableColumnArr",function(t,n){e.tableColumnNumObj={},e.totalSelectedNum=0;for(let t=0;t<o.length;t++){let n=o[t],r=n.type.toLowerCase();void 0===e.tableColumnNumObj[r]&&(e.tableColumnNumObj[r]=0),n.selected&&(e.totalSelectedNum++,e.tableColumnNumObj[r]++)}},!0),e.toggleColType=function(t,n){let o=e.tableColumnObj[n];if(t)for(let e=0;e<o.length;e++)o[e].selected=!0;else for(let e=0;e<o.length;e++)o[e].selected=void 0},e.toggleSelectAll=function(e){if(e)for(let e=0;e<o.length;e++)o[e].selected=!0;else for(let e=0;e<o.length;e++)o[e].selected=void 0},t.popupConfirm=function(){let t=[];for(let e=0;e<o.length;e++)o[e].selected&&t.push(o[e].name);i.value=t.join(","),e.ok()}}else a("未获取到数据")},function(e){console.error(e),a("未获取到数据")}):a("未获取到数据")},function(e){console.error(e),a("未获取到数据")}),e.$on("$destroy",function(){t.popupTitle=void 0,t.popupLoading=void 0,t.popupNotice=void 0,t.popupHasFooter=void 0,t.popupConfirm=void 0})}]),angular.module("app").controller("readController",["$state","$stateParams","$scope","$rootScope","nodeService","hardwareService","APP_STATUS","common","appService","predictService","rpaService","toaster","$window","scriptService",function(e,t,n,o,r,i,a,s,l,c,p,u,d,f){o.readOnly=!0,o.sockets=o.sockets||{},o.scriptLogs=o.scriptLogs||{};const h=function(){o.sockets[t.id]||(o.sockets[t.id]=f.connect(t.id)),o.appSocket||(o.appSocket=window.io(`${location.protocol}//${window.appConfig.predictHost}/master`,{path:`/socket/${t.id}`}),o.appSocket.on("process error",function(e){!function(e){const{data:{node_id:t=""}={}}=e,n=r.getNode(t),o=$(`#${t}`);o.find(".the-graph-spin").hide(),o.find(".the-graph-success-icon").hide(),o.find(".the-graph-error-icon").show(),n&&u.pop("error",`节点 ${n.metadata.label} 运行出错，查看日志获取详细信息`)}(e)}))};r.setGroupSelectionHandler(function(t){t&&(e.includes("app.exp.read")?e.go("app.exp.read.group",{groupId:t}):e.includes("app.exp.run")&&e.go("app.exp.run.group",{groupId:t}))}),r.setNodeSelectionHandler(function(t,n,o,r){n?e.includes("app.exp.read")?e.go("app.exp.read.node",{nodeId:n}):e.includes("app.exp.run")?e.go("app.exp.run.node",{nodeId:n}):e.includes("app.exp.prepare")?e.go("app.exp.prepare.node",{nodeId:n}):e.includes("app.exp.history")?e.go("app.exp.history.node",{nodeId:n}):e.includes("app.exp.cron")?e.go("app.exp.cron.node",{nodeId:n}):e.includes("app.predict.read")?e.go("app.predict.read.node",{nodeId:n}):e.includes("app.predict.run")?e.go("app.predict.run.node",{nodeId:n}):e.includes("app.predict.prepare")&&e.go("app.predict.prepare.node",{nodeId:n}):e.includes("app.exp.read")?e.go("app.exp.read.setting.overview",{nodeId:n}):e.includes("app.exp.run")?e.go("app.exp.run.setting.overview",{nodeId:n}):e.includes("app.exp.prepare")?e.go("app.exp.prepare.setting.overview",{nodeId:n}):e.includes("app.exp.history")?e.go("app.exp.history.setting.overview",{nodeId:n}):e.includes("app.exp.cron")?e.go("app.exp.cron.setting.overview",{nodeId:n}):e.includes("app.predict.read")?e.go("app.predict.read.setting.overview",{nodeId:n}):e.includes("app.predict.run")?e.go("app.predict.run.setting.overview",{nodeId:n}):e.includes("app.predict.prepare")&&e.go("app.predict.prepare.setting.overview",{nodeId:n})}),r.setNodeRectImgDblclickHandler.call(this,function(e,n,r){if("dblclick"==e.type&&n&&r){let e="studio/"+window.appConfig.userId+"/logs/"+t.id+"/screenshots/"+n+"/";o.showFiles(e)}});let m,g,v,b,y=$("#editor");n.$on("editor.ready",function(){y=$("#editor")});let w=!1,x={};const C=window.appConfig.statusTimeout||2e3,k=function(n){t.nodeId?e.go(n+".node",{type:t.type,id:t.id,nodeId:t.nodeId,refresh:t.refresh+1}):e.go(n,{type:t.type,id:t.id,refresh:t.refresh+1})};let S=l;"predict"===t.type?S=c:"rpa"===t.type&&(S=p);let T=0,I=function(n){if(!n||!n.map){if(e.includes("app.exp.run")||e.includes("app.predict.run")){const t=e.includes("app.exp.run")?"运行失败":"部署失败";u.pop("error",t),e.reload()}return}n.msg&&n.msg[T]&&(u.pop("info",n.msg[T]),T+=1);let o=n.map;!_.isEmpty(o)&&function(t){for(let n in t){if(!n.startsWith("node.status."))continue;let o=n;n=n.replace("node.status.","");let i=$("#"+n);switch(t[o]){case"5":case"6":e.includes("app.predict.run")&&(i.find(".the-graph-spin").show(),i.find(".the-graph-success-icon").hide(),i.find(".the-graph-error-icon").hide()),(e.includes("app.exp.run")||e.includes("app.exp.history"))&&(y.find(".edge").filter(function(){return this.id.match(new RegExp("^edge-.*"+n+"$"))}).find(".edge-fg").removeClass("dashing"),i.find(".the-graph-spin").show(),i.find(".the-graph-success-icon").hide(),i.find(".the-graph-error-icon").hide());break;case"1":if(e.includes("app.exp.run")||e.includes("app.exp.history")){y.find(".edge").filter(function(){return this.id.match(new RegExp("^edge-.*"+n+"$"))}).find(".edge-fg").addClass("dashing");let e=document.querySelector(".edges");document.querySelectorAll(".edge-fg.dashing").forEach(function(t,n){n>0&&e.appendChild(t.parentNode)}),(!x[n]||s.now()-x[n]>2e3)&&(r.updateScreenshot(n,!0),x[n]=s.now())}i.find(".the-graph-spin").show(),i.find(".the-graph-success-icon").hide(),i.find(".the-graph-error-icon").hide();break;case"4":y.find(".edge").filter(function(){return this.id.match(new RegExp("^edge-.*"+n+"$"))}).find(".edge-fg").removeClass("dashing"),i.find(".the-graph-spin").hide(),i.find(".the-graph-success-icon").hide(),i.find(".the-graph-error-icon").show();break;case"3":y.find(".edge").filter(function(){return this.id.match(new RegExp("^edge-.*"+n+"$"))}).find(".edge-fg").removeClass("dashing"),i.find(".the-graph-spin").hide(),i.find(".the-graph-success-icon").show(),i.find(".the-graph-error-icon").hide(),(e.includes("app.exp.run")||e.includes("app.exp.history"))&&(!x[n]||s.now()-x[n]>1e4)&&(r.updateScreenshot(n,!0),x[n]=s.now());break;default:y.find(".edge").filter(function(){return this.id.match(new RegExp("^edge-.*"+n+"$"))}).find(".edge-fg").removeClass("dashing"),i.find(".the-graph-spin").hide(),i.find(".the-graph-success-icon").hide(),i.find(".the-graph-error-icon").hide()}}}(o),g&&"5"!=o.status&&(u.clear(g),g=null),b&&"9"!=o.status&&(u.clear(b),b=null),v&&"6"!=o.status&&(u.clear(b),b=null);let i=C;if(e.includes("app.exp.run")){switch(o.status){case"5":g||(g=u.pop({type:"info",body:"starting-html",bodyOutputType:"directive",directiveData:{title:"启动中"},timeout:0}));break;case"9":b||(b=u.pop({type:"info",body:"starting-html",bodyOutputType:"directive",directiveData:{title:"等待资源"},timeout:0}));break;case"1":break;case"2":return u.pop("success","已停止"),void k("app.exp.edit");case"3":if("algo"===t.type)u.pop("success","运行成功, 将释放资源"),i=5e3;else if("rpa"===t.type)return u.pop("success","运行成功"),void k("app.exp.run");break;case"4":if("algo"===t.type)u.pop("error","运行失败, 将释放资源"),i=5e3;else if("rpa"===t.type)return u.pop("error","运行失败"),void k("app.exp.edit");break;case"6":v||(v=u.pop({type:"info",body:"starting-html",bodyOutputType:"directive",directiveData:{title:"停止中"},timeout:0}));break;case"7":return u.pop("error","运行失败"),void k("app.exp.edit")}m=window.setTimeout(E,i)}else if(e.includes("app.exp.history")){switch(o.status){case"1":case"5":break;default:return}m=window.setTimeout(E,i)}else if(e.includes("app.predict.run")){switch(o.status){case"1":h();break;case"5":g||(g=u.pop({type:"info",body:"starting-html",bodyOutputType:"directive",directiveData:{title:"启动中"},timeout:0}));break;case"9":b||(b=u.pop({type:"info",body:"starting-html",bodyOutputType:"directive",directiveData:{title:"等待资源"},timeout:0}));break;case"2":return u.pop("success","已停止"),void k("app.predict.edit");case"3":return h(),u.pop("success","部署成功"),void k("app.predict.run");case"4":return u.pop("error","部署失败"),void k("app.predict.edit");case"6":v||(v=u.pop({type:"info",body:"starting-html",bodyOutputType:"directive",directiveData:{title:"停止中"},timeout:0}));break;case"7":return u.pop("error","部署失败"),void k("app.predict.edit")}m=window.setTimeout(E,i)}},E=function(){y&&y.length?(e.includes("app.exp")&&(w||(w=!0,r.showAllScreenshots())),"predict"===t.type&&o.appConfig._board?i.post("status",{id:t.id,boardId:o.appConfig._board.id}).then(function(e){I(e)},function(e){m=window.setTimeout(E,C)}):S.getNetworkStatus(t.id).then(function(e){I(e)},function(e){m=window.setTimeout(E,C)})):m=window.setTimeout(E,C)};E(),n.$on("$destroy",function(){y.find(".edge").find(".edge-fg").removeClass("dashing"),y.find(".the-graph-spin").hide(),m&&window.clearTimeout(m),r.setNodeRectImgDblclickHandler(null),r.setNodeSelectionHandler(null),r.setGroupSelectionHandler(null),o.readOnly=void 0,f.disconnect(t.id),delete o.sockets[t.id],o.appSocket&&o.appSocket.disconnect(),o.appSocket=null})}]).controller("readNodeController",["$state","$stateParams","$scope","$rootScope","multiselect","common","nodeService","logService","appService",function(e,t,n,o,r,i,a,s,l){let c=$("#editor #"+t.nodeId);if(!c||0===c.length)return void e.go("^");var p;n.nodeId=t.nodeId,n.node=a.getNode(n.nodeId),n.nodeTabInfo=((p=_.get(n.node.metadata,"ui.tabs",{}))||(p={}),Object.assign({},p,{debug:{tabName:{en_US:"Debug Log",zh_CN:"调试日志",zh:"调试日志"},controls:[{uuid:`${t.nodeId}-debuglog`,type:"debug_log",label:{zh_CN:"调试日志"}}]}})),n.componentId=n.node.component,o.nodeCompType=n.node.metadata.def.type;let u=o.appConfig._board?o.appConfig._board.id:null;n.logId=s.getLogId(window.appConfig.userId,t.id,t.nodeId,u),o.$broadcast("toggle.node",n.node),n.resetTabInfo(n.node.metadata.def.params,n.nodeTabInfo),n.appList=[],998===o.nodeCompType&&l.list(9999,"algo").then(function(e){e&&e.list&&(n.appList=e.list)},function(e){toaster.pop("error","获取项目列表失败: "+e.msg)}),c.addClass("selected");let d=document.querySelector(".edges"),f=document.querySelector(".edges").childNodes,h=[];for(let e=0;e<f.length;e++)f[e].attributes&&($(f[e]).removeClass("active"),f[e].getAttribute("id")&&f[e].getAttribute("id").indexOf(t.nodeId)>-1&&($(f[e]).addClass("active"),h.push(f[e])));for(let e=0;e<h.length;e++)d.appendChild(h[e]);$(document).on("keydown.node.read",function(e){let t=$(e.target);if(!t.is("input")&&!t.is("textarea"))switch(e.keyCode){case 67:(e.ctrlKey||e.metaKey)&&(e.stopPropagation(),o.copyNode(n.node.metadata,n.node.component))}}),n.$on("$destroy",function(){c.removeClass("selected"),$(f).removeClass("active"),$(document).off("keydown.node.read"),o.nodeCompType=void 0,f=void 0,o.$broadcast("toggle.node",null)})}]).controller("readGroupController",["$state","$stateParams","$scope","$rootScope","multiselect","common","nodeService","logService","appService",function(e,t,n,o,r,i,a,s,l){n.group=a.getGroup(t.groupId);let c=$("#editor #"+t.groupId);c.addClass("selection"),n.$on("$destroy",function(){c.removeClass("selection"),c=void 0})}]).controller("prepareController",["$state","$stateParams","$scope","rpaService","toaster","$rootScope","predictService","appService","loopService",function(e,t,n,o,r,i,a,s,l){let c,p,u,d=!0,f=function(e){d&&s.edgeImageStatus(e).then(function(t){let n=0,o=0,i=!1;if(Object.keys(t).forEach(function(e){if(t[e]){let r=t[e].match(/^(\d+(\.\d+)?)%$/);if(r&&r[1]){let e=parseInt(r[1],10);if(!isNaN(e)&&e>=0&&e<=100)return n+=e,void o++}}i=e}),i)g("文件 "+i+" 下载失败");else if(0!==o){if(100===(n=Math.floor(n/o)))return c?(c.toaster.title="下载完成",r.reset(c)):c=r.pop({type:"info",title:"下载完成",timeout:3e3}),void w();c?(c.toaster.title="正在下载项目所需文件 "+n+"%",r.reset(c)):c=r.pop({type:"info",title:"正在下载项目所需文件 "+n+"%",timeout:3e3,tapToDismiss:!1}),window.setTimeout(function(){f(e)},1e3)}else w()},function(e){g("获取下载进度失败")})},h=function(){"edge"===window.appConfig.env?s.edgeImagePrepare(t.id).then(function(e){f(e)},function(e){g("下载文件失败")}):w()},m=function(e,t){t||h(),r.clear(p)};let g=function(e){r.clear(p),p=r.pop({type:"error",title:e,body:'<a style="margin-top: 4px; color: #00c1de">重试</a>',bodyOutputType:"trustedHtml",showCloseButton:!0,tapToDismiss:!1,timeout:0,clickHandler:m})},v=i.appConfig._board,b=function(){u=r.pop({type:"info",body:"starting-html",bodyOutputType:"directive",directiveData:{title:"正在将资源发送到边缘端"},timeout:0}),hardwareService.post("storage.create",{appId:t.id,boardId:v.id,keys:["dashboard","configs","share"]}).then(function(e){r.clear(u),r.pop("success","发送完成"),y()},function(e){r.clear(u),r.pop("error","发送失败："+e.msg)})},y=function(){hardwareService.post("get",{hwtype:"board",boardId:v.id}).then(function(n){n.success&&"online"===_.get(n,"data.state")?hardwareService.post("app/deploy",{boardId:v.id,appId:t.id}).then(function(t){t.success?(r.pop("success","正在部署"),e.params.nodeId?e.go("app.predict.run.node",{nodeId:e.params.nodeId}):e.go("app.predict.run")):r.pop("error","部署失败")},function(e){r.pop("error","部署失败: "+e.msg)}):r.pop("error","板子 "+v.id+" 已经掉线")})},w=function(){if(e.includes("app.exp")){("rpa"===t.type?o:s).run(t.id,t.targetNodeId,t.runType).then(function(t){r.pop("success","开始运行"),e.params.nodeId?e.go("app.exp.run.node",{nodeId:e.params.nodeId}):e.go("app.exp.run")},function(e){r.pop("error","运行失败: "+e.msg)})}else e.includes("app.predict")&&(v?s.export(t.id,{type:"appDashboardExport"}).then(function(e){l.fetchJob({title:"正在导出"},e.job.id,s.getJob,b)},function(e){}):a.deploy(t.id).then(function(t){r.pop("success","正在部署"),e.params.nodeId?e.go("app.predict.run.node",{nodeId:e.params.nodeId}):e.go("app.predict.run")},function(e){r.pop("error","部署失败: "+e.msg)}))};h(),n.stop=function(){let n=e.current.name.split(".prepare")[0];e.go(n,{type:t.type,id:t.id,nodeId:t.nodeId,refresh:t.refresh+1})},n.release=function(){e.go("app.predict",{type:t.type,id:t.id,nodeId:t.nodeId,refresh:t.refresh+1})},n.$on("$destroy",function(){d=!1,r.clear(p)})}]),angular.module("app").controller("predictNodeSettingTestController",["$state","$scope","$rootScope","$http",function(e,t,n,o){t.currentTab.type=e.current.data.type,t.currentTab.title=_.get(_.find(t.tabs,{type:t.currentTab.type}),"name.zh_CN"),t.testing=!1,t.test=function(e){try{e=JSON.parse(e)}catch(e){return void(t.test_error="请输入正确的 JSON 字符串")}if(t.test_error="",t.testing)return;t.testing=!0;const r=("hardware"==n.appConfig._context?location.protocol+"//"+n.appConfig._board.ip:location.protocol+"//"+t.appConfig.predictHost)+"/"+t.appInfo.id+"/"+_.get(t.node,"metadata.apiName")||"api名称未设置";o({method:"POST",url:r,data:{debug:!0,data:e}}).then(function(e){"object"==typeof e.data&&(e.data=JSON.stringify(e.data)),t.testResult=e.data},function(e,n){t.testResult="error"}).finally(function(){t.testing=!1})}}]),angular.module("app").factory("remoteService",["$http","$q",function(e,t){let n={},o=function(e){return window.appConfig.affinity?["/app/status","/app/stop","/app/run","/app/cron/start","/app/cron/stop","/app/get/permission","/app/set/permission","/component/get/permission","/component/set/permission","/predict/release","/predict/deploy","/predict/status","/oss/object/check"].includes(e)?e:0===e.indexOf("/edge")?e:0===e.indexOf("http")?e:e.startsWith("/table/meta")?e:e.startsWith("/local")||e.startsWith("/system")?e:window.appConfig.affinity+e:window.appConfig.redirectRequest?e.startsWith("http")||e.startsWith("https")?e:`${window.appConfig.redirectRequest}${e}`:e};return n.get=function(n){let r=t.defer();return e({method:"GET",url:o(n),headers:{"x-sp-user-id":window.appConfig.userId,"x-sp-signature":window.appConfig.signature,"x-sp-sign-version":window.appConfig.signVersion}}).then(function(e){e&&e.data&&e.data.success?r.resolve(e.data):r.reject(e.data)},function(e,t){r.reject({success:!1,msg:"网络错误"})}),r.promise},n.post=function(n,r){let i=t.defer();return e({method:"POST",url:o(n),headers:{"Content-Type":"application/json; charset=utf-8","x-sp-user-id":window.appConfig.userId,"x-sp-signature":window.appConfig.signature,"x-sp-sign-version":window.appConfig.signVersion},data:r}).then(function(e){e.data.success?i.resolve(e.data):i.reject(e.data)},function(e,t){i.reject({success:!1,msg:"网络错误"})}),i.promise},n.getBinary=function(n,r){let i=t.defer();return e({method:"GET",url:o(n),responseType:r}).then(function(e){i.resolve(e.data)},function(e,t){i.reject({success:!1,msg:_.get(e,"statusText")||"网络错误"})}),i.promise},n.head=function(n){let r=t.defer();return e({method:"HEAD",url:o(n)}).then(function(e){r.resolve(e)},function(e,t){r.reject({success:!1,msg:"网络错误"})}),r.promise},n.delete=function(n){let r=t.defer();return e({method:"DELETE",url:o(n)}).then(function(e){r.resolve(e)},function(e,t){r.reject({success:!1,msg:"网络错误"})}),r.promise},n.put=function(n,r){let i=t.defer();return e({method:"PUT",url:o(n),headers:{"Content-Type":"application/octet-stream;"},data:r,transformRequest:[]}).then(function(e){i.resolve(e)},function(e,t){i.reject({success:!1,msg:"网络错误"})}),i.promise},n}]).factory("appService",["$http","remoteService","$q","ossService","ccc","appDataStoreService","statisticsService",function(e,t,n,o,r,i,a){let s={},l={};return s.create=function(e,o,r){let i=n.defer();return t.post("/app/create",{name:e,dir:o,type:r}).then(function(t){switch(l={},r){case"algo":a.trackEvent(a.STAT_ACTIONS.APP.CREATE,`${a.DEFAULT_OPT_LABEL}_${t.id}_${e}`,1);break;case"predict":a.trackEvent(a.STAT_ACTIONS.SERVICE.CREATE,`${a.DEFAULT_OPT_LABEL}_${t.id}_${e}`,1)}i.resolve(t)},function(e){i.reject(e)}),i.promise},s.get=function(e,i){let a=n.defer();return t.post("/app/get",{id:e}).then(function(e){if(i)return void a.resolve(e.appInfo);const t=e.appInfo.data;o.getObject(window.appConfig.oss.bucket,t,null,!0).then(function(t){e.appInfo.data=r.d(t),a.resolve(e)},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise},s.head=function(e){let r=n.defer();return t.post("/app/get",{id:e}).then(function(e){const t=e.appInfo.data;o.headObject(window.appConfig.oss.bucket,t).then(function(e){r.resolve(e)},function(e){r.reject(e)})},function(e){r.reject(e)}),r.promise},s.del=function(e){let o=n.defer();return t.post("/app/del",{id:e}).then(function(t){l={},a.trackEvent(a.STAT_ACTIONS.APP.DELETE,`${a.DEFAULT_OPT_LABEL}_${e}`,1),o.resolve(t)},function(e){o.reject(e)}),o.promise},s.edgeImagePrepare=function(e){let o=n.defer();return t.get("/edge/images/prepare/"+e).then(function(e){try{let t=JSON.parse(e.result);o.resolve(t.download_id)}catch(e){o.reject(e)}},function(e){o.reject(e)}),o.promise},s.edgeImageStatus=function(e){let o=n.defer();return t.get("/edge/images/status/"+e).then(function(e){try{let t=JSON.parse(e.result);o.resolve(t)}catch(e){o.reject(e)}},function(e){o.reject(e)}),o.promise},s.delnode=function(e,o){let r=n.defer();return t.post("/app/delnode",{id:e,nodeId:o}).then(function(e){r.resolve(e)},function(e){r.reject(e)}),r.promise},s.getPermission=function(e){let o=n.defer();return t.post("/app/get/permission",{id:e}).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise},s.setPermission=function(e){let o=n.defer();return t.post("/app/set/permission",{id:e,permission:"write"}).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise},s.listCron=function(e,o,r){let i=n.defer();return t.post("/app/cron/list",{id:e,limit:o,offset:r}).then(function(e){i.resolve(e)},function(e){i.reject(e)}),i.promise},s.save=function(e,t,i){let a=n.defer(),s="studio/"+window.appConfig.userId+"/"+e+"/data",l="predict"===i?"v2":"v1";return o.putObject(window.appConfig.oss.bucket,s,r.c(JSON.stringify(t),l)).then(function(e){a.resolve(e)},function(e){a.reject(e)}),a.promise},s.saveScripts=function(e,t){let i=n.defer(),a="studio/"+window.appConfig.userId+"/"+e+"/data";return o.putObject(window.appConfig.oss.bucket,a,r.c(JSON.stringify(t),"v2"),void 0,void 0,!0).then(function(e){i.resolve(e)},function(e){i.reject(e)}),i.promise},s.share=function(e,o,r,i,s,l=!1){let c=n.defer();return t.post("/app/share",{id:e,targetUserId:r,name:o,description:i,type:s,withData:l}).then(function(t){a.trackEvent(a.STAT_ACTIONS.APP.SHARE,`${a.DEFAULT_OPT_LABEL}_${e}_${r}`,1),c.resolve(t)},function(e){c.reject(e)}),c.promise},s.duplicate=function(e,o,r,i,s=!1,c){let p=n.defer();return t.post("/app/duplicate",{id:e,name:o,description:r,type:i,withData:s,dir:c}).then(function(t){l={},p.resolve(t),a.trackEvent(a.STAT_ACTIONS.APP.COPY,`${a.DEFAULT_OPT_LABEL}_${e}_${o}`,1)},function(e){p.reject(e)}),p.promise},s.duplicatePublic=function(e,o,r,i){let s=n.defer();return t.post("/app/public/duplicate",{id:e,name:o,description:r,type:i}).then(function(t){l={},a.trackEvent(a.STAT_ACTIONS.APP.DUPLICATE_FROM_TEMPLATE,`${a.DEFAULT_OPT_LABEL}_${e}_${o}`,1),s.resolve(t)},function(e){s.reject(e)}),s.promise},s.changeName=function(e,o){let r=n.defer();return t.post("/app/update/name",{id:e,name:o}).then(function(e){l={},r.resolve(e)},function(e){r.reject(e)}),r.promise},s.changeTags=function(e,o){let r=n.defer();return t.post("/app/update/tags",{id:e,tags:o}).then(function(e){l={},r.resolve(e)},function(e){r.reject(e)}),r.promise},s.changeDir=function(e,o){let r=n.defer();return t.post("/app/update/dir",{id:e,dir:o}).then(function(e){l={},r.resolve(e)},function(e){r.reject(e)}),r.promise},s.changeDescription=function(e,o){let r=n.defer();return t.post("/app/update/description",{id:e,description:o}).then(function(e){l={},r.resolve(e)},function(e){r.reject(e)}),r.promise},s.list=function(e,o,r){let i=n.defer(),a=e+"-"+o;return!r&&l[a]?i.resolve(l[a]):t.post("/app/list",{limit:e,type:o}).then(function(e){l={},i.resolve(e)},function(e){i.reject(e)}),i.promise},s.listPublic=function(e){let o=n.defer();return t.post("/app/public/list",{type:e}).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise},s.getVersion=function(){let t=n.defer();return e({method:"GET",url:window.appConfig.publicOss+"/version.json?"+(new Date).getTime()}).then(function(e){200==e.status&&t.resolve(e.data)},function(e){t.reject(e)}),t.promise},s.startCron=function(e,o){let r=n.defer();return t.post("/app/cron/start",{id:e,cronConfig:o}).then(function(t){a.trackEvent(a.STAT_ACTIONS.APP.RUNCRON,`${a.DEFAULT_OPT_LABEL}_${e}`,1),r.resolve(t)},function(e){r.reject(e)}),r.promise},s.stopCron=function(e,o){let r=n.defer();return t.post("/app/cron/stop",{id:e}).then(function(t){a.trackEvent(a.STAT_ACTIONS.APP.STOPCRON,`${a.DEFAULT_OPT_LABEL}_${e}`,1),r.resolve(t)},function(e){r.reject(e)}),r.promise},s.run=function(e,o,r){let i=n.defer();return t.post("/app/run",{id:e,nodeId:o,type:r}).then(function(t){a.trackEvent(a.STAT_ACTIONS.APP.RUN,`${a.DEFAULT_OPT_LABEL}_${e}_${o}`,1),i.resolve(t)},function(e){i.reject(e)}),i.promise},s.stop=function(e){let o=n.defer();return t.post("/app/stop",{id:e}).then(function(t){a.trackEvent(a.STAT_ACTIONS.APP.STOP,`${a.DEFAULT_OPT_LABEL}_${e}`,1),o.resolve(t)},function(e){o.reject(e)}),o.promise},s.getNetworkStatus=function(e){let o=n.defer();return t.post("/app/status",{id:e}).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise},s.getContents=function(e,t,o=1e3,r=!1){let a=n.defer(),s=[],l=[],c=e.length;return function(t){i.list(e,t,o).then(function(e){if(e.success){let t=e.data.CommonPrefixes,n=e.data.Contents;_.isEmpty(t)||t.forEach(function(e){let t=e.Prefix.slice(c);l.push({id:e.Prefix,label:t,isFolder:!0,type:"folder",checked:r})}),_.isEmpty(n)||n.forEach(function(e){let t=e.Key.slice(c),n=Math.ceil(e.Size/1024),o=_.toLower(t.split(".")[1]);"upload_meta"!==t&&s.push({id:e.Key,label:t,size:n,type:o,checked:r})}),a.resolve({prefixes:l,catalog:s,NextMarker:e.data.NextMarker})}else a.resolve({prefixes:l,catalog:s})},function(e){a.reject(e)})}(t),a.promise},s.getImgUrl=function(e,r){const a=n.defer(),s=window.appConfig.oss.bucket;return(r?o.headObject(s,e):i.head(e)).then(function(n){t.post("/oss/object/get",{Bucket:window.appConfig.oss.bucket,Key:e}).then(function(e){if(e.success){let t=e.data;a.resolve(t)}},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise},s.getMetrics=function(e){let o=n.defer();return t.get(e).then(function(e){e.success?o.resolve(e.result):o.reject(err)},function(e){o.reject(e)}),o.promise},s.getMetricsList=function(e){let o=n.defer();return t.get("/app/metrics?type="+e).then(function(e){o.resolve(e.result)},function(e){o.reject(e)}),o.promise},s.import=function(e){const o=n.defer(),{id:r,name:i,dataPath:a,dir:s}=e;return t.post("/app/import",{appId:r,newAppName:i,importAppDataPath:a,dir:s}).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise},s.export=function(e,o){const r=n.defer();return t.post("/app/"+e+"/export",o).then(function(e){r.resolve(e)},function(e){r.reject(e)}),r.promise},s.switch=function(e,o){const r=n.defer();return t.post("/app/"+e+"/switch",{appVersion:o}).then(function(e){r.resolve(e)},function(e){r.reject(e)}),r.promise},s.getJobs=function(e){const o=n.defer();return t.get("/app/"+e+"/jobs").then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise},s.getJob=function(e){const o=n.defer();return t.get("/app/job/"+e).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise},window.appService=s,s}]).factory("componentService",["$http","remoteService","$q","ccc","ossService","appDataStoreService","statisticsService",function(e,t,n,o,r,i,a){let s={create:function(e,o,r,i,s){let l=n.defer();return t.post("/component/create",{name:e,dir:o,type:r,fromAppId:i,fromNodeId:s}).then(function(t){a.trackEvent(a.STAT_ACTIONS.COMPONENT.CREATE,`${a.DEFAULT_OPT_LABEL}_${t.id}_${e}_${r}`,1),l.resolve(t)},function(e){l.reject(e)}),l.promise},import:function(e,o,r,i){const s=n.defer();return t.post("/component/import",{newComponentName:e,componentId:o||"",dir:r,importComponentDataPath:i}).then(function(t){a.trackEvent(a.STAT_ACTIONS.COMPONENT.IMPORT,`${a.DEFAULT_OPT_LABEL}_${o}_${e}_${i}`,1),s.resolve(t)},function(e){s.reject(e)}),s.promise},export:function(e){const o=n.defer();return t.post("/component/"+e+"/export",{packComponentNext:!0}).then(function(t){a.trackEvent(a.STAT_ACTIONS.COMPONENT.EXPORT,`${a.DEFAULT_OPT_LABEL}_${e}`,1),o.resolve(t)},function(e){o.reject(e)}),o.promise},switch:function(e,o){const r=n.defer();return t.post("/component/"+e+"/switch",{componentVersion:o}).then(function(e){r.resolve(e)},function(e){r.reject(e)}),r.promise},getJob:function(e){const o=n.defer();return t.get("/component/job/"+e).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise},exportModel:function(e,n,o,r,s){const l="studio/{USER_ID}/{APP_ID}/{NODE_ID}/{PORT_ID}/model".replace(/{USER_ID}/g,window.appConfig.userId).replace(/{APP_ID}/g,e).replace(/{NODE_ID}/g,n).replace(/{PORT_ID}/g,o);return i.sync(l,"upload").then(function(){return t.post("/component/export/model",{id:e,nodeId:n,portId:o,name:r,overwrite:s})}).then(function(t){a.trackEvent(a.STAT_ACTIONS.COMMON.EXPORTMODEL,`${a.DEFAULT_OPT_LABEL}_${e}_${n}_${o}`,1);const r="studio/{USER_ID}/component/{COMPONENT_ID}/out1/model/{MODEL_VERSION}".replace(/{USER_ID}/g,window.appConfig.userId).replace(/{COMPONENT_ID}/g,t.componentInfo.id).replace(/{MODEL_VERSION}/g,t.componentInfo.data.version);return i.sync(r,"download").then(function(){return t})})},get:function(e){let i=n.defer();return t.post("/component/get",{id:e}).then(function(e){r.getObject(window.appConfig.oss.bucket,e.componentInfo.data,null,!0).then(function(t){e.componentInfo.data=o.d(t),i.resolve(e)},function(e){i.reject(e)})},function(e){i.reject(e)}),i.promise},getPublic:function(e){let r=n.defer();return t.post("/component/public/get",{id:e}).then(function(e){t.getBinary(e.componentInfo.data,"arraybuffer").then(function(t){e.componentInfo.data=o.d(new Uint8Array(t)),r.resolve(e)},function(e){r.reject(e)})},function(e){r.reject(e)}),r.promise},getExternal:function(t,o){const r=n.defer();return e({method:"GET",url:t,params:o,withCredentials:!0}).then(function(e){200==e.status?r.resolve(e.data):r.reject(e.data)},function(e){r.reject(e)}),r.promise},del:function(e){let o=n.defer();return t.post("/component/del",{id:e}).then(function(t){a.trackEvent(a.STAT_ACTIONS.COMPONENT.DEL,`${a.DEFAULT_OPT_LABEL}_${e}`,1),o.resolve(t)},function(e){o.reject(e)}),o.promise},removeList:function(e){const t=n.defer(),o=[],r=e.length;let i=0;const a=function(n){i++,s.del(n.id).then(function(e){o.push(Object.assign({},n,{removed:!0}))},function(e){o.push(Object.assign({},n,{removed:!1}))}).finally(function(){i==r?t.resolve(o):a(e[i])})};return a(e[i]),t.promise},getPermission:function(e){let o=n.defer();return t.post("/component/get/permission",{id:e}).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise},setPermission:function(e){let o=n.defer();return t.post("/component/set/permission",{id:e,permission:"write"}).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise},save:function(e,t){let i=n.defer(),a="studio/"+window.appConfig.userId+"/component/"+e+"/data";return r.putObject(window.appConfig.oss.bucket,a,o.c(JSON.stringify(t)),"application/octet-stream").then(function(e){i.resolve(e)},function(e){i.reject(e)}),i.promise},share:function(e,o,r){let i=n.defer();return t.post("/component/share",{id:e,targetUserId:r,name:o}).then(function(t){a.trackEvent(a.STAT_ACTIONS.COMPONENT.SHARE,`${a.DEFAULT_OPT_LABEL}_${e}_${r}`,1),i.resolve(t)},function(e){i.reject(e)}),i.promise},duplicate:function(e,o){let r=n.defer();return t.post("/component/duplicate",{id:e,name:o}).then(function(t){a.trackEvent(a.STAT_ACTIONS.COMPONENT.COPY,`${a.DEFAULT_OPT_LABEL}_${e}_${o}`,1),r.resolve(t)},function(e){r.reject(e)}),r.promise},changeName:function(e,o){let r=n.defer();return t.post("/component/update/name",{id:e,name:o}).then(function(t){a.trackEvent(a.STAT_ACTIONS.COMPONENT.EDIT_PARAM,`${a.DEFAULT_OPT_LABEL}_${e}`,1),r.resolve(t)},function(e){r.reject(e)}),r.promise},changeTags:function(e,o){let r=n.defer();return t.post("/component/update/tags",{id:e,tags:o}).then(function(t){a.trackEvent(a.STAT_ACTIONS.COMPONENT.EDIT_PARAM,`${a.DEFAULT_OPT_LABEL}_${e}`,1),r.resolve(t)},function(e){r.reject(e)}),r.promise},changeDir:function(e,o){let r=n.defer();return t.post("/component/update/dir",{id:e,dir:o}).then(function(t){a.trackEvent(a.STAT_ACTIONS.COMPONENT.EDIT_PARAM,`${a.DEFAULT_OPT_LABEL}_${e}`,1),r.resolve(t)},function(e){r.reject(e)}),r.promise},list:function(e,o){const r=n.defer();return t.post("/component/list",{limit:o||9999,type:e}).then(function(e){r.resolve(e)},function(e){r.reject(e)}),r.promise},listPublic:function(e){let o=n.defer();return t.post("/component/public/list",{type:e}).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise}};return window.componentService=s,s}]).factory("predictScriptService",["remoteService","$q","ccc","ossService",function(e,t,n,o){let r={getPredictScriptPath:function(e,t){return"studio/"+window.appConfig.userId+"/predict/"+e+"/"+t+"/predict_script"},get:function(e,n){let i=t.defer();return o.getObject(window.appConfig.oss.bucket,r.getPredictScriptPath(e,n),null,!1).then(function(e){i.resolve(e)}),i.promise},save:function(e,n,i){let a=t.defer();return o.putObject(window.appConfig.oss.bucket,r.getPredictScriptPath(e,n),i,"application/octet-stream").then(function(e){a.resolve(e)},function(e){a.reject(e)}),a.promise}};return r}]).factory("predictService",["remoteService","$q","ccc","ossService","nodeService","statisticsService",function(e,t,n,o,r,i){let a={getNetworkStatus:function(n){let o=t.defer();return e.post("/predict/status",{id:n}).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise},deploy:function(n){let o=t.defer();return e.post("/predict/deploy",{id:n,predictConfig:r.getPredictConfig()}).then(function(e){i.trackEvent(i.STAT_ACTIONS.SERVICE.RUN,`${i.DEFAULT_OPT_LABEL}_${n}`,1),o.resolve(e)},function(e){o.reject(e)}),o.promise},release:function(n){let o=t.defer();return e.post("/predict/release",{id:n}).then(function(e){i.trackEvent(i.STAT_ACTIONS.SERVICE.STOP,`${i.DEFAULT_OPT_LABEL}_${n}`,1),o.resolve(e)},function(e){o.reject(e)}),o.promise}};return a}]).factory("rpaService",["remoteService","$q","ccc","ossService","nodeService",function(e,t,n,o,r){let i={getNetworkStatus:function(n){let o=t.defer();return e.post("/rpa/status",{id:n}).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise},run:function(n,o,r){let i=t.defer();return e.post("/rpa/run",{id:n,nodeId:o,type:r}).then(function(e){i.resolve(e)},function(e){i.reject(e)}),i.promise},stop:function(n){let o=t.defer();return e.post("/rpa/stop",{id:n}).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise}};return i}]).factory("userService",["remoteService","$q","ossService","ccc","USER_CONFIG",function(e,t,n,o,r){const i={getConfig:function(){let e=t.defer();return n.getObject(window.appConfig.oss.bucket,window.appConfig.userConfigPath,null,!0).then(function(t){let n=o.d(t);try{n=JSON.parse(n)}catch(e){}_.isEmpty(n)?i.saveConfig(r).then(function(t){e.resolve(r)},function(t){e.reject(t)}):e.resolve(n)},function(t){e.reject(t)}),e.promise},saveConfig:function(e){let r=t.defer();return n.putObject(window.appConfig.oss.bucket,window.appConfig.userConfigPath,o.c(JSON.stringify(e))).then(function(e){r.resolve(e)},function(e){r.reject(e)}),r.promise},getAccessKey:function(){let n=t.defer();return e.get("/oss/ak").then(function(e){n.resolve(e)},function(e){n.reject(e)}),n.promise}};return i}]).factory("hardwareService",["remoteService","$q",function(e,t){const n={},o={broadcast:"/hardware/broadcast",register:"/hardware/register",list:"/hardware/list",get:"/hardware/get",remove:"/hardware/remove","app/deploy":"/hardware/app/deploy","app/release":"/hardware/app/release",status:"/hardware/status","storage.list":"/hardware/storage/list","storage.create":"/hardware/storage/create","storage.remove":"/hardware/storage/remove"};return n.post=function(n,r){let i=t.defer();return e.post(o[n],r).then(function(e){i.resolve(e)},function(e){i.reject(e)}),i.promise},window.hardwareService=n,n}]),angular.module("app").factory("getStsToken",["remoteService","$q",function(e,t){let n="",o=!1,r=[];return function(){let i=t.defer();return n&&n.Credentials&&n.Credentials.Expiration&&new Date(n.Credentials.Expiration).getTime()-(new Date).getTime()>18e5?i.resolve({token:n,refresh:!1}):o?r.push(i):(o=!0,e.get("/oss/token").then(function(e){for(n=e,i.resolve({token:e,refresh:!0});r.length;){r.pop().resolve({token:e,refresh:!0})}},function(e){for(i.reject(e);r.length;){r.pop().reject(e)}}).finally(function(){o=!1})),i.promise}}]).factory("logService",["ossService","$q",function(e,t){let n={getLogId:function(e,t,n,o){return _.isEmpty(o)||(t=o+"-"+t),"studio/"+e+"/logs/"+t+"/"+n},getAppLogId:function(e,t,n,o){return _.isEmpty(o)||(t=o+"-"+t),"studio/"+e+"/logs/"+t+"/app.log"},getLog:function(n,o){let r=t.defer();return e.headObject(window.appConfig.oss.bucket,n).then(function(t){let i=t.NextAppendPosition-1;i>o?e.getObject(window.appConfig.oss.bucket,n,o+"-"+i).then(function(e){r.resolve({text:e,nextLogPosition:i})}):i===o?r.resolve():r.resolve("reload")},function(e){r.resolve("reload")}),r.promise}};return n}]).factory("ossService",["$http","$q","$timeout","$rootScope","getStsToken","remoteService",function(e,t,n,o,r,i){let a,s=window.ALY,l=function(e){let t="";return e.code,t="网络错误"},c=function(){let e=t.defer();return r().then(function(t){let n=t.token;!a||t.refresh?(a=new s.OSS({accessKeyId:n.Credentials.AccessKeyId,secretAccessKey:n.Credentials.AccessKeySecret,securityToken:n.Credentials.SecurityToken,endpoint:window.appConfig.oss.endpoint,apiVersion:"2013-10-15"}),e.resolve(a)):e.resolve(a)},function(t){e.reject(t)}),e.promise};const p=function(e,n,o,r,i){let a=t.defer();return c().then(function(t){t.putObject({Bucket:e,Key:n,Body:o,ACL:i,ContentType:r,Expires:0,CacheControl:"no-cache, must-revalidate"},function(e,t){e?a.reject({err:e,msg:l(e)}):a.resolve(t)})},function(e){a.reject(e)}),a.promise};let u=function(e,n,o,r){let a=t.defer();return i.post("/oss/object/get",{Bucket:e,Key:n}).then(function(e){i.getBinary(e.data,r?"arraybuffer":"").then(function(e){r?a.resolve(new Uint8Array(e)):a.resolve(e)},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise},d=function(e,n){let o=t.defer();return i.post("/oss/object/head",{Bucket:e,Key:n}).then(function(e){e.data.NextAppendPosition=e.data.ContentLength,o.resolve(e.data)},function(e){o.reject(e)}),o.promise},f=function(e,n){let o=t.defer();return i.post("/oss/object/delete",{Bucket:e,Key:n}).then(function(e){i.delete(e.data).then(function(e){o.resolve(e)},function(e){o.reject(e)})},function(e){o.reject(e)}),o.promise},h=function(e,n,o,r,a,s=!1){let l=t.defer();return i.post("/oss/object/put",{Bucket:e,Key:n,Expires:0,CacheControl:"no-cache, must-revalidate",ignoreCheck:s}).then(function(e){i.put(e.data,o).then(function(e){l.resolve(e)},function(e){l.reject(e)})},function(e){l.reject(e)}),l.promise},m=function(e,n,o,r,a){let s=t.defer();return i.post("/oss/object/put",{Bucket:window.appConfig.oss.bucket,Key:e}).then(function(e){let t=new XMLHttpRequest;t.onload=function(){200===t.status?a():r(t.statusText)},t.onprogress=function(e){o(e)},t.open("PUT",e.data,!0),t.send(n),s.resolve(e)},function(e){s.reject(e)}),s.promise},g={getOss:c,upload:function(e,n,o,i,a){let s=t.defer();return r().then(function(t){new window.OssUpload({bucket:window.appConfig.oss.bucket,endpoint:window.appConfig.oss.endpoint,chunkSize:1048576,concurrency:3,stsToken:t.token}).upload({file:n,key:e,maxRetry:1,headers:{ServerSideEncryption:""},onprogress:function(e){o(e)},onerror:function(e){i(e)},oncomplete:function(e){a(e)}}),s.resolve("uploaded")},function(e){s.reject(e)}),s.promise},getObject:function(e,n,o,r){let a=t.defer();return i.post("/oss/object/check",{Bucket:e,Key:n,type:"get"}).then(function(t){c().then(function(t){t.getObject({Bucket:e,Key:n,Range:o?"bytes="+o:""},function(e,t){e?a.reject({err:e,msg:l(e)}):r?a.resolve(t.Body):a.resolve(t.Body.toString())})},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise},headObject:function(e,n){let o=t.defer();return i.post("/oss/object/check",{Bucket:e,Key:n,type:"head"}).then(function(t){c().then(function(t){t.headObject({Bucket:e,Key:n},function(e,t){e?o.reject({err:e,msg:l(e)}):o.resolve(t)})},function(e){o.reject(e)})},function(e){o.reject(e)}),o.promise},putObject:function(e,n,o,r,a,s){let l=t.defer();return s?p(e,n,o,r,a).then(function(e){l.resolve(e)},function(){l.reject(err)}):i.post("/oss/object/check",{Bucket:e,Key:n,type:"put"}).then(function(t){p(e,n,o,r,a).then(function(e){l.resolve(e)},function(e){l.reject(e)})},function(e){l.reject(e)}),l.promise},putObjectAcl:function(e,n,o){let r=t.defer();return i.post("/oss/object/check",{Bucket:e,Key:n,type:"put"}).then(function(t){c().then(function(t){t.putObjectAcl({Bucket:e,Key:n,ACL:o},function(e,t){e?r.reject({err:e,msg:l(e)}):r.resolve(t)})},function(e){r.reject(e)})},function(e){r.reject(e)}),r.promise},deleteObject:function(e,n){let o=t.defer();return i.post("/oss/object/check",{Bucket:e,Key:n,type:"get"}).then(function(t){c().then(function(t){t.deleteObject({Bucket:e,Key:n},function(e,t){e?o.reject({err:e,msg:l(e)}):o.resolve(t)})},function(e){o.reject(e)})},function(e){o.reject(e)}),o.promise},getSignedUrl:function(e){let n=t.defer();return i.post("/oss/object/get",{Bucket:window.appConfig.oss.bucket,Key:e}).then(function(e){n.resolve(e.data)},function(e){n.reject(e)}),n.promise}};return"minio"===window.appConfig.ossType&&(g.getObject=u,g.headObject=d,g.deleteObject=f,g.putObject=h,g.upload=m),window.ossService=g,g}]),angular.module("app").factory("pageLoading",function(){const e=angular.element(".page-loading");return{show:function(){e.css({display:"block"}).css({opacity:1})},hide:function(){window.setTimeout(function(){e.css({opacity:0}).on("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){e.css({display:"none"})})},300)}}}).factory("ccc",function(){let e=function(){let e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",o={};function r(e,t){if(!o[e]){o[e]={};for(let t=0;t<e.length;t++)o[e][e.charAt(t)]=t}return o[e][t]}let i={compressToBase64:function(e){if(null==e)return"";let n=i._compress(e,6,function(e){return t.charAt(e)});switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:i._decompress(e.length,32,function(n){return r(t,e.charAt(n))})},compressToUTF16:function(t){return null==t?"":i._compress(t,15,function(t){return e(t+32)})+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:i._decompress(e.length,16384,function(t){return e.charCodeAt(t)-32})},encoder:new TextEncoder,decoder:new TextDecoder,secret:new Uint8Array([8,2,1,2,1,6]),checkVersion:function(e){return 8!==e[e.length-6]?"v1":2!==e[e.length-5]?"v1":1!==e[e.length-4]?"v1":2!==e[e.length-3]?"v1":1!==e[e.length-2]?"v1":6!==e[e.length-1]?"v1":"v2"},compressToUint8Array:function(e,t){switch(t=t||"v1"){case"v1":let n=i.compress(e),o=new Uint8Array(2*n.length);for(let e=0,t=n.length;e<t;e++){let t=n.charCodeAt(e);o[2*e]=t>>>8,o[2*e+1]=t%256}return o;case"v2":let r=i.encoder.encode(e),a=new Uint8Array(r.length+i.secret.length);return a.set(r,0),a.set(i.secret,r.length),a}},decompressFromUint8Array:function(t){switch(i.checkVersion(t)){case"v1":if(null==t)return i.decompress(t);{let n=new Array(t.length/2);for(let e=0,o=n.length;e<o;e++)n[e]=256*t[2*e]+t[2*e+1];let o=[];return n.forEach(function(t){o.push(e(t))}),i.decompress(o.join(""))}case"v2":let n=new Uint8Array(t.buffer,0,t.length-i.secret.length);return i.decoder.decode(n)}},compressToEncodedURIComponent:function(e){return null==e?"":i._compress(e,6,function(e){return n.charAt(e)})},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),i._decompress(e.length,32,function(t){return r(n,e.charAt(t))}))},compress:function(t){return i._compress(t,16,function(t){return e(t)})},_compress:function(e,t,n){if(!e)return"";let o,r,i,a={},s={},l="",c="",p="",u=2,d=3,f=2,h=[],m=0,g=0;for(i=0;i<e.length;i+=1)if(l=e.charAt(i),Object.prototype.hasOwnProperty.call(a,l)||(a[l]=d++,s[l]=!0),c=p+l,Object.prototype.hasOwnProperty.call(a,c))p=c;else{if(Object.prototype.hasOwnProperty.call(s,p)){if(p.charCodeAt(0)<256){for(o=0;o<f;o++)m<<=1,g==t-1?(g=0,h.push(n(m)),m=0):g++;for(r=p.charCodeAt(0),o=0;o<8;o++)m=m<<1|1&r,g==t-1?(g=0,h.push(n(m)),m=0):g++,r>>=1}else{for(r=1,o=0;o<f;o++)m=m<<1|r,g==t-1?(g=0,h.push(n(m)),m=0):g++,r=0;for(r=p.charCodeAt(0),o=0;o<16;o++)m=m<<1|1&r,g==t-1?(g=0,h.push(n(m)),m=0):g++,r>>=1}0==--u&&(u=Math.pow(2,f),f++),delete s[p]}else for(r=a[p],o=0;o<f;o++)m=m<<1|1&r,g==t-1?(g=0,h.push(n(m)),m=0):g++,r>>=1;0==--u&&(u=Math.pow(2,f),f++),a[c]=d++,p=String(l)}if(""!==p){if(Object.prototype.hasOwnProperty.call(s,p)){if(p.charCodeAt(0)<256){for(o=0;o<f;o++)m<<=1,g==t-1?(g=0,h.push(n(m)),m=0):g++;for(r=p.charCodeAt(0),o=0;o<8;o++)m=m<<1|1&r,g==t-1?(g=0,h.push(n(m)),m=0):g++,r>>=1}else{for(r=1,o=0;o<f;o++)m=m<<1|r,g==t-1?(g=0,h.push(n(m)),m=0):g++,r=0;for(r=p.charCodeAt(0),o=0;o<16;o++)m=m<<1|1&r,g==t-1?(g=0,h.push(n(m)),m=0):g++,r>>=1}0==--u&&(u=Math.pow(2,f),f++),delete s[p]}else for(r=a[p],o=0;o<f;o++)m=m<<1|1&r,g==t-1?(g=0,h.push(n(m)),m=0):g++,r>>=1;0==--u&&(u=Math.pow(2,f),f++)}for(r=2,o=0;o<f;o++)m=m<<1|1&r,g==t-1?(g=0,h.push(n(m)),m=0):g++,r>>=1;for(;;){if(m<<=1,g==t-1){h.push(n(m));break}g++}return h.join("")},decompress:function(e){return null==e?"":""==e?null:i._decompress(e.length,32768,function(t){return e.charCodeAt(t)})},_decompress:function(t,n,o){let r,i,a,s,l,c,p,u,d=[],f=4,h=4,m=3,g="",v=[],b={val:o(0),position:n,index:1};for(i=0;i<3;i+=1)d[i]=i;for(s=0,c=Math.pow(2,2),p=1;p!=c;)l=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=o(b.index++)),s|=(l>0?1:0)*p,p<<=1;switch(r=s){case 0:for(s=0,c=Math.pow(2,8),p=1;p!=c;)l=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=o(b.index++)),s|=(l>0?1:0)*p,p<<=1;u=e(s);break;case 1:for(s=0,c=Math.pow(2,16),p=1;p!=c;)l=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=o(b.index++)),s|=(l>0?1:0)*p,p<<=1;u=e(s);break;case 2:return""}for(d[3]=u,a=u,v.push(u);;){if(b.index>t)return"";for(s=0,c=Math.pow(2,m),p=1;p!=c;)l=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=o(b.index++)),s|=(l>0?1:0)*p,p<<=1;switch(u=s){case 0:for(s=0,c=Math.pow(2,8),p=1;p!=c;)l=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=o(b.index++)),s|=(l>0?1:0)*p,p<<=1;d[h++]=e(s),u=h-1,f--;break;case 1:for(s=0,c=Math.pow(2,16),p=1;p!=c;)l=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=o(b.index++)),s|=(l>0?1:0)*p,p<<=1;d[h++]=e(s),u=h-1,f--;break;case 2:return v.join("")}if(0==f&&(f=Math.pow(2,m),m++),d[u])g=d[u];else{if(u!==h)return null;g=a+a.charAt(0)}v.push(g),d[h++]=a+g.charAt(0),a=g,0==--f&&(f=Math.pow(2,m),m++)}}};return i}(),t={};return t.c=e.compressToUint8Array,t.d=e.decompressFromUint8Array,t.c1=e.compressToBase64,t.d1=e.decompressFromBase64,t}).factory("xssList",function(){let e=[];return{filterXSS:function(e){return filterXSS(e)},escape:function(e){return escape(e)},add:function(t){let n=!1;e.map(function(e,o){e.data==t.data&&(n=!0)}),n||e.push(t)},xss:function(){e.map(function(e,t){let n=e.data[e.key];e.data[e.key]=filterXSS(n)}),e=[]}}}).factory("common",function(){let e={now:function(){return(new Date).getTime()},uuid:function(e,t,n){return(n=n||"")+uuidv1().replace(/-/g,"")},arrayContainsArray:function(e,t){return!!(e&&t&&e.length&&t.length)&&(!(e.length<t.length)&&e.filter(function(e){return t.includes(e)}).length===t.length)},getIndexFromPortUuid:function(e){return e.includes("in")?parseInt(e.substr(2),10):parseInt(e.substr(3),10)},getDirList:function(t,n){let o=[];if(!t||!t.length)return o;for(let r=0;r<t.length;r++){let i=t[r];n&&(i.parentId=n),i.selected&&delete i.selected,o.push(i),i.children&&(o=o.concat(e.getDirList(i.children,i.id)))}return o},getDirMap:function(t){let n={},o=e.getDirList(t);for(let e=0;e<o.length;e++)n[o[e].id]=o[e];return n},expandDir:function(e,t){for(;t;){let n=e[t];void 0===n.expanded&&(n.expanded=!0),t=n.parentId}},handleLinkInDesc:function(e){function t(e){let t="";return 0===e.length?t:t=(t+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}let n=e.indexOf("http");if(n>-1){let o=e.slice(n),r=o.indexOf(" "),i=o.indexOf("\n"),a=o.length;r>0?a=r:i>0&&(a=i);let s=o.slice(0,a);e=t(e.slice(0,n))+'<a href="'+s+'" target="_blank" ng-click="$event.stopPropagation()">'+s+"</a>"+t(e.slice(n+a))}else e=t(e);return e},getUploadPath:function(t,n,o){return"studio/"+t+"/component/"+n+"/uploaded_code_"+e.uuid()},getUploadPyLibPath:function(e,t){return"studio/"+e+"/component/"+t+"/uploaded_py_lib.zip"},getUploadNodeDataPath:function(e,t="data"){return"studio/{{userId}}/{{appId}}/{{nodeId}}/"+e+"/"+t+"/"},getUploadDataPath:function(e){return"studio/{{userId}}/share/{{appId}}/uploads/"+e+"/"},getScreenshotKey:function(e,t){return`studio/${e}/${t}/screen_shot.png`},getImportPath:function(e){return`studio/${e}/tmp/import/`},calImageSize:function(e,t){let n=new Image;n.src=e,n.onload=function(){let e=n.naturalWidth,o=n.naturalHeight;t({width:126,height:126*(o/e)})}},isEmpty:function(e){for(let t in e)if(e.hasOwnProperty(t))return!1;return!0},getNaturalSize:function(e){return{width:$(e)[0].naturalWidth,height:$(e)[0].naturalHeight}},changeBackspaceDefault:function(e){let t=e.srcElement||e.target,n=!1;(n=("INPUT"!==t.tagName.toUpperCase()||"TEXT"!==t.type.toUpperCase()&&"PASSWORD"!==t.type.toUpperCase()&&"FILE"!==t.type.toUpperCase()&&"EMAIL"!==t.type.toUpperCase()&&"SEARCH"!==t.type.toUpperCase()&&"DATE"!==t.type.toUpperCase())&&"TEXTAREA"!==t.tagName.toUpperCase()||(t.readOnly||t.disabled))&&e.preventDefault()},detectFormElement:function(e){let t,n=e.srcElement||e.target;return t="INPUT"===n.tagName.toUpperCase()&&("TEXT"===n.type.toUpperCase()||"PASSWORD"===n.type.toUpperCase()||"FILE"===n.type.toUpperCase()||"SEARCH"===n.type.toUpperCase()||"DATE"===n.type.toUpperCase())||"TEXTAREA"===n.tagName.toUpperCase()},getInitedNodeColor:function(e){switch(e){case"default":return"rgba(255,255,255,1)";case"primary":return"rgba(69,112,253,1)";case"info":return"rgba(214,69,250,1)";case"success":return"rgba(253,91,70,1)";case"warning":return"rgba(254,70,144,1)";case"danger":return"rgba(79,86,104,1)";case"orange":return"rgba(243,152,0,1)";case"green":return"rgba(0,153,68,1)";case"blue":return"rgba(0,70,134,1)";case"cyan":return"rgba(19,181,177,1)";case"golden":return"rgba(237,0,27,1)";case"warmgreen":return"rgba(179,212,101,1)";default:return"rgba(255,255,255,1)"}}};return e}).factory("multiselect",function(){let e,t,n,o=[];return{init:function(r,i,a){let s=$(r);e=s,t=i,n=a;s.on("dragstart",{distance:2},function(e,t){return o=[],$('<div class="drag-selection" />').css({position:"fixed",zIndex:1e3}).appendTo(document.body)}).on("drag",function(e,t){$(t.proxy).css({top:Math.min(e.clientY,t.startY),left:Math.min(e.clientX,t.startX),height:Math.abs(e.clientY-t.startY),width:Math.abs(e.clientX-t.startX)})}).on("dragend",function(e,t){$(t.proxy).remove(),"function"==typeof a&&a(o)}),s.find(".element").on("dropstart",function(e,t){$(this).addClass("mock-selected"),o.push(this),"function"==typeof i&&i()}).on("dropend",function(e,t){$(this).removeClass("mock-selected");let n=o.indexOf(this);o.splice(n,1),"function"==typeof i&&i()}).on("drop",function(e,t){$(this).addClass("selected"),o.push(this)}),$.drop({multi:!0})},select:function(e){e&&e.map(function(e){let t=$("#player #"+e.id);t.addClass("selected"),o.push(t[0])})},add:function(n){e.find("#"+n.id).on("dropstart",function(e,n){$(this).addClass("mock-selected"),o.push(this),"function"==typeof t&&t()}).on("dropend",function(e,n){$(this).removeClass("mock-selected");let r=o.indexOf(this);o.splice(r,1),"function"==typeof t&&t()}).on("drop",function(e,t){$(this).addClass("selected"),o.push(this)})},remove:function(t){e.find("#"+t.id).off("drop dropstart dragend")},disable:function(){e.off("drag dragstart dragend"),e.find(".element").off("drop dropstart dropend")},getCurrent:function(){return o},clearCurrent:function(){o=[],e&&e.find(".element").removeClass("selected")}}}).factory("align",function(){function e(e,t){let n=[];for(let o=0;o<e.length;o++)n.push(e[o].css[t]);return Math.min.apply(null,n)}function t(e,t){$("#player #"+e).css(t),$(".app-aside #"+e).css(t)}return{left:function(n){let o=e(n,"left");for(let e=0;e<n.length;e++)n[e].css.left=o,t(n[e].id,{left:o})},top:function(n){let o=e(n,"top");for(let e=0;e<n.length;e++)n[e].css.top=o,t(n[e].id,{top:o})},right:function(e){let n=[];for(let t=0;t<e.length;t++)n.push(parseInt(e[t].css.left)+parseInt(e[t].css.width));let o=Math.max.apply(null,n);for(let n=0;n<e.length;n++)e[n].css.left=o-parseInt(e[n].css.width),t(e[n].id,{left:o-parseInt(e[n].css.width)})},bottom:function(e){let n=[];for(let t=0;t<e.length;t++)n.push(parseInt(e[t].css.top)+parseInt(e[t].css.height));let o=Math.max.apply(null,n);for(let n=0;n<e.length;n++)e[n].css.top=o-parseInt(e[n].css.height),t(e[n].id,{top:o-parseInt(e[n].css.height)})},center:function(n){let o=e(n,"left"),r=[];for(let e=0;e<n.length;e++)r.push(parseInt(n[e].css.left)+parseInt(n[e].css.width));let i=Math.max.apply(null,r)/2+o/2;for(let e=0;e<n.length;e++)n[e].css.left=i-parseInt(n[e].css.width)/2,t(n[e].id,{left:i-parseInt(n[e].css.width)/2})},middle:function(n){let o=e(n,"top"),r=[];for(let e=0;e<n.length;e++)r.push(parseInt(n[e].css.top)+parseInt(n[e].css.height));let i=o/2+Math.max.apply(null,r)/2;for(let e=0;e<n.length;e++)n[e].css.top=i-parseInt(n[e].css.height)/2,t(n[e].id,{top:i-parseInt(n[e].css.height)/2})}}}).factory("multidrag",function(){let e,t,n,o,r,i,a,s;return{enable:function(l,c,p){let u=$(p);function d(e){let t,n=$(e).attr("id");return c.map(function(e){e.id==n&&(t=e)}),t}a=u,u.on("mousedown.multi",function(a){(s=Draggable.create(this,{type:"top,left",zIndexBoost:!1,bounds:".edit_main",onPress:function(){e=[],t=this.x,n=this.y;for(let t=0;t<u.length;t++)if(u[t]!==this.target){let n=d(u[t]),o={element:u[t],preview:$(".app-aside #"+$(u[t]).attr("id")),data:n,x:n.css.left,y:n.css.top};e.push(o)}r=$(this.target),i=$(".app-aside #"+$(this.target).attr("id")),TweenLite.killTweensOf(u)},onDragStart:function(){o=function(e){let t=[];for(let n=0;n<e.length;n++)t.push(e[n].css.top);let n=Math.min.apply(null,t),o=[];for(let t=0;t<e.length;t++)o.push(e[t].css.left);let r=Math.min.apply(null,o);return{top:n,left:r}}(c)},onDrag:function(){u.addClass("user-move");let o={left:this.x,top:this.y};TweenLite.set(i,{css:o}),angular.extend(d(r).css,o),function(){let o,r=this.x-t,i=this.y-n;for(let t=0;t<e.length;t++){let n={top:(o=e[t]).y+i,left:o.x+r};TweenLite.set(o.element,{css:n}),TweenLite.set(o.preview,{css:n}),angular.extend(o.data.css,n)}}.apply(this)},onDragEnd:function(){u.removeClass("user-move"),s[0].kill()}}))[0].startDrag(a)})},disable:function(){a&&a.off("mousedown.multi")}}}).factory("ossImageProcess",function(){return function(e){return e.rotate+"r|"+(t=e.x,n=e.y,o=e.width,r=e.height,t+"-"+n+"-"+o+"-"+r+"a")+"|506h_320w_0e";var t,n,o,r}}).factory("selectionOp",function(){return function(e){try{document.execCommand("MultipleSelection",null,!0)}catch(e){}rangy.init();let t=null,n=rangy.createHighlighter();return n.addClassApplier(rangy.createClassApplier("highlight",{ignoreWhiteSpace:!0,tagNames:["span","a"]})),e.on("focus.rangy",function(){t&&rangy.removeMarkers(t),t=rangy.saveSelection()}).on("blur.rangy",function(){n.highlightSelection("highlight")}),function(){e.off("focus.rangy").off("focus.rangy"),$("input.sp-input").off("focus.current").off("blur.current")}}}).factory("enabledUser",function(){let e=[["s","h","a","n","g","l","u","e"]];e=_.map(e,function(e){return e.join("")});let t=-1==_.indexOf(e,window.appConfig.userId);return window.enabled=t,t}).factory("format",["$stateParams",function(e){return function(t,n){if(n||(n={"{{userId}}":window.appConfig.userId,"{{appId}}":e.id,"{{nodeId}}":e.nodeId,"{{componentId}}":e.componentId}),_.isEmpty(t))return t;let o=t;return _.keys(n).forEach(e=>{o=o.replace(e,n[e])}),o}}]).factory("loopService",["$q","toaster",function(e,t){const n={};let o,r,i;const a=function(n,s,l,c){n&&n.asyncable&&(i=e.defer()),_.has(n,"title")&&(r?r&&(r.toaster.title=n.title,t.reset(r)):r=t.pop({type:"info",title:n.title,timeout:0,tapToDismiss:!1}));const p=function(){o&&(clearTimeout(o),o=null),o=setTimeout(function(){l(s).then(function(e){"completed"===e.job.status?_.get(e.job.returnvalue,"id")&&"export"===n.type?a({type:n.type},e.job.returnvalue.id,l,c):(r&&t.clear(r),clearTimeout(o),o=null,r=null,c&&c(e.job.returnvalue),i&&i.resolve(e.job.returnvalue)):"failed"===e.job.status?(r&&t.clear(r),clearTimeout(o),o=null,r=null,i&&i.reject(e.failedReason)):(r&&(r.toaster.title=n.title+"，已完成 "+e.job.progress+"%",t.reset(r)),p())},function(e){i&&i.reject(e)})},2e3)};if(p(),i)return i.promise};return n.fetchJob=a,n}]).factory("downloadFile",["appDataStoreService","$q",function(e,t){let n={};function o(e,t){if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(e,t);else{let n=document.createElement("a"),o=document.querySelector("body");n.href=window.URL.createObjectURL(e),n.download=t,n.style.display="none",o.appendChild(n),n.click(),o.removeChild(n),window.URL.revokeObjectURL(n.href)}}function r(e,t){n.getBlob(e).then(function(e){o(e,t)},function(e){})}let i={oss:r,minio:r,local:function(e){open("/local/"+e)}};return n.getBlob=function(n,o){let r=t.defer();return e.get(n,!0).then(function(e){return new Blob([e.buffer])}).then(function(e){if(o){let t=new FileReader;t.onloadend=function(){r.resolve(t.result)},t.readAsDataURL(e)}else r.resolve(e)}).catch(function(e){r.reject(e)}),r.promise},n.download=function(e,t){i[appConfig.appDataStoreType](e,t)},n.downloadZip=function(e,r){let i=t.defer(),a=new JSZip,s=e.length,l=0,c=[],p=function(){l<s?u(e[l]):a.generateAsync({type:"blob"}).then(function(e){o(e,r+".zip"),i.resolve({completed:!c.length,failedFile:c})})},u=function(t){l++,n.getBlob(t.id).then(function(e){a.file(t.label,e),p()},function(n){c.push({id:e.id,label:t.label,error:n}),p()})};return u(e[l]),i.promise},n}]),angular.module("app").factory("nodeService",["$q","$rootScope","common","componentService","$state","toaster","$stateParams","appDataStoreService",function(e,t,n,o,r,i,a,s){let l,c,u,d=window.TheGraph.fbpGraph,f={getComponentInfo:function(e){return f[e]}},h=null,m=null,g=null,v=null,b=null,y=null,w=null,x=null,C=null,k=function(e,t,n){h&&h(e,t,n)},S=function(e,t,n){m&&m(e,t,n)},T=function(e,t,n){g&&g(e,t,n)},I=function(e,t,n,o){v&&v(e,t,n,o)},E=function(e){b&&b(e)},N=function(){let e={x:c.properties.x||0,y:c.properties.y||0,readonly:!1,height:l.height(),width:l.width(),graph:c,library:f,showScriptEditIcon:r.includes("app.predict"),onEdgeSelection:T,onClickEdgeCode:I,onNodeSelection:k,onNodeRectImgDblclick:S,onGroupSelection:E,onExpandIconClicked:function(e,t){C&&C(e,t)},onMoved:function(e,t){c.properties.x=e,c.properties.y=t}},t=React.createElement(TheGraph.App,e);u=ReactDOM.render(t,l.get(0))};const O=function(e){const t=[],n=[];for(let o in e)t.push(e[o].metadata.x),n.push(e[o].metadata.y);return{x:{min:_.min(t),max:_.max(t)},y:{min:_.min(n),max:_.max(n)}}};let D={init:function(e,t,n){l=e,t&&"{}"!==t?(t=function(e){let t=JSON.parse(e);try{t=JSON.parse(e)}catch(e){}let n=document.body.offsetWidth,o=document.body.offsetHeight-50,r=t.properties.x,i=t.properties.y;const a=O(t.processes);let s=a.x.min,l=a.y.min,c=a.x.max,p=a.y.max;return(s+r<250&&c+r<250||s+r>n-250&&c+r>n-250)&&(t.properties.x=(n-c+s)/2-s-45-50),(l+i<0&&p+i<0||l+i>o-45&&p+i>o-45)&&(t.properties.y=(o-p+l)/2-l-45),JSON.stringify(t)}(t),d.graph.loadJSON(t,function(e,t){c=t,N(),n()})):(c=new d.Graph,N(),n()),c.on("endTransaction",function(e){y&&y(e)}),window.addEventListener("resize",function(){D.resetCanvas()})},resetCanvas:function(){let e=l.width(),t=l.height();if(l.is(":hidden")){const n=l.parents("#edit");e=n.width(),t=n.height()-64-16-2,n.hasClass("left-hidden")?e-=32:e-=296,n.hasClass("right-hidden")?e-=32:e-=296,e-=2}u.setState({width:e,height:t})},getPosition:function(){return{x:u.state.x,y:u.state.y,scale:u.state.scale}},setPosition:function(e,t,n){u.setState({x:e,y:t,scale:n||1})},addGroup:function(e,t,n){c.addGroup(e,t,n)},getGroups:function(){return c.groups},getGroup:function(e){for(let t=0;t<c.groups.length;t++){let n=c.groups[t];if(n.name===e)return n}return null},getChildGroup:function(e){let t=[],o=D.getGroups(),r=D.getGroup(e);if(!r||!r.nodes)return!1;for(let i=0;i<o.length;i++){let a=o[i];a.name!==e&&(n.arrayContainsArray(r.nodes,a.nodes)&&t.push(a))}return t},getParentGroup:function(e){let t=[],o=D.getGroups(),r=D.getGroup(e);if(!r||!r.nodes)return!1;for(let i=0;i<o.length;i++){let a=o[i];a.name!==e&&(n.arrayContainsArray(a.nodes,r.nodes)&&t.push(a))}return t},whichGroup:function(e){let t=[],n=D.getGroups();if(!n)return t;for(let o=0;o<n.length;o++){let r=n[o];r.nodes&&(r.nodes.includes(e)&&t.push(r))}return t},removeGroup:function(e){c.removeGroup(e)},getPortHasTargetNodePort:function(e,t,n,o){let r=0;for(let i=0;i<e.length;i++){let a=e[i];if(a.ioType===t&&(r++,a.targetNode===n&&a.targetPort===o))return{result:!0,id:a.uuid}}return{result:!1,id:t+(r+1)}},expandGroup:function(e){let t=D.whichGroup(e.id),n=c.toJSON(),o=function(t){for(let n=0;n<e.metadata.def.ports.length;n++){let o=e.metadata.def.ports[n];if(o.uuid===t)return o}},r=_.get(e,"metadata.def.composite"),a=0,s=0;if(e.metadata.initCoord)a=e.metadata.x-e.metadata.initCoord.x,s=e.metadata.y-e.metadata.initCoord.y;else if(r){const t=O(r.processes);let n=t.x.min+(t.x.max-t.x.min)/2,o=t.y.min+(t.y.max-t.y.min)/2;a=e.metadata.x-n,s=e.metadata.y-o}let l=[];Object.keys(r.processes).forEach(function(e){l.push(e);const n=r.processes[e].metadata;n.x+=a,n.y+=s,D.addNode(e,r.processes[e].component,n),t.forEach(function(t){t.nodes.push(e)})}),n.connections.forEach(function(t){if(t.src.process===e.id){let e=o(t.src.port);e&&e.display?c.addEdge(e.targetNode,e.targetPort,t.tgt.process,t.tgt.port):(c.removeEdge(t.src.process,t.src.port,t.tgt.process,t.tgt.port),i.pop("info","运行项目更新，连线删除"))}else if(t.tgt.process===e.id){let e=o(t.tgt.port);e&&e.display?c.addEdge(t.src.process,t.src.port,e.targetNode,e.targetPort):(c.removeEdge(t.src.process,t.src.port,t.tgt.process,t.tgt.port),i.pop("info","运行项目更新，连线删除"))}}),r.connections.forEach(function(e){c.addEdge(e.src.process,e.src.port,e.tgt.process,e.tgt.port)}),-1==_.findIndex(c.groups,{name:e.id})?D.addGroup(e.id,l,{name:e.metadata.label,component:e.component,data:e.metadata}):c.setGroupMetadata(e.id,{name:e.metadata.label,component:e.component,data:e.metadata}),e.id,c.removeNode(e.id)},collectCompositePorts:function(e,t){const n=Object.keys(e.processes);_.remove(t,function(e){return-1==_.indexOf(n,e.targetNode)});let o=_.map(_.filter(t,{ioType:"in"}),function(e){return parseInt(e.uuid.slice(2))}),r=_.map(_.filter(t,{ioType:"out"}),function(e){return parseInt(e.uuid.slice(3))}),i=_.isEmpty(o)?1:_.max(o)+1,a=_.isEmpty(r)?1:_.max(r)+1,s={};e.connections.forEach(function(e){s[e.src.process+"-"+e.src.port]=1,s[e.tgt.process+"-"+e.tgt.port]=1}),n.forEach(function(n){e.processes[n].metadata.def.ports.forEach(function(e){const o=_.findIndex(t,function(t){return t.targetNode==n&&t.targetPort==e.uuid});var r;if(e.display){if(!s[n+"-"+e.uuid])return o>-1?(t[o].type=e.type,t[o].display=e.display,void(t[o].description=e.description)):void t.push({description:e.description,display:1,ioType:e.ioType,targetNode:n,targetPort:e.uuid,type:e.type,uuid:(r=e.ioType,"in"===r?"in"+i++:"out"+a++)});o>-1&&t.splice(o,1)}else o>-1&&(t[o].display=e.display)})})},collectGroupInport:function(e,t){for(let n=0;n<e.length;n++){let o=e[n],r=D.getPort(o.tgt.process,o.tgt.port);if(!r)continue;let i=D.getPortHasTargetNodePort(t,"in",o.tgt.process,o.tgt.port);i.result||t.push({description:angular.copy(r.description),display:1,ioType:"in",targetNode:o.tgt.process,targetPort:o.tgt.port,type:r.type,uuid:i.id})}t.length||t.push({description:"",display:0,ioType:"in",uuid:"in1"})},collectGroupOutport:function(e,t){for(let n=0;n<e.length;n++){let o=e[n],r=D.getPort(o.src.process,o.src.port);if(!r)continue;let i=D.getPortHasTargetNodePort(t,"out",o.src.process,o.src.port);i.result||t.push({description:angular.copy(r.description),display:1,ioType:"out",targetNode:o.src.process,targetPort:o.src.port,type:r.type,uuid:i.id})}},findGroupMinMax:function(e){return window.TheGraph.findMinMax(c,e)},getGroupNodeUiControl:function(e,t){let n;if(t.metadata.ui.tabs.fields&&t.metadata.ui.tabs.fields.controls){n=t.metadata.ui.tabs.fields.controls;for(let t=0;t<n.length;t++){let o=n[t];if(o.uuid===e.controlId)return o}}if(t.metadata.ui.tabs.params&&t.metadata.ui.tabs.params.controls){n=t.metadata.ui.tabs.params.controls;for(let t=0;t<n.length;t++){let o=n[t];if(o.uuid===e.controlId)return o}}if(t.metadata.ui.tabs.tune&&t.metadata.ui.tabs.tune.controls){n=t.metadata.ui.tabs.tune.controls;for(let t=0;t<n.length;t++){let o=n[t];if(o.uuid===e.controlId)return o}}return null},genGroupTabInfo:function(e){let t=[];if(!e)return t;for(let n=0;n<e.length;n++){let o=e[n],r=D.getNode(o.nodeId),i=D.getGroupNodeUiControl(o,r);i&&t.push(i)}return t},genCompositeTabInfo:function(e,t,n,o){let r=[];if(!e)return r;for(let i=0;i<e.length;i++){let a=e[i];if("global"===a.type)n&&n.forEach(function(e){e.id===a.id&&r.push({type:"global",uuid:e.id})});else{let e=t[a.nodeId],n=D.getGroupNodeUiControl(a,e);n&&(p.nodeId=a.nodeId,p.appId=o,r.push(n))}}return r},getInitedMetadata:function(){return{def:{description:{zh_CN:""},type:999,params:{},ports:[]},ui:{tabs:{params:{tabName:{en_US:"Parameters Setting",zh_CN:"参数设置",zh:"参数设置"},controls:[]}}},locale:"zh_CN"}},foldGroup:function(e){let t=D.getParentGroup(e),n=D.getGroup(e);if(!n)return;let o=_.isEmpty(n.metadata.data)?D.getInitedMetadata():Object.assign({},_.get(n,"metadata.data"));if(o.label=n.metadata.name,n&&!_.isEmpty(n.nodes)){const e=D.findGroupMinMax(n.nodes);if(e){const t=(e.minX+e.maxX)/2-45,n=(e.minY+e.maxY)/2-45;o.x=t,o.y=n,o.initCoord={x:t,y:n}}}_.has(n,"metadata.def")&&Object.assign(o.def,n.metadata.def);let r=c.toJSON(),i=D.getGroupConnections(r,n);D.collectGroupInport(i.inConnections,o.def.ports),D.collectGroupOutport(i.outConnections,o.def.ports),D.genParamsFromPorts(o.def.ports,o.def.params),"composite"==n.metadata.component&&_.isEmpty(o.def.composite)&&(o.def.composite=JSON.parse('{"caseSensitive":false,"properties":{},"inports":{},"outports":{},"groups":[],"processes":{},"connections":[]}'),o.def.composite.connections=angular.copy(i.innerConnections),Object.keys(r.processes).forEach(function(e){n.nodes.includes(e)&&(o.def.composite.processes[e]=r.processes[e])})),c.removeGroup(e),n.nodes,n.nodes.forEach(function(e){c.removeNode(e)}),-1==_.findIndex(c.nodes,{id:e})?c.addNode(e,n.metadata.component,o):c.setNodeMetadata(e,o);for(let t=0;t<i.inConnections.length;t++){let n=i.inConnections[t],r=D.getPortHasTargetNodePort(o.def.ports,"in",n.tgt.process,n.tgt.port);c.addEdge(n.src.process,n.src.port,e,r.id)}for(let t=0;t<i.outConnections.length;t++){let n=i.outConnections[t],r=D.getPortHasTargetNodePort(o.def.ports,"out",n.src.process,n.src.port);c.addEdge(e,r.id,n.tgt.process,n.tgt.port)}t.forEach(function(t){t.nodes.push(e)})},getPort:function(e,t){let n=D.getNode(e);if(!n)return null;let o=n.metadata.def.ports;for(let e=0;e<o.length;e++){let n=o[e];if(n.uuid===t)return n}return null},genParamsFromPorts:function(e,t){for(let n=0;n<e.length;n++){let o=e[n];if(o.display&&o.type){let e=D.getNode(o.targetNode);if(e){let r=e.metadata.def.params;for(let e in r){let i=r[e];"in"===o.ioType?i.defInPortUuid===o.targetPort&&(t[e+n]=angular.copy(i),t[e+n].defInPortUuid=o.uuid):i.defOutPortUuid===o.targetPort&&(t[e+n]=angular.copy(i),t[e+n].defOutPortUuid=o.uuid)}}}}},getGroupConnections:function(e,t){let n=[],o=[],r=[],i=[];return Object.keys(e.connections).forEach(function(a){let s=e.connections[a];t.nodes.includes(s.tgt.process)?t.nodes.includes(s.src.process)?r.push(s):n.push(s):t.nodes.includes(s.src.process)?o.push(s):i.push(s)}),angular.copy({inConnections:n,outConnections:o,innerConnections:r,outerConnections:i})},getNode:function(e){return c?c.getNode(e):null},showAllScreenshots:function(){},updateScreenshot:function(e){},getEdge:function(e,t,n,o){return c.getEdge(e,t,n,o)},getNodeScriptEdges:function(e){return _.filter(c.edges,function(t){return(t.from.node==e||t.to.node==e)&&_.has(t,"metadata.script")})},setEdgeMetadata:function(e,t,n,o,r){return c.setEdgeMetadata(e,t,n,o,r)},getPredictConfig:function(){return angular.copy(c.properties.predictConfig)},getCronConfig:function(){return angular.copy(c.properties.cronConfig)},setCronConfig:function(e){c.properties.cronConfig=angular.copy(e)},getDashboardConfig:function(){return angular.copy(c.properties.dashboardConfig)},setDashboardConfig:function(e){c.properties.dashboardConfig=angular.copy(e)},setEdgeScript:function(e,t,n,o){return c.appScripts||(c.appScripts={}),_.set(c,`appScripts.${e}.${t}.${n}`,o),c},setGlobalScript:function(e){return c.appScripts||(c.appScripts={}),c.appScripts.global=e,c},getGraph:function(){return c},getParamsModel:function(e){let t={port:{},control:{}},n=function(e,n){if(!n.controlInstUuid||"undefined"===n.controlInstUuid)return;const o=_.cloneDeep(n);_.unset(o,"controlInstUuid");let r=t.control[n.controlInstUuid]={meta:o};r.value=e,n.defInPortUuid&&(r.inport=n.defInPortUuid),n.defOutPortUuid&&(r.outport=n.defOutPortUuid,r.outportProperty=n.propertyName);for(let e in n)switch(e){case"type":case"defInPortUuid":case"defOutPortUuid":case"controlInstUuid":case"propertyName":break;default:r.meta[e]=n[e]}},o=function(e,n){t.port[n.defInPortUuid]||(t.port[n.defInPortUuid]={});let o=t.port[n.defInPortUuid];"tableName"===n.propertyName&&(o.table=e),"partitionName"===n.propertyName&&(o.partition=e),"modelName"===n.propertyName&&(o.model=e),"dataName"===n.propertyName&&(o.data=e),"visualName"===n.propertyName&&(o.visual=e)},r=function(e,o){t.port[o.defOutPortUuid]||(t.port[o.defOutPortUuid]={});let r=t.port[o.defOutPortUuid];"tableName"===o.propertyName&&(r.table=e),"partitionName"===o.propertyName&&(r.partition=e),"modelName"===o.propertyName&&(r.model=e),"dataName"===o.propertyName&&(r.data=e),"visualName"===o.propertyName&&(r.visual=e),o.defOutPortUuid&&n("",o)};for(let t in e)e[t].defOutPortUuid?r(t,e[t]):e[t].controlInstUuid?n(t,e[t]):e[t].defInPortUuid&&o(t,e[t]);return t},getCustomizeNodeMetadata:function(e,t){let n={},o=function(e){switch(e){case"table":return"tableName";case"partition":return"partitionName";case"model":return"modelName";case"visual":return"visualName";case"data":return"dataName"}};for(let e in t.port){let r=t.port[e];for(let t in r)r[t]&&(0===e.indexOf("in")?n[r[t]]={type:"string",propertyName:o(t),defInPortUuid:e}:n[r[t]]={type:"string",propertyName:o(t),defOutPortUuid:e})}for(let e in t.control)if(t.control[e].value){n[t.control[e].value]={type:"string",controlInstUuid:e};for(let o in t.control[e].meta)n[t.control[e].value][o]=t.control[e].meta[o];t.control[e].inport&&(n[t.control[e].value].defInPortUuid=t.control[e].inport)}else if(t.control[e].outport)for(let o in n)if(n[o].defOutPortUuid===t.control[e].outport&&n[o].propertyName===t.control[e].outportProperty){n[o].controlInstUuid=e;for(let r in t.control[e].meta)n[o][r]=t.control[e].meta[r]}let r=angular.copy(D.getNode(e)).metadata;return delete r.x,delete r.y,delete r.width,delete r.height,delete r.label,r.def.params=n,r},addNode:function(e,t,n){let o=c.addNode(e,t,n);return D.analyzeGraph(),o},addPublicRemoteNode:function(e,t,r,a){o.getPublic(e).then(function(o){let i=JSON.parse(o.componentInfo.data),s=l.offset(),c=l.find(".view").attr("transform"),p=_.toNumber(_.split(_.split(c,",")[0],"(")[1]);r=r||0,t=((t=t||0)-s.left-45*p-u.state.x)/p,r=(r-s.top-45*p-u.state.y)/p,i.label=o.componentInfo.name,i.x=t,i.y=r,i.type=a;const d=n.uuid();return 10002==i.def.type&&(i.apiName=d),D.addNode(d,e,i),d},function(e){_.isError(e.err)?i.pop("error","组件加载失败: "+e.err.message):i.pop("error","组件加载失败: "+e.msg)})},addRemoteNode:function(e,t,r,a){o.get(e).then(function(o){let i=JSON.parse(o.componentInfo.data),s=l.offset(),c=l.find(".view").attr("transform"),p=_.toNumber(_.split(_.split(c,",")[0],"(")[1]);r=r||0,t=((t=t||0)-s.left-45*p-u.state.x)/p,r=(r-s.top-45*p-u.state.y)/p,i.label=o.componentInfo.name,i.x=t,i.y=r,i.type=a;let d=n.uuid();return D.addNode(d,e,i),d},function(e){_.isError(e.err)?i.pop("error","组件加载失败: "+e.err.message):i.pop("error","组件加载失败: "+e.msg)})},addRemoteDashboardNode:function(e){o.get(e).then(function(e){let t=JSON.parse(e.componentInfo.data).def.dashboardComponentType;w(t)},function(e){_.isError(e.err)?i.pop("error","组件加载失败: "+e.err.message):i.pop("error","组件加载失败: "+e.msg)})},addDashboardNode:function(e){if(!e.x||!e.y){const t=u.state.scale,n=Math.floor(9*Math.random()),o=Math.floor(6*Math.random()),r=(90*n+30-u.state.x)/t,i=(90*o+30-u.state.y)/t;e.x=r,e.y=i}let t=n.uuid();return D.addNode(t,"dashboard",e),t},addExternalNode:function(e,t,r,a){t=t||0,r=r||0;const s=e.componentId,c=e.label,p=l.offset(),d=l.find(".view").attr("transform"),f=_.toNumber(_.split(_.split(d,",")[0],"(")[1]);t=(t-p.left-45*f-u.state.x)/f,r=(r-p.top-45*f-u.state.y)/f;const h=n.uuid();let m=o.getPublic;"device_component"===a&&(m=o.get),m(s).then(function(n){let o=JSON.parse(n.componentInfo.data),i=n.componentInfo.id;if(o.label=c,o.x=t,o.y=r,o.type=a,o.tags=n.componentInfo.tags,"device_component"===a){o.def.params.param2.value=e.deviceId,o.def.dashboardComponentType="xly-iframe";const t=o.def.dashboardComponentType;w(t,{propName:e.label,url:e.mxgraphUrl})}return D.addNode(h,i,o),h},function(e){_.isError(e.err)?i.pop("error","组件加载失败: "+e.err.message):i.pop("error","组件加载失败: "+e.msg)})},addWebCompNode:function(e,t,o,r,i){let a;"__web_input"===e&&(a={uuid:r,apiName:"",icon:"globe",def:{description:{zh_CN:"web input "+i},type:"web-input",theme:"green",docUrl:"",author:"aliyun",params:{__script:{type:"string",value:"",isRequired:!0}},ports:[{uuid:"out1",description:{en_US:"input data",zh_CN:"web input 数据"},display:1,ioType:"out",type:"data"}]},locale:"zh_CN"}),"__web_output"===e&&(a={uuid:r,icon:"globe",def:{icon:"globe",description:{zh_CN:"web output "+i},type:"web-output",theme:"green",docUrl:"",author:"aliyun",params:{},ports:[{uuid:"in1",description:{en_US:"output data",zh_CN:"web output 数据"},display:1,ioType:"in",type:"data"}]},locale:"zh_CN"});let s=l.offset(),c=l.find(".view").attr("transform"),p=_.toNumber(_.split(_.split(c,",")[0],"(")[1]);o=o||0,t=((t=t||0)-s.left-45*p-u.state.x)/p,o=(o-s.top-45*p-u.state.y)/p,a.label=a.def.description.zh_CN,a.x=t,a.y=o;let d=n.uuid();return D.addNode(d,e,a),d},addCustomNode:function(e,t,o){"string"==typeof t&&(t=JSON.parse(t));let r=angular.copy(t);r.label=e,r.x=u.state.width/2-100,r.y=200,r.type=o;let i=n.uuid();return D.addNode(i,"custom",r),i},pasteNode:function(e,t){let o=angular.copy(e),r=(l.offset(),o.x+20),i=o.y+20;o.x=r,o.y=i;let a=n.uuid();return D.addNode(a,t,o)},removeNode:function(e,t){if(!t){const t=D.getNode(e),n=_.get(t,"metadata.def.dashboardId");n&&x&&x(n)}c.removeNode(e)},removeEdge:function(e,t,n,o){c.removeEdge(e,t,n,o)},getGraphJson:function(){return angular.copy(c.toJSON())},hightEdges:function(e){let t=document.querySelector(".edges"),n=document.querySelector(".edges").childNodes,o=[];for(let t=0;t<n.length;t++)n[t].attributes&&($(n[t]).removeClass("active"),n[t].getAttribute("id")&&n[t].getAttribute("id").indexOf(e)>-1&&($(n[t]).addClass("active"),o.push(n[t])));for(let e=0;e<o.length;e++)t.appendChild(o[e]);return n},getDashboardNode:function(e){for(let t=0;t<c.nodes.length;t++)if(_.get(c.nodes[t],"metadata.def.dashboardId")===e)return c.nodes[t]},analyzeGraph:function(e){let t={},n={},o={};c.nodes.forEach(function(e){_.get(e,"metadata.def.ports").forEach(function(r){if(!r.display||!r.type||!r.subType)return;let i=r.type+":"+r.subType;t[e.id+":"+r.uuid]=i,"out"===r.ioType?(n[i]||(n[i]=[]),n[i].push({nodeId:e.id,port:r.uuid})):r.autoReceive&&(o[e.id+":"+r.uuid]={nodeId:e.id,port:r.uuid,type:i})})}),c.edges.forEach(function(e){e.metadata&&e.metadata.auto?(t[e.from.node+":"+e.from.port]!==t[e.to.node+":"+e.to.port]&&c.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port),o[e.to.node+":"+e.to.port]||c.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port)):o[e.to.node+":"+e.to.port]&&c.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port)});for(let e in o){let t=o[e],r=n[t.type];r&&r.forEach(function(e){e.nodeId!==t.nodeId&&c.addEdge(e.nodeId,e.port,t.nodeId,t.port,{auto:1})})}D.changeNode()},addEdge:function(e){let t=c.nodes,n=t.length;if(n<1)return;let o=e||t[Math.floor(Math.random()*n)].id,r=t[Math.floor(Math.random()*n)].id,i="out"+Math.floor(3*Math.random()),a="in"+Math.floor(12*Math.random()),s={route:Math.floor(10*Math.random())};return c.addEdge(o,i,r,a,s)},updateEdges:function(e,t,n,o){const r={in:"to",out:"from"};for(let i=0;i<c.edges.length;i++){const a=c.edges[i][r[e]];if(a.node==t&&a.port==e+n){a.port=o;break}}},getNodeOriginalPosision:function(e,t){let n=l.offset(),o=l.find(".view").attr("transform"),r=_.toNumber(_.split(_.split(o,",")[0],"(")[1]);return t=t||0,{x:e=(e=e||0)*r+u.state.x+45*r+n.left,y:t=t*r+u.state.y+45*r+n.left}},getTheGraphInstance:function(){return u},setNodeSelectionHandler:function(e){h=e},setNodeRectImgDblclickHandler:function(e){m=e},setEdgeSelectionHandler:function(e){g=e},setEdgeIconClickHandler:function(e){v=e},setGroupSelectionHandler:function(e){b=e},setGraphChangeHandler:function(e){y=e},setGraphAddNodeHandler:function(e){w=e},setGraphDeleteNodeHandler:function(e){x=e},setExpandIconClickedHandler:function(e){C=e},getComponentInfo:function(e){return f.getComponentInfo(e)},changeNode:function(e){c.setNodeMetadata(e,{})},changeGraph:function(e){c.setGroupMetadata(e,{})},getRunJson:function(){let e=D.getGraphJson();for(let t in e.processes){let n=e.processes[t];n.metadata={codeName:n.metadata.def.codeName,type:n.metadata.def.type,baseRunner:n.metadata.def.baseRunner,codePath:n.metadata.def.codePath,pyLibPath:n.metadata.def.pyLibPath,params:n.metadata.def.params,ports:n.metadata.def.ports,author:n.metadata.def.author}}return e},getIgnoredNodes:function(e){let t={};for(let n=0;n<e.length;n++)t[e[n]]=!0;let n=[];for(let e=0;e<c.nodes.length;e++)t[c.nodes[e].id]||n.push(c.nodes[e].id);return n},getAllUpstreamNodes:function(e){let t=D.getUpstreamNodes(e);for(let e=0;e<t.length;e++)t=t.concat(D.getAllUpstreamNodes(t[e]));let n=[];for(let e=0;e<t.length;e++)n.indexOf(t[e])<0&&n.push(t[e]);return n},getUpstreamNodes:function(e){let t=[];if(!c||!c.edges)return t;for(let n=0;n<c.edges.length;n++){let o=c.edges[n];o.to.node===e&&t.push(o.from.node)}return t},getUpstreamNodeByPort:function(e,t){return c&&c.edges?_.map(_.filter(c.edges,{to:{port:t,node:e}}),"from")[0]:null},getDownstreamNodeByPort:function(e,t){return c&&c.edges?_.map(_.filter(c.edges,{from:{port:t,node:e}}),"to"):null},getDownstreamNodes:function(e){let t=[];if(!c||!c.edges)return t;for(let n=0;n<c.edges.length;n++){let o=c.edges[n];o.from.node===e&&t.push(o.to.node)}return t},getAllDownstreamNodes:function(e){let t=D.getDownstreamNodes(e);for(let e=0;e<t.length;e++)t=t.concat(D.getAllDownstreamNodes(t[e]));let n=[];for(let e=0;e<t.length;e++)n.indexOf(t[e])<0&&n.push(t[e]);return n},load:function(t){let n=e.defer();return c.loadJSON(t,function(){n.resolve(res)}),n.promise},getNodeOutputTypeArr:function(e){let t=[];if(!e)return t;let o=D.getNode(e);if(!o)return t;let r=_.filter(o.metadata.def.ports,function(e){return"out"===e.ioType&&e.display});for(let e in o.metadata.def.params){let i=o.metadata.def.params[e],a=_.findIndex(t,{portId:i.defOutPortUuid}),s=-1==_.findIndex(r,{uuid:i.defOutPortUuid});if(a>-1||!i.propertyName||"partitionName"===i.propertyName||s)continue;let l={},c="";for(let e=0;e<o.metadata.def.ports.length;e++)if(o.metadata.def.ports[e].uuid==i.defOutPortUuid){l=o.metadata.def.ports[e];const t=o.metadata.def.ports[e].type;"model"!=t&&"data"!=t||"/"!=(c=_.get(i,"value")||n.getUploadNodeDataPath(l.uuid,t)).slice(-1)&&(c+="/")}let p={portId:i.defOutPortUuid,propertyName:i.propertyName,label:_.get(l,"description.zh_CN","")};c&&(p.path=c),_.isEmpty(l.subType)||(p.subType=l.subType),t.push(p)}return t},onValidated:function(e){if(_.isEmpty(c.nodes))return{status:"error",message:"项目中没有节点"};const t=_.filter(c.nodes,function(t){if(e&&t.id!==e)return!1;const n=_.filter(_.values(_.get(t,"metadata.def.params")),function(e){return(e.required||e.isRequired)&&_.isUndefined(e.value)});return!_.isEmpty(n)}),n=_.map(t,function(e){return e.metadata.label});if(!_.isEmpty(t))return{status:"error",message:n.join("、")+" 中的必填参数不能为空！"};if(!e&&_.findIndex(c.edges,"metadata.error")>-1)return{status:"error",message:"请检查项目中的连线！"};const o=_.filter(c.groups,function(e){return"composite"!==e.metadata.component});if(!e&&!_.isEmpty(o)){return{status:"error",message:"请将项目中的复合组件 “"+_.map(o,"metadata.name").join("”、“")+"” 折叠！"}}}};return D}]),angular.module("app").directive("scriptLog",["appDataStoreService",function(e){return{restrict:"EA",link:function(t,n,o){n.on("click","a[data-preview]",function(t){const n=t.target,o=n.getAttribute("data-preview"),r=n.getAttribute("data-subtype"),i=n.parentNode.querySelector(".data-container");switch(r){case"file":e.get(o).then(e=>{i.innerHTML=`文件内容：<br /><pre style="color: #fff; background-color: #272822;">${e}</pre>`});break;default:i.innerHTML=`<pre style="color: #fff; background-color: #272822;">${o}</pre>`}}),t.$watch(function(e){return e.$eval(o.scriptLog)},function(e){n.html(e)})}}}]).factory("scriptService",["$rootScope","appService","nodeService","$state","$stateParams","toaster",function(e,t,n,o,r,i){return{DIRECTION:{IN:"in",OUT:"out"},APP_GLOBAL_SCRIPT_NODEID:"app",APP_GLOBAL_SCRIPT_PORTID:"global",APP_GLOBAL_SCRIPT_KEYWORD:"content",MAX_LOG_LIMIT:100,sockets:{},logs:{},connect:function(e){const t=this,n=window.io(`${location.protocol}//${window.appConfig.predictHost}/appScripts`,{path:`/socket/${e}`});return n.on("connect",function(){n.id,t.logs[e]=[]}),n.on("disconnect",function(){n.id}),n.on("scriptParseError",function({err:n}){t.logs[e].push({type:"error",appId:e,err:n.message,timestamp:moment().format("YYYY-MM-DD hh:mm:ss")})}),n.on("scriptProcessed",function({node:n,port:o,when:r,before:i,after:a}){t.logs[e].push({type:"port",node:n,port:o,direction:"postOut"===r?t.DIRECTION.OUT:t.DIRECTION.IN,timestamp:moment().format("YYYY-MM-DD hh:mm:ss"),before:i,after:a})}),n.on("scriptRuntimeError",function({node:n,port:o,when:r,err:i}){t.logs[e].push({type:"error",node:n,port:o,direction:"postOut"===r?t.DIRECTION.OUT:t.DIRECTION.IN,timestamp:moment().format("YYYY-MM-DD hh:mm:ss"),err:i})}),n.on("globalLogging",function({userId:e,appId:n,content:o}){t.logs[n].push({type:"app",appId:n,userId:e,msg:`${o}\n\n`,timestamp:moment().format("YYYY-MM-DD hh:mm:ss")})}),n.on("scriptLogging",function({node:n,port:o,when:r,content:i}){t.logs[e].push({type:"app",node:n,port:o,direction:"postOut"===r?t.DIRECTION.OUT:t.DIRECTION.IN,msg:`${i}\n\n`,timestamp:moment().format("YYYY-MM-DD hh:mm:ss")})}),this.sockets[e]=n,n},disconnect:function(e){this.sockets[e]&&(this.sockets[e].disconnect(),delete this.sockets[e])},getAppLogs:function(e,t=(e=>e)){const o=[];return this.logs[e]||(this.logs[e]=[]),this.logs[e].sort((e,t)=>moment(e.timestamp).isAfter(moment(t.timestamp))).filter(t).forEach(({type:e,before:t,after:r,timestamp:i,err:a,msg:s,node:l,port:c})=>{switch(e){case"port":const p=n.getPort(l,c);o.push(`<div>${i} 输入 <a data-preview="${t}" data-subtype="${p.subType}" href="javascript:void(0)">${t}</a><div class="data-container"></div></div>`),o.push(`<div>${i} 输出 <a data-preview="${r}" data-subtype="${p.subType}" href="javascript:void(0)">${r}</a><div class="data-container"></div></div>`);break;case"error":o.push(`<div>${i} ${a}</div>`);break;case"app":o.push(`<div>${i} ${s}</div>`);break;default:return}}),o.slice(-this.MAX_LOG_LIMIT).join("")},getGlobalLogs:function(e){return this.getAppLogs(e,e=>"app"===e.type||"error"===e.type)},getLogsByEdge:function(e,{from:t,to:n}){return this.getAppLogs(e,({type:e,node:o,port:r})=>"error"===e||"port"===e&&(t.node===o&&t.port===r||n.node===o&&n.port===r))},getLogsByPort:function(e,t,n){return this.getAppLogs(e,({type:e,node:o,port:r})=>"error"===e||"port"===e&&t===o&&n===r)},getPortLogs:function(e){return this.getAppLogs(e,e=>"port"===e.type)},getErrorLogs:function(e){return this.getAppLogs(e,e=>"error"===e.type)},cleanOldScripts:function(e){delete e.properties.appScripts,delete e.properties.appScriptString,e.edges.forEach(function(e){delete e.metadata.script})},doSaveScript:function(n,o){const r=this.packScripts(o);_.set(o,"properties.packedScripts",r),this.cleanOldScripts(o),t.saveScripts(n,o).then(function(){i.pop("success","脚本数据保存成功"),setTimeout(function(){e.sockets&&e.sockets[n]&&e.sockets[n].emit("scriptsChanged",o.properties.packedScripts)},2e3)},function(e){i.pop("error","脚本数据保存失败："+e.msg)})},getOldEdgeScripts:function(e){if(!e)return"";if(e.content)return e.content;const{afterLeave:t,beforeEnter:n}=e;return`${t}\n${n}`},getFunctionBlock:function(e){switch(e){case"afterLeave":case"beforeEnter":return`\n${e}((data, $) => {});\n`;case"initializer":return`\n${e}(($) => {});\n`;case"onSystemMessage":return`\n${e}((data) => {});\n`;default:return"() => {};\n"}},getKeyword:function(e=""){return{in:"beforeEnter",out:"afterLeave",beforeEnter:"beforeEnter",afterLeave:"afterLeave",content:"content"}[e]||""},getAppGlobalScriptKey:function(){return`${this.APP_GLOBAL_SCRIPT_NODEID}.${this.APP_GLOBAL_SCRIPT_PORTID}.${this.APP_GLOBAL_SCRIPT_KEYWORD}`},getSupportedFunctions:function(){return["afterLeave","beforeEnter","onSystemMessage","initializer"]},getScriptKey:function(e,t,n){return`properties.scripts.${e}.${t}.${this.getKeyword(n)}`},getScriptsByNode:function(e,t){const o=n.getGraph();return _.get(o,`properties.scripts.${e.node}.${e.port}.${this.getKeyword(t)}`,"")},idNodeDeletable:function(e){const t=_.get(n.getGraph(),`properties.scripts.${e}`,{});return _.isEmpty(t)},isEdgeDeletable:function(e){const{from:t,to:o}=e,r=n.getGraph(),i=_.get(r,`properties.scripts.${t.node}.${t.port}`,{}),a=_.get(r,`properties.scripts.${o.node}.${o.port}`,{});return!_.isEmpty(i)||!_.isEmpty(a)},packBlock:function(e){return"\n(function() {\n"+e+"\n})();\n"},packFunction:function(e,t,n,o){o=o||"";const r=new RegExp(`${e}\\(`,"g");return o.replace(r,`${e}('${t}', '${n}', `)},packScripts:function(e){const t=this;let o="";const r=_.get(e,"properties.scripts",{}),i=this.getAppGlobalScriptKey();Object.keys(r).forEach(function(e){Object.keys(r[e]).forEach(function(a){Object.keys(r[e][a]).forEach(function(s){if(`${e}.${a}.${s}`===i)return;const l=n.getNode(e),c=`// <${_.get(l,"metadata.label","")}> - <${a}> - <${s}>\n`;o+=t.packBlock(`${c}${t.packFunction(s,e,a,r[e][a][s])}`)})})});const a=`// 全局脚本\n${_.get(r,i,"")}\n`;return o=this.packBlock(`${a}${o}`)},removeScriptByEdge:function(e){const{from:t,to:o}=e,r=n.getGraph();_.get(r,`properties.scripts.${t.node}.${t.port}`,null)&&delete r.properties.scripts[t.node][t.port],_.get(r,`properties.scripts.${o.node}.${o.port}`,null)&&delete r.properties.scripts[o.node][o.port]},removeScriptByNode:function(e){const t=this,o=n.getGraph();delete _.get(o,"properties.scripts",{})[e];const r=_.filter(o.edges,function(t){return t.from.node===e||t.to.node===e});r&&r.forEach(function(e){t.removeScriptByEdge(e)})},setScript:function(e,t,o,r){return _.set(n.getGraph(),this.getScriptKey(e,t,o),r)},saveEdgeScripts:function(e,t,o){const r=n.getGraph();_.set(r,this.getScriptKey(e.node,e.port,t),o),this.saveAppScripts()},saveAppScripts:function(){const e=this,a=r.id,s=n.getGraph();o.includes("app.predict.edit")?e.doSaveScript(a,s):t.setPermission(a).then(function(t){e.doSaveScript(a,s)},function(e){i.pop("error","请求失败: "+e.msg)})}}}]),angular.module("app").directive("nodeDebugLog",["instantNodeLogService",function(e){return{strict:"EA",template:'<textarea class="form-control node-debug-log" readonly ng-model="logs"></textarea>',scope:{nodeId:"="},link:function(t,n,o,r){const{nodeId:i}=t,a=function(){t.logs=e.getNodeLog(i),setTimeout(a,2e3)};a()}}}]).factory("instantNodeLogService",["$rootScope","appService","nodeService","$state","$stateParams","toaster",function(e,t,n,o,r,i){return{MAP_DIRECTION_LABEL:{source:"输出",target:"输入"},nodeLogs:{},isNodeDataLogEnabled:{},edgeAnimator:null,nodeDataLogSocket:null,appendLogString:function(e,t){this.nodeLogs[e.node_id]||(this.nodeLogs[e.node_id]=[]),this.nodeLogs[e.node_id].push(`${moment(new Date(e.timestamp)).format("YYYY-MM-DD hh:mm:ss")} 端口${e.port}  ${this.MAP_DIRECTION_LABEL[t]} ${JSON.stringify(e.data)}`)},_enable:function(e){this.nodeDataLogSocket.emit("control.replay",e)},connect:function(){const t=this,o=this.nodeDataLogSocket=window.io(`${location.protocol}//${window.appConfig.predictHost}`,{path:`/socket/${r.id}/pstream`});return o.on("data.replay",function(e){t.edgeAnimator&&(t.edgeAnimator.setAnimationData(e),t.edgeAnimator.animate()),t.packNodeLog(e)}),o.on("listen.replay.status",({success:t,data:n})=>{t&&(e.showFlowAnimation=n)}),o.on("connect",function(){n.getGraph()?t.initAnimator():e.$on("editor.ready",t.initAnimator.bind(t))}),o},disable:function(e){delete this.isNodeDataLogEnabled[e],_.isEmpty(this.isNodeDataLogEnabled)&&this._enable(!1)},disconnect:function(){this.nodeDataLogSocket&&(this.nodeDataLogSocket.disconnect(),this.nodeDataLogSocket=null)},enable:function(e){this.nodeDataLogSocket&&(this.isNodeDataLogEnabled[e]=!0,this._enable(!0))},getNodeLog:function(e){return this.nodeLogs[e]?this.nodeLogs[e].join("\n"):""},initAnimator:function(){n.getGraph()&&(this.edgeAnimator=new window.TheGraph.EdgeAnimator(n.getGraph().edges,{})),this.nodeDataLogSocket&&this.nodeDataLogSocket.emit("query.replay.status")},packNodeLog:function(e){const t=this;for(const n in e)if(e.hasOwnProperty(n)){const{messages:o=[]}=e[n];o.forEach(({source:e,target:n})=>{t.appendLogString(e,"source"),t.appendLogString(n,"target")})}},toggle:function(e){this.nodeDataLogSocket&&this.nodeDataLogSocket.emit("control.replay",{start:e})}}}]).factory("componentLogService",["common","$stateParams",function(e,t){return{processors:{},connect:function(){const e=this.nodeDataLogSocket=window.io({path:`/socket.io/${t.id}/logkit`});return e.on(`publish.app.${t.id}`,e=>{Object.keys(this.processors).forEach(t=>{const{callback:n=(()=>{}),context:o=null,data:r={}}=this.processors[t];n.call(o,e,r)})}),e},disconnect:function(){this.nodeDataLogSocket&&(this.nodeDataLogSocket.disconnect(),this.nodeDataLogSocket=null)},registerLogProcessor:function(t,n=null,o={}){const r=e.uuid();return this.processors[r]={callback:t,context:n,data:o},r},unregisterLogProcessor:function(e){delete this.processors[e]},clean:function(){this.nodeDataLogSocket.emit("clean",{app:t.id})},query:function(){this.nodeDataLogSocket.emit("query",{app:t.id})},append:function(e){this.nodeDataLogSocket.emit("append",{app:t.id,logs:e})}}}]),angular.module("app").factory("eventService",[function(){return{EVENTS:{sp:{node:{select:"sp:node:select"},ng:{transition:{success:"sp:transition:success"}}},rto:{setting:{params:"rto:setting:params"}}},getPubSub:function(){return window.PubSub},emit:function(e,t){this.getPubSub().publish(e,t)},on:function(e,t){return this.getPubSub().subscribe(e,t)},off:function(e){return this.getPubSub().unsubscribe(e)}}}]),angular.module("app").factory("tableService",["$rootScope","format","$q","remoteService","nodeService","appDataStoreService",function(e,t,n,o,r,i){let a={getUpstreamTableName:function(o,i,s){let l,c,p=n.defer(),u=r.getNode(i);for(let e in u.metadata.def.params){let t=u.metadata.def.params[e];if(t.controlInstUuid===s){l=t.defInPortUuid||"in1",c=t;break}}if(l){let n=r.getUpstreamNodeByPort(i,l);if(n){let r=n.node,i=n.port;const s={"{{userId}}":e.appConfig.userId,"{{appId}}":o,"{{nodeId}}":r};a.getNodeTableName(o,r,i).then(function(e){p.resolve({propertyName:e.propertyName,value:t(e.value,s),controlObj:c})},function(e){p.reject("未获取到上游节点输出表名")})}else p.reject("未找到上游节点")}else p.reject("未获取到输入桩信息");return p.promise},getNodeTableName:function(e,t,i){let a=n.defer(),s=r.getNode(t),l=!1;for(let e=0;e<s.metadata.def.ports.length;e++){let t=s.metadata.def.ports[e];if("in"===t.ioType&&0!==t.display){l=!0;break}}let c="xuelang"===s.metadata.def.author&&"save"===s.metadata.def.codeName;if(!l||c)for(let e in s.metadata.def.params){let t=s.metadata.def.params[e];t.defOutPortUuid!==i||"tableName"!==t.propertyName&&"dataName"!==t.propertyName||a.resolve(t)}else{let n=_.find(_.values(s.metadata.def.params),{defOutPortUuid:i});if(n)if(_.isEmpty(n.value))if("tableName"==n.propertyName)o.get("/table/name/"+e+"/"+t+"/"+i).then(function(e){a.resolve({propertyName:"tableName",value:e.table})},function(e){a.reject(e)});else if("dataName"==n.propertyName){let o="studio/"+window.appConfig.userId+"/"+e+"/"+t+"/"+i+"/data/";a.resolve({propertyName:n.propertyName,value:o})}else a.reject("类型不匹配");else a.resolve({propertyName:n.propertyName,value:n.value})}return a.promise},getTableMeta:function(e,t){let r=n.defer();return"dataName"==t?i.get(e+"data.csv").then(function(e){let t=_.slice(_.split(e.split(/\r\n|\n/)[0],","),1);r.resolve(t)},function(e){r.reject(e)}):o.post("/table/meta/"+e,{}).then(function(e){r.resolve(e)},function(e){r.reject(e)}),r.promise},listTable:function(e){let t=n.defer();return o.post("/table/list/"+e,{}).then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise},existTable:function(e){let t=n.defer();return o.post("/table/exist/"+e,{}).then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise}};return a}]),angular.module("app").factory("dashboardAssetService",["appDataStoreService","userService","$q","$rootScope",function(e,t,n,o){return{nextMarker:null,filter:"",maxKeys:10,listImages:function(){const t=this;let o=n.defer();const r=`studio/${window.appConfig.userId}/dashboard/assets/`;return e.list(r,this.nextMarker,this.maxKeys).then(function(e){const n=e.data;t.nextMarker=n.NextMarker;let r=n.Contents.sort((e,t)=>moment(e.LastModified).isBefore(moment(t.LastModified))?1:-1).map(e=>({type:"image",key:e.Key,name:e.Key.slice(e.Key.lastIndexOf("/")+1),src:`/oss_public/${e.Key}`}));t.filter&&(r=r.filter(function(e){return e.name.indexOf(t.filter.trim())>-1})),o.resolve(r.map(e=>_.assign(e)))},function(e){o.reject(e)}),o.promise},reset:function(){this.nextMarker=null,this.filter="",this.maxKeys=10},search:function(e){return this.filter=e||"",this.nextMarker=null,this.maxKeys=e?1e3:10,this.listImages()},uploadImage:function(t){let o=n.defer(),r=t.name||"",i=`${(new Date).getTime()}_${r}`;const a=`studio/${window.appConfig.userId}/dashboard/assets/${i}`;return e.upload(a,t,function(){},function(e){o.reject(e)},function(n){const r={name:t.name,key:a,src:`/oss_public/${a}`};"oss"===window.appConfig.ossType?e.putObjectAcl(window.appConfig.oss.bucket,a,"public-read").then(()=>{o.resolve(r)},e=>{console.warn("set public failed",e),o.reject(e)}):o.resolve(r)}),o.promise},deleteImage:function(t){let o=n.defer();return t.key?e.remove(t.key).then(function(e){o.resolve(t)},function(e){o.reject(e)}):o.resolve(t),o.promise}}}]),angular.module("app").factory("statisticsService",["$http",function(){let e={UNDEFINED:"未定义行为",COMMON:{LOGIN:"登录",LOGOUT:"登出",ERROR:"页面错误",EXPORTMODEL:"导出模型"},APP:{CREATE:"创建算法项目",COPY:"复制算法项目",DUPLICATE_FROM_TEMPLATE:"从模板复制算法项目",IMPORT:"导入模板",EXPORT:"导出项目",SHARE:"分享算法项目",DELETE:"删除算法项目",RUN:"运行算法项目",STOP:"停止算法项目",ERROR:"运行报错",RUNCRON:"创建定时任务",STOPCRON:"取消定时任务"},SERVICE:{CREATE:"创建应用项目",COPY:"复制应用项目",SHARE:"分享应用项目",DELETE:"删除应用项目",RUN:"部署应用项目",STOP:"释放应用项目",ERROR:"运行报错"},COMPONENT:{CREATE:"新建组件",IMPORT:"导入组件",EXPORT:"导出组件",SHARE:"分享组件",COPY:"复制组件",DEL:"删除组件",EDIT_PARAM:"修改组件参数",DROP_IN:"拖入组件",CONNECT:"连接组件",VSCODE:"使用VSCODE",CREATE_FROM_VSCODE:"使用VSCODE生成组件"}},t={USER_ID:"用户ID",USER_NAME:"用户名",TIME:"操作时间",VERSION:"当前版本",APP_ID:"项目ID",OSS_TYPE:"存储类型"},n=`${appConfig.userId}_${appConfig.userName}_${appConfig.version}_${appConfig.address?appConfig.address.address:""}`,o={STAT_ACTIONS:e,DEFAULT_OPT_LABEL:n,OPT_LABEL:t};return $.ajax({url:"https://api.map.baidu.com/location/ip?ak=0A9seER1BLoS4QAx925rzNUAkq8KmNhv",type:"GET",async:!1,dataType:"jsonp",timeout:5e3,contentType:"application/json; charset=utf-8",success:function(e){window.appConfig.address=e.content}}),o.trackEvent=function(t=e.UNDEFINED,o=n,r){window._hmt&&window._hmt.push(["_trackEvent",`${appConfig.env}_${location.hostname}`,t,`${o}_${+new Date}`,r])},o.trackLoginEvent=function(){window._hmt&&window._hmt.push(["_trackEvent",`${appConfig.env}_${location.hostname}`,e.COMMON.LOGIN,`${appConfig.userId}_${appConfig.userName}_${appConfig.version}_${appConfig.address?appConfig.address.address:""}_${+new Date}`])},o.trackLogoutEvent=function(){window._hmt&&window._hmt.push(["_trackEvent",`${appConfig.env}_${location.hostname}`,e.COMMON.LOGOUT,`${appConfig.userId}_${appConfig.userName}_${appConfig.version}_${appConfig.address?appConfig.address.address:""}_${+new Date}`])},o.trackErrorEvent=function(n){window._hmt&&window._hmt.push(["_trackEvent",`${appConfig.env}_${location.hostname}`,e.COMMON.ERROR,[`${t.USER_ID}: ${appConfig.userId}`,`${t.USER_NAME}: ${appConfig.userName}`,`${t.VERSION}: ${appConfig.version}`,`${t.APP_ID}: ${appConfig.appId}`,`${t.OSS_TYPE}: ${appConfig.ossType}`,n.msg,n.url,n.lineNo,n.columnNo,n.error,new Date].join("-")])},o.trackAppEvent=function(t,{appId:n="",appName:o=""}=appInfo,r){t===e.APP.STOP&&(t=e.APP.RUN,r=r||-1),window._hmt&&window._hmt.push(["_trackEvent",appConfig.env,t,[appConfig.userId,appConfig.userName,"算法项目",n,o].join("-"),r])},o.trackServiceEvent=function(t,{serviceId:n="",serviceName:o=""}=appInfo,r){t===e.SERVICE.STOP&&(t=e.SERVICE.RUN,r=r||-1),window._hmt&&window._hmt.push(["_trackEvent",appConfig.env,t,[appConfig.userId,appConfig.userName,"应用项目",n,o].join("-"),r])},o}]),angular.module("app").factory("uiService",["$rootScope","applyFn",function(e,t){return e.uiConfig={isShowHeader:!0,isShowScreenshot:!0},{showHeader:function(n){t(function(){e.uiConfig.isShowHeader=n})},showScreenshot:function(n){t(function(){e.uiConfig.isShowScreenshot=n})}}}]),angular.module("app").factory("appDataStoreService",["$q","remoteService","ossService","localStorageService","fileServerService","toaster",function(e,t,n,o,r,i){let a=window.appConfig.oss.bucket,s=window.appConfig.appDataStoreType,l={head:function(e){return n.headObject(a,e)},get:function(e,t){return n.getObject(a,e,null,t)},list:function(e,n,o=1e3){return t.post("/oss/object/list",{Bucket:a,Key:e,Delimiter:"/",Marker:n,MaxKeys:o})},putObjectAcl:function(e,t,o){return n.putObjectAcl(e,t,o)},url:function(e){return t.post("/oss/object/get",{Bucket:a,Key:e})},upload:function(e,o,r,s,l){return t.post("/oss/object/check",{Bucket:a,Key:e,type:"put"}).then(function(t){if(t.success)return n.upload(e,o,r,s,l)},function(e){i.pop("error","上传失败："+e.msg)})},remove:function(e){function t(e){return n.deleteObject(a,e)}return l.head(e).then(function(){return t(e)},function(){return function e(n,o){return l.list(n,o).then(function(o){if(o.success){let r=o.data.NextMarker?[e(n,o.data.NextMarker)]:[],i=_.map(o.data.Contents,function(e){return t(e.Key)}),a=_.map(o.data.CommonPrefixes,function(t){return e(t.Prefix)});return r.concat(i,a)}})}(e)})},copy:function(e,t){},sync:function(t,n){return console.debug("Nothing to sync (appDataStoreType is oss)"),e.resolve()}},c={oss:l,minio:l,local:{head:function(e){return o.head(e)},get:function(e){return o.get(e)},list:function(e,t){return o.list(e,t)},url:function(e){return o.url(e)},upload:function(e,t,n,r,i){return o.upload(e,t,n,r,i)},remove:function(e){return o.remove(e)},sync:function(e,t){return new Promise(function(n,r){o.sync(e,t).then(function(e){n(e)}).catch(function(e){n()})})}},fileServer:{head:function(e){return r.head(e)},get:function(e){return r.get(e)},list:function(e,t){return r.list(e,t)},url:function(e){return r.url(e)},upload:function(e,t,n,o,i){return r.upload(e,t,n,o,i)},remove:function(e){return r.remove(e)},sync:function(e,t){return new Promise(function(n,o){r.sync(e,t).then(function(e){n(e)}).catch(function(e){n()})})}}}[s];if(!c)throw Error("Unknown App Data Store Type: "+s);return c}]),angular.module("app").factory("localStorageService",["$q","$http","remoteService",function(e,t,n){return{url:function(t){return e.resolve({success:!0,data:"/local/"+t})},head:function(e){return n.head("/local/"+e).then(function(e){return e.ContentType=e.headers("Content-Type"),e.ContentLength=e.headers("Content-Length"),e})},get:function(e){return t.get("/local/"+e).then(function(e){return e.data})},list:function(e){return n.post("/local/list",{Key:e})},upload:function(e,t,o,r,i){return n.post("/local/upload",{Key:e,file:t.path}).then(function(e){return i(e),e},function(e){throw r(e),e})},remove:function(e){return n.post("/local/remove",{Key:e})},sync:function(e,t){return n.post("/local/sync",{key:e,action:t})}}}]),angular.module("app").factory("fileServerService",["$q","$http","localStorageService",function(e,t,n){return{url:n.url,head:n.head,get:n.get,list:n.list,upload:function(n,o,r,i,a){let s=e.defer();return t({method:"POST",url:"/local/upload",headers:{"Content-Type":void 0},data:{key:n,files:o},transformRequest:function(e,t){return Object.keys(e).reduce(function(t,n){return t.append(n,e[n]),t},new FormData)},uploadEventHandlers:{progress:r}}).then(function(e){a(e),s.resolve(e)},function(e){i(e),s.reject(e)}),s.promise},remove:n.remove,sync:n.sync}}]);